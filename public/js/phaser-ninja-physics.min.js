/*
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}

 @overview

 Phaser - http://phaser.io

 v2.4.2 "Altara" - Built: Sun Aug 02 2015 14:29:40

 By Richard Davey http://www.photonstorm.com @photonstorm

 Phaser is a fun, free and fast 2D game framework for making HTML5 games
 for desktop and mobile web browsers, supporting Canvas and WebGL rendering.

 Phaser uses Pixi.js for rendering, created by Mat Groves http://matgroves.com @Doormat23
 Phaser uses p2.js for full-body physics, created by Stefan Hedman https://github.com/schteppe/p2.js @schteppe
 Phaser contains a port of N+ Physics, converted by Richard Davey, original by http://www.metanetsoftware.com

 Many thanks to Adam Saltsman (@ADAMATOMIC) for releasing Flixel, from which both Phaser
 and my love of framework development originate.

 Follow development at http://phaser.io and on our forum

 "If you want your children to be intelligent,  read them fairy tales."
 "If you want them to be more intelligent, read them more fairy tales."
                                                     -- Albert Einstein
 Mat Groves, Rovanion Luckey
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd, Richard Davey
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd, Richard Davey
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
 Â© 2012 Timo Hausmann

 Permission is hereby granted, free of charge, to any person obtaining
 a copy of this software and associated documentation files (the
 "Software"), to deal in the Software without restriction, including
 without limitation the rights to use, copy, modify, merge, publish,
 distribute, sublicense, and/or sell copies of the Software, and to
 permit persons to whom the Software is furnished to do so, subject to
 the following conditions:

 The above copyright notice and this permission notice shall be
 included in all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
    2015 Photon Storm Ltd.
 @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}
*/
(function(){var f=f||{};f.WEBGL_RENDERER=0;f.CANVAS_RENDERER=1;f.VERSION="v2.2.8";f._UID=0;"undefined"!=typeof Float32Array?(f.Float32Array=Float32Array,f.Uint16Array=Uint16Array,f.Uint32Array=Uint32Array,f.ArrayBuffer=ArrayBuffer):(f.Float32Array=Array,f.Uint16Array=Array);f.PI_2=2*Math.PI;f.RAD_TO_DEG=180/Math.PI;f.DEG_TO_RAD=Math.PI/180;f.RETINA_PREFIX="@2x";f.defaultRenderOptions={view:null,transparent:!1,antialias:!1,preserveDrawingBuffer:!1,resolution:1,clearBeforeRender:!0,autoResize:!1};f.DisplayObject=
function(){this.position=new f.Point(0,0);this.scale=new f.Point(1,1);this.transformCallbackContext=this.transformCallback=null;this.pivot=new f.Point(0,0);this.rotation=0;this.alpha=1;this.visible=!0;this.hitArea=null;this.renderable=!1;this.stage=this.parent=null;this.worldAlpha=1;this.worldTransform=new f.Matrix;this.worldPosition=new f.Point(0,0);this.worldScale=new f.Point(1,1);this._sr=this.worldRotation=0;this._cr=1;this.filterArea=null;this._bounds=new f.Rectangle(0,0,1,1);this._mask=this._currentBounds=
null;this._cacheIsDirty=this._cacheAsBitmap=!1};f.DisplayObject.prototype.constructor=f.DisplayObject;f.DisplayObject.prototype.destroy=function(){if(this.children){for(var b=this.children.length;b--;)this.children[b].destroy();this.children=[]}this._mask=this._currentBounds=this._bounds=this.filterArea=this.worldTransform=this.stage=this.parent=this.hitArea=this.transformCallbackContext=this.transformCallback=null;this.renderable=!1;this._destroyCachedSprite()};Object.defineProperty(f.DisplayObject.prototype,
"worldVisible",{get:function(){var b=this;do{if(!b.visible)return!1;b=b.parent}while(b);return!0}});Object.defineProperty(f.DisplayObject.prototype,"mask",{get:function(){return this._mask},set:function(b){this._mask&&(this._mask.isMask=!1);if(this._mask=b)this._mask.isMask=!0}});Object.defineProperty(f.DisplayObject.prototype,"filters",{get:function(){return this._filters},set:function(b){if(b){for(var h=[],f=0;f<b.length;f++)for(var k=b[f].passes,n=0;n<k.length;n++)h.push(k[n]);this._filterBlock=
{target:this,filterPasses:h}}this._filters=b}});Object.defineProperty(f.DisplayObject.prototype,"cacheAsBitmap",{get:function(){return this._cacheAsBitmap},set:function(b){this._cacheAsBitmap!==b&&(b?this._generateCachedSprite():this._destroyCachedSprite(),this._cacheAsBitmap=b)}});f.DisplayObject.prototype.updateTransform=function(b){if(b||this.parent||this.game){var h=this.parent;b?h=b:this.parent||(h=this.game.world);b=h.worldTransform;var m=this.worldTransform,k,n,a,c,d,e;if(this.rotation%f.PI_2){this.rotation!==
this.rotationCache&&(this.rotationCache=this.rotation,this._sr=Math.sin(this.rotation),this._cr=Math.cos(this.rotation));k=this._cr*this.scale.x;n=this._sr*this.scale.x;a=-this._sr*this.scale.y;c=this._cr*this.scale.y;d=this.position.x;e=this.position.y;if(this.pivot.x||this.pivot.y)d-=this.pivot.x*k+this.pivot.y*a,e-=this.pivot.x*n+this.pivot.y*c;m.a=k*b.a+n*b.c;m.b=k*b.b+n*b.d;m.c=a*b.a+c*b.c;m.d=a*b.b+c*b.d}else k=this.scale.x,c=this.scale.y,d=this.position.x-this.pivot.x*k,e=this.position.y-this.pivot.y*
c,m.a=k*b.a,m.b=k*b.b,m.c=c*b.c,m.d=c*b.d;m.tx=d*b.a+e*b.c+b.tx;m.ty=d*b.b+e*b.d+b.ty;this.worldAlpha=this.alpha*h.worldAlpha;this.worldPosition.set(m.tx,m.ty);this.worldScale.set(Math.sqrt(m.a*m.a+m.b*m.b),Math.sqrt(m.c*m.c+m.d*m.d));this.worldRotation=Math.atan2(-m.c,m.d);this._currentBounds=null;this.transformCallback&&this.transformCallback.call(this.transformCallbackContext,m,b)}};f.DisplayObject.prototype.displayObjectUpdateTransform=f.DisplayObject.prototype.updateTransform;f.DisplayObject.prototype.getBounds=
function(b){return f.EmptyRectangle};f.DisplayObject.prototype.getLocalBounds=function(){return this.getBounds(f.identityMatrix)};f.DisplayObject.prototype.setStageReference=function(b){this.stage=b};f.DisplayObject.prototype.preUpdate=function(){};f.DisplayObject.prototype.generateTexture=function(b,h,m){var k=this.getLocalBounds();b=new f.RenderTexture(k.width|0,k.height|0,m,h,b);f.DisplayObject._tempMatrix.tx=-k.x;f.DisplayObject._tempMatrix.ty=-k.y;b.render(this,f.DisplayObject._tempMatrix);return b};
f.DisplayObject.prototype.updateCache=function(){this._generateCachedSprite()};f.DisplayObject.prototype.toGlobal=function(b){this.displayObjectUpdateTransform();return this.worldTransform.apply(b)};f.DisplayObject.prototype.toLocal=function(b,h){h&&(b=h.toGlobal(b));this.displayObjectUpdateTransform();return this.worldTransform.applyInverse(b)};f.DisplayObject.prototype._renderCachedSprite=function(b){this._cachedSprite.worldAlpha=this.worldAlpha;b.gl?f.Sprite.prototype._renderWebGL.call(this._cachedSprite,
b):f.Sprite.prototype._renderCanvas.call(this._cachedSprite,b)};f.DisplayObject.prototype._generateCachedSprite=function(){this._cacheAsBitmap=!1;var b=this.getLocalBounds();if(this._cachedSprite)this._cachedSprite.texture.resize(b.width|0,b.height|0);else{var h=new f.RenderTexture(b.width|0,b.height|0);this._cachedSprite=new f.Sprite(h);this._cachedSprite.worldTransform=this.worldTransform}h=this._filters;this._filters=null;this._cachedSprite.filters=h;f.DisplayObject._tempMatrix.tx=-b.x;f.DisplayObject._tempMatrix.ty=
-b.y;this._cachedSprite.texture.render(this,f.DisplayObject._tempMatrix,!0);this._cachedSprite.anchor.x=-(b.x/b.width);this._cachedSprite.anchor.y=-(b.y/b.height);this._filters=h;this._cacheAsBitmap=!0};f.DisplayObject.prototype._destroyCachedSprite=function(){this._cachedSprite&&(this._cachedSprite.texture.destroy(!0),this._cachedSprite=null)};f.DisplayObject.prototype._renderWebGL=function(b){};f.DisplayObject.prototype._renderCanvas=function(b){};Object.defineProperty(f.DisplayObject.prototype,
"x",{get:function(){return this.position.x},set:function(b){this.position.x=b}});Object.defineProperty(f.DisplayObject.prototype,"y",{get:function(){return this.position.y},set:function(b){this.position.y=b}});f.DisplayObjectContainer=function(){f.DisplayObject.call(this);this.children=[]};f.DisplayObjectContainer.prototype=Object.create(f.DisplayObject.prototype);f.DisplayObjectContainer.prototype.constructor=f.DisplayObjectContainer;Object.defineProperty(f.DisplayObjectContainer.prototype,"width",
{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(b){var h=this.getLocalBounds().width;this.scale.x=0!==h?b/h:1;this._width=b}});Object.defineProperty(f.DisplayObjectContainer.prototype,"height",{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(b){var h=this.getLocalBounds().height;this.scale.y=0!==h?b/h:1;this._height=b}});f.DisplayObjectContainer.prototype.addChild=function(b){return this.addChildAt(b,this.children.length)};f.DisplayObjectContainer.prototype.addChildAt=
function(b,h){if(0<=h&&h<=this.children.length)return b.parent&&b.parent.removeChild(b),b.parent=this,this.children.splice(h,0,b),this.stage&&b.setStageReference(this.stage),b;throw Error(b+"addChildAt: The index "+h+" supplied is out of bounds "+this.children.length);};f.DisplayObjectContainer.prototype.swapChildren=function(b,h){if(b!==h){var f=this.getChildIndex(b),k=this.getChildIndex(h);if(0>f||0>k)throw Error("swapChildren: Both the supplied DisplayObjects must be a child of the caller.");this.children[f]=
h;this.children[k]=b}};f.DisplayObjectContainer.prototype.getChildIndex=function(b){b=this.children.indexOf(b);if(-1===b)throw Error("The supplied DisplayObject must be a child of the caller");return b};f.DisplayObjectContainer.prototype.setChildIndex=function(b,h){if(0>h||h>=this.children.length)throw Error("The supplied index is out of bounds");var f=this.getChildIndex(b);this.children.splice(f,1);this.children.splice(h,0,b)};f.DisplayObjectContainer.prototype.getChildAt=function(b){if(0>b||b>=
this.children.length)throw Error("getChildAt: Supplied index "+b+" does not exist in the child list, or the supplied DisplayObject must be a child of the caller");return this.children[b]};f.DisplayObjectContainer.prototype.removeChild=function(b){b=this.children.indexOf(b);if(-1!==b)return this.removeChildAt(b)};f.DisplayObjectContainer.prototype.removeChildAt=function(b){var h=this.getChildAt(b);this.stage&&h.removeStageReference();h.parent=void 0;this.children.splice(b,1);return h};f.DisplayObjectContainer.prototype.removeChildren=
function(b,h){var f=b||0,k="number"===typeof h?h:this.children.length,n=k-f;if(0<n&&n<=k){f=this.children.splice(f,n);for(k=0;k<f.length;k++)n=f[k],this.stage&&n.removeStageReference(),n.parent=void 0;return f}if(0===n&&0===this.children.length)return[];throw Error("removeChildren: Range Error, numeric values are outside the acceptable range");};f.DisplayObjectContainer.prototype.updateTransform=function(){if(this.visible&&(this.displayObjectUpdateTransform(),!this._cacheAsBitmap))for(var b=0;b<this.children.length;b++)this.children[b].updateTransform()};
f.DisplayObjectContainer.prototype.displayObjectContainerUpdateTransform=f.DisplayObjectContainer.prototype.updateTransform;f.DisplayObjectContainer.prototype.getBounds=function(){if(0===this.children.length)return f.EmptyRectangle;for(var b=Infinity,h=Infinity,m=-Infinity,k=-Infinity,n,a,c=!1,d=0,e=this.children.length;d<e;d++)this.children[d].visible&&(c=!0,n=this.children[d].getBounds(),b=b<n.x?b:n.x,h=h<n.y?h:n.y,a=n.width+n.x,n=n.height+n.y,m=m>a?m:a,k=k>n?k:n);if(!c)return f.EmptyRectangle;
a=this._bounds;a.x=b;a.y=h;a.width=m-b;a.height=k-h;return a};f.DisplayObjectContainer.prototype.getLocalBounds=function(){var b=this.worldTransform;this.worldTransform=f.identityMatrix;for(var h=0,m=this.children.length;h<m;h++)this.children[h].updateTransform();h=this.getBounds();this.worldTransform=b;return h};f.DisplayObjectContainer.prototype.setStageReference=function(b){this.stage=b;for(var h=0;h<this.children.length;h++)this.children[h].setStageReference(b)};f.DisplayObjectContainer.prototype.removeStageReference=
function(){for(var b=0;b<this.children.length;b++)this.children[b].removeStageReference();this.stage=null};f.DisplayObjectContainer.prototype._renderWebGL=function(b){if(this.visible&&!(0>=this.alpha))if(this._cacheAsBitmap)this._renderCachedSprite(b);else{var h;if(this._mask||this._filters){this._filters&&(b.spriteBatch.flush(),b.filterManager.pushFilter(this._filterBlock));this._mask&&(b.spriteBatch.stop(),b.maskManager.pushMask(this.mask,b),b.spriteBatch.start());for(h=0;h<this.children.length;h++)this.children[h]._renderWebGL(b);
b.spriteBatch.stop();this._mask&&b.maskManager.popMask(this._mask,b);this._filters&&b.filterManager.popFilter();b.spriteBatch.start()}else for(h=0;h<this.children.length;h++)this.children[h]._renderWebGL(b)}};f.DisplayObjectContainer.prototype._renderCanvas=function(b){if(!1!==this.visible&&0!==this.alpha)if(this._cacheAsBitmap)this._renderCachedSprite(b);else{this._mask&&b.maskManager.pushMask(this._mask,b);for(var h=0;h<this.children.length;h++)this.children[h]._renderCanvas(b);this._mask&&b.maskManager.popMask(b)}};
f.Sprite=function(b){f.DisplayObjectContainer.call(this);this.anchor=new f.Point;this.texture=b||f.Texture.emptyTexture;this._height=this._width=0;this.tint=16777215;this.cachedTint=-1;this.tintedTexture=null;this.blendMode=f.blendModes.NORMAL;this.shader=null;if(this.texture.baseTexture.hasLoaded)this.onTextureUpdate();this.renderable=!0};f.Sprite.prototype=Object.create(f.DisplayObjectContainer.prototype);f.Sprite.prototype.constructor=f.Sprite;Object.defineProperty(f.Sprite.prototype,"width",{get:function(){return this.scale.x*
this.texture.frame.width},set:function(b){this.scale.x=b/this.texture.frame.width;this._width=b}});Object.defineProperty(f.Sprite.prototype,"height",{get:function(){return this.scale.y*this.texture.frame.height},set:function(b){this.scale.y=b/this.texture.frame.height;this._height=b}});f.Sprite.prototype.setTexture=function(b){this.texture=b;this.texture.valid=!0};f.Sprite.prototype.onTextureUpdate=function(){this._width&&(this.scale.x=this._width/this.texture.frame.width);this._height&&(this.scale.y=
this._height/this.texture.frame.height)};f.Sprite.prototype.getBounds=function(b){var h=this.texture.frame.width,f=this.texture.frame.height,k=h*(1-this.anchor.x),h=h*-this.anchor.x,n=f*(1-this.anchor.y),a=f*-this.anchor.y;b=b||this.worldTransform;var c=b.a,d=b.b,e=b.c,g=b.d,l=b.tx,p=b.ty,f=b=-Infinity,u=Infinity,y=Infinity;if(0===d&&0===e)0>c&&(c*=-1),0>g&&(g*=-1),u=c*h+l,b=c*k+l,y=g*a+p,f=g*n+p;else{var w=c*h+e*a+l,q=g*a+d*h+p,t=c*k+e*a+l,a=g*a+d*k+p,r=c*k+e*n+l,k=g*n+d*k+p,c=c*h+e*n+l,h=g*n+d*
h+p,u=w<u?w:u,u=t<u?t:u,u=r<u?r:u,u=c<u?c:u,y=q<y?q:y,y=a<y?a:y,y=k<y?k:y,y=h<y?h:y;b=w>b?w:b;b=t>b?t:b;b=r>b?r:b;b=c>b?c:b;f=q>f?q:f;f=a>f?a:f;f=k>f?k:f;f=h>f?h:f}h=this._bounds;h.x=u;h.width=b-u;h.y=y;h.height=f-y;return this._currentBounds=h};f.Sprite.prototype._renderWebGL=function(b,h){if(this.visible&&!(0>=this.alpha)&&this.renderable){var f=this.worldTransform;h&&(f=h);if(this._mask||this._filters){f=b.spriteBatch;this._filters&&(f.flush(),b.filterManager.pushFilter(this._filterBlock));this._mask&&
(f.stop(),b.maskManager.pushMask(this.mask,b),f.start());f.render(this);for(var k=0;k<this.children.length;k++)this.children[k]._renderWebGL(b);f.stop();this._mask&&b.maskManager.popMask(this._mask,b);this._filters&&b.filterManager.popFilter();f.start()}else for(b.spriteBatch.render(this),k=0;k<this.children.length;k++)this.children[k]._renderWebGL(b,f)}};f.Sprite.prototype._renderCanvas=function(b,h){if(!(!1===this.visible||0===this.alpha||!1===this.renderable||0>=this.texture.crop.width||0>=this.texture.crop.height)){var m=
this.worldTransform;h&&(m=h);this.blendMode!==b.currentBlendMode&&(b.currentBlendMode=this.blendMode,b.context.globalCompositeOperation=f.blendModesCanvas[b.currentBlendMode]);this._mask&&b.maskManager.pushMask(this._mask,b);if(this.texture.valid){var k=this.texture.baseTexture.resolution/b.resolution;b.context.globalAlpha=this.worldAlpha;b.smoothProperty&&b.scaleMode!==this.texture.baseTexture.scaleMode&&(b.scaleMode=this.texture.baseTexture.scaleMode,b.context[b.smoothProperty]=b.scaleMode===f.scaleModes.LINEAR);
var n=this.texture.trim?this.texture.trim.x-this.anchor.x*this.texture.trim.width:this.anchor.x*-this.texture.frame.width,a=this.texture.trim?this.texture.trim.y-this.anchor.y*this.texture.trim.height:this.anchor.y*-this.texture.frame.height;b.roundPixels?(b.context.setTransform(m.a,m.b,m.c,m.d,m.tx*b.resolution|0,m.ty*b.resolution|0),n|=0,a|=0):b.context.setTransform(m.a,m.b,m.c,m.d,m.tx*b.resolution,m.ty*b.resolution);var m=this.texture.crop.width,c=this.texture.crop.height,n=n/k,a=a/k;if(16777215!==
this.tint){if(this.texture.requiresReTint||this.cachedTint!==this.tint)this.tintedTexture=f.CanvasTinter.getTintedTexture(this,this.tint),this.cachedTint=this.tint;b.context.drawImage(this.tintedTexture,0,0,m,c,n,a,m/k,c/k)}else b.context.drawImage(this.texture.baseTexture.source,this.texture.crop.x,this.texture.crop.y,m,c,n,a,m/k,c/k)}for(k=0;k<this.children.length;k++)this.children[k]._renderCanvas(b);this._mask&&b.maskManager.popMask(b)}};f.Sprite.fromFrame=function(b){var h=f.TextureCache[b];
if(!h)throw Error('The frameId "'+b+'" does not exist in the texture cache'+this);return new f.Sprite(h)};f.Sprite.fromImage=function(b,h,m){b=f.Texture.fromImage(b,h,m);return new f.Sprite(b)};f.SpriteBatch=function(b){f.DisplayObjectContainer.call(this);this.textureThing=b;this.ready=!1};f.SpriteBatch.prototype=Object.create(f.DisplayObjectContainer.prototype);f.SpriteBatch.prototype.constructor=f.SpriteBatch;f.SpriteBatch.prototype.initWebGL=function(b){this.fastSpriteBatch=new f.WebGLFastSpriteBatch(b);
this.ready=!0};f.SpriteBatch.prototype.updateTransform=function(){this.displayObjectUpdateTransform()};f.SpriteBatch.prototype._renderWebGL=function(b){!this.visible||0>=this.alpha||!this.children.length||(this.ready||this.initWebGL(b.gl),this.fastSpriteBatch.gl!==b.gl&&this.fastSpriteBatch.setContext(b.gl),b.spriteBatch.stop(),b.shaderManager.setShader(b.shaderManager.fastShader),this.fastSpriteBatch.begin(this,b),this.fastSpriteBatch.render(this),b.spriteBatch.start())};f.SpriteBatch.prototype._renderCanvas=
function(b){if(this.visible&&!(0>=this.alpha)&&this.children.length){var h=b.context;h.globalAlpha=this.worldAlpha;this.displayObjectUpdateTransform();for(var f=this.worldTransform,k=!0,n=0;n<this.children.length;n++){var a=this.children[n];if(a.visible){var c=a.texture,d=c.frame;h.globalAlpha=this.worldAlpha*a.alpha;if(0===a.rotation%(2*Math.PI))k&&(h.setTransform(f.a,f.b,f.c,f.d,f.tx,f.ty),k=!1),h.drawImage(c.baseTexture.source,d.x,d.y,d.width,d.height,a.anchor.x*-d.width*a.scale.x+a.position.x+
.5|0,a.anchor.y*-d.height*a.scale.y+a.position.y+.5|0,d.width*a.scale.x,d.height*a.scale.y);else{k||(k=!0);a.displayObjectUpdateTransform();var e=a.worldTransform;b.roundPixels?h.setTransform(e.a,e.b,e.c,e.d,e.tx|0,e.ty|0):h.setTransform(e.a,e.b,e.c,e.d,e.tx,e.ty);h.drawImage(c.baseTexture.source,d.x,d.y,d.width,d.height,a.anchor.x*-d.width+.5|0,a.anchor.y*-d.height+.5|0,d.width,d.height)}}}}};f.Stage=function(b){f.DisplayObjectContainer.call(this);this.worldTransform=new f.Matrix;this.stage=this;
this.setBackgroundColor(b)};f.Stage.prototype=Object.create(f.DisplayObjectContainer.prototype);f.Stage.prototype.constructor=f.Stage;f.Stage.prototype.updateTransform=function(){this.worldAlpha=1;for(var b=0;b<this.children.length;b++)this.children[b].updateTransform()};f.Stage.prototype.setBackgroundColor=function(b){this.backgroundColor=b||0;this.backgroundColorSplit=f.hex2rgb(this.backgroundColor);b=this.backgroundColor.toString(16);b="000000".substr(0,6-b.length)+b;this.backgroundColorString=
"#"+b};f.hex2rgb=function(b){return[(b>>16&255)/255,(b>>8&255)/255,(b&255)/255]};f.rgb2hex=function(b){return(255*b[0]<<16)+(255*b[1]<<8)+255*b[2]};f.canUseNewCanvasBlendModes=function(){if(void 0===document)return!1;var b=new Image;b.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAABAQMAAADD8p2OAAAAA1BMVEX/AP804Oa6AAAACklEQVQI12NgAAAAAgAB4iG8MwAAAABJRU5ErkJggg==";var h=new Image;h.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAABAQMAAADD8p2OAAAAA1BMVEX//wCKxvRFAAAACklEQVQI12NgAAAAAgAB4iG8MwAAAABJRU5ErkJggg==";
var f=document.createElement("canvas");f.width=6;f.height=1;f=f.getContext("2d");f.globalCompositeOperation="multiply";f.drawImage(b,0,0);f.drawImage(h,2,0);if(!f.getImageData(2,0,1,1))return!1;b=f.getImageData(2,0,1,1).data;return 255===b[0]&&0===b[1]&&0===b[2]};f.getNextPowerOfTwo=function(b){if(0<b&&0===(b&b-1))return b;for(var h=1;h<b;)h<<=1;return h};f.isPowerOfTwo=function(b,h){return 0<b&&0===(b&b-1)&&0<h&&0===(h&h-1)};f.PolyK={};f.PolyK.Triangulate=function(b){var h=!0,m=b.length>>1;if(3>
m)return[];for(var k=[],n=[],a=0;a<m;a++)n.push(a);for(var a=0,c=m;3<c;){var d=n[(a+0)%c],e=n[(a+1)%c],g=n[(a+2)%c],l=b[2*d],p=b[2*d+1],u=b[2*e],y=b[2*e+1],w=b[2*g],q=b[2*g+1],t=!1;if(f.PolyK._convex(l,p,u,y,w,q,h))for(var t=!0,r=0;r<c;r++){var x=n[r];if(x!==d&&x!==e&&x!==g&&f.PolyK._PointInTriangle(b[2*x],b[2*x+1],l,p,u,y,w,q)){t=!1;break}}if(t)k.push(d,e,g),n.splice((a+1)%c,1),c--,a=0;else if(a++>3*c)if(h){k=[];n=[];for(a=0;a<m;a++)n.push(a);a=0;c=m;h=!1}else return null}k.push(n[0],n[1],n[2]);
return k};f.PolyK._PointInTriangle=function(b,h,f,k,n,a,c,d){c-=f;d-=k;n-=f;a-=k;b-=f;f=h-k;h=c*c+d*d;k=c*n+d*a;c=c*b+d*f;d=n*n+a*a;n=n*b+a*f;a=1/(h*d-k*k);d=(d*c-k*n)*a;c=(h*n-k*c)*a;return 0<=d&&0<=c&&1>d+c};f.PolyK._convex=function(b,h,f,k,n,a,c){return 0<=(h-k)*(n-f)+(f-b)*(a-k)===c};f.initDefaultShaders=function(){};f.CompileVertexShader=function(b,h){return f._CompileShader(b,h,b.VERTEX_SHADER)};f.CompileFragmentShader=function(b,h){return f._CompileShader(b,h,b.FRAGMENT_SHADER)};f._CompileShader=
function(b,h,f){var k=h;Array.isArray(h)&&(k=h.join("\n"));h=b.createShader(f);b.shaderSource(h,k);b.compileShader(h);return b.getShaderParameter(h,b.COMPILE_STATUS)?h:(window.console.log(b.getShaderInfoLog(h)),null)};f.compileProgram=function(b,h,m){m=f.CompileFragmentShader(b,m);h=f.CompileVertexShader(b,h);var k=b.createProgram();b.attachShader(k,h);b.attachShader(k,m);b.linkProgram(k);b.getProgramParameter(k,b.LINK_STATUS)||window.console.log("Could not initialise shaders");return k};f.PixiShader=
function(b){this._UID=f._UID++;this.gl=b;this.program=null;this.fragmentSrc=["precision lowp float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"];this.textureCount=0;this.dirty=this.firstRun=!0;this.attributes=[];this.init()};f.PixiShader.prototype.constructor=f.PixiShader;f.PixiShader.prototype.init=function(){var b=this.gl,h=f.compileProgram(b,this.vertexSrc||f.PixiShader.defaultVertexSrc,
this.fragmentSrc);b.useProgram(h);this.uSampler=b.getUniformLocation(h,"uSampler");this.projectionVector=b.getUniformLocation(h,"projectionVector");this.offsetVector=b.getUniformLocation(h,"offsetVector");this.dimensions=b.getUniformLocation(h,"dimensions");this.aVertexPosition=b.getAttribLocation(h,"aVertexPosition");this.aTextureCoord=b.getAttribLocation(h,"aTextureCoord");this.colorAttribute=b.getAttribLocation(h,"aColor");-1===this.colorAttribute&&(this.colorAttribute=2);this.attributes=[this.aVertexPosition,
this.aTextureCoord,this.colorAttribute];for(var m in this.uniforms)this.uniforms[m].uniformLocation=b.getUniformLocation(h,m);this.initUniforms();this.program=h};f.PixiShader.prototype.initUniforms=function(){this.textureCount=1;var b=this.gl,h,f;for(f in this.uniforms){h=this.uniforms[f];var k=h.type;"sampler2D"===k?(h._init=!1,null!==h.value&&this.initSampler2D(h)):"mat2"===k||"mat3"===k||"mat4"===k?(h.glMatrix=!0,h.glValueLength=1,"mat2"===k?h.glFunc=b.uniformMatrix2fv:"mat3"===k?h.glFunc=b.uniformMatrix3fv:
"mat4"===k&&(h.glFunc=b.uniformMatrix4fv)):(h.glFunc=b["uniform"+k],h.glValueLength="2f"===k||"2i"===k?2:"3f"===k||"3i"===k?3:"4f"===k||"4i"===k?4:1)}};f.PixiShader.prototype.initSampler2D=function(b){if(b.value&&b.value.baseTexture&&b.value.baseTexture.hasLoaded){var h=this.gl;h.activeTexture(h["TEXTURE"+this.textureCount]);h.bindTexture(h.TEXTURE_2D,b.value.baseTexture._glTextures[h.id]);if(b.textureData){var f=b.textureData,k=f.magFilter?f.magFilter:h.LINEAR,n=f.minFilter?f.minFilter:h.LINEAR,
a=f.wrapS?f.wrapS:h.CLAMP_TO_EDGE,c=f.wrapT?f.wrapT:h.CLAMP_TO_EDGE,d=f.luminance?h.LUMINANCE:h.RGBA;f.repeat&&(c=a=h.REPEAT);h.pixelStorei(h.UNPACK_FLIP_Y_WEBGL,!!f.flipY);f.width?h.texImage2D(h.TEXTURE_2D,0,d,f.width?f.width:512,f.height?f.height:2,f.border?f.border:0,d,h.UNSIGNED_BYTE,null):h.texImage2D(h.TEXTURE_2D,0,d,h.RGBA,h.UNSIGNED_BYTE,b.value.baseTexture.source);h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,k);h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,n);h.texParameteri(h.TEXTURE_2D,
h.TEXTURE_WRAP_S,a);h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,c)}h.uniform1i(b.uniformLocation,this.textureCount);b._init=!0;this.textureCount++}};f.PixiShader.prototype.syncUniforms=function(){this.textureCount=1;var b,h=this.gl,m;for(m in this.uniforms)b=this.uniforms[m],1===b.glValueLength?!0===b.glMatrix?b.glFunc.call(h,b.uniformLocation,b.transpose,b.value):b.glFunc.call(h,b.uniformLocation,b.value):2===b.glValueLength?b.glFunc.call(h,b.uniformLocation,b.value.x,b.value.y):3===b.glValueLength?
b.glFunc.call(h,b.uniformLocation,b.value.x,b.value.y,b.value.z):4===b.glValueLength?b.glFunc.call(h,b.uniformLocation,b.value.x,b.value.y,b.value.z,b.value.w):"sampler2D"===b.type&&(b._init?(h.activeTexture(h["TEXTURE"+this.textureCount]),b.value.baseTexture._dirty[h.id]?f.instances[h.id].updateTexture(b.value.baseTexture):h.bindTexture(h.TEXTURE_2D,b.value.baseTexture._glTextures[h.id]),h.uniform1i(b.uniformLocation,this.textureCount),this.textureCount++):this.initSampler2D(b))};f.PixiShader.prototype.destroy=
function(){this.gl.deleteProgram(this.program);this.attributes=this.gl=this.uniforms=null};f.PixiShader.defaultVertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute vec4 aColor;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","varying vec2 vTextureCoord;","varying vec4 vColor;","const vec2 center = vec2(-1.0, 1.0);","void main(void) {","   gl_Position = vec4( ((aVertexPosition + offsetVector) / projectionVector) + center , 0.0, 1.0);","   vTextureCoord = aTextureCoord;",
"   vColor = vec4(aColor.rgb * aColor.a, aColor.a);","}"];f.PixiFastShader=function(b){this._UID=f._UID++;this.gl=b;this.program=null;this.fragmentSrc=["precision lowp float;","varying vec2 vTextureCoord;","varying float vColor;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"];this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aPositionCoord;","attribute vec2 aScale;","attribute float aRotation;","attribute vec2 aTextureCoord;",
"attribute float aColor;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform mat3 uMatrix;","varying vec2 vTextureCoord;","varying float vColor;","const vec2 center = vec2(-1.0, 1.0);","void main(void) {","   vec2 v;","   vec2 sv = aVertexPosition * aScale;","   v.x = (sv.x) * cos(aRotation) - (sv.y) * sin(aRotation);","   v.y = (sv.x) * sin(aRotation) + (sv.y) * cos(aRotation);","   v = ( uMatrix * vec3(v + aPositionCoord , 1.0) ).xy ;","   gl_Position = vec4( ( v / projectionVector) + center , 0.0, 1.0);",
"   vTextureCoord = aTextureCoord;","   vColor = aColor;","}"];this.textureCount=0;this.init()};f.PixiFastShader.prototype.constructor=f.PixiFastShader;f.PixiFastShader.prototype.init=function(){var b=this.gl,h=f.compileProgram(b,this.vertexSrc,this.fragmentSrc);b.useProgram(h);this.uSampler=b.getUniformLocation(h,"uSampler");this.projectionVector=b.getUniformLocation(h,"projectionVector");this.offsetVector=b.getUniformLocation(h,"offsetVector");this.dimensions=b.getUniformLocation(h,"dimensions");
this.uMatrix=b.getUniformLocation(h,"uMatrix");this.aVertexPosition=b.getAttribLocation(h,"aVertexPosition");this.aPositionCoord=b.getAttribLocation(h,"aPositionCoord");this.aScale=b.getAttribLocation(h,"aScale");this.aRotation=b.getAttribLocation(h,"aRotation");this.aTextureCoord=b.getAttribLocation(h,"aTextureCoord");this.colorAttribute=b.getAttribLocation(h,"aColor");-1===this.colorAttribute&&(this.colorAttribute=2);this.attributes=[this.aVertexPosition,this.aPositionCoord,this.aScale,this.aRotation,
this.aTextureCoord,this.colorAttribute];this.program=h};f.PixiFastShader.prototype.destroy=function(){this.gl.deleteProgram(this.program);this.attributes=this.gl=this.uniforms=null};f.StripShader=function(b){this._UID=f._UID++;this.gl=b;this.program=null;this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","uniform float alpha;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y)) * alpha;","}"];this.vertexSrc=
["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","varying vec2 vTextureCoord;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / -projectionVector.y + 1.0 , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","}"];this.init()};f.StripShader.prototype.constructor=f.StripShader;
f.StripShader.prototype.init=function(){var b=this.gl,h=f.compileProgram(b,this.vertexSrc,this.fragmentSrc);b.useProgram(h);this.uSampler=b.getUniformLocation(h,"uSampler");this.projectionVector=b.getUniformLocation(h,"projectionVector");this.offsetVector=b.getUniformLocation(h,"offsetVector");this.colorAttribute=b.getAttribLocation(h,"aColor");this.aVertexPosition=b.getAttribLocation(h,"aVertexPosition");this.aTextureCoord=b.getAttribLocation(h,"aTextureCoord");this.attributes=[this.aVertexPosition,
this.aTextureCoord];this.translationMatrix=b.getUniformLocation(h,"translationMatrix");this.alpha=b.getUniformLocation(h,"alpha");this.program=h};f.StripShader.prototype.destroy=function(){this.gl.deleteProgram(this.program);this.attribute=this.gl=this.uniforms=null};f.PrimitiveShader=function(b){this._UID=f._UID++;this.gl=b;this.program=null;this.fragmentSrc=["precision mediump float;","varying vec4 vColor;","void main(void) {","   gl_FragColor = vColor;","}"];this.vertexSrc=["attribute vec2 aVertexPosition;",
"attribute vec4 aColor;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform float alpha;","uniform float flipY;","uniform vec3 tint;","varying vec4 vColor;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, (v.y / projectionVector.y * -flipY) + flipY , 0.0, 1.0);","   vColor = aColor * vec4(tint * alpha, alpha);","}"];this.init()};
f.PrimitiveShader.prototype.constructor=f.PrimitiveShader;f.PrimitiveShader.prototype.init=function(){var b=this.gl,h=f.compileProgram(b,this.vertexSrc,this.fragmentSrc);b.useProgram(h);this.projectionVector=b.getUniformLocation(h,"projectionVector");this.offsetVector=b.getUniformLocation(h,"offsetVector");this.tintColor=b.getUniformLocation(h,"tint");this.flipY=b.getUniformLocation(h,"flipY");this.aVertexPosition=b.getAttribLocation(h,"aVertexPosition");this.colorAttribute=b.getAttribLocation(h,
"aColor");this.attributes=[this.aVertexPosition,this.colorAttribute];this.translationMatrix=b.getUniformLocation(h,"translationMatrix");this.alpha=b.getUniformLocation(h,"alpha");this.program=h};f.PrimitiveShader.prototype.destroy=function(){this.gl.deleteProgram(this.program);this.attributes=this.gl=this.uniforms=null};f.ComplexPrimitiveShader=function(b){this._UID=f._UID++;this.gl=b;this.program=null;this.fragmentSrc=["precision mediump float;","varying vec4 vColor;","void main(void) {","   gl_FragColor = vColor;",
"}"];this.vertexSrc=["attribute vec2 aVertexPosition;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform vec3 tint;","uniform float alpha;","uniform vec3 color;","uniform float flipY;","varying vec4 vColor;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, (v.y / projectionVector.y * -flipY) + flipY , 0.0, 1.0);","   vColor = vec4(color * alpha * tint, alpha);",
"}"];this.init()};f.ComplexPrimitiveShader.prototype.constructor=f.ComplexPrimitiveShader;f.ComplexPrimitiveShader.prototype.init=function(){var b=this.gl,h=f.compileProgram(b,this.vertexSrc,this.fragmentSrc);b.useProgram(h);this.projectionVector=b.getUniformLocation(h,"projectionVector");this.offsetVector=b.getUniformLocation(h,"offsetVector");this.tintColor=b.getUniformLocation(h,"tint");this.color=b.getUniformLocation(h,"color");this.flipY=b.getUniformLocation(h,"flipY");this.aVertexPosition=b.getAttribLocation(h,
"aVertexPosition");this.attributes=[this.aVertexPosition,this.colorAttribute];this.translationMatrix=b.getUniformLocation(h,"translationMatrix");this.alpha=b.getUniformLocation(h,"alpha");this.program=h};f.ComplexPrimitiveShader.prototype.destroy=function(){this.gl.deleteProgram(this.program);this.attribute=this.gl=this.uniforms=null};f.WebGLGraphics=function(){};f.WebGLGraphics.renderGraphics=function(b,h){var m=h.gl,k=h.projection,n=h.offset,a=h.shaderManager.primitiveShader,c;b.dirty&&f.WebGLGraphics.updateGraphics(b,
m);for(var d=b._webGL[m.id],e=0;e<d.data.length;e++)1===d.data[e].mode?(c=d.data[e],h.stencilManager.pushStencil(b,c,h),m.drawElements(m.TRIANGLE_FAN,4,m.UNSIGNED_SHORT,2*(c.indices.length-4)),h.stencilManager.popStencil(b,c,h)):(c=d.data[e],h.shaderManager.setShader(a),a=h.shaderManager.primitiveShader,m.uniformMatrix3fv(a.translationMatrix,!1,b.worldTransform.toArray(!0)),m.uniform1f(a.flipY,1),m.uniform2f(a.projectionVector,k.x,-k.y),m.uniform2f(a.offsetVector,-n.x,-n.y),m.uniform3fv(a.tintColor,
f.hex2rgb(b.tint)),m.uniform1f(a.alpha,b.worldAlpha),m.bindBuffer(m.ARRAY_BUFFER,c.buffer),m.vertexAttribPointer(a.aVertexPosition,2,m.FLOAT,!1,24,0),m.vertexAttribPointer(a.colorAttribute,4,m.FLOAT,!1,24,8),m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,c.indexBuffer),m.drawElements(m.TRIANGLE_STRIP,c.indices.length,m.UNSIGNED_SHORT,0))};f.WebGLGraphics.updateGraphics=function(b,h){var m=b._webGL[h.id];m||(m=b._webGL[h.id]={lastIndex:0,data:[],gl:h});b.dirty=!1;var k;if(b.clearDirty){b.clearDirty=!1;for(k=
0;k<m.data.length;k++){var n=m.data[k];n.reset();f.WebGLGraphics.graphicsDataPool.push(n)}m.data=[];m.lastIndex=0}for(k=m.lastIndex;k<b.graphicsData.length;k++){var a=b.graphicsData[k];a.type===f.Graphics.POLY?(a.points=a.shape.points.slice(),a.shape.closed&&(a.points[0]===a.points[a.points.length-2]&&a.points[1]===a.points[a.points.length-1]||a.points.push(a.points[0],a.points[1])),a.fill&&6<=a.points.length&&(12>a.points.length?(n=f.WebGLGraphics.switchMode(m,0),f.WebGLGraphics.buildPoly(a,n)||
(n=f.WebGLGraphics.switchMode(m,1),f.WebGLGraphics.buildComplexPoly(a,n))):(n=f.WebGLGraphics.switchMode(m,1),f.WebGLGraphics.buildComplexPoly(a,n))),0<a.lineWidth&&(n=f.WebGLGraphics.switchMode(m,0),f.WebGLGraphics.buildLine(a,n))):(n=f.WebGLGraphics.switchMode(m,0),a.type===f.Graphics.RECT?f.WebGLGraphics.buildRectangle(a,n):a.type===f.Graphics.CIRC||a.type===f.Graphics.ELIP?f.WebGLGraphics.buildCircle(a,n):a.type===f.Graphics.RREC&&f.WebGLGraphics.buildRoundedRectangle(a,n));m.lastIndex++}for(k=
0;k<m.data.length;k++)n=m.data[k],n.dirty&&n.upload()};f.WebGLGraphics.switchMode=function(b,h){var m;if(b.data.length){if(m=b.data[b.data.length-1],m.mode!==h||1===h)m=f.WebGLGraphics.graphicsDataPool.pop()||new f.WebGLGraphicsData(b.gl),m.mode=h,b.data.push(m)}else m=f.WebGLGraphics.graphicsDataPool.pop()||new f.WebGLGraphicsData(b.gl),m.mode=h,b.data.push(m);m.dirty=!0;return m};f.WebGLGraphics.buildRectangle=function(b,h){var m=b.shape,k=m.x,n=m.y,a=m.width,m=m.height;if(b.fill){var c=f.hex2rgb(b.fillColor),
d=b.fillAlpha,e=c[0]*d,g=c[1]*d,c=c[2]*d,l=h.points,p=h.indices,u=l.length/6;l.push(k,n);l.push(e,g,c,d);l.push(k+a,n);l.push(e,g,c,d);l.push(k,n+m);l.push(e,g,c,d);l.push(k+a,n+m);l.push(e,g,c,d);p.push(u,u,u+1,u+2,u+3,u+3)}b.lineWidth&&(d=b.points,b.points=[k,n,k+a,n,k+a,n+m,k,n+m,k,n],f.WebGLGraphics.buildLine(b,h),b.points=d)};f.WebGLGraphics.buildRoundedRectangle=function(b,h){var m=b.shape,k=m.x,n=m.y,a=m.width,c=m.height,d=m.radius,m=[];m.push(k,n+d);m=m.concat(f.WebGLGraphics.quadraticBezierCurve(k,
n+c-d,k,n+c,k+d,n+c));m=m.concat(f.WebGLGraphics.quadraticBezierCurve(k+a-d,n+c,k+a,n+c,k+a,n+c-d));m=m.concat(f.WebGLGraphics.quadraticBezierCurve(k+a,n+d,k+a,n,k+a-d,n));m=m.concat(f.WebGLGraphics.quadraticBezierCurve(k+d,n,k,n,k,n+d));if(b.fill){for(var c=f.hex2rgb(b.fillColor),k=b.fillAlpha,n=c[0]*k,a=c[1]*k,c=c[2]*k,d=h.points,e=h.indices,g=d.length/6,l=f.PolyK.Triangulate(m),p=0,p=0;p<l.length;p+=3)e.push(l[p]+g),e.push(l[p]+g),e.push(l[p+1]+g),e.push(l[p+2]+g),e.push(l[p+2]+g);for(p=0;p<m.length;p++)d.push(m[p],
m[++p],n,a,c,k)}b.lineWidth&&(k=b.points,b.points=m,f.WebGLGraphics.buildLine(b,h),b.points=k)};f.WebGLGraphics.quadraticBezierCurve=function(b,h,f,k,n,a){for(var c,d,e,g,l=[],p=0,u=0;20>=u;u++)p=u/20,c=b+(f-b)*p,d=h+(k-h)*p,e=f+(n-f)*p,g=k+(a-k)*p,c+=(e-c)*p,d+=(g-d)*p,l.push(c,d);return l};f.WebGLGraphics.buildCircle=function(b,h){var m=b.shape,k=m.x,n=m.y,a;b.type===f.Graphics.CIRC?m=a=m.radius:(a=m.width,m=m.height);var c=2*Math.PI/40,d=0;if(b.fill){var d=f.hex2rgb(b.fillColor),e=b.fillAlpha,
g=d[0]*e,l=d[1]*e,p=d[2]*e,u=h.points,y=h.indices,w=u.length/6;y.push(w);for(d=0;41>d;d++)u.push(k,n,g,l,p,e),u.push(k+Math.sin(c*d)*a,n+Math.cos(c*d)*m,g,l,p,e),y.push(w++,w++);y.push(w-1)}if(b.lineWidth){e=b.points;b.points=[];for(d=0;41>d;d++)b.points.push(k+Math.sin(c*d)*a,n+Math.cos(c*d)*m);f.WebGLGraphics.buildLine(b,h);b.points=e}};f.WebGLGraphics.buildLine=function(b,h){var m=0,k=b.points;if(0!==k.length){if(b.lineWidth%2)for(m=0;m<k.length;m++)k[m]+=.5;var n=new f.Point(k[0],k[1]),a=new f.Point(k[k.length-
2],k[k.length-1]);if(n.x===a.x&&n.y===a.y){k=k.slice();k.pop();k.pop();var a=new f.Point(k[k.length-2],k[k.length-1]),c=a.x+.5*(n.x-a.x),n=a.y+.5*(n.y-a.y);k.unshift(c,n);k.push(c,n)}var c=h.points,n=h.indices,a=k.length/2,d=k.length,e=c.length/6,g=b.lineWidth/2,m=f.hex2rgb(b.lineColor),l=b.lineAlpha,p=m[0]*l,u=m[1]*l,y=m[2]*l,w,q,t,r,x,v,A,C,B,z,E,D,F;t=k[0];r=k[1];x=k[2];v=k[3];B=-(r-v);z=t-x;q=Math.sqrt(B*B+z*z);B=B/q*g;z=z/q*g;c.push(t-B,r-z,p,u,y,l);c.push(t+B,r+z,p,u,y,l);for(m=1;m<a-1;m++)t=
k[2*(m-1)],r=k[2*(m-1)+1],x=k[2*m],v=k[2*m+1],A=k[2*(m+1)],C=k[2*(m+1)+1],B=-(r-v),z=t-x,q=Math.sqrt(B*B+z*z),B/=q,z/=q,B*=g,z*=g,E=-(v-C),D=x-A,q=Math.sqrt(E*E+D*D),E/=q,D/=q,E*=g,D*=g,q=-z+r-(-z+v),w=-B+x-(-B+t),t=(-B+t)*(-z+v)-(-B+x)*(-z+r),r=-D+C-(-D+v),F=-E+x-(-E+A),A=(-E+A)*(-D+v)-(-E+x)*(-D+C),C=q*F-r*w,.1>Math.abs(C)?(c.push(x-B,v-z,p,u,y,l),c.push(x+B,v+z,p,u,y,l)):(w=(w*A-F*t)/C,q=(r*t-q*A)/C,A=(w-x)*(w-x)+(q-v)+(q-v),19600<A?(B-=E,z-=D,q=Math.sqrt(B*B+z*z),B/=q,z/=q,B*=g,z*=g,c.push(x-
B,v-z),c.push(p,u,y,l),c.push(x+B,v+z),c.push(p,u,y,l),c.push(x-B,v-z),c.push(p,u,y,l),d++):(c.push(w,q),c.push(p,u,y,l),c.push(x-(w-x),v-(q-v)),c.push(p,u,y,l)));t=k[2*(a-2)];r=k[2*(a-2)+1];x=k[2*(a-1)];v=k[2*(a-1)+1];B=-(r-v);z=t-x;q=Math.sqrt(B*B+z*z);B/=q;z/=q;B*=g;z*=g;c.push(x-B,v-z);c.push(p,u,y,l);c.push(x+B,v+z);c.push(p,u,y,l);n.push(e);for(m=0;m<d;m++)n.push(e++);n.push(e-1)}};f.WebGLGraphics.buildComplexPoly=function(b,h){var m=b.points.slice();if(!(6>m.length)){var k=h.indices;h.points=
m;h.alpha=b.fillAlpha;h.color=f.hex2rgb(b.fillColor);for(var n=Infinity,a=-Infinity,c=Infinity,d=-Infinity,e,g,l=0;l<m.length;l+=2)e=m[l],g=m[l+1],n=e<n?e:n,a=e>a?e:a,c=g<c?g:c,d=g>d?g:d;m.push(n,c,a,c,a,d,n,d);m=m.length/2;for(l=0;l<m;l++)k.push(l)}};f.WebGLGraphics.buildPoly=function(b,h){var m=b.points;if(!(6>m.length)){var k=h.points,n=h.indices,a=m.length/2,c=f.hex2rgb(b.fillColor),d=b.fillAlpha,e=c[0]*d,g=c[1]*d,c=c[2]*d,l=f.PolyK.Triangulate(m);if(!l)return!1;for(var p=k.length/6,u=0,u=0;u<
l.length;u+=3)n.push(l[u]+p),n.push(l[u]+p),n.push(l[u+1]+p),n.push(l[u+2]+p),n.push(l[u+2]+p);for(u=0;u<a;u++)k.push(m[2*u],m[2*u+1],e,g,c,d);return!0}};f.WebGLGraphics.graphicsDataPool=[];f.WebGLGraphicsData=function(b){this.gl=b;this.color=[0,0,0];this.points=[];this.indices=[];this.buffer=b.createBuffer();this.indexBuffer=b.createBuffer();this.alpha=this.mode=1;this.dirty=!0};f.WebGLGraphicsData.prototype.reset=function(){this.points=[];this.indices=[]};f.WebGLGraphicsData.prototype.upload=function(){var b=
this.gl;this.glPoints=new f.Float32Array(this.points);b.bindBuffer(b.ARRAY_BUFFER,this.buffer);b.bufferData(b.ARRAY_BUFFER,this.glPoints,b.STATIC_DRAW);this.glIndicies=new f.Uint16Array(this.indices);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,this.indexBuffer);b.bufferData(b.ELEMENT_ARRAY_BUFFER,this.glIndicies,b.STATIC_DRAW);this.dirty=!1};f.glContexts=[];f.instances=[];f.WebGLRenderer=function(b,h,m){if(m)for(var k in f.defaultRenderOptions)void 0===m[k]&&(m[k]=f.defaultRenderOptions[k]);else m=f.defaultRenderOptions;
f.defaultRenderer||(f.defaultRenderer=this);this.type=f.WEBGL_RENDERER;this.resolution=m.resolution;this.transparent=m.transparent;this.autoResize=m.autoResize||!1;this.preserveDrawingBuffer=m.preserveDrawingBuffer;this.clearBeforeRender=m.clearBeforeRender;this.width=b||800;this.height=h||600;this.view=m.view||document.createElement("canvas");this._contextOptions={alpha:this.transparent,antialias:m.antialias,premultipliedAlpha:this.transparent&&"notMultiplied"!==this.transparent,stencil:!0,preserveDrawingBuffer:m.preserveDrawingBuffer};
this.projection=new f.Point;this.offset=new f.Point(0,0);this.shaderManager=new f.WebGLShaderManager;this.spriteBatch=new f.WebGLSpriteBatch;this.maskManager=new f.WebGLMaskManager;this.filterManager=new f.WebGLFilterManager;this.stencilManager=new f.WebGLStencilManager;this.blendModeManager=new f.WebGLBlendModeManager;this.renderSession={};this.renderSession.gl=this.gl;this.renderSession.drawCount=0;this.renderSession.shaderManager=this.shaderManager;this.renderSession.maskManager=this.maskManager;
this.renderSession.filterManager=this.filterManager;this.renderSession.blendModeManager=this.blendModeManager;this.renderSession.spriteBatch=this.spriteBatch;this.renderSession.stencilManager=this.stencilManager;this.renderSession.renderer=this;this.renderSession.resolution=this.resolution;this.initContext();this.mapBlendModes()};f.WebGLRenderer.prototype.constructor=f.WebGLRenderer;f.WebGLRenderer.prototype.initContext=function(){var b=this.view.getContext("webgl",this._contextOptions)||this.view.getContext("experimental-webgl",
this._contextOptions);this.gl=b;if(!b)throw Error("This browser does not support webGL. Try using the canvas renderer");this.glContextId=b.id=f.WebGLRenderer.glContextId++;f.glContexts[this.glContextId]=b;f.instances[this.glContextId]=this;b.disable(b.DEPTH_TEST);b.disable(b.CULL_FACE);b.enable(b.BLEND);this.shaderManager.setContext(b);this.spriteBatch.setContext(b);this.maskManager.setContext(b);this.filterManager.setContext(b);this.blendModeManager.setContext(b);this.stencilManager.setContext(b);
this.renderSession.gl=this.gl;this.resize(this.width,this.height)};f.WebGLRenderer.prototype.render=function(b){if(!this.contextLost){this.__stage!==b&&(this.__stage=b);b.updateTransform();var h=this.gl;h.viewport(0,0,this.width,this.height);h.bindFramebuffer(h.FRAMEBUFFER,null);this.clearBeforeRender&&(this.transparent?h.clearColor(0,0,0,0):h.clearColor(b.backgroundColorSplit[0],b.backgroundColorSplit[1],b.backgroundColorSplit[2],1),h.clear(h.COLOR_BUFFER_BIT));this.renderDisplayObject(b,this.projection)}};
f.WebGLRenderer.prototype.renderDisplayObject=function(b,h,m,k){this.renderSession.blendModeManager.setBlendMode(f.blendModes.NORMAL);this.renderSession.drawCount=0;this.renderSession.flipY=m?-1:1;this.renderSession.projection=h;this.renderSession.offset=this.offset;this.spriteBatch.begin(this.renderSession);this.filterManager.begin(this.renderSession,m);b._renderWebGL(this.renderSession,k);this.spriteBatch.end()};f.WebGLRenderer.prototype.resize=function(b,h){this.width=b*this.resolution;this.height=
h*this.resolution;this.view.width=this.width;this.view.height=this.height;this.autoResize&&(this.view.style.width=this.width/this.resolution+"px",this.view.style.height=this.height/this.resolution+"px");this.gl.viewport(0,0,this.width,this.height);this.projection.x=this.width/2/this.resolution;this.projection.y=-this.height/2/this.resolution};f.WebGLRenderer.prototype.updateTexture=function(b){if(b.hasLoaded){var h=this.gl;b._glTextures[h.id]||(b._glTextures[h.id]=h.createTexture());h.bindTexture(h.TEXTURE_2D,
b._glTextures[h.id]);h.pixelStorei(h.UNPACK_PREMULTIPLY_ALPHA_WEBGL,b.premultipliedAlpha);h.texImage2D(h.TEXTURE_2D,0,h.RGBA,h.RGBA,h.UNSIGNED_BYTE,b.source);h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,b.scaleMode===f.scaleModes.LINEAR?h.LINEAR:h.NEAREST);b.mipmap&&f.isPowerOfTwo(b.width,b.height)?(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,b.scaleMode===f.scaleModes.LINEAR?h.LINEAR_MIPMAP_LINEAR:h.NEAREST_MIPMAP_NEAREST),h.generateMipmap(h.TEXTURE_2D)):h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,
b.scaleMode===f.scaleModes.LINEAR?h.LINEAR:h.NEAREST);b._powerOf2?(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,h.REPEAT),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,h.REPEAT)):(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,h.CLAMP_TO_EDGE));b._dirty[h.id]=!1;return b._glTextures[h.id]}};f.WebGLRenderer.prototype.destroy=function(){this.offset=this.projection=f.glContexts[this.glContextId]=null;this.shaderManager.destroy();this.spriteBatch.destroy();
this.maskManager.destroy();this.filterManager.destroy();this.renderSession=this.gl=this.filterManager=this.maskManager=this.spriteBatch=this.shaderManager=null;f.instances[this.glContextId]=null;f.WebGLRenderer.glContextId--};f.WebGLRenderer.prototype.mapBlendModes=function(){var b=this.gl;f.blendModesWebGL||(f.blendModesWebGL=[],f.blendModesWebGL[f.blendModes.NORMAL]=[b.ONE,b.ONE_MINUS_SRC_ALPHA],f.blendModesWebGL[f.blendModes.ADD]=[b.SRC_ALPHA,b.DST_ALPHA],f.blendModesWebGL[f.blendModes.MULTIPLY]=
[b.DST_COLOR,b.ONE_MINUS_SRC_ALPHA],f.blendModesWebGL[f.blendModes.SCREEN]=[b.SRC_ALPHA,b.ONE],f.blendModesWebGL[f.blendModes.OVERLAY]=[b.ONE,b.ONE_MINUS_SRC_ALPHA],f.blendModesWebGL[f.blendModes.DARKEN]=[b.ONE,b.ONE_MINUS_SRC_ALPHA],f.blendModesWebGL[f.blendModes.LIGHTEN]=[b.ONE,b.ONE_MINUS_SRC_ALPHA],f.blendModesWebGL[f.blendModes.COLOR_DODGE]=[b.ONE,b.ONE_MINUS_SRC_ALPHA],f.blendModesWebGL[f.blendModes.COLOR_BURN]=[b.ONE,b.ONE_MINUS_SRC_ALPHA],f.blendModesWebGL[f.blendModes.HARD_LIGHT]=[b.ONE,
b.ONE_MINUS_SRC_ALPHA],f.blendModesWebGL[f.blendModes.SOFT_LIGHT]=[b.ONE,b.ONE_MINUS_SRC_ALPHA],f.blendModesWebGL[f.blendModes.DIFFERENCE]=[b.ONE,b.ONE_MINUS_SRC_ALPHA],f.blendModesWebGL[f.blendModes.EXCLUSION]=[b.ONE,b.ONE_MINUS_SRC_ALPHA],f.blendModesWebGL[f.blendModes.HUE]=[b.ONE,b.ONE_MINUS_SRC_ALPHA],f.blendModesWebGL[f.blendModes.SATURATION]=[b.ONE,b.ONE_MINUS_SRC_ALPHA],f.blendModesWebGL[f.blendModes.COLOR]=[b.ONE,b.ONE_MINUS_SRC_ALPHA],f.blendModesWebGL[f.blendModes.LUMINOSITY]=[b.ONE,b.ONE_MINUS_SRC_ALPHA])};
f.WebGLRenderer.glContextId=0;f.WebGLBlendModeManager=function(){this.currentBlendMode=99999};f.WebGLBlendModeManager.prototype.constructor=f.WebGLBlendModeManager;f.WebGLBlendModeManager.prototype.setContext=function(b){this.gl=b};f.WebGLBlendModeManager.prototype.setBlendMode=function(b){if(this.currentBlendMode===b)return!1;this.currentBlendMode=b;b=f.blendModesWebGL[this.currentBlendMode];this.gl.blendFunc(b[0],b[1]);return!0};f.WebGLBlendModeManager.prototype.destroy=function(){this.gl=null};
f.WebGLMaskManager=function(){};f.WebGLMaskManager.prototype.constructor=f.WebGLMaskManager;f.WebGLMaskManager.prototype.setContext=function(b){this.gl=b};f.WebGLMaskManager.prototype.pushMask=function(b,h){var m=h.gl;b.dirty&&f.WebGLGraphics.updateGraphics(b,m);b._webGL[m.id].data.length&&h.stencilManager.pushStencil(b,b._webGL[m.id].data[0],h)};f.WebGLMaskManager.prototype.popMask=function(b,h){h.stencilManager.popStencil(b,b._webGL[this.gl.id].data[0],h)};f.WebGLMaskManager.prototype.destroy=function(){this.gl=
null};f.WebGLStencilManager=function(){this.stencilStack=[];this.reverse=!0;this.count=0};f.WebGLStencilManager.prototype.setContext=function(b){this.gl=b};f.WebGLStencilManager.prototype.pushStencil=function(b,h,f){var k=this.gl;this.bindGraphics(b,h,f);0===this.stencilStack.length&&(k.enable(k.STENCIL_TEST),k.clear(k.STENCIL_BUFFER_BIT),this.reverse=!0,this.count=0);this.stencilStack.push(h);b=this.count;k.colorMask(!1,!1,!1,!1);k.stencilFunc(k.ALWAYS,0,255);k.stencilOp(k.KEEP,k.KEEP,k.INVERT);
1===h.mode?(k.drawElements(k.TRIANGLE_FAN,h.indices.length-4,k.UNSIGNED_SHORT,0),this.reverse?(k.stencilFunc(k.EQUAL,255-b,255),k.stencilOp(k.KEEP,k.KEEP,k.DECR)):(k.stencilFunc(k.EQUAL,b,255),k.stencilOp(k.KEEP,k.KEEP,k.INCR)),k.drawElements(k.TRIANGLE_FAN,4,k.UNSIGNED_SHORT,2*(h.indices.length-4)),this.reverse?k.stencilFunc(k.EQUAL,255-(b+1),255):k.stencilFunc(k.EQUAL,b+1,255),this.reverse=!this.reverse):(this.reverse?(k.stencilFunc(k.EQUAL,b,255),k.stencilOp(k.KEEP,k.KEEP,k.INCR)):(k.stencilFunc(k.EQUAL,
255-b,255),k.stencilOp(k.KEEP,k.KEEP,k.DECR)),k.drawElements(k.TRIANGLE_STRIP,h.indices.length,k.UNSIGNED_SHORT,0),this.reverse?k.stencilFunc(k.EQUAL,b+1,255):k.stencilFunc(k.EQUAL,255-(b+1),255));k.colorMask(!0,!0,!0,!0);k.stencilOp(k.KEEP,k.KEEP,k.KEEP);this.count++};f.WebGLStencilManager.prototype.bindGraphics=function(b,h,m){this._currentGraphics=b;var k=this.gl,n=m.projection,a=m.offset,c;1===h.mode?(c=m.shaderManager.complexPrimitiveShader,m.shaderManager.setShader(c),k.uniform1f(c.flipY,m.flipY),
k.uniformMatrix3fv(c.translationMatrix,!1,b.worldTransform.toArray(!0)),k.uniform2f(c.projectionVector,n.x,-n.y),k.uniform2f(c.offsetVector,-a.x,-a.y),k.uniform3fv(c.tintColor,f.hex2rgb(b.tint)),k.uniform3fv(c.color,h.color),k.uniform1f(c.alpha,b.worldAlpha*h.alpha),k.bindBuffer(k.ARRAY_BUFFER,h.buffer),k.vertexAttribPointer(c.aVertexPosition,2,k.FLOAT,!1,8,0)):(c=m.shaderManager.primitiveShader,m.shaderManager.setShader(c),k.uniformMatrix3fv(c.translationMatrix,!1,b.worldTransform.toArray(!0)),k.uniform1f(c.flipY,
m.flipY),k.uniform2f(c.projectionVector,n.x,-n.y),k.uniform2f(c.offsetVector,-a.x,-a.y),k.uniform3fv(c.tintColor,f.hex2rgb(b.tint)),k.uniform1f(c.alpha,b.worldAlpha),k.bindBuffer(k.ARRAY_BUFFER,h.buffer),k.vertexAttribPointer(c.aVertexPosition,2,k.FLOAT,!1,24,0),k.vertexAttribPointer(c.colorAttribute,4,k.FLOAT,!1,24,8));k.bindBuffer(k.ELEMENT_ARRAY_BUFFER,h.indexBuffer)};f.WebGLStencilManager.prototype.popStencil=function(b,h,f){var k=this.gl;this.stencilStack.pop();this.count--;if(0===this.stencilStack.length)k.disable(k.STENCIL_TEST);
else{var n=this.count;this.bindGraphics(b,h,f);k.colorMask(!1,!1,!1,!1);1===h.mode?((this.reverse=!this.reverse)?(k.stencilFunc(k.EQUAL,255-(n+1),255),k.stencilOp(k.KEEP,k.KEEP,k.INCR)):(k.stencilFunc(k.EQUAL,n+1,255),k.stencilOp(k.KEEP,k.KEEP,k.DECR)),k.drawElements(k.TRIANGLE_FAN,4,k.UNSIGNED_SHORT,2*(h.indices.length-4)),k.stencilFunc(k.ALWAYS,0,255),k.stencilOp(k.KEEP,k.KEEP,k.INVERT),k.drawElements(k.TRIANGLE_FAN,h.indices.length-4,k.UNSIGNED_SHORT,0)):(this.reverse?(k.stencilFunc(k.EQUAL,n+
1,255),k.stencilOp(k.KEEP,k.KEEP,k.DECR)):(k.stencilFunc(k.EQUAL,255-(n+1),255),k.stencilOp(k.KEEP,k.KEEP,k.INCR)),k.drawElements(k.TRIANGLE_STRIP,h.indices.length,k.UNSIGNED_SHORT,0));this.reverse?k.stencilFunc(k.EQUAL,n,255):k.stencilFunc(k.EQUAL,255-n,255);k.colorMask(!0,!0,!0,!0);k.stencilOp(k.KEEP,k.KEEP,k.KEEP)}};f.WebGLStencilManager.prototype.destroy=function(){this.gl=this.stencilStack=null};f.WebGLShaderManager=function(){this.maxAttibs=10;this.attribState=[];this.tempAttribState=[];for(var b=
0;b<this.maxAttibs;b++)this.attribState[b]=!1;this.stack=[]};f.WebGLShaderManager.prototype.constructor=f.WebGLShaderManager;f.WebGLShaderManager.prototype.setContext=function(b){this.gl=b;this.primitiveShader=new f.PrimitiveShader(b);this.complexPrimitiveShader=new f.ComplexPrimitiveShader(b);this.defaultShader=new f.PixiShader(b);this.fastShader=new f.PixiFastShader(b);this.stripShader=new f.StripShader(b);this.setShader(this.defaultShader)};f.WebGLShaderManager.prototype.setAttribs=function(b){var h;
for(h=0;h<this.tempAttribState.length;h++)this.tempAttribState[h]=!1;for(h=0;h<b.length;h++)this.tempAttribState[b[h]]=!0;b=this.gl;for(h=0;h<this.attribState.length;h++)this.attribState[h]!==this.tempAttribState[h]&&(this.attribState[h]=this.tempAttribState[h],this.tempAttribState[h]?b.enableVertexAttribArray(h):b.disableVertexAttribArray(h))};f.WebGLShaderManager.prototype.setShader=function(b){if(this._currentId===b._UID)return!1;this._currentId=b._UID;this.currentShader=b;this.gl.useProgram(b.program);
this.setAttribs(b.attributes);return!0};f.WebGLShaderManager.prototype.destroy=function(){this.tempAttribState=this.attribState=null;this.primitiveShader.destroy();this.complexPrimitiveShader.destroy();this.defaultShader.destroy();this.fastShader.destroy();this.stripShader.destroy();this.gl=null};f.WebGLSpriteBatch=function(){this.vertSize=5;this.size=2E3;var b=6*this.size;this.vertices=new f.ArrayBuffer(16*this.size*this.vertSize);this.positions=new f.Float32Array(this.vertices);this.colors=new f.Uint32Array(this.vertices);
this.indices=new f.Uint16Array(b);for(var h=this.lastIndexCount=0,m=0;h<b;h+=6,m+=4)this.indices[h+0]=m+0,this.indices[h+1]=m+1,this.indices[h+2]=m+2,this.indices[h+3]=m+0,this.indices[h+4]=m+2,this.indices[h+5]=m+3;this.drawing=!1;this.currentBatchSize=0;this.currentBaseTexture=null;this.dirty=!0;this.textures=[];this.blendModes=[];this.shaders=[];this.sprites=[];this.defaultShader=new f.AbstractFilter(["precision lowp float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;",
"void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"])};f.WebGLSpriteBatch.prototype.setContext=function(b){this.gl=b;this.vertexBuffer=b.createBuffer();this.indexBuffer=b.createBuffer();b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,this.indexBuffer);b.bufferData(b.ELEMENT_ARRAY_BUFFER,this.indices,b.STATIC_DRAW);b.bindBuffer(b.ARRAY_BUFFER,this.vertexBuffer);b.bufferData(b.ARRAY_BUFFER,this.vertices,b.DYNAMIC_DRAW);this.currentBlendMode=99999;var h=new f.PixiShader(b);
h.fragmentSrc=this.defaultShader.fragmentSrc;h.uniforms={};h.init();this.defaultShader.shaders[b.id]=h};f.WebGLSpriteBatch.prototype.begin=function(b){this.renderSession=b;this.shader=this.renderSession.shaderManager.defaultShader;this.start()};f.WebGLSpriteBatch.prototype.end=function(){this.flush()};f.WebGLSpriteBatch.prototype.render=function(b,h){var f=b.texture,k=b.worldTransform;h&&(k=h);this.currentBatchSize>=this.size&&(this.flush(),this.currentBaseTexture=f.baseTexture);var n=f._uvs;if(n){var a=
b.anchor.x,c=b.anchor.y,d,e,g;f.trim?(e=f.trim,a=e.x-a*e.width,d=a+f.crop.width,g=e.y-c*e.height,e=g+f.crop.height):(d=f.frame.width*(1-a),a=f.frame.width*-a,e=f.frame.height*(1-c),g=f.frame.height*-c);var c=4*this.currentBatchSize*this.vertSize,l=f.baseTexture.resolution,f=k.a/l,p=k.b/l,u=k.c/l,l=k.d/l,y=k.tx,w=k.ty,k=this.colors,q=this.positions;this.renderSession.roundPixels?(q[c]=f*a+u*g+y|0,q[c+1]=l*g+p*a+w|0,q[c+5]=f*d+u*g+y|0,q[c+6]=l*g+p*d+w|0,q[c+10]=f*d+u*e+y|0,q[c+11]=l*e+p*d+w|0,q[c+15]=
f*a+u*e+y|0,q[c+16]=l*e+p*a+w|0):(q[c]=f*a+u*g+y,q[c+1]=l*g+p*a+w,q[c+5]=f*d+u*g+y,q[c+6]=l*g+p*d+w,q[c+10]=f*d+u*e+y,q[c+11]=l*e+p*d+w,q[c+15]=f*a+u*e+y,q[c+16]=l*e+p*a+w);q[c+2]=n.x0;q[c+3]=n.y0;q[c+7]=n.x1;q[c+8]=n.y1;q[c+12]=n.x2;q[c+13]=n.y2;q[c+17]=n.x3;q[c+18]=n.y3;n=b.tint;k[c+4]=k[c+9]=k[c+14]=k[c+19]=(n>>16)+(n&65280)+((n&255)<<16)+(255*b.worldAlpha<<24);this.sprites[this.currentBatchSize++]=b}};f.WebGLSpriteBatch.prototype.renderTilingSprite=function(b){var h=b.tilingTexture;this.currentBatchSize>=
this.size&&(this.flush(),this.currentBaseTexture=h.baseTexture);b._uvs||(b._uvs=new f.TextureUvs);var m=b._uvs,k=h.baseTexture.width,n=h.baseTexture.height;b.tilePosition.x%=k*b.tileScaleOffset.x;b.tilePosition.y%=n*b.tileScaleOffset.y;var a=b.tilePosition.x/(k*b.tileScaleOffset.x),c=b.tilePosition.y/(n*b.tileScaleOffset.y),k=b.width/k/(b.tileScale.x*b.tileScaleOffset.x),n=b.height/n/(b.tileScale.y*b.tileScaleOffset.y);m.x0=0-a;m.y0=0-c;m.x1=1*k-a;m.y1=0-c;m.x2=1*k-a;m.y2=1*n-c;m.x3=0-a;m.y3=1*n-
c;var a=b.tint,a=(a>>16)+(a&65280)+((a&255)<<16)+(255*b.worldAlpha<<24),c=this.positions,n=this.colors,d=b.width,e=b.height,g=b.anchor.x,l=b.anchor.y,k=d*(1-g),d=d*-g,g=e*(1-l),e=e*-l,l=4*this.currentBatchSize*this.vertSize,p=h.baseTexture.resolution,u=b.worldTransform,h=u.a/p,y=u.b/p,w=u.c/p,p=u.d/p,q=u.tx,u=u.ty;c[l++]=h*d+w*e+q;c[l++]=p*e+y*d+u;c[l++]=m.x0;c[l++]=m.y0;n[l++]=a;c[l++]=h*k+w*e+q;c[l++]=p*e+y*k+u;c[l++]=m.x1;c[l++]=m.y1;n[l++]=a;c[l++]=h*k+w*g+q;c[l++]=p*g+y*k+u;c[l++]=m.x2;c[l++]=
m.y2;n[l++]=a;c[l++]=h*d+w*g+q;c[l++]=p*g+y*d+u;c[l++]=m.x3;c[l++]=m.y3;n[l++]=a;this.sprites[this.currentBatchSize++]=b};f.WebGLSpriteBatch.prototype.flush=function(){if(0!==this.currentBatchSize){var b=this.gl,h;if(this.dirty){this.dirty=!1;b.activeTexture(b.TEXTURE0);b.bindBuffer(b.ARRAY_BUFFER,this.vertexBuffer);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,this.indexBuffer);h=this.defaultShader.shaders[b.id];var m=4*this.vertSize;b.vertexAttribPointer(h.aVertexPosition,2,b.FLOAT,!1,m,0);b.vertexAttribPointer(h.aTextureCoord,
2,b.FLOAT,!1,m,8);b.vertexAttribPointer(h.colorAttribute,4,b.UNSIGNED_BYTE,!0,m,16)}this.currentBatchSize>.5*this.size?b.bufferSubData(b.ARRAY_BUFFER,0,this.vertices):(m=this.positions.subarray(0,4*this.currentBatchSize*this.vertSize),b.bufferSubData(b.ARRAY_BUFFER,0,m));for(var k,n,a=m=0,c=null,d=this.renderSession.blendModeManager.currentBlendMode,e=null,g=!1,l=!1,p=0,u=this.currentBatchSize;p<u;p++){n=this.sprites[p];h=n.tilingTexture?n.tilingTexture.baseTexture:n.texture.baseTexture;k=n.blendMode;
n=n.shader||this.defaultShader;g=d!==k;l=e!==n;if(c!==h||g||l)this.renderBatch(c,m,a),a=p,m=0,c=h,g&&(d=k,this.renderSession.blendModeManager.setBlendMode(d)),l&&(e=n,h=e.shaders[b.id],h||(h=new f.PixiShader(b),h.fragmentSrc=e.fragmentSrc,h.uniforms=e.uniforms,h.init(),e.shaders[b.id]=h),this.renderSession.shaderManager.setShader(h),h.dirty&&h.syncUniforms(),k=this.renderSession.projection,b.uniform2f(h.projectionVector,k.x,k.y),k=this.renderSession.offset,b.uniform2f(h.offsetVector,k.x,k.y));m++}this.renderBatch(c,
m,a);this.currentBatchSize=0}};f.WebGLSpriteBatch.prototype.renderBatch=function(b,h,f){if(0!==h){var k=this.gl;b._dirty[k.id]?this.renderSession.renderer.updateTexture(b):k.bindTexture(k.TEXTURE_2D,b._glTextures[k.id]);k.drawElements(k.TRIANGLES,6*h,k.UNSIGNED_SHORT,12*f);this.renderSession.drawCount++}};f.WebGLSpriteBatch.prototype.stop=function(){this.flush();this.dirty=!0};f.WebGLSpriteBatch.prototype.start=function(){this.dirty=!0};f.WebGLSpriteBatch.prototype.destroy=function(){this.indices=
this.vertices=null;this.gl.deleteBuffer(this.vertexBuffer);this.gl.deleteBuffer(this.indexBuffer);this.gl=this.currentBaseTexture=null};f.WebGLFastSpriteBatch=function(b){this.vertSize=10;this.size=this.maxSize=6E3;var h=6*this.maxSize;this.vertices=new f.Float32Array(4*this.size*this.vertSize);this.indices=new f.Uint16Array(h);this.indexBuffer=this.vertexBuffer=null;for(var m=this.lastIndexCount=0,k=0;m<h;m+=6,k+=4)this.indices[m+0]=k+0,this.indices[m+1]=k+1,this.indices[m+2]=k+2,this.indices[m+
3]=k+0,this.indices[m+4]=k+2,this.indices[m+5]=k+3;this.drawing=!1;this.currentBatchSize=0;this.currentBaseTexture=null;this.currentBlendMode=0;this.matrix=this.shader=this.renderSession=null;this.setContext(b)};f.WebGLFastSpriteBatch.prototype.constructor=f.WebGLFastSpriteBatch;f.WebGLFastSpriteBatch.prototype.setContext=function(b){this.gl=b;this.vertexBuffer=b.createBuffer();this.indexBuffer=b.createBuffer();b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,this.indexBuffer);b.bufferData(b.ELEMENT_ARRAY_BUFFER,
this.indices,b.STATIC_DRAW);b.bindBuffer(b.ARRAY_BUFFER,this.vertexBuffer);b.bufferData(b.ARRAY_BUFFER,this.vertices,b.DYNAMIC_DRAW)};f.WebGLFastSpriteBatch.prototype.begin=function(b,h){this.renderSession=h;this.shader=this.renderSession.shaderManager.fastShader;this.matrix=b.worldTransform.toArray(!0);this.start()};f.WebGLFastSpriteBatch.prototype.end=function(){this.flush()};f.WebGLFastSpriteBatch.prototype.render=function(b){b=b.children;var h=b[0];if(h.texture._uvs){this.currentBaseTexture=h.texture.baseTexture;
h.blendMode!==this.renderSession.blendModeManager.currentBlendMode&&(this.flush(),this.renderSession.blendModeManager.setBlendMode(h.blendMode));for(var h=0,f=b.length;h<f;h++)this.renderSprite(b[h]);this.flush()}};f.WebGLFastSpriteBatch.prototype.renderSprite=function(b){if(b.visible){if(b.texture.baseTexture!==this.currentBaseTexture&&(this.flush(),this.currentBaseTexture=b.texture.baseTexture,!b.texture._uvs))return;var h,f=this.vertices,k,n,a,c,d;h=b.texture._uvs;b.texture.trim?(a=b.texture.trim,
n=a.x-b.anchor.x*a.width,k=n+b.texture.crop.width,c=a.y-b.anchor.y*a.height,a=c+b.texture.crop.height):(k=b.texture.frame.width*(1-b.anchor.x),n=b.texture.frame.width*-b.anchor.x,a=b.texture.frame.height*(1-b.anchor.y),c=b.texture.frame.height*-b.anchor.y);d=4*this.currentBatchSize*this.vertSize;f[d++]=n;f[d++]=c;f[d++]=b.position.x;f[d++]=b.position.y;f[d++]=b.scale.x;f[d++]=b.scale.y;f[d++]=b.rotation;f[d++]=h.x0;f[d++]=h.y1;f[d++]=b.alpha;f[d++]=k;f[d++]=c;f[d++]=b.position.x;f[d++]=b.position.y;
f[d++]=b.scale.x;f[d++]=b.scale.y;f[d++]=b.rotation;f[d++]=h.x1;f[d++]=h.y1;f[d++]=b.alpha;f[d++]=k;f[d++]=a;f[d++]=b.position.x;f[d++]=b.position.y;f[d++]=b.scale.x;f[d++]=b.scale.y;f[d++]=b.rotation;f[d++]=h.x2;f[d++]=h.y2;f[d++]=b.alpha;f[d++]=n;f[d++]=a;f[d++]=b.position.x;f[d++]=b.position.y;f[d++]=b.scale.x;f[d++]=b.scale.y;f[d++]=b.rotation;f[d++]=h.x3;f[d++]=h.y3;f[d++]=b.alpha;this.currentBatchSize++;this.currentBatchSize>=this.size&&this.flush()}};f.WebGLFastSpriteBatch.prototype.flush=
function(){if(0!==this.currentBatchSize){var b=this.gl;this.currentBaseTexture._glTextures[b.id]||this.renderSession.renderer.updateTexture(this.currentBaseTexture,b);b.bindTexture(b.TEXTURE_2D,this.currentBaseTexture._glTextures[b.id]);if(this.currentBatchSize>.5*this.size)b.bufferSubData(b.ARRAY_BUFFER,0,this.vertices);else{var h=this.vertices.subarray(0,4*this.currentBatchSize*this.vertSize);b.bufferSubData(b.ARRAY_BUFFER,0,h)}b.drawElements(b.TRIANGLES,6*this.currentBatchSize,b.UNSIGNED_SHORT,
0);this.currentBatchSize=0;this.renderSession.drawCount++}};f.WebGLFastSpriteBatch.prototype.stop=function(){this.flush()};f.WebGLFastSpriteBatch.prototype.start=function(){var b=this.gl;b.activeTexture(b.TEXTURE0);b.bindBuffer(b.ARRAY_BUFFER,this.vertexBuffer);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var h=this.renderSession.projection;b.uniform2f(this.shader.projectionVector,h.x,h.y);b.uniformMatrix3fv(this.shader.uMatrix,!1,this.matrix);h=4*this.vertSize;b.vertexAttribPointer(this.shader.aVertexPosition,
2,b.FLOAT,!1,h,0);b.vertexAttribPointer(this.shader.aPositionCoord,2,b.FLOAT,!1,h,8);b.vertexAttribPointer(this.shader.aScale,2,b.FLOAT,!1,h,16);b.vertexAttribPointer(this.shader.aRotation,1,b.FLOAT,!1,h,24);b.vertexAttribPointer(this.shader.aTextureCoord,2,b.FLOAT,!1,h,28);b.vertexAttribPointer(this.shader.colorAttribute,1,b.FLOAT,!1,h,36)};f.WebGLFilterManager=function(){this.filterStack=[];this.offsetY=this.offsetX=0};f.WebGLFilterManager.prototype.constructor=f.WebGLFilterManager;f.WebGLFilterManager.prototype.setContext=
function(b){this.gl=b;this.texturePool=[];this.initShaderBuffers()};f.WebGLFilterManager.prototype.begin=function(b,h){this.renderSession=b;this.defaultShader=b.shaderManager.defaultShader;var f=this.renderSession.projection;this.width=2*f.x;this.height=2*-f.y;this.buffer=h};f.WebGLFilterManager.prototype.pushFilter=function(b){var h=this.gl,m=this.renderSession.projection,k=this.renderSession.offset;b._filterArea=b.target.filterArea||b.target.getBounds();this.filterStack.push(b);var n=b.filterPasses[0];
this.offsetX+=b._filterArea.x;this.offsetY+=b._filterArea.y;var a=this.texturePool.pop();a?a.resize(this.width,this.height):a=new f.FilterTexture(this.gl,this.width,this.height);h.bindTexture(h.TEXTURE_2D,a.texture);var c=b._filterArea,n=n.padding;c.x-=n;c.y-=n;c.width+=2*n;c.height+=2*n;0>c.x&&(c.x=0);c.width>this.width&&(c.width=this.width);0>c.y&&(c.y=0);c.height>this.height&&(c.height=this.height);h.bindFramebuffer(h.FRAMEBUFFER,a.frameBuffer);h.viewport(0,0,c.width,c.height);m.x=c.width/2;m.y=
-c.height/2;k.x=-c.x;k.y=-c.y;h.colorMask(!0,!0,!0,!0);h.clearColor(0,0,0,0);h.clear(h.COLOR_BUFFER_BIT);b._glFilterTexture=a};f.WebGLFilterManager.prototype.popFilter=function(){var b=this.gl,h=this.filterStack.pop(),m=h._filterArea,k=h._glFilterTexture,n=this.renderSession.projection,a=this.renderSession.offset;if(1<h.filterPasses.length){b.viewport(0,0,m.width,m.height);b.bindBuffer(b.ARRAY_BUFFER,this.vertexBuffer);this.vertexArray[0]=0;this.vertexArray[1]=m.height;this.vertexArray[2]=m.width;
this.vertexArray[3]=m.height;this.vertexArray[4]=0;this.vertexArray[5]=0;this.vertexArray[6]=m.width;this.vertexArray[7]=0;b.bufferSubData(b.ARRAY_BUFFER,0,this.vertexArray);b.bindBuffer(b.ARRAY_BUFFER,this.uvBuffer);this.uvArray[2]=m.width/this.width;this.uvArray[5]=m.height/this.height;this.uvArray[6]=m.width/this.width;this.uvArray[7]=m.height/this.height;b.bufferSubData(b.ARRAY_BUFFER,0,this.uvArray);var c=this.texturePool.pop();c||(c=new f.FilterTexture(this.gl,this.width,this.height));c.resize(this.width,
this.height);b.bindFramebuffer(b.FRAMEBUFFER,c.frameBuffer);b.clear(b.COLOR_BUFFER_BIT);b.disable(b.BLEND);for(var d=0;d<h.filterPasses.length-1;d++){var e=h.filterPasses[d];b.bindFramebuffer(b.FRAMEBUFFER,c.frameBuffer);b.activeTexture(b.TEXTURE0);b.bindTexture(b.TEXTURE_2D,k.texture);this.applyFilterPass(e,m,m.width,m.height);e=k;k=c;c=e}b.enable(b.BLEND);this.texturePool.push(c)}c=h.filterPasses[h.filterPasses.length-1];this.offsetX-=m.x;this.offsetY-=m.y;var d=this.width,e=this.height,g=0,l=0,
p=this.buffer;0===this.filterStack.length?b.colorMask(!0,!0,!0,!0):(p=this.filterStack[this.filterStack.length-1],m=p._filterArea,d=m.width,e=m.height,g=m.x,l=m.y,p=p._glFilterTexture.frameBuffer);n.x=d/2;n.y=-e/2;a.x=g;a.y=l;m=h._filterArea;n=m.x-g;a=m.y-l;b.bindBuffer(b.ARRAY_BUFFER,this.vertexBuffer);this.vertexArray[0]=n;this.vertexArray[1]=a+m.height;this.vertexArray[2]=n+m.width;this.vertexArray[3]=a+m.height;this.vertexArray[4]=n;this.vertexArray[5]=a;this.vertexArray[6]=n+m.width;this.vertexArray[7]=
a;b.bufferSubData(b.ARRAY_BUFFER,0,this.vertexArray);b.bindBuffer(b.ARRAY_BUFFER,this.uvBuffer);this.uvArray[2]=m.width/this.width;this.uvArray[5]=m.height/this.height;this.uvArray[6]=m.width/this.width;this.uvArray[7]=m.height/this.height;b.bufferSubData(b.ARRAY_BUFFER,0,this.uvArray);b.viewport(0,0,d*this.renderSession.resolution,e*this.renderSession.resolution);b.bindFramebuffer(b.FRAMEBUFFER,p);b.activeTexture(b.TEXTURE0);b.bindTexture(b.TEXTURE_2D,k.texture);this.applyFilterPass(c,m,d,e);this.texturePool.push(k);
h._glFilterTexture=null};f.WebGLFilterManager.prototype.applyFilterPass=function(b,h,m,k){h=this.gl;var n=b.shaders[h.id];n||(n=new f.PixiShader(h),n.fragmentSrc=b.fragmentSrc,n.uniforms=b.uniforms,n.init(),b.shaders[h.id]=n);this.renderSession.shaderManager.setShader(n);h.uniform2f(n.projectionVector,m/2,-k/2);h.uniform2f(n.offsetVector,0,0);b.uniforms.dimensions&&(b.uniforms.dimensions.value[0]=this.width,b.uniforms.dimensions.value[1]=this.height,b.uniforms.dimensions.value[2]=this.vertexArray[0],
b.uniforms.dimensions.value[3]=this.vertexArray[5]);n.syncUniforms();h.bindBuffer(h.ARRAY_BUFFER,this.vertexBuffer);h.vertexAttribPointer(n.aVertexPosition,2,h.FLOAT,!1,0,0);h.bindBuffer(h.ARRAY_BUFFER,this.uvBuffer);h.vertexAttribPointer(n.aTextureCoord,2,h.FLOAT,!1,0,0);h.bindBuffer(h.ARRAY_BUFFER,this.colorBuffer);h.vertexAttribPointer(n.colorAttribute,2,h.FLOAT,!1,0,0);h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,this.indexBuffer);h.drawElements(h.TRIANGLES,6,h.UNSIGNED_SHORT,0);this.renderSession.drawCount++};
f.WebGLFilterManager.prototype.initShaderBuffers=function(){var b=this.gl;this.vertexBuffer=b.createBuffer();this.uvBuffer=b.createBuffer();this.colorBuffer=b.createBuffer();this.indexBuffer=b.createBuffer();this.vertexArray=new f.Float32Array([0,0,1,0,0,1,1,1]);b.bindBuffer(b.ARRAY_BUFFER,this.vertexBuffer);b.bufferData(b.ARRAY_BUFFER,this.vertexArray,b.STATIC_DRAW);this.uvArray=new f.Float32Array([0,0,1,0,0,1,1,1]);b.bindBuffer(b.ARRAY_BUFFER,this.uvBuffer);b.bufferData(b.ARRAY_BUFFER,this.uvArray,
b.STATIC_DRAW);this.colorArray=new f.Float32Array([1,16777215,1,16777215,1,16777215,1,16777215]);b.bindBuffer(b.ARRAY_BUFFER,this.colorBuffer);b.bufferData(b.ARRAY_BUFFER,this.colorArray,b.STATIC_DRAW);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,this.indexBuffer);b.bufferData(b.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,1,3,2]),b.STATIC_DRAW)};f.WebGLFilterManager.prototype.destroy=function(){var b=this.gl;this.filterStack=null;for(var h=this.offsetY=this.offsetX=0;h<this.texturePool.length;h++)this.texturePool[h].destroy();
this.texturePool=null;b.deleteBuffer(this.vertexBuffer);b.deleteBuffer(this.uvBuffer);b.deleteBuffer(this.colorBuffer);b.deleteBuffer(this.indexBuffer)};f.FilterTexture=function(b,h,m,k){this.gl=b;this.frameBuffer=b.createFramebuffer();this.texture=b.createTexture();k=k||f.scaleModes.DEFAULT;b.bindTexture(b.TEXTURE_2D,this.texture);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,k===f.scaleModes.LINEAR?b.LINEAR:b.NEAREST);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,k===f.scaleModes.LINEAR?
b.LINEAR:b.NEAREST);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE);b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE);b.bindFramebuffer(b.FRAMEBUFFER,this.frameBuffer);b.bindFramebuffer(b.FRAMEBUFFER,this.frameBuffer);b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,this.texture,0);this.renderBuffer=b.createRenderbuffer();b.bindRenderbuffer(b.RENDERBUFFER,this.renderBuffer);b.framebufferRenderbuffer(b.FRAMEBUFFER,b.DEPTH_STENCIL_ATTACHMENT,b.RENDERBUFFER,
this.renderBuffer);this.resize(h,m)};f.FilterTexture.prototype.constructor=f.FilterTexture;f.FilterTexture.prototype.clear=function(){var b=this.gl;b.clearColor(0,0,0,0);b.clear(b.COLOR_BUFFER_BIT)};f.FilterTexture.prototype.resize=function(b,h){if(this.width!==b||this.height!==h){this.width=b;this.height=h;var f=this.gl;f.bindTexture(f.TEXTURE_2D,this.texture);f.texImage2D(f.TEXTURE_2D,0,f.RGBA,b,h,0,f.RGBA,f.UNSIGNED_BYTE,null);f.bindRenderbuffer(f.RENDERBUFFER,this.renderBuffer);f.renderbufferStorage(f.RENDERBUFFER,
f.DEPTH_STENCIL,b,h)}};f.FilterTexture.prototype.destroy=function(){var b=this.gl;b.deleteFramebuffer(this.frameBuffer);b.deleteTexture(this.texture);this.texture=this.frameBuffer=null};f.CanvasBuffer=function(b,h){this.width=b;this.height=h;this.canvas=document.createElement("canvas");this.context=this.canvas.getContext("2d");this.canvas.width=b;this.canvas.height=h};f.CanvasBuffer.prototype.constructor=f.CanvasBuffer;f.CanvasBuffer.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,
0);this.context.clearRect(0,0,this.width,this.height)};f.CanvasBuffer.prototype.resize=function(b,h){this.width=this.canvas.width=b;this.height=this.canvas.height=h};f.CanvasMaskManager=function(){};f.CanvasMaskManager.prototype.constructor=f.CanvasMaskManager;f.CanvasMaskManager.prototype.pushMask=function(b,h){var m=h.context;m.save();var k=b.alpha,n=b.worldTransform,a=h.resolution;m.setTransform(n.a*a,n.b*a,n.c*a,n.d*a,n.tx*a,n.ty*a);f.CanvasGraphics.renderGraphicsMask(b,m);m.clip();b.worldAlpha=
k};f.CanvasMaskManager.prototype.popMask=function(b){b.context.restore()};f.CanvasTinter=function(){};f.CanvasTinter.getTintedTexture=function(b,h){var m=b.tintedTexture||document.createElement("canvas");f.CanvasTinter.tintMethod(b.texture,h,m);return m};f.CanvasTinter.tintWithMultiply=function(b,h,f){var k=f.getContext("2d"),n=b.crop;if(f.width!==n.width||f.height!==n.height)f.width=n.width,f.height=n.height;k.clearRect(0,0,n.width,n.height);k.fillStyle="#"+("00000"+(h|0).toString(16)).substr(-6);
k.fillRect(0,0,n.width,n.height);k.globalCompositeOperation="multiply";k.drawImage(b.baseTexture.source,n.x,n.y,n.width,n.height,0,0,n.width,n.height);k.globalCompositeOperation="destination-atop";k.drawImage(b.baseTexture.source,n.x,n.y,n.width,n.height,0,0,n.width,n.height)};f.CanvasTinter.tintWithPerPixel=function(b,h,m){var k=m.getContext("2d"),n=b.crop;m.width=n.width;m.height=n.height;k.globalCompositeOperation="copy";k.drawImage(b.baseTexture.source,n.x,n.y,n.width,n.height,0,0,n.width,n.height);
m=f.hex2rgb(h);b=m[0];h=m[1];m=m[2];for(var n=k.getImageData(0,0,n.width,n.height),a=n.data,c=0;c<a.length;c+=4)if(a[c+0]*=b,a[c+1]*=h,a[c+2]*=m,!f.CanvasTinter.canHandleAlpha){var d=a[c+3];a[c+0]/=255/d;a[c+1]/=255/d;a[c+2]/=255/d}k.putImageData(n,0,0)};f.CanvasTinter.checkInverseAlpha=function(){var b=new f.CanvasBuffer(2,1);b.context.fillStyle="rgba(10, 20, 30, 0.5)";b.context.fillRect(0,0,1,1);var h=b.context.getImageData(0,0,1,1);if(null===h)return!1;b.context.putImageData(h,1,0);b=b.context.getImageData(1,
0,1,1);return b.data[0]===h.data[0]&&b.data[1]===h.data[1]&&b.data[2]===h.data[2]&&b.data[3]===h.data[3]};f.CanvasTinter.canHandleAlpha=f.CanvasTinter.checkInverseAlpha();f.CanvasTinter.canUseMultiply=f.canUseNewCanvasBlendModes();f.CanvasTinter.tintMethod=f.CanvasTinter.canUseMultiply?f.CanvasTinter.tintWithMultiply:f.CanvasTinter.tintWithPerPixel;f.CanvasRenderer=function(b,h,m){if(m)for(var k in f.defaultRenderOptions)void 0===m[k]&&(m[k]=f.defaultRenderOptions[k]);else m=f.defaultRenderOptions;
f.defaultRenderer||(f.defaultRenderer=this);this.type=f.CANVAS_RENDERER;this.resolution=m.resolution;this.clearBeforeRender=m.clearBeforeRender;this.transparent=m.transparent;this.autoResize=m.autoResize||!1;this.width=b||800;this.height=h||600;this.width*=this.resolution;this.height*=this.resolution;this.view=m.view||document.createElement("canvas");this.context=this.view.getContext("2d",{alpha:this.transparent});this.refresh=!0;this.view.width=this.width*this.resolution;this.view.height=this.height*
this.resolution;this.count=0;this.maskManager=new f.CanvasMaskManager;this.renderSession={context:this.context,maskManager:this.maskManager,scaleMode:null,smoothProperty:null,roundPixels:!1};this.mapBlendModes();this.resize(b,h);"imageSmoothingEnabled"in this.context?this.renderSession.smoothProperty="imageSmoothingEnabled":"webkitImageSmoothingEnabled"in this.context?this.renderSession.smoothProperty="webkitImageSmoothingEnabled":"mozImageSmoothingEnabled"in this.context?this.renderSession.smoothProperty=
"mozImageSmoothingEnabled":"oImageSmoothingEnabled"in this.context?this.renderSession.smoothProperty="oImageSmoothingEnabled":"msImageSmoothingEnabled"in this.context&&(this.renderSession.smoothProperty="msImageSmoothingEnabled")};f.CanvasRenderer.prototype.constructor=f.CanvasRenderer;f.CanvasRenderer.prototype.render=function(b){b.updateTransform();this.context.setTransform(1,0,0,1,0,0);this.context.globalAlpha=1;this.renderSession.currentBlendMode=f.blendModes.NORMAL;this.context.globalCompositeOperation=
f.blendModesCanvas[f.blendModes.NORMAL];navigator.isCocoonJS&&this.view.screencanvas&&(this.context.fillStyle="black",this.context.clear());this.clearBeforeRender&&(this.transparent?this.context.clearRect(0,0,this.width,this.height):(this.context.fillStyle=b.backgroundColorString,this.context.fillRect(0,0,this.width,this.height)));this.renderDisplayObject(b)};f.CanvasRenderer.prototype.destroy=function(b){void 0===b&&(b=!0);b&&this.view.parent&&this.view.parent.removeChild(this.view);this.renderSession=
this.maskManager=this.context=this.view=null};f.CanvasRenderer.prototype.resize=function(b,f){this.width=b*this.resolution;this.height=f*this.resolution;this.view.width=this.width;this.view.height=this.height;this.autoResize&&(this.view.style.width=this.width/this.resolution+"px",this.view.style.height=this.height/this.resolution+"px")};f.CanvasRenderer.prototype.renderDisplayObject=function(b,f,m){this.renderSession.context=f||this.context;this.renderSession.resolution=this.resolution;b._renderCanvas(this.renderSession,
m)};f.CanvasRenderer.prototype.mapBlendModes=function(){f.blendModesCanvas||(f.blendModesCanvas=[],f.canUseNewCanvasBlendModes()?(f.blendModesCanvas[f.blendModes.NORMAL]="source-over",f.blendModesCanvas[f.blendModes.ADD]="lighter",f.blendModesCanvas[f.blendModes.MULTIPLY]="multiply",f.blendModesCanvas[f.blendModes.SCREEN]="screen",f.blendModesCanvas[f.blendModes.OVERLAY]="overlay",f.blendModesCanvas[f.blendModes.DARKEN]="darken",f.blendModesCanvas[f.blendModes.LIGHTEN]="lighten",f.blendModesCanvas[f.blendModes.COLOR_DODGE]=
"color-dodge",f.blendModesCanvas[f.blendModes.COLOR_BURN]="color-burn",f.blendModesCanvas[f.blendModes.HARD_LIGHT]="hard-light",f.blendModesCanvas[f.blendModes.SOFT_LIGHT]="soft-light",f.blendModesCanvas[f.blendModes.DIFFERENCE]="difference",f.blendModesCanvas[f.blendModes.EXCLUSION]="exclusion",f.blendModesCanvas[f.blendModes.HUE]="hue",f.blendModesCanvas[f.blendModes.SATURATION]="saturation",f.blendModesCanvas[f.blendModes.COLOR]="color",f.blendModesCanvas[f.blendModes.LUMINOSITY]="luminosity"):
(f.blendModesCanvas[f.blendModes.NORMAL]="source-over",f.blendModesCanvas[f.blendModes.ADD]="lighter",f.blendModesCanvas[f.blendModes.MULTIPLY]="source-over",f.blendModesCanvas[f.blendModes.SCREEN]="source-over",f.blendModesCanvas[f.blendModes.OVERLAY]="source-over",f.blendModesCanvas[f.blendModes.DARKEN]="source-over",f.blendModesCanvas[f.blendModes.LIGHTEN]="source-over",f.blendModesCanvas[f.blendModes.COLOR_DODGE]="source-over",f.blendModesCanvas[f.blendModes.COLOR_BURN]="source-over",f.blendModesCanvas[f.blendModes.HARD_LIGHT]=
"source-over",f.blendModesCanvas[f.blendModes.SOFT_LIGHT]="source-over",f.blendModesCanvas[f.blendModes.DIFFERENCE]="source-over",f.blendModesCanvas[f.blendModes.EXCLUSION]="source-over",f.blendModesCanvas[f.blendModes.HUE]="source-over",f.blendModesCanvas[f.blendModes.SATURATION]="source-over",f.blendModesCanvas[f.blendModes.COLOR]="source-over",f.blendModesCanvas[f.blendModes.LUMINOSITY]="source-over"))};f.CanvasGraphics=function(){};f.CanvasGraphics.renderGraphics=function(b,h){var m=b.worldAlpha;
b.dirty&&(this.updateGraphicsTint(b),b.dirty=!1);for(var k=0;k<b.graphicsData.length;k++){var n=b.graphicsData[k],a=n.shape,c=n._fillTint,d=n._lineTint;h.lineWidth=n.lineWidth;if(n.type===f.Graphics.POLY){h.beginPath();var e=a.points;h.moveTo(e[0],e[1]);for(var g=1;g<e.length/2;g++)h.lineTo(e[2*g],e[2*g+1]);a.closed&&h.lineTo(e[0],e[1]);e[0]===e[e.length-2]&&e[1]===e[e.length-1]&&h.closePath();n.fill&&(h.globalAlpha=n.fillAlpha*m,h.fillStyle="#"+("00000"+(c|0).toString(16)).substr(-6),h.fill());n.lineWidth&&
(h.globalAlpha=n.lineAlpha*m,h.strokeStyle="#"+("00000"+(d|0).toString(16)).substr(-6),h.stroke())}else if(n.type===f.Graphics.RECT){if(n.fillColor||0===n.fillColor)h.globalAlpha=n.fillAlpha*m,h.fillStyle="#"+("00000"+(c|0).toString(16)).substr(-6),h.fillRect(a.x,a.y,a.width,a.height);n.lineWidth&&(h.globalAlpha=n.lineAlpha*m,h.strokeStyle="#"+("00000"+(d|0).toString(16)).substr(-6),h.strokeRect(a.x,a.y,a.width,a.height))}else if(n.type===f.Graphics.CIRC)h.beginPath(),h.arc(a.x,a.y,a.radius,0,2*Math.PI),
h.closePath(),n.fill&&(h.globalAlpha=n.fillAlpha*m,h.fillStyle="#"+("00000"+(c|0).toString(16)).substr(-6),h.fill()),n.lineWidth&&(h.globalAlpha=n.lineAlpha*m,h.strokeStyle="#"+("00000"+(d|0).toString(16)).substr(-6),h.stroke());else if(n.type===f.Graphics.ELIP){var l=2*a.width,g=2*a.height,e=a.x-l/2,a=a.y-g/2;h.beginPath();var p=l/2*.5522848,u=g/2*.5522848,y=e+l,w=a+g,l=e+l/2,g=a+g/2;h.moveTo(e,g);h.bezierCurveTo(e,g-u,l-p,a,l,a);h.bezierCurveTo(l+p,a,y,g-u,y,g);h.bezierCurveTo(y,g+u,l+p,w,l,w);
h.bezierCurveTo(l-p,w,e,g+u,e,g);h.closePath();n.fill&&(h.globalAlpha=n.fillAlpha*m,h.fillStyle="#"+("00000"+(c|0).toString(16)).substr(-6),h.fill());n.lineWidth&&(h.globalAlpha=n.lineAlpha*m,h.strokeStyle="#"+("00000"+(d|0).toString(16)).substr(-6),h.stroke())}else if(n.type===f.Graphics.RREC){e=a.x;g=a.y;p=a.width;u=a.height;a=a.radius;y=Math.min(p,u)/2|0;a=a>y?y:a;h.beginPath();h.moveTo(e,g+a);h.lineTo(e,g+u-a);h.quadraticCurveTo(e,g+u,e+a,g+u);h.lineTo(e+p-a,g+u);h.quadraticCurveTo(e+p,g+u,e+
p,g+u-a);h.lineTo(e+p,g+a);h.quadraticCurveTo(e+p,g,e+p-a,g);h.lineTo(e+a,g);h.quadraticCurveTo(e,g,e,g+a);h.closePath();if(n.fillColor||0===n.fillColor)h.globalAlpha=n.fillAlpha*m,h.fillStyle="#"+("00000"+(c|0).toString(16)).substr(-6),h.fill();n.lineWidth&&(h.globalAlpha=n.lineAlpha*m,h.strokeStyle="#"+("00000"+(d|0).toString(16)).substr(-6),h.stroke())}}};f.CanvasGraphics.renderGraphicsMask=function(b,h){var m=b.graphicsData.length;if(0!==m){h.beginPath();for(var k=0;k<m;k++){var n=b.graphicsData[k],
a=n.shape;if(n.type===f.Graphics.POLY){n=a.points;h.moveTo(n[0],n[1]);for(var c=1;c<n.length/2;c++)h.lineTo(n[2*c],n[2*c+1]);n[0]===n[n.length-2]&&n[1]===n[n.length-1]&&h.closePath()}else if(n.type===f.Graphics.RECT)h.rect(a.x,a.y,a.width,a.height),h.closePath();else if(n.type===f.Graphics.CIRC)h.arc(a.x,a.y,a.radius,0,2*Math.PI),h.closePath();else if(n.type===f.Graphics.ELIP){var d=2*a.width,c=2*a.height,n=a.x-d/2,a=a.y-c/2,e=d/2*.5522848,g=c/2*.5522848,l=n+d,p=a+c,d=n+d/2,c=a+c/2;h.moveTo(n,c);
h.bezierCurveTo(n,c-g,d-e,a,d,a);h.bezierCurveTo(d+e,a,l,c-g,l,c);h.bezierCurveTo(l,c+g,d+e,p,d,p);h.bezierCurveTo(d-e,p,n,c+g,n,c);h.closePath()}else n.type===f.Graphics.RREC&&(n=a.x,c=a.y,e=a.width,g=a.height,a=a.radius,l=Math.min(e,g)/2|0,a=a>l?l:a,h.moveTo(n,c+a),h.lineTo(n,c+g-a),h.quadraticCurveTo(n,c+g,n+a,c+g),h.lineTo(n+e-a,c+g),h.quadraticCurveTo(n+e,c+g,n+e,c+g-a),h.lineTo(n+e,c+a),h.quadraticCurveTo(n+e,c,n+e-a,c),h.lineTo(n+a,c),h.quadraticCurveTo(n,c,n,c+a),h.closePath())}}};f.CanvasGraphics.updateGraphicsTint=
function(b){if(16777215!==b.tint)for(var f=(b.tint>>16&255)/255,m=(b.tint>>8&255)/255,k=(b.tint&255)/255,n=0;n<b.graphicsData.length;n++){var a=b.graphicsData[n],c=a.fillColor|0,d=a.lineColor|0;a._fillTint=((c>>16&255)/255*f*255<<16)+((c>>8&255)/255*m*255<<8)+(c&255)/255*k*255;a._lineTint=((d>>16&255)/255*f*255<<16)+((d>>8&255)/255*m*255<<8)+(d&255)/255*k*255}};f.BaseTextureCache={};f.BaseTextureCacheIdGenerator=0;f.BaseTexture=function(b,h){this.resolution=1;this.height=this.width=100;this.scaleMode=
h||f.scaleModes.DEFAULT;this.hasLoaded=!1;this.source=b;this._UID=f._UID++;this.premultipliedAlpha=!0;this._glTextures=[];this.mipmap=!1;this._dirty=[!0,!0,!0,!0];b&&((this.source.complete||this.source.getContext)&&this.source.width&&this.source.height&&(this.hasLoaded=!0,this.width=this.source.naturalWidth||this.source.width,this.height=this.source.naturalHeight||this.source.height,this.dirty()),this.imageUrl=null,this._powerOf2=!1)};f.BaseTexture.prototype.constructor=f.BaseTexture;f.BaseTexture.prototype.forceLoaded=
function(b,f){this.hasLoaded=!0;this.width=b;this.height=f;this.dirty()};f.BaseTexture.prototype.destroy=function(){this.imageUrl?(delete f.BaseTextureCache[this.imageUrl],delete f.TextureCache[this.imageUrl],this.imageUrl=null,navigator.isCocoonJS||(this.source.src="")):this.source&&this.source._pixiId&&delete f.BaseTextureCache[this.source._pixiId];this.source=null;this.unloadFromGPU()};f.BaseTexture.prototype.updateSourceImage=function(b){this.hasLoaded=!1;this.source.src=null;this.source.src=
b};f.BaseTexture.prototype.dirty=function(){for(var b=0;b<this._glTextures.length;b++)this._dirty[b]=!0};f.BaseTexture.prototype.unloadFromGPU=function(){this.dirty();for(var b=this._glTextures.length-1;0<=b;b--){var h=this._glTextures[b],m=f.glContexts[b];m&&h&&m.deleteTexture(h)}this._glTextures.length=0;this.dirty()};f.BaseTexture.fromImage=function(b,h,m){var k=f.BaseTextureCache[b];void 0===h&&-1===b.indexOf("data:")&&(h=!0);k||(k=new Image,h&&(k.crossOrigin=""),k.src=b,k=new f.BaseTexture(k,
m),k.imageUrl=b,f.BaseTextureCache[b]=k,-1!==b.indexOf(f.RETINA_PREFIX+".")&&(k.resolution=2));return k};f.BaseTexture.fromCanvas=function(b,h){b._pixiId||(b._pixiId="canvas_"+f.TextureCacheIdGenerator++);0===b.width&&(b.width=1);0===b.height&&(b.height=1);var m=f.BaseTextureCache[b._pixiId];m||(m=new f.BaseTexture(b,h),f.BaseTextureCache[b._pixiId]=m);return m};f.TextureCache={};f.FrameCache={};f.TextureSilentFail=!1;f.TextureCacheIdGenerator=0;f.Texture=function(b,h,m,k){this.noFrame=!1;h||(this.noFrame=
!0,h=new f.Rectangle(0,0,1,1));b instanceof f.Texture&&(b=b.baseTexture);this.baseTexture=b;this.frame=h;this.trim=k;this.requiresReTint=this.requiresUpdate=this.isTiling=this.valid=!1;this._uvs=null;this.height=this.width=0;this.crop=m||new f.Rectangle(0,0,1,1);b.hasLoaded&&(this.noFrame&&(h=new f.Rectangle(0,0,b.width,b.height)),this.setFrame(h))};f.Texture.prototype.constructor=f.Texture;f.Texture.prototype.onBaseTextureLoaded=function(){var b=this.baseTexture;this.noFrame&&(this.frame=new f.Rectangle(0,
0,b.width,b.height));this.setFrame(this.frame)};f.Texture.prototype.destroy=function(b){b&&this.baseTexture.destroy();this.valid=!1};f.Texture.prototype.setFrame=function(b){this.noFrame=!1;this.frame=b;this.width=b.width;this.height=b.height;this.crop.x=b.x;this.crop.y=b.y;this.crop.width=b.width;this.crop.height=b.height;if(!this.trim&&(b.x+b.width>this.baseTexture.width||b.y+b.height>this.baseTexture.height)){if(!f.TextureSilentFail)throw Error("Texture Error: frame does not fit inside the base Texture dimensions "+
this);this.valid=!1}else this.valid=b&&b.width&&b.height&&this.baseTexture.source&&this.baseTexture.hasLoaded,this.trim&&(this.width=this.trim.width,this.height=this.trim.height,this.frame.width=this.trim.width,this.frame.height=this.trim.height),this.valid&&this._updateUvs()};f.Texture.prototype._updateUvs=function(){this._uvs||(this._uvs=new f.TextureUvs);var b=this.crop,h=this.baseTexture.width,m=this.baseTexture.height;this._uvs.x0=b.x/h;this._uvs.y0=b.y/m;this._uvs.x1=(b.x+b.width)/h;this._uvs.y1=
b.y/m;this._uvs.x2=(b.x+b.width)/h;this._uvs.y2=(b.y+b.height)/m;this._uvs.x3=b.x/h;this._uvs.y3=(b.y+b.height)/m};f.Texture.fromImage=function(b,h,m){var k=f.TextureCache[b];k||(k=new f.Texture(f.BaseTexture.fromImage(b,h,m)),f.TextureCache[b]=k);return k};f.Texture.fromFrame=function(b){var h=f.TextureCache[b];if(!h)throw Error('The frameId "'+b+'" does not exist in the texture cache ');return h};f.Texture.fromCanvas=function(b,h){var m=f.BaseTexture.fromCanvas(b,h);return new f.Texture(m)};f.Texture.addTextureToCache=
function(b,h){f.TextureCache[h]=b};f.Texture.removeTextureFromCache=function(b){var h=f.TextureCache[b];delete f.TextureCache[b];delete f.BaseTextureCache[b];return h};f.TextureUvs=function(){this.y3=this.x3=this.y2=this.x2=this.y1=this.x1=this.y0=this.x0=0};f.RenderTexture=function(b,h,m,k,n){this.width=b||100;this.height=h||100;this.resolution=n||1;this.frame=new f.Rectangle(0,0,this.width*this.resolution,this.height*this.resolution);this.crop=new f.Rectangle(0,0,this.width*this.resolution,this.height*
this.resolution);this.baseTexture=new f.BaseTexture;this.baseTexture.width=this.width*this.resolution;this.baseTexture.height=this.height*this.resolution;this.baseTexture._glTextures=[];this.baseTexture.resolution=this.resolution;this.baseTexture.scaleMode=k||f.scaleModes.DEFAULT;this.baseTexture.hasLoaded=!0;f.Texture.call(this,this.baseTexture,new f.Rectangle(0,0,this.width*this.resolution,this.height*this.resolution));this.renderer=m||f.defaultRenderer;this.renderer.type===f.WEBGL_RENDERER?(b=
this.renderer.gl,this.baseTexture._dirty[b.id]=!1,this.textureBuffer=new f.FilterTexture(b,this.width,this.height,this.baseTexture.scaleMode),this.baseTexture._glTextures[b.id]=this.textureBuffer.texture,this.render=this.renderWebGL,this.projection=new f.Point(.5*this.width,.5*-this.height)):(this.render=this.renderCanvas,this.textureBuffer=new f.CanvasBuffer(this.width*this.resolution,this.height*this.resolution),this.baseTexture.source=this.textureBuffer.canvas);this.valid=!0;this.tempMatrix=new Phaser.Matrix;
this._updateUvs()};f.RenderTexture.prototype=Object.create(f.Texture.prototype);f.RenderTexture.prototype.constructor=f.RenderTexture;f.RenderTexture.prototype.resize=function(b,h,m){if(b!==this.width||h!==this.height)this.valid=0<b&&0<h,this.width=b,this.height=h,this.frame.width=this.crop.width=b*this.resolution,this.frame.height=this.crop.height=h*this.resolution,m&&(this.baseTexture.width=this.width*this.resolution,this.baseTexture.height=this.height*this.resolution),this.renderer.type===f.WEBGL_RENDERER&&
(this.projection.x=this.width/2,this.projection.y=-this.height/2),this.valid&&this.textureBuffer.resize(this.width,this.height)};f.RenderTexture.prototype.clear=function(){this.valid&&(this.renderer.type===f.WEBGL_RENDERER&&this.renderer.gl.bindFramebuffer(this.renderer.gl.FRAMEBUFFER,this.textureBuffer.frameBuffer),this.textureBuffer.clear())};f.RenderTexture.prototype.renderWebGL=function(b,f,m){if(this.valid&&0!==b.alpha){var k=b.worldTransform;k.identity();k.translate(0,2*this.projection.y);f&&
k.append(f);k.scale(1,-1);for(k=0;k<b.children.length;k++)b.children[k].updateTransform();k=this.renderer.gl;k.viewport(0,0,this.width*this.resolution,this.height*this.resolution);k.bindFramebuffer(k.FRAMEBUFFER,this.textureBuffer.frameBuffer);m&&this.textureBuffer.clear();this.renderer.spriteBatch.dirty=!0;this.renderer.renderDisplayObject(b,this.projection,this.textureBuffer.frameBuffer,f);this.renderer.spriteBatch.dirty=!0}};f.RenderTexture.prototype.renderCanvas=function(b,f,m){if(this.valid&&
0!==b.alpha){for(var k=0;k<b.children.length;k++)b.children[k].updateTransform();m&&this.textureBuffer.clear();m=this.renderer.resolution;this.renderer.resolution=this.resolution;this.renderer.renderDisplayObject(b,this.textureBuffer.context,f);this.renderer.resolution=m}};f.RenderTexture.prototype.getImage=function(){var b=new Image;b.src=this.getBase64();return b};f.RenderTexture.prototype.getBase64=function(){return this.getCanvas().toDataURL()};f.RenderTexture.prototype.getCanvas=function(){if(this.renderer.type===
f.WEBGL_RENDERER){var b=this.renderer.gl,h=this.textureBuffer.width,m=this.textureBuffer.height,k=new Uint8Array(4*h*m);b.bindFramebuffer(b.FRAMEBUFFER,this.textureBuffer.frameBuffer);b.readPixels(0,0,h,m,b.RGBA,b.UNSIGNED_BYTE,k);b.bindFramebuffer(b.FRAMEBUFFER,null);b=new f.CanvasBuffer(h,m);h=b.context.getImageData(0,0,h,m);h.data.set(k);b.context.putImageData(h,0,0);return b.canvas}return this.textureBuffer.canvas};f.AbstractFilter=function(b,f){this.passes=[this];this.shaders=[];this.dirty=!0;
this.padding=0;this.uniforms=f||{};this.fragmentSrc=b||[]};f.AbstractFilter.prototype.constructor=f.AbstractFilter;f.AbstractFilter.prototype.syncUniforms=function(){for(var b=0,f=this.shaders.length;b<f;b++)this.shaders[b].dirty=!0};f.Strip=function(b){f.DisplayObjectContainer.call(this);this.texture=b;this.uvs=new f.Float32Array([0,1,1,1,1,0,0,1]);this.vertices=new f.Float32Array([0,0,100,0,100,100,0,100]);this.colors=new f.Float32Array([1,1,1,1]);this.indices=new f.Uint16Array([0,1,2,3]);this.dirty=
!0;this.blendMode=f.blendModes.NORMAL;this.canvasPadding=0;this.drawMode=f.Strip.DrawModes.TRIANGLE_STRIP};f.Strip.prototype=Object.create(f.DisplayObjectContainer.prototype);f.Strip.prototype.constructor=f.Strip;f.Strip.prototype._renderWebGL=function(b){!this.visible||0>=this.alpha||(b.spriteBatch.stop(),this._vertexBuffer||this._initWebGL(b),b.shaderManager.setShader(b.shaderManager.stripShader),this._renderStrip(b),b.spriteBatch.start())};f.Strip.prototype._initWebGL=function(b){b=b.gl;this._vertexBuffer=
b.createBuffer();this._indexBuffer=b.createBuffer();this._uvBuffer=b.createBuffer();this._colorBuffer=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,this._vertexBuffer);b.bufferData(b.ARRAY_BUFFER,this.vertices,b.DYNAMIC_DRAW);b.bindBuffer(b.ARRAY_BUFFER,this._uvBuffer);b.bufferData(b.ARRAY_BUFFER,this.uvs,b.STATIC_DRAW);b.bindBuffer(b.ARRAY_BUFFER,this._colorBuffer);b.bufferData(b.ARRAY_BUFFER,this.colors,b.STATIC_DRAW);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,this._indexBuffer);b.bufferData(b.ELEMENT_ARRAY_BUFFER,
this.indices,b.STATIC_DRAW)};f.Strip.prototype._renderStrip=function(b){var h=b.gl,m=b.projection,k=b.offset,n=b.shaderManager.stripShader,a=this.drawMode===f.Strip.DrawModes.TRIANGLE_STRIP?h.TRIANGLE_STRIP:h.TRIANGLES;b.blendModeManager.setBlendMode(this.blendMode);h.uniformMatrix3fv(n.translationMatrix,!1,this.worldTransform.toArray(!0));h.uniform2f(n.projectionVector,m.x,-m.y);h.uniform2f(n.offsetVector,-k.x,-k.y);h.uniform1f(n.alpha,this.worldAlpha);this.dirty?(this.dirty=!1,h.bindBuffer(h.ARRAY_BUFFER,
this._vertexBuffer),h.bufferData(h.ARRAY_BUFFER,this.vertices,h.STATIC_DRAW),h.vertexAttribPointer(n.aVertexPosition,2,h.FLOAT,!1,0,0),h.bindBuffer(h.ARRAY_BUFFER,this._uvBuffer),h.bufferData(h.ARRAY_BUFFER,this.uvs,h.STATIC_DRAW),h.vertexAttribPointer(n.aTextureCoord,2,h.FLOAT,!1,0,0),h.activeTexture(h.TEXTURE0),this.texture.baseTexture._dirty[h.id]?b.renderer.updateTexture(this.texture.baseTexture):h.bindTexture(h.TEXTURE_2D,this.texture.baseTexture._glTextures[h.id]),h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,
this._indexBuffer),h.bufferData(h.ELEMENT_ARRAY_BUFFER,this.indices,h.STATIC_DRAW)):(h.bindBuffer(h.ARRAY_BUFFER,this._vertexBuffer),h.bufferSubData(h.ARRAY_BUFFER,0,this.vertices),h.vertexAttribPointer(n.aVertexPosition,2,h.FLOAT,!1,0,0),h.bindBuffer(h.ARRAY_BUFFER,this._uvBuffer),h.vertexAttribPointer(n.aTextureCoord,2,h.FLOAT,!1,0,0),h.activeTexture(h.TEXTURE0),this.texture.baseTexture._dirty[h.id]?b.renderer.updateTexture(this.texture.baseTexture):h.bindTexture(h.TEXTURE_2D,this.texture.baseTexture._glTextures[h.id]),
h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,this._indexBuffer));h.drawElements(a,this.indices.length,h.UNSIGNED_SHORT,0)};f.Strip.prototype._renderCanvas=function(b){var h=b.context,m=this.worldTransform;b.roundPixels?h.setTransform(m.a,m.b,m.c,m.d,m.tx|0,m.ty|0):h.setTransform(m.a,m.b,m.c,m.d,m.tx,m.ty);this.drawMode===f.Strip.DrawModes.TRIANGLE_STRIP?this._renderCanvasTriangleStrip(h):this._renderCanvasTriangles(h)};f.Strip.prototype._renderCanvasTriangleStrip=function(b){var f=this.vertices,m=this.uvs,
k=f.length/2;this.count++;for(var n=0;n<k-2;n++){var a=2*n;this._renderCanvasDrawTriangle(b,f,m,a,a+2,a+4)}};f.Strip.prototype._renderCanvasTriangles=function(b){var f=this.vertices,m=this.uvs,k=this.indices,n=k.length;this.count++;for(var a=0;a<n;a+=3)this._renderCanvasDrawTriangle(b,f,m,2*k[a],2*k[a+1],2*k[a+2])};f.Strip.prototype._renderCanvasDrawTriangle=function(b,f,m,k,n,a){var c=this.texture.baseTexture.source,d=this.texture.width,e=this.texture.height,g=f[k],l=f[n],p=f[a],u=f[k+1],y=f[n+1];
f=f[a+1];var w=m[k]*d,q=m[n]*d,d=m[a]*d;k=m[k+1]*e;n=m[n+1]*e;m=m[a+1]*e;if(0<this.canvasPadding){a=this.canvasPadding/this.worldTransform.a;var e=this.canvasPadding/this.worldTransform.d,t=(g+l+p)/3,r=(u+y+f)/3,x=g-t,v=u-r,A=Math.sqrt(x*x+v*v),g=t+x/A*(A+a),u=r+v/A*(A+e),x=l-t,v=y-r,A=Math.sqrt(x*x+v*v),l=t+x/A*(A+a),y=r+v/A*(A+e),x=p-t,v=f-r,A=Math.sqrt(x*x+v*v),p=t+x/A*(A+a);f=r+v/A*(A+e)}b.save();b.beginPath();b.moveTo(g,u);b.lineTo(l,y);b.lineTo(p,f);b.closePath();b.clip();a=w*n+k*d+q*m-n*d-
k*q-w*m;b.transform((g*n+k*p+l*m-n*p-k*l-g*m)/a,(u*n+k*f+y*m-n*f-k*y-u*m)/a,(w*l+g*d+q*p-l*d-g*q-w*p)/a,(w*y+u*d+q*f-y*d-u*q-w*f)/a,(w*n*p+k*l*d+g*q*m-g*n*d-k*q*p-w*l*m)/a,(w*n*f+k*y*d+u*q*m-u*n*d-k*q*f-w*y*m)/a);b.drawImage(c,0,0);b.restore()};f.Strip.prototype.renderStripFlat=function(b){var f=this.context;b=b.vertices;var m=b.length/2;this.count++;f.beginPath();for(var k=1;k<m-2;k++){var n=2*k,a=b[n+2],c=b[n+4],d=b[n+3],e=b[n+5];f.moveTo(b[n],b[n+1]);f.lineTo(a,d);f.lineTo(c,e)}f.fillStyle="#FF0000";
f.fill();f.closePath()};f.Strip.prototype.onTextureUpdate=function(){this.updateFrame=!0};f.Strip.prototype.getBounds=function(b){var h=b||this.worldTransform;b=h.a;for(var m=h.b,k=h.c,n=h.d,a=h.tx,c=h.ty,d=h=-Infinity,e=Infinity,g=Infinity,l=this.vertices,p=0,u=l.length;p<u;p+=2)var y=l[p],w=l[p+1],q=b*y+k*w+a,y=n*w+m*y+c,e=q<e?q:e,g=y<g?y:g,h=q>h?q:h,d=y>d?y:d;if(-Infinity===e||Infinity===d)return f.EmptyRectangle;b=this._bounds;b.x=e;b.width=h-e;b.y=g;b.height=d-g;return this._currentBounds=b};
f.Strip.DrawModes={TRIANGLE_STRIP:0,TRIANGLES:1};f.Rope=function(b,h){f.Strip.call(this,b);this.points=h;this.vertices=new f.Float32Array(4*h.length);this.uvs=new f.Float32Array(4*h.length);this.colors=new f.Float32Array(2*h.length);this.indices=new f.Uint16Array(2*h.length);this.refresh()};f.Rope.prototype=Object.create(f.Strip.prototype);f.Rope.prototype.constructor=f.Rope;f.Rope.prototype.refresh=function(){var b=this.points;if(!(1>b.length)){var f=this.uvs,m=this.indices,k=this.colors;this.count-=
.2;f[0]=0;f[1]=0;f[2]=0;f[3]=1;k[0]=1;k[1]=1;m[0]=0;m[1]=1;for(var b=b.length,n,a,c=1;c<b;c++)n=4*c,a=c/(b-1),f[n]=a,f[n+1]=0,f[n+2]=a,f[n+3]=1,n=2*c,k[n]=1,k[n+1]=1,n=2*c,m[n]=n,m[n+1]=n+1}};f.Rope.prototype.updateTransform=function(){var b=this.points;if(!(1>b.length)){var h=b[0],m,k=m=0;this.count-=.2;for(var n=this.vertices,a=b.length,c,d,e,g=0;g<a;g++)c=b[g],d=4*g,m=g<b.length-1?b[g+1]:c,k=-(m.x-h.x),m=m.y-h.y,h=Math.sqrt(m*m+k*k),e=this.texture.height/2,m/=h,k/=h,m*=e,k*=e,n[d]=c.x+m,n[d+1]=
c.y+k,n[d+2]=c.x-m,n[d+3]=c.y-k,h=c;f.DisplayObjectContainer.prototype.updateTransform.call(this)}};f.Rope.prototype.setTexture=function(b){this.texture=b};f.TilingSprite=function(b,h,m){f.Sprite.call(this,b);this._width=h||128;this._height=m||128;this.tileScale=new f.Point(1,1);this.tileScaleOffset=new f.Point(1,1);this.tilePosition=new f.Point;this.renderable=!0;this.tint=16777215;this.textureDebug=!1;this.blendMode=f.blendModes.NORMAL;this.tilePattern=this.tilingTexture=this.canvasBuffer=null;
this.refreshTexture=!0;this.frameHeight=this.frameWidth=0};f.TilingSprite.prototype=Object.create(f.Sprite.prototype);f.TilingSprite.prototype.constructor=f.TilingSprite;f.TilingSprite.prototype.setTexture=function(b){this.texture!==b&&(this.texture=b,this.refreshTexture=!0,this.cachedTint=16777215)};f.TilingSprite.prototype._renderWebGL=function(b){if(!1!==this.visible&&0!==this.alpha){this._mask&&(b.spriteBatch.stop(),b.maskManager.pushMask(this.mask,b),b.spriteBatch.start());this._filters&&(b.spriteBatch.flush(),
b.filterManager.pushFilter(this._filterBlock));if(this.refreshTexture)if(this.generateTilingTexture(!0),this.tilingTexture)this.tilingTexture.needsUpdate&&(b.renderer.updateTexture(this.tilingTexture.baseTexture),this.tilingTexture.needsUpdate=!1);else return;b.spriteBatch.renderTilingSprite(this);for(var f=0;f<this.children.length;f++)this.children[f]._renderWebGL(b);b.spriteBatch.stop();this._filters&&b.filterManager.popFilter();this._mask&&b.maskManager.popMask(this._mask,b);b.spriteBatch.start()}};
f.TilingSprite.prototype._renderCanvas=function(b){if(!1!==this.visible&&0!==this.alpha){var h=b.context;this._mask&&b.maskManager.pushMask(this._mask,b);h.globalAlpha=this.worldAlpha;var m=this.worldTransform,k=b.resolution;h.setTransform(m.a*k,m.b*k,m.c*k,m.d*k,m.tx*k,m.ty*k);if(this.refreshTexture)if(this.generateTilingTexture(!1),this.tilingTexture)this.tilePattern=h.createPattern(this.tilingTexture.baseTexture.source,"repeat");else return;m=b.currentBlendMode;this.blendMode!==b.currentBlendMode&&
(b.currentBlendMode=this.blendMode,h.globalCompositeOperation=f.blendModesCanvas[b.currentBlendMode]);var k=this.tilePosition,n=this.tileScale;k.x%=this.tilingTexture.baseTexture.width;k.y%=this.tilingTexture.baseTexture.height;h.scale(n.x,n.y);h.translate(k.x+this.anchor.x*-this._width,k.y+this.anchor.y*-this._height);h.fillStyle=this.tilePattern;var a=-k.x,c=-k.y,d=this._width/n.x,e=this._height/n.y;b.roundPixels&&(a|0,c|0,d|0,e|0);h.fillRect(a,c,d,e);h.scale(1/n.x,1/n.y);h.translate(-k.x+this.anchor.x*
this._width,-k.y+this.anchor.y*this._height);this._mask&&b.maskManager.popMask(b);for(k=0;k<this.children.length;k++)this.children[k]._renderCanvas(b);m!==this.blendMode&&(b.currentBlendMode=m,h.globalCompositeOperation=f.blendModesCanvas[m])}};f.TilingSprite.prototype.onTextureUpdate=function(){};f.TilingSprite.prototype.generateTilingTexture=function(b){if(this.texture.baseTexture.hasLoaded){var h=this.texture,m=h.frame,k=this._frame.sourceSizeW,n=this._frame.sourceSizeH,a=0,c=0;this._frame.trimmed&&
(a=this._frame.spriteSourceSizeX,c=this._frame.spriteSourceSizeY);b&&(k=f.getNextPowerOfTwo(k),n=f.getNextPowerOfTwo(n));this.canvasBuffer?(this.canvasBuffer.resize(k,n),this.tilingTexture.baseTexture.width=k,this.tilingTexture.baseTexture.height=n):(this.canvasBuffer=new f.CanvasBuffer(k,n),this.tilingTexture=f.Texture.fromCanvas(this.canvasBuffer.canvas),this.tilingTexture=f.Texture.fromCanvas(this.canvasBuffer.canvas),this.tilingTexture.isTiling=!0);this.tilingTexture.needsUpdate=!0;this.textureDebug&&
(this.canvasBuffer.context.strokeStyle="#00ff00",this.canvasBuffer.context.strokeRect(0,0,k,n));b=h.crop.width;var d=h.crop.height;if(b!==k||d!==n)b=k,d=n;this.canvasBuffer.context.drawImage(h.baseTexture.source,h.crop.x,h.crop.y,h.crop.width,h.crop.height,a,c,b,d);this.tileScaleOffset.x=m.width/k;this.tileScaleOffset.y=m.height/n;this.refreshTexture=!1;this.tilingTexture.baseTexture._powerOf2=!0}};f.TilingSprite.prototype.getBounds=function(){var b=this._width,f=this._height,m=b*(1-this.anchor.x),
k=b*-this.anchor.x,n=f*(1-this.anchor.y),a=f*-this.anchor.y,f=this.worldTransform,c=f.a,d=f.b,e=f.c,g=f.d,l=f.tx,p=f.ty,f=c*k+e*a+l,b=g*a+d*k+p,u=c*m+e*a+l,a=g*a+d*m+p,y=c*m+e*n+l,m=g*n+d*m+p,c=c*k+e*n+l,k=g*n+d*k+p,d=n=-Infinity,e=g=Infinity,g=f<g?f:g,g=u<g?u:g,g=y<g?y:g,g=c<g?c:g,e=b<e?b:e,e=a<e?a:e,e=m<e?m:e,e=k<e?k:e,n=f>n?f:n,n=u>n?u:n,n=y>n?y:n,d=b>d?b:d,d=a>d?a:d,d=m>d?m:d,f=this._bounds;f.x=g;f.width=(c>n?c:n)-g;f.y=e;f.height=(k>d?k:d)-e;return this._currentBounds=f};f.TilingSprite.prototype.destroy=
function(){f.Sprite.prototype.destroy.call(this);this.tilePosition=this.tileScaleOffset=this.tileScale=null;this.tilingTexture&&(this.tilingTexture.destroy(!0),this.tilingTexture=null)};Object.defineProperty(f.TilingSprite.prototype,"width",{get:function(){return this._width},set:function(b){this._width=b}});Object.defineProperty(f.TilingSprite.prototype,"height",{get:function(){return this._height},set:function(b){this._height=b}});"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&
(exports=module.exports=f),exports.PIXI=f):"undefined"!==typeof define&&define.amd?define("PIXI",this.PIXI=f):this.PIXI=f;return f}).call(this);
(function(){function f(a,c){this._scaleFactor=a;this._deltaMode=c;this.originalEvent=null}var b=b||{VERSION:"2.4.2",GAMES:[],AUTO:0,CANVAS:1,WEBGL:2,HEADLESS:3,NONE:0,LEFT:1,RIGHT:2,UP:3,DOWN:4,SPRITE:0,BUTTON:1,IMAGE:2,GRAPHICS:3,TEXT:4,TILESPRITE:5,BITMAPTEXT:6,GROUP:7,RENDERTEXTURE:8,TILEMAP:9,TILEMAPLAYER:10,EMITTER:11,POLYGON:12,BITMAPDATA:13,CANVAS_FILTER:14,WEBGL_FILTER:15,ELLIPSE:16,SPRITEBATCH:17,RETROFONT:18,POINTER:19,ROPE:20,CIRCLE:21,RECTANGLE:22,LINE:23,MATRIX:24,POINT:25,ROUNDEDRECTANGLE:26,
CREATURE:27,VIDEO:28,blendModes:{NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16},scaleModes:{DEFAULT:0,LINEAR:0,NEAREST:1},PIXI:PIXI||{}};Math.trunc||(Math.trunc=function(a){return 0>a?Math.ceil(a):Math.floor(a)});Function.prototype.bind||(Function.prototype.bind=function(){var a=Array.prototype.slice;return function(c){function b(){var l=g.concat(a.call(arguments));
e.apply(this instanceof b?this:c,l)}var e=this,g=a.call(arguments,1);if("function"!==typeof e)throw new TypeError;b.prototype=function p(a){a&&(p.prototype=a);if(!(this instanceof p))return new p}(e.prototype);return b}}());Array.isArray||(Array.isArray=function(a){return"[object Array]"==Object.prototype.toString.call(a)});Array.prototype.forEach||(Array.prototype.forEach=function(a){if(void 0===this||null===this)throw new TypeError;var c=Object(this),b=c.length>>>0;if("function"!==typeof a)throw new TypeError;
for(var e=2<=arguments.length?arguments[1]:void 0,g=0;g<b;g++)g in c&&a.call(e,c[g],g,c)});if("function"!==typeof window.Uint32Array&&"object"!==typeof window.Uint32Array){var h=function(a){window[a]=function(a){if("number"===typeof a){Array.call(this,a);this.length=a;for(var b=0;b<this.length;b++)this[b]=0}else for(Array.call(this,a.length),this.length=a.length,b=0;b<this.length;b++)this[b]=a[b]};window[a].prototype=[];window[a].constructor=window[a]};h("Uint32Array");h("Int16Array")}window.console||
(window.console={},window.console.log=window.console.assert=function(){},window.console.warn=window.console.assert=function(){});b.Utils={getProperty:function(a,c){for(var b=c.split("."),e=b.pop(),g=b.length,l=1,p=b[0];l<g&&(a=a[p]);)p=b[l],l++;return a?a[e]:null},setProperty:function(a,c,b){c=c.split(".");for(var e=c.pop(),g=c.length,l=1,p=c[0];l<g&&(a=a[p]);)p=c[l],l++;a&&(a[e]=b);return a},chanceRoll:function(a){void 0===a&&(a=50);return 0<a&&100*Math.random()<=a},randomChoice:function(a,c){return.5>
Math.random()?a:c},parseDimension:function(a,c){var b=0,b=0;"string"===typeof a?"%"===a.substr(-1)?(b=parseInt(a,10)/100,b=0===c?window.innerWidth*b:window.innerHeight*b):b=parseInt(a,10):b=a;return b},pad:function(a,c,b,e){void 0===c&&(c=0);void 0===b&&(b=" ");void 0===e&&(e=3);var g=0;if(c+1>=a.length)switch(e){case 1:a=Array(c+1-a.length).join(b)+a;break;case 3:c=Math.ceil((g=c-a.length)/2);a=Array(g-c+1).join(b)+a+Array(c+1).join(b);break;default:a+=Array(c+1-a.length).join(b)}return a},isPlainObject:function(a){if("object"!==
typeof a||a.nodeType||a===a.window)return!1;try{if(a.constructor&&!{}.hasOwnProperty.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(c){return!1}return!0},extend:function(){var a,c,d,e,g,l=arguments[0]||{},p=1,f=arguments.length,h=!1;"boolean"===typeof l&&(h=l,l=arguments[1]||{},p=2);f===p&&(l=this,--p);for(;p<f;p++)if(null!=(a=arguments[p]))for(c in a)d=l[c],e=a[c],l!==e&&(h&&e&&(b.Utils.isPlainObject(e)||(g=Array.isArray(e)))?(g?(g=!1,d=d&&Array.isArray(d)?d:[]):d=d&&b.Utils.isPlainObject(d)?
d:{},l[c]=b.Utils.extend(h,d,e)):void 0!==e&&(l[c]=e));return l},mixinPrototype:function(a,c,b){void 0===b&&(b=!1);for(var e=Object.keys(c),g=0;g<e.length;g++){var l=e[g],p=c[l];!b&&l in a||(!p||"function"!==typeof p.get&&"function"!==typeof p.set?a[l]=p:"function"===typeof p.clone?a[l]=p.clone():Object.defineProperty(a,l,p))}},mixin:function(a,c){if(!a||"object"!==typeof a)return c;for(var d in a){var e=a[d];if(!e.childNodes&&!e.cloneNode){var g=typeof a[d];c[d]=a[d]&&"object"===g?typeof c[d]===
g?b.Utils.mixin(a[d],c[d]):b.Utils.mixin(a[d],new e.constructor):a[d]}}return c}};b.Circle=function(a,c,d){d=d||0;this.x=a||0;this.y=c||0;this._diameter=d;this._radius=0;0<d&&(this._radius=.5*d);this.type=b.CIRCLE};b.Circle.prototype={circumference:function(){return 2*Math.PI*this._radius},random:function(a){void 0===a&&(a=new b.Point);var c=2*Math.PI*Math.random(),d=Math.random()+Math.random(),d=1<d?2-d:d,e=d*Math.sin(c);a.x=this.x+d*Math.cos(c)*this.radius;a.y=this.y+e*this.radius;return a},getBounds:function(){return new b.Rectangle(this.x-
this.radius,this.y-this.radius,this.diameter,this.diameter)},setTo:function(a,c,b){this.x=a;this.y=c;this._diameter=b;this._radius=.5*b;return this},copyFrom:function(a){return this.setTo(a.x,a.y,a.diameter)},copyTo:function(a){a.x=this.x;a.y=this.y;a.diameter=this._diameter;return a},distance:function(a,c){var d=b.Math.distance(this.x,this.y,a.x,a.y);return c?Math.round(d):d},clone:function(a){void 0===a||null===a?a=new b.Circle(this.x,this.y,this.diameter):a.setTo(this.x,this.y,this.diameter);return a},
contains:function(a,c){return b.Circle.contains(this,a,c)},circumferencePoint:function(a,c,d){return b.Circle.circumferencePoint(this,a,c,d)},offset:function(a,c){this.x+=a;this.y+=c;return this},offsetPoint:function(a){return this.offset(a.x,a.y)},toString:function(){return"[{Phaser.Circle (x="+this.x+" y="+this.y+" diameter="+this.diameter+" radius="+this.radius+")}]"}};b.Circle.prototype.constructor=b.Circle;Object.defineProperty(b.Circle.prototype,"diameter",{get:function(){return this._diameter},
set:function(a){0<a&&(this._diameter=a,this._radius=.5*a)}});Object.defineProperty(b.Circle.prototype,"radius",{get:function(){return this._radius},set:function(a){0<a&&(this._radius=a,this._diameter=2*a)}});Object.defineProperty(b.Circle.prototype,"left",{get:function(){return this.x-this._radius},set:function(a){a>this.x?this._diameter=this._radius=0:this.radius=this.x-a}});Object.defineProperty(b.Circle.prototype,"right",{get:function(){return this.x+this._radius},set:function(a){a<this.x?this._diameter=
this._radius=0:this.radius=a-this.x}});Object.defineProperty(b.Circle.prototype,"top",{get:function(){return this.y-this._radius},set:function(a){a>this.y?this._diameter=this._radius=0:this.radius=this.y-a}});Object.defineProperty(b.Circle.prototype,"bottom",{get:function(){return this.y+this._radius},set:function(a){a<this.y?this._diameter=this._radius=0:this.radius=a-this.y}});Object.defineProperty(b.Circle.prototype,"area",{get:function(){return 0<this._radius?Math.PI*this._radius*this._radius:
0}});Object.defineProperty(b.Circle.prototype,"empty",{get:function(){return 0===this._diameter},set:function(a){!0===a&&this.setTo(0,0,0)}});b.Circle.contains=function(a,c,b){return 0<a.radius&&c>=a.left&&c<=a.right&&b>=a.top&&b<=a.bottom?(a.x-c)*(a.x-c)+(a.y-b)*(a.y-b)<=a.radius*a.radius:!1};b.Circle.equals=function(a,c){return a.x==c.x&&a.y==c.y&&a.diameter==c.diameter};b.Circle.intersects=function(a,c){return b.Math.distance(a.x,a.y,c.x,c.y)<=a.radius+c.radius};b.Circle.circumferencePoint=function(a,
c,d,e){void 0===d&&(d=!1);void 0===e&&(e=new b.Point);!0===d&&(c=b.Math.degToRad(c));e.x=a.x+a.radius*Math.cos(c);e.y=a.y+a.radius*Math.sin(c);return e};b.Circle.intersectsRectangle=function(a,c){var b=Math.abs(a.x-c.x-c.halfWidth);if(b>c.halfWidth+a.radius)return!1;var e=Math.abs(a.y-c.y-c.halfHeight);if(e>c.halfHeight+a.radius)return!1;if(b<=c.halfWidth||e<=c.halfHeight)return!0;b-=c.halfWidth;e-=c.halfHeight;return b*b+e*e<=a.radius*a.radius};PIXI.Circle=b.Circle;b.Ellipse=function(a,c,d,e){this.x=
a||0;this.y=c||0;this.width=d||0;this.height=e||0;this.type=b.ELLIPSE};b.Ellipse.prototype={setTo:function(a,c,b,e){this.x=a;this.y=c;this.width=b;this.height=e;return this},getBounds:function(){return new b.Rectangle(this.x-this.width,this.y-this.height,this.width,this.height)},copyFrom:function(a){return this.setTo(a.x,a.y,a.width,a.height)},copyTo:function(a){a.x=this.x;a.y=this.y;a.width=this.width;a.height=this.height;return a},clone:function(a){void 0===a||null===a?a=new b.Ellipse(this.x,this.y,
this.width,this.height):a.setTo(this.x,this.y,this.width,this.height);return a},contains:function(a,c){return b.Ellipse.contains(this,a,c)},random:function(a){void 0===a&&(a=new b.Point);var c=Math.random()*Math.PI*2,d=Math.random();a.x=Math.sqrt(d)*Math.cos(c);a.y=Math.sqrt(d)*Math.sin(c);a.x=this.x+a.x*this.width/2;a.y=this.y+a.y*this.height/2;return a},toString:function(){return"[{Phaser.Ellipse (x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+")}]"}};b.Ellipse.prototype.constructor=
b.Ellipse;Object.defineProperty(b.Ellipse.prototype,"left",{get:function(){return this.x},set:function(a){this.x=a}});Object.defineProperty(b.Ellipse.prototype,"right",{get:function(){return this.x+this.width},set:function(a){this.width=a<this.x?0:a-this.x}});Object.defineProperty(b.Ellipse.prototype,"top",{get:function(){return this.y},set:function(a){this.y=a}});Object.defineProperty(b.Ellipse.prototype,"bottom",{get:function(){return this.y+this.height},set:function(a){this.height=a<this.y?0:a-
this.y}});Object.defineProperty(b.Ellipse.prototype,"empty",{get:function(){return 0===this.width||0===this.height},set:function(a){!0===a&&this.setTo(0,0,0,0)}});b.Ellipse.contains=function(a,c,b){if(0>=a.width||0>=a.height)return!1;c=(c-a.x)/a.width-.5;a=(b-a.y)/a.height-.5;return.25>c*c+a*a};PIXI.Ellipse=b.Ellipse;b.Line=function(a,c,d,e){d=d||0;e=e||0;this.start=new b.Point(a||0,c||0);this.end=new b.Point(d,e);this.type=b.LINE};b.Line.prototype={setTo:function(a,c,b,e){this.start.setTo(a,c);this.end.setTo(b,
e);return this},fromSprite:function(a,c,b){void 0===b&&(b=!1);return b?this.setTo(a.center.x,a.center.y,c.center.x,c.center.y):this.setTo(a.x,a.y,c.x,c.y)},fromAngle:function(a,c,b,e){this.start.setTo(a,c);this.end.setTo(a+Math.cos(b)*e,c+Math.sin(b)*e);return this},rotate:function(a,c){var b=this.start.x,e=this.start.y;this.start.rotate(this.end.x,this.end.y,a,c,this.length);this.end.rotate(b,e,a,c,this.length);return this},intersects:function(a,c,d){return b.Line.intersectsPoints(this.start,this.end,
a.start,a.end,c,d)},reflect:function(a){return b.Line.reflect(this,a)},pointOnLine:function(a,c){return(a-this.start.x)*(this.end.y-this.start.y)===(this.end.x-this.start.x)*(c-this.start.y)},pointOnSegment:function(a,c){var b=Math.min(this.start.x,this.end.x),e=Math.max(this.start.x,this.end.x),g=Math.min(this.start.y,this.end.y),l=Math.max(this.start.y,this.end.y);return this.pointOnLine(a,c)&&a>=b&&a<=e&&c>=g&&c<=l},random:function(a){void 0===a&&(a=new b.Point);var c=Math.random();a.x=this.start.x+
c*(this.end.x-this.start.x);a.y=this.start.y+c*(this.end.y-this.start.y);return a},coordinatesOnLine:function(a,c){void 0===a&&(a=1);void 0===c&&(c=[]);var b=Math.round(this.start.x),e=Math.round(this.start.y),g=Math.round(this.end.x),l=Math.round(this.end.y),p=Math.abs(g-b),f=Math.abs(l-e),h=b<g?1:-1,k=e<l?1:-1,m=p-f;c.push([b,e]);for(var n=1;b!=g||e!=l;){var r=m<<1;r>-f&&(m-=f,b+=h);r<p&&(m+=p,e+=k);0===n%a&&c.push([b,e]);n++}return c},clone:function(a){void 0===a||null===a?a=new b.Line(this.start.x,
this.start.y,this.end.x,this.end.y):a.setTo(this.start.x,this.start.y,this.end.x,this.end.y);return a}};Object.defineProperty(b.Line.prototype,"length",{get:function(){return Math.sqrt((this.end.x-this.start.x)*(this.end.x-this.start.x)+(this.end.y-this.start.y)*(this.end.y-this.start.y))}});Object.defineProperty(b.Line.prototype,"angle",{get:function(){return Math.atan2(this.end.y-this.start.y,this.end.x-this.start.x)}});Object.defineProperty(b.Line.prototype,"slope",{get:function(){return(this.end.y-
this.start.y)/(this.end.x-this.start.x)}});Object.defineProperty(b.Line.prototype,"perpSlope",{get:function(){return-((this.end.x-this.start.x)/(this.end.y-this.start.y))}});Object.defineProperty(b.Line.prototype,"x",{get:function(){return Math.min(this.start.x,this.end.x)}});Object.defineProperty(b.Line.prototype,"y",{get:function(){return Math.min(this.start.y,this.end.y)}});Object.defineProperty(b.Line.prototype,"left",{get:function(){return Math.min(this.start.x,this.end.x)}});Object.defineProperty(b.Line.prototype,
"right",{get:function(){return Math.max(this.start.x,this.end.x)}});Object.defineProperty(b.Line.prototype,"top",{get:function(){return Math.min(this.start.y,this.end.y)}});Object.defineProperty(b.Line.prototype,"bottom",{get:function(){return Math.max(this.start.y,this.end.y)}});Object.defineProperty(b.Line.prototype,"width",{get:function(){return Math.abs(this.start.x-this.end.x)}});Object.defineProperty(b.Line.prototype,"height",{get:function(){return Math.abs(this.start.y-this.end.y)}});Object.defineProperty(b.Line.prototype,
"normalX",{get:function(){return Math.cos(this.angle-1.5707963267948966)}});Object.defineProperty(b.Line.prototype,"normalY",{get:function(){return Math.sin(this.angle-1.5707963267948966)}});Object.defineProperty(b.Line.prototype,"normalAngle",{get:function(){return b.Math.wrap(this.angle-1.5707963267948966,-Math.PI,Math.PI)}});b.Line.intersectsPoints=function(a,c,d,e,g,l){void 0===g&&(g=!0);void 0===l&&(l=new b.Point);var p=c.y-a.y,f=e.y-d.y,h=a.x-c.x,k=d.x-e.x,m=c.x*a.y-a.x*c.y,n=e.x*d.y-d.x*e.y,
r=p*k-f*h;if(0===r)return null;l.x=(h*n-k*m)/r;l.y=(f*m-p*n)/r;return!g||(g=(e.y-d.y)*(c.x-a.x)-(e.x-d.x)*(c.y-a.y),e=((e.x-d.x)*(a.y-d.y)-(e.y-d.y)*(a.x-d.x))/g,a=((c.x-a.x)*(a.y-d.y)-(c.y-a.y)*(a.x-d.x))/g,0<=e&&1>=e&&0<=a&&1>=a)?l:null};b.Line.intersects=function(a,c,d,e){return b.Line.intersectsPoints(a.start,a.end,c.start,c.end,d,e)};b.Line.reflect=function(a,c){return 2*c.normalAngle-3.141592653589793-a.angle};b.Matrix=function(a,c,d,e,g,l){this.a=a||1;this.b=c||0;this.c=d||0;this.d=e||1;this.tx=
g||0;this.ty=l||0;this.type=b.MATRIX};b.Matrix.prototype={fromArray:function(a){return this.setTo(a[0],a[1],a[3],a[4],a[2],a[5])},setTo:function(a,c,b,e,g,l){this.a=a;this.b=c;this.c=b;this.d=e;this.tx=g;this.ty=l;return this},clone:function(a){void 0===a||null===a?a=new b.Matrix(this.a,this.b,this.c,this.d,this.tx,this.ty):(a.a=this.a,a.b=this.b,a.c=this.c,a.d=this.d,a.tx=this.tx,a.ty=this.ty);return a},copyTo:function(a){a.copyFrom(this);return a},copyFrom:function(a){this.a=a.a;this.b=a.b;this.c=
a.c;this.d=a.d;this.tx=a.tx;this.ty=a.ty;return this},toArray:function(a,c){void 0===c&&(c=new PIXI.Float32Array(9));a?(c[0]=this.a,c[1]=this.b,c[2]=0,c[3]=this.c,c[4]=this.d,c[5]=0,c[6]=this.tx,c[7]=this.ty):(c[0]=this.a,c[1]=this.c,c[2]=this.tx,c[3]=this.b,c[4]=this.d,c[5]=this.ty,c[6]=0,c[7]=0);c[8]=1;return c},apply:function(a,c){void 0===c&&(c=new b.Point);c.x=this.a*a.x+this.c*a.y+this.tx;c.y=this.b*a.x+this.d*a.y+this.ty;return c},applyInverse:function(a,c){void 0===c&&(c=new b.Point);var d=
1/(this.a*this.d+this.c*-this.b),e=a.x,g=a.y;c.x=this.d*d*e+-this.c*d*g+(this.ty*this.c-this.tx*this.d)*d;c.y=this.a*d*g+-this.b*d*e+(-this.ty*this.a+this.tx*this.b)*d;return c},translate:function(a,c){this.tx+=a;this.ty+=c;return this},scale:function(a,c){this.a*=a;this.d*=c;this.c*=a;this.b*=c;this.tx*=a;this.ty*=c;return this},rotate:function(a){var c=Math.cos(a);a=Math.sin(a);var b=this.a,e=this.c,g=this.tx;this.a=b*c-this.b*a;this.b=b*a+this.b*c;this.c=e*c-this.d*a;this.d=e*a+this.d*c;this.tx=
g*c-this.ty*a;this.ty=g*a+this.ty*c;return this},append:function(a){var c=this.a,b=this.b,e=this.c,g=this.d;this.a=a.a*c+a.b*e;this.b=a.a*b+a.b*g;this.c=a.c*c+a.d*e;this.d=a.c*b+a.d*g;this.tx=a.tx*c+a.ty*e+this.tx;this.ty=a.tx*b+a.ty*g+this.ty;return this},identity:function(){return this.setTo(1,0,0,1,0,0)}};b.identityMatrix=new b.Matrix;PIXI.Matrix=b.Matrix;PIXI.identityMatrix=b.identityMatrix;b.Point=function(a,c){this.x=a||0;this.y=c||0;this.type=b.POINT};b.Point.prototype={copyFrom:function(a){return this.setTo(a.x,
a.y)},invert:function(){return this.setTo(this.y,this.x)},setTo:function(a,c){this.x=a||0;this.y=c||(0!==c?this.x:0);return this},set:function(a,c){this.x=a||0;this.y=c||(0!==c?this.x:0);return this},add:function(a,c){this.x+=a;this.y+=c;return this},subtract:function(a,c){this.x-=a;this.y-=c;return this},multiply:function(a,c){this.x*=a;this.y*=c;return this},divide:function(a,c){this.x/=a;this.y/=c;return this},clampX:function(a,c){this.x=b.Math.clamp(this.x,a,c);return this},clampY:function(a,
c){this.y=b.Math.clamp(this.y,a,c);return this},clamp:function(a,c){this.x=b.Math.clamp(this.x,a,c);this.y=b.Math.clamp(this.y,a,c);return this},clone:function(a){void 0===a||null===a?a=new b.Point(this.x,this.y):a.setTo(this.x,this.y);return a},copyTo:function(a){a.x=this.x;a.y=this.y;return a},distance:function(a,c){return b.Point.distance(this,a,c)},equals:function(a){return a.x===this.x&&a.y===this.y},angle:function(a,c){void 0===c&&(c=!1);return c?b.Math.radToDeg(Math.atan2(a.y-this.y,a.x-this.x)):
Math.atan2(a.y-this.y,a.x-this.x)},rotate:function(a,c,d,e,g){return b.Point.rotate(this,a,c,d,e,g)},getMagnitude:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},getMagnitudeSq:function(){return this.x*this.x+this.y*this.y},setMagnitude:function(a){return this.normalize().multiply(a,a)},normalize:function(){if(!this.isZero()){var a=this.getMagnitude();this.x/=a;this.y/=a}return this},isZero:function(){return 0===this.x&&0===this.y},dot:function(a){return this.x*a.x+this.y*a.y},cross:function(a){return this.x*
a.y-this.y*a.x},perp:function(){return this.setTo(-this.y,this.x)},rperp:function(){return this.setTo(this.y,-this.x)},normalRightHand:function(){return this.setTo(-1*this.y,this.x)},floor:function(){return this.setTo(Math.floor(this.x),Math.floor(this.y))},ceil:function(){return this.setTo(Math.ceil(this.x),Math.ceil(this.y))},toString:function(){return"[{Point (x="+this.x+" y="+this.y+")}]"}};b.Point.prototype.constructor=b.Point;b.Point.add=function(a,c,d){void 0===d&&(d=new b.Point);d.x=a.x+c.x;
d.y=a.y+c.y;return d};b.Point.subtract=function(a,c,d){void 0===d&&(d=new b.Point);d.x=a.x-c.x;d.y=a.y-c.y;return d};b.Point.multiply=function(a,c,d){void 0===d&&(d=new b.Point);d.x=a.x*c.x;d.y=a.y*c.y;return d};b.Point.divide=function(a,c,d){void 0===d&&(d=new b.Point);d.x=a.x/c.x;d.y=a.y/c.y;return d};b.Point.equals=function(a,c){return a.x===c.x&&a.y===c.y};b.Point.angle=function(a,c){return Math.atan2(a.y-c.y,a.x-c.x)};b.Point.negative=function(a,c){void 0===c&&(c=new b.Point);return c.setTo(-a.x,
-a.y)};b.Point.multiplyAdd=function(a,c,d,e){void 0===e&&(e=new b.Point);return e.setTo(a.x+c.x*d,a.y+c.y*d)};b.Point.interpolate=function(a,c,d,e){void 0===e&&(e=new b.Point);return e.setTo(a.x+(c.x-a.x)*d,a.y+(c.y-a.y)*d)};b.Point.perp=function(a,c){void 0===c&&(c=new b.Point);return c.setTo(-a.y,a.x)};b.Point.rperp=function(a,c){void 0===c&&(c=new b.Point);return c.setTo(a.y,-a.x)};b.Point.distance=function(a,c,d){a=b.Math.distance(a.x,a.y,c.x,c.y);return d?Math.round(a):a};b.Point.project=function(a,
c,d){void 0===d&&(d=new b.Point);a=a.dot(c)/c.getMagnitudeSq();0!==a&&d.setTo(a*c.x,a*c.y);return d};b.Point.projectUnit=function(a,c,d){void 0===d&&(d=new b.Point);a=a.dot(c);0!==a&&d.setTo(a*c.x,a*c.y);return d};b.Point.normalRightHand=function(a,c){void 0===c&&(c=new b.Point);return c.setTo(-1*a.y,a.x)};b.Point.normalize=function(a,c){void 0===c&&(c=new b.Point);var d=a.getMagnitude();0!==d&&c.setTo(a.x/d,a.y/d);return c};b.Point.rotate=function(a,c,d,e,g,l){void 0===g&&(g=!1);void 0===l&&(l=null);
g&&(e=b.Math.degToRad(e));null===l&&(l=Math.sqrt((c-a.x)*(c-a.x)+(d-a.y)*(d-a.y)));e+=Math.atan2(a.y-d,a.x-c);a.x=c+l*Math.cos(e);a.y=d+l*Math.sin(e);return a};b.Point.centroid=function(a,c){void 0===c&&(c=new b.Point);if("[object Array]"!==Object.prototype.toString.call(a))throw Error("Phaser.Point. Parameter 'points' must be an array");var d=a.length;if(1>d)throw Error("Phaser.Point. Parameter 'points' array must not be empty");if(1===d)return c.copyFrom(a[0]),c;for(var e=0;e<d;e++)b.Point.add(c,
a[e],c);c.divide(d,d);return c};b.Point.parse=function(a,c,d){c=c||"x";d=d||"y";var e=new b.Point;a[c]&&(e.x=parseInt(a[c],10));a[d]&&(e.y=parseInt(a[d],10));return e};PIXI.Point=b.Point;b.Polygon=function(){this.area=0;this._points=[];0<arguments.length&&this.setTo.apply(this,arguments);this.closed=!0;this.type=b.POLYGON};b.Polygon.prototype={toNumberArray:function(a){void 0===a&&(a=[]);for(var c=0;c<this._points.length;c++)"number"===typeof this._points[c]?(a.push(this._points[c]),a.push(this._points[c+
1]),c++):(a.push(this._points[c].x),a.push(this._points[c].y));return a},flatten:function(){this._points=this.toNumberArray();return this},clone:function(a){var c=this._points.slice();void 0===a||null===a?a=new b.Polygon(c):a.setTo(c);return a},contains:function(a,c){for(var b=this._points.length,e=!1,g=-1,l=b-1;++g<b;l=g){var p=this._points[g].x,f=this._points[g].y,h=this._points[l].x,l=this._points[l].y;(f<=c&&c<l||l<=c&&c<f)&&a<(h-p)*(c-f)/(l-f)+p&&(e=!e)}return e},setTo:function(a){this.area=
0;this._points=[];if(0<arguments.length){Array.isArray(a)||(a=Array.prototype.slice.call(arguments));for(var c=Number.MAX_VALUE,b=0,e=a.length;b<e;b++){if("number"===typeof a[b]){var g=new PIXI.Point(a[b],a[b+1]);b++}else g=new PIXI.Point(a[b].x,a[b].y);this._points.push(g);g.y<c&&(c=g.y)}this.calculateArea(c)}return this},calculateArea:function(a){for(var c,b,e,g=0,l=this._points.length;g<l;g++)c=this._points[g],b=g===l-1?this._points[0]:this._points[g+1],e=(c.y-a+(b.y-a))/2,c=c.x-b.x,this.area+=
e*c;return this.area}};b.Polygon.prototype.constructor=b.Polygon;Object.defineProperty(b.Polygon.prototype,"points",{get:function(){return this._points},set:function(a){null!=a?this.setTo(a):this.setTo()}});PIXI.Polygon=b.Polygon;b.Rectangle=function(a,c,d,e){this.x=a||0;this.y=c||0;this.width=d||0;this.height=e||0;this.type=b.RECTANGLE};b.Rectangle.prototype={offset:function(a,c){this.x+=a;this.y+=c;return this},offsetPoint:function(a){return this.offset(a.x,a.y)},setTo:function(a,c,b,e){this.x=
a;this.y=c;this.width=b;this.height=e;return this},scale:function(a,c){void 0===c&&(c=a);this.width*=a;this.height*=c;return this},centerOn:function(a,c){this.centerX=a;this.centerY=c;return this},floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y)},floorAll:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.width=Math.floor(this.width);this.height=Math.floor(this.height)},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y)},ceilAll:function(){this.x=
Math.ceil(this.x);this.y=Math.ceil(this.y);this.width=Math.ceil(this.width);this.height=Math.ceil(this.height)},copyFrom:function(a){return this.setTo(a.x,a.y,a.width,a.height)},copyTo:function(a){a.x=this.x;a.y=this.y;a.width=this.width;a.height=this.height;return a},inflate:function(a,c){return b.Rectangle.inflate(this,a,c)},size:function(a){return b.Rectangle.size(this,a)},resize:function(a,c){this.width=a;this.height=c;return this},clone:function(a){return b.Rectangle.clone(this,a)},contains:function(a,
c){return b.Rectangle.contains(this,a,c)},containsRect:function(a){return b.Rectangle.containsRect(a,this)},equals:function(a){return b.Rectangle.equals(this,a)},intersection:function(a,c){return b.Rectangle.intersection(this,a,c)},intersects:function(a){return b.Rectangle.intersects(this,a)},intersectsRaw:function(a,c,d,e,g){return b.Rectangle.intersectsRaw(this,a,c,d,e,g)},union:function(a,c){return b.Rectangle.union(this,a,c)},random:function(a){void 0===a&&(a=new b.Point);a.x=this.randomX;a.y=
this.randomY;return a},toString:function(){return"[{Rectangle (x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+" empty="+this.empty+")}]"}};Object.defineProperty(b.Rectangle.prototype,"halfWidth",{get:function(){return Math.round(this.width/2)}});Object.defineProperty(b.Rectangle.prototype,"halfHeight",{get:function(){return Math.round(this.height/2)}});Object.defineProperty(b.Rectangle.prototype,"bottom",{get:function(){return this.y+this.height},set:function(a){this.height=a<=
this.y?0:a-this.y}});Object.defineProperty(b.Rectangle.prototype,"bottomLeft",{get:function(){return new b.Point(this.x,this.bottom)},set:function(a){this.x=a.x;this.bottom=a.y}});Object.defineProperty(b.Rectangle.prototype,"bottomRight",{get:function(){return new b.Point(this.right,this.bottom)},set:function(a){this.right=a.x;this.bottom=a.y}});Object.defineProperty(b.Rectangle.prototype,"left",{get:function(){return this.x},set:function(a){this.width=a>=this.right?0:this.right-a;this.x=a}});Object.defineProperty(b.Rectangle.prototype,
"right",{get:function(){return this.x+this.width},set:function(a){this.width=a<=this.x?0:a-this.x}});Object.defineProperty(b.Rectangle.prototype,"volume",{get:function(){return this.width*this.height}});Object.defineProperty(b.Rectangle.prototype,"perimeter",{get:function(){return 2*this.width+2*this.height}});Object.defineProperty(b.Rectangle.prototype,"centerX",{get:function(){return this.x+this.halfWidth},set:function(a){this.x=a-this.halfWidth}});Object.defineProperty(b.Rectangle.prototype,"centerY",
{get:function(){return this.y+this.halfHeight},set:function(a){this.y=a-this.halfHeight}});Object.defineProperty(b.Rectangle.prototype,"randomX",{get:function(){return this.x+Math.random()*this.width}});Object.defineProperty(b.Rectangle.prototype,"randomY",{get:function(){return this.y+Math.random()*this.height}});Object.defineProperty(b.Rectangle.prototype,"top",{get:function(){return this.y},set:function(a){a>=this.bottom?(this.height=0,this.y=a):this.height=this.bottom-a}});Object.defineProperty(b.Rectangle.prototype,
"topLeft",{get:function(){return new b.Point(this.x,this.y)},set:function(a){this.x=a.x;this.y=a.y}});Object.defineProperty(b.Rectangle.prototype,"topRight",{get:function(){return new b.Point(this.x+this.width,this.y)},set:function(a){this.right=a.x;this.y=a.y}});Object.defineProperty(b.Rectangle.prototype,"empty",{get:function(){return!this.width||!this.height},set:function(a){!0===a&&this.setTo(0,0,0,0)}});b.Rectangle.prototype.constructor=b.Rectangle;b.Rectangle.inflate=function(a,c,b){a.x-=c;
a.width+=2*c;a.y-=b;a.height+=2*b;return a};b.Rectangle.inflatePoint=function(a,c){return b.Rectangle.inflate(a,c.x,c.y)};b.Rectangle.size=function(a,c){void 0===c||null===c?c=new b.Point(a.width,a.height):c.setTo(a.width,a.height);return c};b.Rectangle.clone=function(a,c){void 0===c||null===c?c=new b.Rectangle(a.x,a.y,a.width,a.height):c.setTo(a.x,a.y,a.width,a.height);return c};b.Rectangle.contains=function(a,c,b){return 0>=a.width||0>=a.height?!1:c>=a.x&&c<a.right&&b>=a.y&&b<a.bottom};b.Rectangle.containsRaw=
function(a,c,b,e,g,l){return g>=a&&g<a+b&&l>=c&&l<c+e};b.Rectangle.containsPoint=function(a,c){return b.Rectangle.contains(a,c.x,c.y)};b.Rectangle.containsRect=function(a,c){return a.volume>c.volume?!1:a.x>=c.x&&a.y>=c.y&&a.right<c.right&&a.bottom<c.bottom};b.Rectangle.equals=function(a,c){return a.x==c.x&&a.y==c.y&&a.width==c.width&&a.height==c.height};b.Rectangle.sameDimensions=function(a,c){return a.width===c.width&&a.height===c.height};b.Rectangle.intersection=function(a,c,d){void 0===d&&(d=new b.Rectangle);
b.Rectangle.intersects(a,c)&&(d.x=Math.max(a.x,c.x),d.y=Math.max(a.y,c.y),d.width=Math.min(a.right,c.right)-d.x,d.height=Math.min(a.bottom,c.bottom)-d.y);return d};b.Rectangle.intersects=function(a,c){return 0>=a.width||0>=a.height||0>=c.width||0>=c.height?!1:!(a.right<c.x||a.bottom<c.y||a.x>c.right||a.y>c.bottom)};b.Rectangle.intersectsRaw=function(a,c,b,e,g,l){void 0===l&&(l=0);return!(c>a.right+l||b<a.left-l||e>a.bottom+l||g<a.top-l)};b.Rectangle.union=function(a,c,d){void 0===d&&(d=new b.Rectangle);
return d.setTo(Math.min(a.x,c.x),Math.min(a.y,c.y),Math.max(a.right,c.right)-Math.min(a.left,c.left),Math.max(a.bottom,c.bottom)-Math.min(a.top,c.top))};b.Rectangle.aabb=function(a,c){void 0===c&&(c=new b.Rectangle);var d=Number.MIN_VALUE,e=Number.MAX_VALUE,g=Number.MIN_VALUE,l=Number.MAX_VALUE;a.forEach(function(a){a.x>d&&(d=a.x);a.x<e&&(e=a.x);a.y>g&&(g=a.y);a.y<l&&(l=a.y)});c.setTo(e,l,d-e,g-l);return c};PIXI.Rectangle=b.Rectangle;PIXI.EmptyRectangle=new b.Rectangle(0,0,0,0);b.RoundedRectangle=
function(a,c,d,e,g){void 0===a&&(a=0);void 0===c&&(c=0);void 0===d&&(d=0);void 0===e&&(e=0);void 0===g&&(g=20);this.x=a;this.y=c;this.width=d;this.height=e;this.radius=g||20;this.type=b.ROUNDEDRECTANGLE};b.RoundedRectangle.prototype={clone:function(){return new b.RoundedRectangle(this.x,this.y,this.width,this.height,this.radius)},contains:function(a,c){if(0>=this.width||0>=this.height)return!1;var b=this.x;return a>=b&&a<=b+this.width&&(b=this.y,c>=b&&c<=b+this.height)?!0:!1}};b.RoundedRectangle.prototype.constructor=
b.RoundedRectangle;PIXI.RoundedRectangle=b.RoundedRectangle;b.Camera=function(a,c,d,e,g,l){this.game=a;this.world=a.world;this.id=0;this.view=new b.Rectangle(d,e,g,l);this.bounds=new b.Rectangle(d,e,g,l);this.deadzone=null;this.roundPx=this.visible=!0;this.atLimit={x:!1,y:!1};this.scale=this.displayObject=this.target=null;this.totalInView=0;this._targetPosition=new b.Point;this._edge=0;this._position=new b.Point};b.Camera.FOLLOW_LOCKON=0;b.Camera.FOLLOW_PLATFORMER=1;b.Camera.FOLLOW_TOPDOWN=2;b.Camera.FOLLOW_TOPDOWN_TIGHT=
3;b.Camera.prototype={preUpdate:function(){this.totalInView=0},follow:function(a,c){void 0===c&&(c=b.Camera.FOLLOW_LOCKON);this.target=a;var d;switch(c){case b.Camera.FOLLOW_PLATFORMER:d=this.width/8;var e=this.height/3;this.deadzone=new b.Rectangle((this.width-d)/2,(this.height-e)/2-.25*e,d,e);break;case b.Camera.FOLLOW_TOPDOWN:d=Math.max(this.width,this.height)/4;this.deadzone=new b.Rectangle((this.width-d)/2,(this.height-d)/2,d,d);break;case b.Camera.FOLLOW_TOPDOWN_TIGHT:d=Math.max(this.width,
this.height)/8;this.deadzone=new b.Rectangle((this.width-d)/2,(this.height-d)/2,d,d);break;case b.Camera.FOLLOW_LOCKON:this.deadzone=null;break;default:this.deadzone=null}},unfollow:function(){this.target=null},focusOn:function(a){this.setPosition(Math.round(a.x-this.view.halfWidth),Math.round(a.y-this.view.halfHeight))},focusOnXY:function(a,c){this.setPosition(Math.round(a-this.view.halfWidth),Math.round(c-this.view.halfHeight))},update:function(){this.target&&this.updateTarget();this.bounds&&this.checkBounds();
this.roundPx&&this.view.floor();this.displayObject.position.x=-this.view.x;this.displayObject.position.y=-this.view.y},updateTarget:function(){this._targetPosition.copyFrom(this.target);this.target.parent&&this._targetPosition.multiply(this.target.parent.worldTransform.a,this.target.parent.worldTransform.d);this.deadzone?(this._edge=this._targetPosition.x-this.view.x,this._edge<this.deadzone.left?this.view.x=this._targetPosition.x-this.deadzone.left:this._edge>this.deadzone.right&&(this.view.x=this._targetPosition.x-
this.deadzone.right),this._edge=this._targetPosition.y-this.view.y,this._edge<this.deadzone.top?this.view.y=this._targetPosition.y-this.deadzone.top:this._edge>this.deadzone.bottom&&(this.view.y=this._targetPosition.y-this.deadzone.bottom)):(this.view.x=this._targetPosition.x-this.view.halfWidth,this.view.y=this._targetPosition.y-this.view.halfHeight)},setBoundsToWorld:function(){this.bounds.copyFrom(this.game.world.bounds)},checkBounds:function(){this.atLimit.x=!1;this.atLimit.y=!1;this.view.x<=
this.bounds.x&&(this.atLimit.x=!0,this.view.x=this.bounds.x);this.view.right>=this.bounds.right&&(this.atLimit.x=!0,this.view.x=this.bounds.right-this.width);this.view.y<=this.bounds.top&&(this.atLimit.y=!0,this.view.y=this.bounds.top);this.view.bottom>=this.bounds.bottom&&(this.atLimit.y=!0,this.view.y=this.bounds.bottom-this.height)},setPosition:function(a,c){this.view.x=a;this.view.y=c;this.bounds&&this.checkBounds()},setSize:function(a,c){this.view.width=a;this.view.height=c},reset:function(){this.target=
null;this.view.x=0;this.view.y=0}};b.Camera.prototype.constructor=b.Camera;Object.defineProperty(b.Camera.prototype,"x",{get:function(){return this.view.x},set:function(a){this.view.x=a;this.bounds&&this.checkBounds()}});Object.defineProperty(b.Camera.prototype,"y",{get:function(){return this.view.y},set:function(a){this.view.y=a;this.bounds&&this.checkBounds()}});Object.defineProperty(b.Camera.prototype,"position",{get:function(){this._position.set(this.view.centerX,this.view.centerY);return this._position},
set:function(a){"undefined"!==typeof a.x&&(this.view.x=a.x);"undefined"!==typeof a.y&&(this.view.y=a.y);this.bounds&&this.checkBounds()}});Object.defineProperty(b.Camera.prototype,"width",{get:function(){return this.view.width},set:function(a){this.view.width=a}});Object.defineProperty(b.Camera.prototype,"height",{get:function(){return this.view.height},set:function(a){this.view.height=a}});b.Create=function(a){this.game=a;this.bmd=a.make.bitmapData();this.canvas=this.bmd.canvas;this.ctx=this.bmd.context;
this.palettes=[{0:"#000",1:"#9D9D9D",2:"#FFF",3:"#BE2633",4:"#E06F8B",5:"#493C2B",6:"#A46422",7:"#EB8931",8:"#F7E26B",9:"#2F484E",A:"#44891A",B:"#A3CE27",C:"#1B2632",D:"#005784",E:"#31A2F2",F:"#B2DCEF"},{0:"#000",1:"#191028",2:"#46af45",3:"#a1d685",4:"#453e78",5:"#7664fe",6:"#833129",7:"#9ec2e8",8:"#dc534b",9:"#e18d79",A:"#d6b97b",B:"#e9d8a1",C:"#216c4b",D:"#d365c8",E:"#afaab9",F:"#f5f4eb"},{0:"#000",1:"#2234d1",2:"#0c7e45",3:"#44aacc",4:"#8a3622",5:"#5c2e78",6:"#aa5c3d",7:"#b5b5b5",8:"#5e606e",9:"#4c81fb",
A:"#6cd947",B:"#7be2f9",C:"#eb8a60",D:"#e23d69",E:"#ffd93f",F:"#fff"},{0:"#000",1:"#fff",2:"#8b4131",3:"#7bbdc5",4:"#8b41ac",5:"#6aac41",6:"#3931a4",7:"#d5de73",8:"#945a20",9:"#5a4100",A:"#bd736a",B:"#525252",C:"#838383",D:"#acee8b",E:"#7b73de",F:"#acacac"},{0:"#000",1:"#191028",2:"#46af45",3:"#a1d685",4:"#453e78",5:"#7664fe",6:"#833129",7:"#9ec2e8",8:"#dc534b",9:"#e18d79",A:"#d6b97b",B:"#e9d8a1",C:"#216c4b",D:"#d365c8",E:"#afaab9",F:"#fff"}]};b.Create.PALETTE_ARNE=0;b.Create.PALETTE_JMP=1;b.Create.PALETTE_CGA=
2;b.Create.PALETTE_C64=3;b.Create.PALETTE_JAPANESE_MACHINE=4;b.Create.prototype={texture:function(a,c,b,e,g){void 0===b&&(b=8);void 0===e&&(e=b);void 0===g&&(g=0);this.bmd.resize(c[0].length*b,c.length*e);this.bmd.clear();for(var l=0;l<c.length;l++)for(var p=c[l],f=0;f<p.length;f++){var h=p[f];"."!==h&&" "!==h&&(this.ctx.fillStyle=this.palettes[g][h],this.ctx.fillRect(f*b,l*e,b,e))}return this.bmd.generateTexture(a)},grid:function(a,c,b,e,g,l){this.bmd.resize(c,b);this.ctx.fillStyle=l;for(l=0;l<b;l+=
g)this.ctx.fillRect(0,l,c,1);for(g=0;g<c;g+=e)this.ctx.fillRect(g,0,1,b);return this.bmd.generateTexture(a)}};b.Create.prototype.constructor=b.Create;b.State=function(){this.game=null;this.key="";this.rnd=this.physics=this.particles=this.world=this.tweens=this.time=this.stage=this.scale=this.sound=this.math=this.load=this.input=this.cache=this.camera=this.make=this.add=null};b.State.prototype={init:function(){},preload:function(){},loadUpdate:function(){},loadRender:function(){},create:function(){},
update:function(){},preRender:function(){},render:function(){},resize:function(){},paused:function(){},resumed:function(){},pauseUpdate:function(){},shutdown:function(){}};b.State.prototype.constructor=b.State;b.StateManager=function(a,c){this.game=a;this.states={};this._pendingState=null;"undefined"!==typeof c&&null!==c&&(this._pendingState=c);this._created=this._clearCache=this._clearWorld=!1;this._args=[];this.current="";this.onStateChange=new b.Signal;this.onShutDownCallback=this.onPauseUpdateCallback=
this.onResumedCallback=this.onPausedCallback=this.onLoadRenderCallback=this.onLoadUpdateCallback=this.onPreRenderCallback=this.onResizeCallback=this.onRenderCallback=this.onUpdateCallback=this.onCreateCallback=this.onPreloadCallback=this.onInitCallback=null};b.StateManager.prototype={boot:function(){this.game.onPause.add(this.pause,this);this.game.onResume.add(this.resume,this);null!==this._pendingState&&"string"!==typeof this._pendingState&&this.add("default",this._pendingState,!0)},add:function(a,
c,d){void 0===d&&(d=!1);var e;c instanceof b.State?e=c:"object"===typeof c?(e=c,e.game=this.game):"function"===typeof c&&(e=new c(this.game));this.states[a]=e;d&&(this.game.isBooted?this.start(a):this._pendingState=a);return e},remove:function(a){this.current===a&&(this.onPauseUpdateCallback=this.onResumedCallback=this.onPausedCallback=this.onResizeCallback=this.onRenderCallback=this.onPreRenderCallback=this.onUpdateCallback=this.onCreateCallback=this.onLoadUpdateCallback=this.onLoadRenderCallback=
this.onPreloadCallback=this.onShutDownCallback=this.onInitCallback=this.callbackContext=null);delete this.states[a]},start:function(a,c,b){void 0===c&&(c=!0);void 0===b&&(b=!1);this.checkState(a)&&(this._pendingState=a,this._clearWorld=c,this._clearCache=b,3<arguments.length&&(this._args=Array.prototype.splice.call(arguments,3)))},restart:function(a,c){void 0===a&&(a=!0);void 0===c&&(c=!1);this._pendingState=this.current;this._clearWorld=a;this._clearCache=c;2<arguments.length&&(this._args=Array.prototype.splice.call(arguments,
2))},dummy:function(){},preUpdate:function(){if(this._pendingState&&this.game.isBooted){var a=this.current;this.clearCurrentState();this.setCurrentState(this._pendingState);this.onStateChange.dispatch(this.current,a);this.current===this._pendingState&&(this._pendingState=null,this.onPreloadCallback?(this.game.load.reset(!0),this.onPreloadCallback.call(this.callbackContext,this.game),0===this.game.load.totalQueuedFiles()&&0===this.game.load.totalQueuedPacks()?this.loadComplete():this.game.load.start()):
this.loadComplete())}},clearCurrentState:function(){this.current&&(this.onShutDownCallback&&this.onShutDownCallback.call(this.callbackContext,this.game),this.game.tweens.removeAll(),this.game.camera.reset(),this.game.input.reset(!0),this.game.physics.clear(),this.game.time.removeAll(),this.game.scale.reset(this._clearWorld),this.game.debug&&this.game.debug.reset(),this._clearWorld&&(this.game.world.shutdown(),!0===this._clearCache&&this.game.cache.destroy()))},checkState:function(a){if(this.states[a]){var c=
!1;if(this.states[a].preload||this.states[a].create||this.states[a].update||this.states[a].render)c=!0;return!1===c?(console.warn("Invalid Phaser State object given. Must contain at least a one of the required functions: preload, create, update or render"),!1):!0}console.warn("Phaser.StateManager - No state found with the key: "+a);return!1},link:function(a){this.states[a].game=this.game;this.states[a].add=this.game.add;this.states[a].make=this.game.make;this.states[a].camera=this.game.camera;this.states[a].cache=
this.game.cache;this.states[a].input=this.game.input;this.states[a].load=this.game.load;this.states[a].math=this.game.math;this.states[a].sound=this.game.sound;this.states[a].scale=this.game.scale;this.states[a].state=this;this.states[a].stage=this.game.stage;this.states[a].time=this.game.time;this.states[a].tweens=this.game.tweens;this.states[a].world=this.game.world;this.states[a].particles=this.game.particles;this.states[a].rnd=this.game.rnd;this.states[a].physics=this.game.physics;this.states[a].key=
a},unlink:function(a){this.states[a]&&(this.states[a].game=null,this.states[a].add=null,this.states[a].make=null,this.states[a].camera=null,this.states[a].cache=null,this.states[a].input=null,this.states[a].load=null,this.states[a].math=null,this.states[a].sound=null,this.states[a].scale=null,this.states[a].state=null,this.states[a].stage=null,this.states[a].time=null,this.states[a].tweens=null,this.states[a].world=null,this.states[a].particles=null,this.states[a].rnd=null,this.states[a].physics=
null)},setCurrentState:function(a){this.callbackContext=this.states[a];this.link(a);this.onInitCallback=this.states[a].init||this.dummy;this.onPreloadCallback=this.states[a].preload||null;this.onLoadRenderCallback=this.states[a].loadRender||null;this.onLoadUpdateCallback=this.states[a].loadUpdate||null;this.onCreateCallback=this.states[a].create||null;this.onUpdateCallback=this.states[a].update||null;this.onPreRenderCallback=this.states[a].preRender||null;this.onRenderCallback=this.states[a].render||
null;this.onResizeCallback=this.states[a].resize||null;this.onPausedCallback=this.states[a].paused||null;this.onResumedCallback=this.states[a].resumed||null;this.onPauseUpdateCallback=this.states[a].pauseUpdate||null;this.onShutDownCallback=this.states[a].shutdown||this.dummy;""!==this.current&&this.game.physics.reset();this.current=a;this._created=!1;this.onInitCallback.apply(this.callbackContext,this._args);a===this._pendingState&&(this._args=[]);this.game._kickstart=!0},getCurrentState:function(){return this.states[this.current]},
loadComplete:function(){!1===this._created&&this.onCreateCallback?(this._created=!0,this.onCreateCallback.call(this.callbackContext,this.game)):this._created=!0},pause:function(){this._created&&this.onPausedCallback&&this.onPausedCallback.call(this.callbackContext,this.game)},resume:function(){this._created&&this.onResumedCallback&&this.onResumedCallback.call(this.callbackContext,this.game)},update:function(){this._created?this.onUpdateCallback&&this.onUpdateCallback.call(this.callbackContext,this.game):
this.onLoadUpdateCallback&&this.onLoadUpdateCallback.call(this.callbackContext,this.game)},pauseUpdate:function(){this._created?this.onPauseUpdateCallback&&this.onPauseUpdateCallback.call(this.callbackContext,this.game):this.onLoadUpdateCallback&&this.onLoadUpdateCallback.call(this.callbackContext,this.game)},preRender:function(a){this._created&&this.onPreRenderCallback&&this.onPreRenderCallback.call(this.callbackContext,this.game,a)},resize:function(a,c){this.onResizeCallback&&this.onResizeCallback.call(this.callbackContext,
a,c)},render:function(){this._created?this.onRenderCallback&&(this.game.renderType===b.CANVAS?(this.game.context.save(),this.game.context.setTransform(1,0,0,1,0,0),this.onRenderCallback.call(this.callbackContext,this.game),this.game.context.restore()):this.onRenderCallback.call(this.callbackContext,this.game)):this.onLoadRenderCallback&&this.onLoadRenderCallback.call(this.callbackContext,this.game)},destroy:function(){this.clearCurrentState();this.game=this.onPauseUpdateCallback=this.onResumedCallback=
this.onPausedCallback=this.onRenderCallback=this.onUpdateCallback=this.onCreateCallback=this.onLoadUpdateCallback=this.onLoadRenderCallback=this.onPreloadCallback=this.onShutDownCallback=this.onInitCallback=this.callbackContext=null;this.states={};this._pendingState=null;this.current=""}};b.StateManager.prototype.constructor=b.StateManager;Object.defineProperty(b.StateManager.prototype,"created",{get:function(){return this._created}});b.Signal=function(){};b.Signal.prototype={_bindings:null,_prevParams:null,
memorize:!1,_shouldPropagate:!0,active:!0,_boundDispatch:!0,validateListener:function(a,c){if("function"!==typeof a)throw Error("Phaser.Signal: listener is a required param of {fn}() and should be a Function.".replace("{fn}",c));},_registerListener:function(a,c,d,e,g){var l=this._indexOfListener(a,d);if(-1!==l){if(a=this._bindings[l],a.isOnce()!==c)throw Error("You cannot add"+(c?"":"Once")+"() then add"+(c?"Once":"")+"() the same listener without removing the relationship first.");}else a=new b.SignalBinding(this,
a,c,d,e,g),this._addBinding(a);this.memorize&&this._prevParams&&a.execute(this._prevParams);return a},_addBinding:function(a){this._bindings||(this._bindings=[]);var c=this._bindings.length;do c--;while(this._bindings[c]&&a._priority<=this._bindings[c]._priority);this._bindings.splice(c+1,0,a)},_indexOfListener:function(a,c){if(!this._bindings)return-1;void 0===c&&(c=null);for(var b=this._bindings.length,e;b--;)if(e=this._bindings[b],e._listener===a&&e.context===c)return b;return-1},has:function(a,
c){return-1!==this._indexOfListener(a,c)},add:function(a,c,b){this.validateListener(a,"add");var e=[];if(3<arguments.length)for(var g=3;g<arguments.length;g++)e.push(arguments[g]);return this._registerListener(a,!1,c,b,e)},addOnce:function(a,c,b){this.validateListener(a,"addOnce");var e=[];if(3<arguments.length)for(var g=3;g<arguments.length;g++)e.push(arguments[g]);return this._registerListener(a,!0,c,b,e)},remove:function(a,c){this.validateListener(a,"remove");var b=this._indexOfListener(a,c);-1!==
b&&(this._bindings[b]._destroy(),this._bindings.splice(b,1));return a},removeAll:function(a){void 0===a&&(a=null);if(this._bindings){for(var c=this._bindings.length;c--;)a?this._bindings[c].context===a&&(this._bindings[c]._destroy(),this._bindings.splice(c,1)):this._bindings[c]._destroy();a||(this._bindings.length=0)}},getNumListeners:function(){return this._bindings?this._bindings.length:0},halt:function(){this._shouldPropagate=!1},dispatch:function(){if(this.active&&this._bindings){var a=Array.prototype.slice.call(arguments),
c=this._bindings.length,b;this.memorize&&(this._prevParams=a);if(c){b=this._bindings.slice();this._shouldPropagate=!0;do c--;while(b[c]&&this._shouldPropagate&&!1!==b[c].execute(a))}}},forget:function(){this._prevParams&&(this._prevParams=null)},dispose:function(){this.removeAll();this._bindings=null;this._prevParams&&(this._prevParams=null)},toString:function(){return"[Phaser.Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}};Object.defineProperty(b.Signal.prototype,"boundDispatch",
{get:function(){var a=this;return this._boundDispatch||(this._boundDispatch=function(){return a.dispatch.apply(a,arguments)})}});b.Signal.prototype.constructor=b.Signal;b.SignalBinding=function(a,c,b,e,g,l){this._listener=c;b&&(this._isOnce=!0);null!=e&&(this.context=e);this._signal=a;g&&(this._priority=g);l&&l.length&&(this._args=l)};b.SignalBinding.prototype={context:null,_isOnce:!1,_priority:0,_args:null,callCount:0,active:!0,params:null,execute:function(a){var c;this.active&&this._listener&&(a=
this.params?this.params.concat(a):a,this._args&&(a=a.concat(this._args)),c=this._listener.apply(this.context,a),this.callCount++,this._isOnce&&this.detach());return c},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&!!this._listener},isOnce:function(){return this._isOnce},getListener:function(){return this._listener},getSignal:function(){return this._signal},_destroy:function(){delete this._signal;delete this._listener;
delete this.context},toString:function(){return"[Phaser.SignalBinding isOnce:"+this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}};b.SignalBinding.prototype.constructor=b.SignalBinding;b.Filter=function(a,c,d){this.game=a;this.type=b.WEBGL_FILTER;this.passes=[this];this.shaders=[];this.dirty=!0;this.padding=0;this.prevPoint=new b.Point;a=new Date;this.uniforms={resolution:{type:"2f",value:{x:256,y:256}},time:{type:"1f",value:0},mouse:{type:"2f",value:{x:0,y:0}},date:{type:"4fv",
value:[a.getFullYear(),a.getMonth(),a.getDate(),3600*a.getHours()+60*a.getMinutes()+a.getSeconds()]},sampleRate:{type:"1f",value:44100},iChannel0:{type:"sampler2D",value:null,textureData:{repeat:!0}},iChannel1:{type:"sampler2D",value:null,textureData:{repeat:!0}},iChannel2:{type:"sampler2D",value:null,textureData:{repeat:!0}},iChannel3:{type:"sampler2D",value:null,textureData:{repeat:!0}}};if(c)for(var e in c)this.uniforms[e]=c[e];this.fragmentSrc=d||""};b.Filter.prototype={init:function(){},setResolution:function(a,
c){this.uniforms.resolution.value.x=a;this.uniforms.resolution.value.y=c},update:function(a){if("undefined"!==typeof a){var c=a.x/this.game.width;a=1-a.y/this.game.height;if(c!==this.prevPoint.x||a!==this.prevPoint.y)this.uniforms.mouse.value.x=c.toFixed(2),this.uniforms.mouse.value.y=a.toFixed(2),this.prevPoint.set(c,a)}this.uniforms.time.value=this.game.time.totalElapsedSeconds()},destroy:function(){this.game=null}};b.Filter.prototype.constructor=b.Filter;Object.defineProperty(b.Filter.prototype,
"width",{get:function(){return this.uniforms.resolution.value.x},set:function(a){this.uniforms.resolution.value.x=a}});Object.defineProperty(b.Filter.prototype,"height",{get:function(){return this.uniforms.resolution.value.y},set:function(a){this.uniforms.resolution.value.y=a}});b.Plugin=function(a,c){void 0===c&&(c=null);this.game=a;this.parent=c;this.hasPostRender=this.hasRender=this.hasPostUpdate=this.hasUpdate=this.hasPreUpdate=this.visible=this.active=!1};b.Plugin.prototype={preUpdate:function(){},
update:function(){},render:function(){},postRender:function(){},destroy:function(){this.parent=this.game=null;this.visible=this.active=!1}};b.Plugin.prototype.constructor=b.Plugin;b.PluginManager=function(a){this.game=a;this.plugins=[];this._i=this._len=0};b.PluginManager.prototype={add:function(a){var c=Array.prototype.splice.call(arguments,1),b=!1;"function"===typeof a?a=new a(this.game,this):(a.game=this.game,a.parent=this);"function"===typeof a.preUpdate&&(b=a.hasPreUpdate=!0);"function"===typeof a.update&&
(b=a.hasUpdate=!0);"function"===typeof a.postUpdate&&(b=a.hasPostUpdate=!0);"function"===typeof a.render&&(b=a.hasRender=!0);"function"===typeof a.postRender&&(b=a.hasPostRender=!0);if(b){if(a.hasPreUpdate||a.hasUpdate||a.hasPostUpdate)a.active=!0;if(a.hasRender||a.hasPostRender)a.visible=!0;this._len=this.plugins.push(a);"function"===typeof a.init&&a.init.apply(a,c);return a}return null},remove:function(a){for(this._i=this._len;this._i--;)if(this.plugins[this._i]===a){a.destroy();this.plugins.splice(this._i,
1);this._len--;break}},removeAll:function(){for(this._i=this._len;this._i--;)this.plugins[this._i].destroy();this._len=this.plugins.length=0},preUpdate:function(){for(this._i=this._len;this._i--;)this.plugins[this._i].active&&this.plugins[this._i].hasPreUpdate&&this.plugins[this._i].preUpdate()},update:function(){for(this._i=this._len;this._i--;)this.plugins[this._i].active&&this.plugins[this._i].hasUpdate&&this.plugins[this._i].update()},postUpdate:function(){for(this._i=this._len;this._i--;)this.plugins[this._i].active&&
this.plugins[this._i].hasPostUpdate&&this.plugins[this._i].postUpdate()},render:function(){for(this._i=this._len;this._i--;)this.plugins[this._i].visible&&this.plugins[this._i].hasRender&&this.plugins[this._i].render()},postRender:function(){for(this._i=this._len;this._i--;)this.plugins[this._i].visible&&this.plugins[this._i].hasPostRender&&this.plugins[this._i].postRender()},destroy:function(){this.removeAll();this.game=null}};b.PluginManager.prototype.constructor=b.PluginManager;b.Stage=function(a){this.game=
a;PIXI.Stage.call(this,0);this.name="_stage_root";this.disableVisibilityChange=!1;this.exists=!0;this.currentRenderOrderID=0;this._hiddenVar="hidden";this._onChange=null;this._backgroundColor=0;a.config&&this.parseConfig(a.config)};b.Stage.prototype=Object.create(PIXI.Stage.prototype);b.Stage.prototype.constructor=b.Stage;b.Stage.prototype.parseConfig=function(a){a.disableVisibilityChange&&(this.disableVisibilityChange=a.disableVisibilityChange);a.backgroundColor&&(this.backgroundColor=a.backgroundColor)};
b.Stage.prototype.boot=function(){b.DOM.getOffset(this.game.canvas,this.offset);b.Canvas.setUserSelect(this.game.canvas,"none");b.Canvas.setTouchAction(this.game.canvas,"none");this.checkVisibility()};b.Stage.prototype.preUpdate=function(){for(var a=this.currentRenderOrderID=0;a<this.children.length;a++)this.children[a].preUpdate()};b.Stage.prototype.update=function(){for(var a=this.children.length;a--;)this.children[a].update()};b.Stage.prototype.postUpdate=function(){if(this.game.world.camera.target){this.game.world.camera.target.postUpdate();
this.game.world.camera.update();for(var a=this.children.length;a--;)this.children[a]!==this.game.world.camera.target&&this.children[a].postUpdate()}else for(this.game.world.camera.update(),a=this.children.length;a--;)this.children[a].postUpdate()};b.Stage.prototype.updateTransform=function(){this.worldAlpha=1;for(var a=0;a<this.children.length;a++)this.children[a].updateTransform()};b.Stage.prototype.checkVisibility=function(){this._hiddenVar=void 0!==document.webkitHidden?"webkitvisibilitychange":
void 0!==document.mozHidden?"mozvisibilitychange":void 0!==document.msHidden?"msvisibilitychange":void 0!==document.hidden?"visibilitychange":null;var a=this;this._onChange=function(c){return a.visibilityChange(c)};this._hiddenVar&&document.addEventListener(this._hiddenVar,this._onChange,!1);window.onblur=this._onChange;window.onfocus=this._onChange;window.onpagehide=this._onChange;window.onpageshow=this._onChange;this.game.device.cocoonJSApp&&(CocoonJS.App.onSuspended.addEventListener(function(){b.Stage.prototype.visibilityChange.call(a,
{type:"pause"})}),CocoonJS.App.onActivated.addEventListener(function(){b.Stage.prototype.visibilityChange.call(a,{type:"resume"})}))};b.Stage.prototype.visibilityChange=function(a){"pagehide"===a.type||"blur"===a.type||"pageshow"===a.type||"focus"===a.type?"pagehide"===a.type||"blur"===a.type?this.game.focusLoss(a):"pageshow"!==a.type&&"focus"!==a.type||this.game.focusGain(a):this.disableVisibilityChange||(document.hidden||document.mozHidden||document.msHidden||document.webkitHidden||"pause"===a.type?
this.game.gamePaused(a):this.game.gameResumed(a))};b.Stage.prototype.setBackgroundColor=function(a){a=b.Color.valueToColor(a);this._backgroundColor=b.Color.getColor(a.r,a.g,a.b);this.backgroundColorSplit=[a.r/255,a.g/255,a.b/255];this.backgroundColorString=b.Color.RGBtoString(a.r,a.g,a.b,255,"#")};b.Stage.prototype.destroy=function(){this._hiddenVar&&document.removeEventListener(this._hiddenVar,this._onChange,!1);window.onpagehide=null;window.onpageshow=null;window.onblur=null;window.onfocus=null};
Object.defineProperty(b.Stage.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(a){this.game.transparent||this.setBackgroundColor(a)}});Object.defineProperty(b.Stage.prototype,"smoothed",{get:function(){return PIXI.scaleModes.DEFAULT===PIXI.scaleModes.LINEAR},set:function(a){PIXI.scaleModes.DEFAULT=a?PIXI.scaleModes.LINEAR:PIXI.scaleModes.NEAREST}});b.Group=function(a,c,d,e,g,l){void 0===e&&(e=!1);void 0===g&&(g=!1);void 0===l&&(l=b.Physics.ARCADE);this.game=a;
void 0===c&&(c=a.world);this.name=d||"group";this.z=0;PIXI.DisplayObjectContainer.call(this);e?(this.game.stage.addChild(this),this.z=this.game.stage.children.length):c&&(c.addChild(this),this.z=c.children.length);this.physicsType=this.type=b.GROUP;this.exists=this.alive=!0;this.pendingDestroy=this.ignoreDestroy=!1;this.classType=b.Sprite;this.cursor=null;this.enableBody=g;this.enableBodyDebug=!1;this.physicsBodyType=l;this.physicsSortDirection=null;this.onDestroy=new b.Signal;this.cursorIndex=0;
this.fixedToCamera=!1;this.cameraOffset=new b.Point;this.hash=[];this._sortProperty="z"};b.Group.prototype=Object.create(PIXI.DisplayObjectContainer.prototype);b.Group.prototype.constructor=b.Group;b.Group.RETURN_NONE=0;b.Group.RETURN_TOTAL=1;b.Group.RETURN_CHILD=2;b.Group.SORT_ASCENDING=-1;b.Group.SORT_DESCENDING=1;b.Group.prototype.add=function(a,c){void 0===c&&(c=!1);if(a.parent!==this){this.addChild(a);a.z=this.children.length;this.enableBody&&null===a.body?this.game.physics.enable(a,this.physicsBodyType):
a.body&&this.addToHash(a);if(!c&&a.events)a.events.onAddedToGroup$dispatch(a,this);null===this.cursor&&(this.cursor=a)}return a};b.Group.prototype.addToHash=function(a){return a.parent===this&&-1===this.hash.indexOf(a)?(this.hash.push(a),!0):!1};b.Group.prototype.removeFromHash=function(a){return a&&(a=this.hash.indexOf(a),-1!==a)?(this.hash.splice(a,1),!0):!1};b.Group.prototype.addMultiple=function(a,c){if(a instanceof b.Group)a.moveAll(this,c);else if(Array.isArray(a))for(var d=0;d<a.length;d++)this.add(a[d],
c);return a};b.Group.prototype.addAt=function(a,c,b){void 0===b&&(b=!1);if(a.parent!==this){this.addChildAt(a,c);this.updateZ();this.enableBody&&null===a.body?this.game.physics.enable(a,this.physicsBodyType):a.body&&this.addToHash(a);if(!b&&a.events)a.events.onAddedToGroup$dispatch(a,this);null===this.cursor&&(this.cursor=a)}return a};b.Group.prototype.getAt=function(a){return 0>a||a>=this.children.length?-1:this.getChildAt(a)};b.Group.prototype.create=function(a,c,b,e,g){void 0===g&&(g=!0);a=new this.classType(this.game,
a,c,b,e);a.exists=g;a.visible=g;a.alive=g;this.addChild(a);a.z=this.children.length;this.enableBody&&this.game.physics.enable(a,this.physicsBodyType,this.enableBodyDebug);if(a.events)a.events.onAddedToGroup$dispatch(a,this);null===this.cursor&&(this.cursor=a);return a};b.Group.prototype.createMultiple=function(a,c,b,e){void 0===e&&(e=!1);for(var g=0;g<a;g++)this.create(0,0,c,b,e)};b.Group.prototype.updateZ=function(){for(var a=this.children.length;a--;)this.children[a].z=a};b.Group.prototype.resetCursor=
function(a){void 0===a&&(a=0);a>this.children.length-1&&(a=0);if(this.cursor)return this.cursorIndex=a,this.cursor=this.children[this.cursorIndex]};b.Group.prototype.next=function(){if(this.cursor)return this.cursorIndex>=this.children.length-1?this.cursorIndex=0:this.cursorIndex++,this.cursor=this.children[this.cursorIndex]};b.Group.prototype.previous=function(){if(this.cursor)return 0===this.cursorIndex?this.cursorIndex=this.children.length-1:this.cursorIndex--,this.cursor=this.children[this.cursorIndex]};
b.Group.prototype.swap=function(a,c){this.swapChildren(a,c);this.updateZ()};b.Group.prototype.bringToTop=function(a){a.parent===this&&this.getIndex(a)<this.children.length&&(this.remove(a,!1,!0),this.add(a,!0));return a};b.Group.prototype.sendToBack=function(a){a.parent===this&&0<this.getIndex(a)&&(this.remove(a,!1,!0),this.addAt(a,0,!0));return a};b.Group.prototype.moveUp=function(a){if(a.parent===this&&this.getIndex(a)<this.children.length-1){var c=this.getIndex(a);(c=this.getAt(c+1))&&this.swap(a,
c)}return a};b.Group.prototype.moveDown=function(a){if(a.parent===this&&0<this.getIndex(a)){var c=this.getIndex(a);(c=this.getAt(c-1))&&this.swap(a,c)}return a};b.Group.prototype.xy=function(a,c,b){if(0>a||a>this.children.length)return-1;this.getChildAt(a).x=c;this.getChildAt(a).y=b};b.Group.prototype.reverse=function(){this.children.reverse();this.updateZ()};b.Group.prototype.getIndex=function(a){return this.children.indexOf(a)};b.Group.prototype.replace=function(a,c){var d=this.getIndex(a);if(-1!==
d)return c.parent&&(c.parent instanceof b.Group?c.parent.remove(c):c.parent.removeChild(c)),this.remove(a),this.addAt(c,d),a};b.Group.prototype.hasProperty=function(a,c){var b=c.length;return 1===b&&c[0]in a||2===b&&c[0]in a&&c[1]in a[c[0]]||3===b&&c[0]in a&&c[1]in a[c[0]]&&c[2]in a[c[0]][c[1]]||4===b&&c[0]in a&&c[1]in a[c[0]]&&c[2]in a[c[0]][c[1]]&&c[3]in a[c[0]][c[1]][c[2]]?!0:!1};b.Group.prototype.setProperty=function(a,c,b,e,g){void 0===g&&(g=!1);e=e||0;if(!this.hasProperty(a,c)&&(!g||0<e))return!1;
g=c.length;1===g?0===e?a[c[0]]=b:1==e?a[c[0]]+=b:2==e?a[c[0]]-=b:3==e?a[c[0]]*=b:4==e&&(a[c[0]]/=b):2===g?0===e?a[c[0]][c[1]]=b:1==e?a[c[0]][c[1]]+=b:2==e?a[c[0]][c[1]]-=b:3==e?a[c[0]][c[1]]*=b:4==e&&(a[c[0]][c[1]]/=b):3===g?0===e?a[c[0]][c[1]][c[2]]=b:1==e?a[c[0]][c[1]][c[2]]+=b:2==e?a[c[0]][c[1]][c[2]]-=b:3==e?a[c[0]][c[1]][c[2]]*=b:4==e&&(a[c[0]][c[1]][c[2]]/=b):4===g&&(0===e?a[c[0]][c[1]][c[2]][c[3]]=b:1==e?a[c[0]][c[1]][c[2]][c[3]]+=b:2==e?a[c[0]][c[1]][c[2]][c[3]]-=b:3==e?a[c[0]][c[1]][c[2]][c[3]]*=
b:4==e&&(a[c[0]][c[1]][c[2]][c[3]]/=b));return!0};b.Group.prototype.checkProperty=function(a,c,d,e){void 0===e&&(e=!1);return!b.Utils.getProperty(a,c)&&e||b.Utils.getProperty(a,c)!==d?!1:!0};b.Group.prototype.set=function(a,c,b,e,g,l,p){void 0===p&&(p=!1);c=c.split(".");void 0===e&&(e=!1);void 0===g&&(g=!1);if((!1===e||e&&a.alive)&&(!1===g||g&&a.visible))return this.setProperty(a,c,b,l,p)};b.Group.prototype.setAll=function(a,c,b,e,g,l){void 0===b&&(b=!1);void 0===e&&(e=!1);void 0===l&&(l=!1);a=a.split(".");
g=g||0;for(var p=0;p<this.children.length;p++)(!b||b&&this.children[p].alive)&&(!e||e&&this.children[p].visible)&&this.setProperty(this.children[p],a,c,g,l)};b.Group.prototype.setAllChildren=function(a,c,d,e,g,l){void 0===d&&(d=!1);void 0===e&&(e=!1);void 0===l&&(l=!1);g=g||0;for(var p=0;p<this.children.length;p++)(!d||d&&this.children[p].alive)&&(!e||e&&this.children[p].visible)&&(this.children[p]instanceof b.Group?this.children[p].setAllChildren(a,c,d,e,g,l):this.setProperty(this.children[p],a.split("."),
c,g,l))};b.Group.prototype.checkAll=function(a,c,b,e,g){void 0===b&&(b=!1);void 0===e&&(e=!1);void 0===g&&(g=!1);for(var l=0;l<this.children.length;l++)if((!b||b&&this.children[l].alive)&&(!e||e&&this.children[l].visible)&&!this.checkProperty(this.children[l],a,c,g))return!1;return!0};b.Group.prototype.addAll=function(a,c,b,e){this.setAll(a,c,b,e,1)};b.Group.prototype.subAll=function(a,c,b,e){this.setAll(a,c,b,e,2)};b.Group.prototype.multiplyAll=function(a,c,b,e){this.setAll(a,c,b,e,3)};b.Group.prototype.divideAll=
function(a,c,b,e){this.setAll(a,c,b,e,4)};b.Group.prototype.callAllExists=function(a,c){var b;if(2<arguments.length){b=[];for(var e=2;e<arguments.length;e++)b.push(arguments[e])}for(e=0;e<this.children.length;e++)this.children[e].exists===c&&this.children[e][a]&&this.children[e][a].apply(this.children[e],b)};b.Group.prototype.callbackFromArray=function(a,c,b){if(1==b){if(a[c[0]])return a[c[0]]}else if(2==b){if(a[c[0]][c[1]])return a[c[0]][c[1]]}else if(3==b){if(a[c[0]][c[1]][c[2]])return a[c[0]][c[1]][c[2]]}else if(4==
b){if(a[c[0]][c[1]][c[2]][c[3]])return a[c[0]][c[1]][c[2]][c[3]]}else if(a[c])return a[c];return!1};b.Group.prototype.callAll=function(a,c){if(void 0!==a){a=a.split(".");var b=a.length;if(void 0===c||null===c||""===c)c=null;else if("string"===typeof c){c=c.split(".");var e=c.length}var g;if(2<arguments.length){g=[];for(var l=2;l<arguments.length;l++)g.push(arguments[l])}for(var p=null,f=null,l=0;l<this.children.length;l++)p=this.callbackFromArray(this.children[l],a,b),c&&p?(f=this.callbackFromArray(this.children[l],
c,e),p&&p.apply(f,g)):p&&p.apply(this.children[l],g)}};b.Group.prototype.preUpdate=function(){if(this.pendingDestroy)return this.destroy(),!1;if(!this.exists||!this.parent.exists)return this.renderOrderID=-1,!1;for(var a=this.children.length;a--;)this.children[a].preUpdate();return!0};b.Group.prototype.update=function(){for(var a=this.children.length;a--;)this.children[a].update()};b.Group.prototype.postUpdate=function(){this.fixedToCamera&&(this.x=this.game.camera.view.x+this.cameraOffset.x,this.y=
this.game.camera.view.y+this.cameraOffset.y);for(var a=this.children.length;a--;)this.children[a].postUpdate()};b.Group.prototype.filter=function(a,c){for(var d=-1,e=this.children.length,g=[];++d<e;){var l=this.children[d];(!c||c&&l.exists)&&a(l,d,this.children)&&g.push(l)}return new b.ArraySet(g)};b.Group.prototype.forEach=function(a,c,b){void 0===b&&(b=!1);if(3>=arguments.length)for(var e=0;e<this.children.length;e++)(!b||b&&this.children[e].exists)&&a.call(c,this.children[e]);else{for(var g=[null],
e=3;e<arguments.length;e++)g.push(arguments[e]);for(e=0;e<this.children.length;e++)if(!b||b&&this.children[e].exists)g[0]=this.children[e],a.apply(c,g)}};b.Group.prototype.forEachExists=function(a,c){var d;if(2<arguments.length){d=[null];for(var e=2;e<arguments.length;e++)d.push(arguments[e])}this.iterate("exists",!0,b.Group.RETURN_TOTAL,a,c,d)};b.Group.prototype.forEachAlive=function(a,c){var d;if(2<arguments.length){d=[null];for(var e=2;e<arguments.length;e++)d.push(arguments[e])}this.iterate("alive",
!0,b.Group.RETURN_TOTAL,a,c,d)};b.Group.prototype.forEachDead=function(a,c){var d;if(2<arguments.length){d=[null];for(var e=2;e<arguments.length;e++)d.push(arguments[e])}this.iterate("alive",!1,b.Group.RETURN_TOTAL,a,c,d)};b.Group.prototype.sort=function(a,c){2>this.children.length||(void 0===a&&(a="z"),void 0===c&&(c=b.Group.SORT_ASCENDING),this._sortProperty=a,c===b.Group.SORT_ASCENDING?this.children.sort(this.ascendingSortHandler.bind(this)):this.children.sort(this.descendingSortHandler.bind(this)),
this.updateZ())};b.Group.prototype.customSort=function(a,c){2>this.children.length||(this.children.sort(a.bind(c)),this.updateZ())};b.Group.prototype.ascendingSortHandler=function(a,c){return a[this._sortProperty]<c[this._sortProperty]?-1:a[this._sortProperty]>c[this._sortProperty]?1:a.z<c.z?-1:1};b.Group.prototype.descendingSortHandler=function(a,c){return a[this._sortProperty]<c[this._sortProperty]?1:a[this._sortProperty]>c[this._sortProperty]?-1:0};b.Group.prototype.iterate=function(a,c,d,e,g,
l){if(d===b.Group.RETURN_TOTAL&&0===this.children.length)return 0;for(var p=0,f=0;f<this.children.length;f++)if(this.children[f][a]===c&&(p++,e&&(l?(l[0]=this.children[f],e.apply(g,l)):e.call(g,this.children[f])),d===b.Group.RETURN_CHILD))return this.children[f];return d===b.Group.RETURN_TOTAL?p:null};b.Group.prototype.getFirstExists=function(a){"boolean"!==typeof a&&(a=!0);return this.iterate("exists",a,b.Group.RETURN_CHILD)};b.Group.prototype.getFirstAlive=function(){return this.iterate("alive",
!0,b.Group.RETURN_CHILD)};b.Group.prototype.getFirstDead=function(){return this.iterate("alive",!1,b.Group.RETURN_CHILD)};b.Group.prototype.getTop=function(){if(0<this.children.length)return this.children[this.children.length-1]};b.Group.prototype.getBottom=function(){if(0<this.children.length)return this.children[0]};b.Group.prototype.countLiving=function(){return this.iterate("alive",!0,b.Group.RETURN_TOTAL)};b.Group.prototype.countDead=function(){return this.iterate("alive",!1,b.Group.RETURN_TOTAL)};
b.Group.prototype.getRandom=function(a,c){if(0===this.children.length)return null;c=c||this.children.length;return b.ArrayUtils.getRandomItem(this.children,a||0,c)};b.Group.prototype.remove=function(a,c,b){void 0===c&&(c=!1);void 0===b&&(b=!1);if(0===this.children.length||-1===this.children.indexOf(a))return!1;if(!b&&a.events&&!a.destroyPhase)a.events.onRemovedFromGroup$dispatch(a,this);b=this.removeChild(a);this.removeFromHash(a);this.updateZ();this.cursor===a&&this.next();c&&b&&b.destroy(!0);return!0};
b.Group.prototype.moveAll=function(a,c){void 0===c&&(c=!1);if(0<this.children.length&&a instanceof b.Group){do a.add(this.children[0],c);while(0<this.children.length);this.hash=[];this.cursor=null}return a};b.Group.prototype.removeAll=function(a,c){void 0===a&&(a=!1);void 0===c&&(c=!1);if(0!==this.children.length){do{if(!c&&this.children[0].events)this.children[0].events.onRemovedFromGroup$dispatch(this.children[0],this);var b=this.removeChild(this.children[0]);this.removeFromHash(b);a&&b&&b.destroy(!0)}while(0<
this.children.length);this.hash=[];this.cursor=null}};b.Group.prototype.removeBetween=function(a,c,b,e){void 0===c&&(c=this.children.length-1);void 0===b&&(b=!1);void 0===e&&(e=!1);if(0!==this.children.length){if(a>c||0>a||c>this.children.length)return!1;for(;c>=a;){if(!e&&this.children[c].events)this.children[c].events.onRemovedFromGroup$dispatch(this.children[c],this);var g=this.removeChild(this.children[c]);this.removeFromHash(g);b&&g&&g.destroy(!0);this.cursor===this.children[c]&&(this.cursor=
null);c--}this.updateZ()}};b.Group.prototype.destroy=function(a,c){null===this.game||this.ignoreDestroy||(void 0===a&&(a=!0),void 0===c&&(c=!1),this.onDestroy.dispatch(this,a,c),this.removeAll(a),this.filters=this.cursor=null,this.pendingDestroy=!1,c||(this.parent&&this.parent.removeChild(this),this.game=null,this.exists=!1))};Object.defineProperty(b.Group.prototype,"total",{get:function(){return this.iterate("exists",!0,b.Group.RETURN_TOTAL)}});Object.defineProperty(b.Group.prototype,"length",{get:function(){return this.children.length}});
Object.defineProperty(b.Group.prototype,"angle",{get:function(){return b.Math.radToDeg(this.rotation)},set:function(a){this.rotation=b.Math.degToRad(a)}});b.World=function(a){b.Group.call(this,a,null,"__world",!1);this.bounds=new b.Rectangle(0,0,a.width,a.height);this.camera=null;this._definedSize=!1;this._width=a.width;this._height=a.height;this.game.state.onStateChange.add(this.stateChange,this)};b.World.prototype=Object.create(b.Group.prototype);b.World.prototype.constructor=b.World;b.World.prototype.boot=
function(){this.camera=new b.Camera(this.game,0,0,0,this.game.width,this.game.height);this.camera.displayObject=this;this.camera.scale=this.scale;this.game.camera=this.camera;this.game.stage.addChild(this)};b.World.prototype.stateChange=function(){this.y=this.x=0;this.camera.reset()};b.World.prototype.setBounds=function(a,c,b,e){this._definedSize=!0;this._width=b;this._height=e;this.bounds.setTo(a,c,b,e);this.x=a;this.y=c;this.camera.bounds&&this.camera.bounds.setTo(a,c,Math.max(b,this.game.width),
Math.max(e,this.game.height));this.game.physics.setBoundsToWorld()};b.World.prototype.resize=function(a,c){this._definedSize&&(a<this._width&&(a=this._width),c<this._height&&(c=this._height));this.bounds.width=a;this.bounds.height=c;this.game.camera.setBoundsToWorld();this.game.physics.setBoundsToWorld()};b.World.prototype.shutdown=function(){this.destroy(!0,!0)};b.World.prototype.wrap=function(a,c,b,e,g){void 0===c&&(c=0);void 0===b&&(b=!1);void 0===e&&(e=!0);void 0===g&&(g=!0);b?(a.getBounds(),
e&&(a.x+a._currentBounds.width<this.bounds.x?a.x=this.bounds.right:a.x>this.bounds.right&&(a.x=this.bounds.left)),g&&(a.y+a._currentBounds.height<this.bounds.top?a.y=this.bounds.bottom:a.y>this.bounds.bottom&&(a.y=this.bounds.top))):(e&&a.x+c<this.bounds.x?a.x=this.bounds.right+c:e&&a.x-c>this.bounds.right&&(a.x=this.bounds.left-c),g&&a.y+c<this.bounds.top?a.y=this.bounds.bottom+c:g&&a.y-c>this.bounds.bottom&&(a.y=this.bounds.top-c))};Object.defineProperty(b.World.prototype,"width",{get:function(){return this.bounds.width},
set:function(a){a<this.game.width&&(a=this.game.width);this._width=this.bounds.width=a;this._definedSize=!0}});Object.defineProperty(b.World.prototype,"height",{get:function(){return this.bounds.height},set:function(a){a<this.game.height&&(a=this.game.height);this._height=this.bounds.height=a;this._definedSize=!0}});Object.defineProperty(b.World.prototype,"centerX",{get:function(){return this.bounds.halfWidth}});Object.defineProperty(b.World.prototype,"centerY",{get:function(){return this.bounds.halfHeight}});
Object.defineProperty(b.World.prototype,"randomX",{get:function(){return 0>this.bounds.x?this.game.rnd.between(this.bounds.x,this.bounds.width-Math.abs(this.bounds.x)):this.game.rnd.between(this.bounds.x,this.bounds.width)}});Object.defineProperty(b.World.prototype,"randomY",{get:function(){return 0>this.bounds.y?this.game.rnd.between(this.bounds.y,this.bounds.height-Math.abs(this.bounds.y)):this.game.rnd.between(this.bounds.y,this.bounds.height)}});b.FlexGrid=function(a,c,d){this.game=a.game;this.manager=
a;this.width=c;this.height=d;this.boundsCustom=new b.Rectangle(0,0,c,d);this.boundsFluid=new b.Rectangle(0,0,c,d);this.boundsFull=new b.Rectangle(0,0,c,d);this.boundsNone=new b.Rectangle(0,0,c,d);this.positionCustom=new b.Point(0,0);this.positionFluid=new b.Point(0,0);this.positionFull=new b.Point(0,0);this.positionNone=new b.Point(0,0);this.scaleCustom=new b.Point(1,1);this.scaleFluid=new b.Point(1,1);this.scaleFluidInversed=new b.Point(1,1);this.scaleFull=new b.Point(1,1);this.scaleNone=new b.Point(1,
1);this.customOffsetY=this.customOffsetX=this.customHeight=this.customWidth=0;this.ratioH=c/d;this.ratioV=d/c;this.multiplier=0;this.layers=[]};b.FlexGrid.prototype={setSize:function(a,c){this.width=a;this.height=c;this.ratioH=a/c;this.ratioV=c/a;this.scaleNone=new b.Point(1,1);this.boundsNone.width=this.width;this.boundsNone.height=this.height;this.refresh()},createCustomLayer:function(a,c,d,e){void 0===e&&(e=!0);this.customWidth=a;this.customHeight=c;this.boundsCustom.width=a;this.boundsCustom.height=
c;a=new b.FlexLayer(this,this.positionCustom,this.boundsCustom,this.scaleCustom);e&&this.game.world.add(a);this.layers.push(a);"undefined"!==typeof d&&null!==typeof d&&a.addMultiple(d);return a},createFluidLayer:function(a,c){void 0===c&&(c=!0);var d=new b.FlexLayer(this,this.positionFluid,this.boundsFluid,this.scaleFluid);c&&this.game.world.add(d);this.layers.push(d);"undefined"!==typeof a&&null!==typeof a&&d.addMultiple(a);return d},createFullLayer:function(a){var c=new b.FlexLayer(this,this.positionFull,
this.boundsFull,this.scaleFluid);this.game.world.add(c);this.layers.push(c);"undefined"!==typeof a&&c.addMultiple(a);return c},createFixedLayer:function(a){var c=new b.FlexLayer(this,this.positionNone,this.boundsNone,this.scaleNone);this.game.world.add(c);this.layers.push(c);"undefined"!==typeof a&&c.addMultiple(a);return c},reset:function(){for(var a=this.layers.length;a--;)this.layers[a].persist||(this.layers[a].position=null,this.layers[a].scale=null,this.layers.slice(a,1))},onResize:function(a,
c){this.ratioH=a/c;this.ratioV=c/a;this.refresh(a,c)},refresh:function(){this.multiplier=Math.min(this.manager.height/this.height,this.manager.width/this.width);this.boundsFluid.width=Math.round(this.width*this.multiplier);this.boundsFluid.height=Math.round(this.height*this.multiplier);this.scaleFluid.set(this.boundsFluid.width/this.width,this.boundsFluid.height/this.height);this.scaleFluidInversed.set(this.width/this.boundsFluid.width,this.height/this.boundsFluid.height);this.scaleFull.set(this.boundsFull.width/
this.width,this.boundsFull.height/this.height);this.boundsFull.width=Math.round(this.manager.width*this.scaleFluidInversed.x);this.boundsFull.height=Math.round(this.manager.height*this.scaleFluidInversed.y);this.boundsFluid.centerOn(this.manager.bounds.centerX,this.manager.bounds.centerY);this.boundsNone.centerOn(this.manager.bounds.centerX,this.manager.bounds.centerY);this.positionFluid.set(this.boundsFluid.x,this.boundsFluid.y);this.positionNone.set(this.boundsNone.x,this.boundsNone.y)},fitSprite:function(a){this.manager.scaleSprite(a);
a.x=this.manager.bounds.centerX;a.y=this.manager.bounds.centerY},debug:function(){this.game.debug.text(this.boundsFluid.width+" x "+this.boundsFluid.height,this.boundsFluid.x+4,this.boundsFluid.y+16);this.game.debug.geom(this.boundsFluid,"rgba(255,0,0,0.9",!1)}};b.FlexGrid.prototype.constructor=b.FlexGrid;b.FlexLayer=function(a,c,d,e){b.Group.call(this,a.game,null,"__flexLayer"+a.game.rnd.uuid(),!1);this.manager=a.manager;this.grid=a;this.persist=!1;this.position=c;this.bounds=d;this.scale=e;this.topLeft=
d.topLeft;this.topMiddle=new b.Point(d.halfWidth,0);this.topRight=d.topRight;this.bottomLeft=d.bottomLeft;this.bottomMiddle=new b.Point(d.halfWidth,d.bottom);this.bottomRight=d.bottomRight};b.FlexLayer.prototype=Object.create(b.Group.prototype);b.FlexLayer.prototype.constructor=b.FlexLayer;b.FlexLayer.prototype.resize=function(){};b.FlexLayer.prototype.debug=function(){this.game.debug.text(this.bounds.width+" x "+this.bounds.height,this.bounds.x+4,this.bounds.y+16);this.game.debug.geom(this.bounds,
"rgba(0,0,255,0.9",!1);this.game.debug.geom(this.topLeft,"rgba(255,255,255,0.9");this.game.debug.geom(this.topMiddle,"rgba(255,255,255,0.9");this.game.debug.geom(this.topRight,"rgba(255,255,255,0.9")};b.ScaleManager=function(a,c,d){this.game=a;this.dom=b.DOM;this.grid=null;this.height=this.width=0;this.maxHeight=this.minHeight=this.maxWidth=this.minWidth=null;this.offset=new b.Point;this._pageAlignVertically=this._pageAlignHorizontally=this.incorrectOrientation=this.forcePortrait=this.forceLandscape=
!1;this.onOrientationChange=new b.Signal;this.enterIncorrectOrientation=new b.Signal;this.leaveIncorrectOrientation=new b.Signal;this._createdFullScreenTarget=this.fullScreenTarget=null;this.onFullScreenInit=new b.Signal;this.onFullScreenChange=new b.Signal;this.onFullScreenError=new b.Signal;this.screenOrientation=this.dom.getScreenOrientation();this.scaleFactor=new b.Point(1,1);this.scaleFactorInversed=new b.Point(1,1);this.margin={left:0,top:0,right:0,bottom:0,x:0,y:0};this.bounds=new b.Rectangle;
this.sourceAspectRatio=this.aspectRatio=0;this.event=null;this.windowConstraints={right:"layout",bottom:""};this.compatibility={supportsFullScreen:!1,orientationFallback:null,noMargins:!1,scrollTo:null,forceMinimumDocumentHeight:!1,canExpandParent:!0,clickTrampoline:""};this._fullScreenScaleMode=this._scaleMode=b.ScaleManager.NO_SCALE;this.parentIsWindow=!1;this.parentNode=null;this.parentScaleFactor=new b.Point(1,1);this.trackParentInterval=2E3;this.onSizeChange=new b.Signal;this._fullScreenRestore=
this._pendingScaleMode=this.onResizeContext=this.onResize=null;this._gameSize=new b.Rectangle;this._userScaleFactor=new b.Point(1,1);this._userScaleTrim=new b.Point(0,0);this._updateThrottle=this._lastUpdate=0;this._updateThrottleReset=100;this._parentBounds=new b.Rectangle;this._tempBounds=new b.Rectangle;this._lastReportedCanvasSize=new b.Rectangle;this._lastReportedGameSize=new b.Rectangle;this._booted=!1;a.config&&this.parseConfig(a.config);this.setupScale(c,d)};b.ScaleManager.EXACT_FIT=0;b.ScaleManager.NO_SCALE=
1;b.ScaleManager.SHOW_ALL=2;b.ScaleManager.RESIZE=3;b.ScaleManager.USER_SCALE=4;b.ScaleManager.prototype={boot:function(){var a=this.compatibility;a.supportsFullScreen=this.game.device.fullscreen&&!this.game.device.cocoonJS;this.game.device.iPad||this.game.device.webApp||this.game.device.desktop||(a.scrollTo=this.game.device.android&&!this.game.device.chrome?new b.Point(0,1):new b.Point(0,0));this.game.device.desktop?(a.orientationFallback="screen",a.clickTrampoline="when-not-mouse"):(a.orientationFallback=
"",a.clickTrampoline="");var c=this;this._orientationChange=function(a){return c.orientationChange(a)};this._windowResize=function(a){return c.windowResize(a)};window.addEventListener("orientationchange",this._orientationChange,!1);window.addEventListener("resize",this._windowResize,!1);this.compatibility.supportsFullScreen&&(this._fullScreenChange=function(a){return c.fullScreenChange(a)},this._fullScreenError=function(a){return c.fullScreenError(a)},document.addEventListener("webkitfullscreenchange",
this._fullScreenChange,!1),document.addEventListener("mozfullscreenchange",this._fullScreenChange,!1),document.addEventListener("MSFullscreenChange",this._fullScreenChange,!1),document.addEventListener("fullscreenchange",this._fullScreenChange,!1),document.addEventListener("webkitfullscreenerror",this._fullScreenError,!1),document.addEventListener("mozfullscreenerror",this._fullScreenError,!1),document.addEventListener("MSFullscreenError",this._fullScreenError,!1),document.addEventListener("fullscreenerror",
this._fullScreenError,!1));this.game.onResume.add(this._gameResumed,this);this.dom.getOffset(this.game.canvas,this.offset);this.bounds.setTo(this.offset.x,this.offset.y,this.width,this.height);this.setGameSize(this.game.width,this.game.height);this.screenOrientation=this.dom.getScreenOrientation(this.compatibility.orientationFallback);this.grid=new b.FlexGrid(this,this.width,this.height);this._booted=!0;this._pendingScaleMode&&(this.scaleMode=this._pendingScaleMode,this._pendingScaleMode=null)},parseConfig:function(a){a.scaleMode&&
(this._booted?this.scaleMode=a.scaleMode:this._pendingScaleMode=a.scaleMode);a.fullScreenScaleMode&&(this.fullScreenScaleMode=a.fullScreenScaleMode);a.fullScreenTarget&&(this.fullScreenTarget=a.fullScreenTarget)},setupScale:function(a,c){var d,e=new b.Rectangle;""!==this.game.parent&&("string"===typeof this.game.parent?d=document.getElementById(this.game.parent):this.game.parent&&1===this.game.parent.nodeType&&(d=this.game.parent));d?(this.parentNode=d,this.parentIsWindow=!1,this.getParentBounds(this._parentBounds),
e.width=this._parentBounds.width,e.height=this._parentBounds.height,this.offset.set(this._parentBounds.x,this._parentBounds.y)):(this.parentNode=null,this.parentIsWindow=!0,e.width=this.dom.visualBounds.width,e.height=this.dom.visualBounds.height,this.offset.set(0,0));var g=d=0;"number"===typeof a?d=a:(this.parentScaleFactor.x=parseInt(a,10)/100,d=e.width*this.parentScaleFactor.x);"number"===typeof c?g=c:(this.parentScaleFactor.y=parseInt(c,10)/100,g=e.height*this.parentScaleFactor.y);this._gameSize.setTo(0,
0,d,g);this.updateDimensions(d,g,!1)},_gameResumed:function(){this.queueUpdate(!0)},setGameSize:function(a,c){this._gameSize.setTo(0,0,a,c);this.currentScaleMode!==b.ScaleManager.RESIZE&&this.updateDimensions(a,c,!0);this.queueUpdate(!0)},setUserScale:function(a,c,b,e){this._userScaleFactor.setTo(a,c);this._userScaleTrim.setTo(b|0,e|0);this.queueUpdate(!0)},setResizeCallback:function(a,c){this.onResize=a;this.onResizeContext=c},signalSizeChange:function(){if(!b.Rectangle.sameDimensions(this,this._lastReportedCanvasSize)||
!b.Rectangle.sameDimensions(this.game,this._lastReportedGameSize)){var a=this.width,c=this.height;this._lastReportedCanvasSize.setTo(0,0,a,c);this._lastReportedGameSize.setTo(0,0,this.game.width,this.game.height);this.grid.onResize(a,c);this.onSizeChange.dispatch(this,a,c);this.currentScaleMode===b.ScaleManager.RESIZE&&(this.game.state.resize(a,c),this.game.load.resize(a,c))}},setMinMax:function(a,c,b,e){this.minWidth=a;this.minHeight=c;"undefined"!==typeof b&&(this.maxWidth=b);"undefined"!==typeof e&&
(this.maxHeight=e)},preUpdate:function(){if(!(this.game.time.time<this._lastUpdate+this._updateThrottle)){var a=this._updateThrottle;this._updateThrottleReset=400<=a?0:100;this.dom.getOffset(this.game.canvas,this.offset);var c=this._parentBounds.width,d=this._parentBounds.height,e=this.getParentBounds(this._parentBounds),c=e.width!==c||e.height!==d,d=this.updateOrientationState();if(c||d)this.onResize&&this.onResize.call(this.onResizeContext,this,e),this.updateLayout(),this.signalSizeChange();e=2*
this._updateThrottle;this._updateThrottle<a&&(e=Math.min(a,this._updateThrottleReset));this._updateThrottle=b.Math.clamp(e,25,this.trackParentInterval);this._lastUpdate=this.game.time.time}},pauseUpdate:function(){this.preUpdate();this._updateThrottle=this.trackParentInterval},updateDimensions:function(a,c,b){this.width=a*this.parentScaleFactor.x;this.height=c*this.parentScaleFactor.y;this.game.width=this.width;this.game.height=this.height;this.sourceAspectRatio=this.width/this.height;this.updateScalingAndBounds();
b&&(this.game.renderer.resize(this.width,this.height),this.game.camera.setSize(this.width,this.height),this.game.world.resize(this.width,this.height))},updateScalingAndBounds:function(){this.scaleFactor.x=this.game.width/this.width;this.scaleFactor.y=this.game.height/this.height;this.scaleFactorInversed.x=this.width/this.game.width;this.scaleFactorInversed.y=this.height/this.game.height;this.aspectRatio=this.width/this.height;this.game.canvas&&this.dom.getOffset(this.game.canvas,this.offset);this.bounds.setTo(this.offset.x,
this.offset.y,this.width,this.height);this.game.input&&this.game.input.scale&&this.game.input.scale.setTo(this.scaleFactor.x,this.scaleFactor.y)},forceOrientation:function(a,c){void 0===c&&(c=!1);this.forceLandscape=a;this.forcePortrait=c;this.queueUpdate(!0)},classifyOrientation:function(a){return"portrait-primary"===a||"portrait-secondary"===a?"portrait":"landscape-primary"===a||"landscape-secondary"===a?"landscape":null},updateOrientationState:function(){var a=this.screenOrientation,c=this.incorrectOrientation;
this.screenOrientation=this.dom.getScreenOrientation(this.compatibility.orientationFallback);this.incorrectOrientation=this.forceLandscape&&!this.isLandscape||this.forcePortrait&&!this.isPortrait;var b=a!==this.screenOrientation,e=c!==this.incorrectOrientation;e&&(this.incorrectOrientation?this.enterIncorrectOrientation.dispatch():this.leaveIncorrectOrientation.dispatch());(b||e)&&this.onOrientationChange.dispatch(this,a,c);return b||e},orientationChange:function(a){this.event=a;this.queueUpdate(!0)},
windowResize:function(a){this.event=a;this.queueUpdate(!0)},scrollTop:function(){var a=this.compatibility.scrollTo;a&&window.scrollTo(a.x,a.y)},refresh:function(){this.scrollTop();this.queueUpdate(!0)},updateLayout:function(){var a=this.currentScaleMode;a===b.ScaleManager.RESIZE?this.reflowGame():(this.scrollTop(),this.compatibility.forceMinimumDocumentHeight&&(document.documentElement.style.minHeight=window.innerHeight+"px"),this.incorrectOrientation?this.setMaximum():a===b.ScaleManager.EXACT_FIT?
this.setExactFit():a===b.ScaleManager.SHOW_ALL?(!this.isFullScreen&&this.boundingParent&&this.compatibility.canExpandParent&&(this.setShowAll(!0),this.resetCanvas()),this.setShowAll()):a===b.ScaleManager.NO_SCALE?(this.width=this.game.width,this.height=this.game.height):a===b.ScaleManager.USER_SCALE&&(this.width=this.game.width*this._userScaleFactor.x-this._userScaleTrim.x,this.height=this.game.height*this._userScaleFactor.y-this._userScaleTrim.y),this.compatibility.canExpandParent||a!==b.ScaleManager.SHOW_ALL&&
a!==b.ScaleManager.USER_SCALE||(a=this.getParentBounds(this._tempBounds),this.width=Math.min(this.width,a.width),this.height=Math.min(this.height,a.height)),this.width|=0,this.height|=0,this.reflowCanvas())},getParentBounds:function(a){a=a||new b.Rectangle;var c=this.boundingParent,d=this.dom.visualBounds,e=this.dom.layoutBounds;if(c){c=c.getBoundingClientRect();a.setTo(c.left,c.top,c.width,c.height);c=this.windowConstraints;if(c.right){var g="layout"===c.right?e:d;a.right=Math.min(a.right,g.width)}c.bottom&&
(g="layout"===c.bottom?e:d,a.bottom=Math.min(a.bottom,g.height))}else a.setTo(0,0,d.width,d.height);a.setTo(Math.round(a.x),Math.round(a.y),Math.round(a.width),Math.round(a.height));return a},alignCanvas:function(a,c){var b=this.getParentBounds(this._tempBounds),e=this.game.canvas,g=this.margin;if(a){g.left=g.right=0;var l=e.getBoundingClientRect();if(this.width<b.width&&!this.incorrectOrientation){var p=l.left-b.x,f=b.width/2-this.width/2,f=Math.max(f,0);g.left=Math.round(f-p)}e.style.marginLeft=
g.left+"px";0!==g.left&&(g.right=-(b.width-l.width-g.left),e.style.marginRight=g.right+"px")}c&&(g.top=g.bottom=0,l=e.getBoundingClientRect(),this.height<b.height&&!this.incorrectOrientation&&(p=l.top-b.y,f=b.height/2-this.height/2,f=Math.max(f,0),g.top=Math.round(f-p)),e.style.marginTop=g.top+"px",0!==g.top&&(g.bottom=-(b.height-l.height-g.top),e.style.marginBottom=g.bottom+"px"));g.x=g.left;g.y=g.top},reflowGame:function(){this.resetCanvas("","");var a=this.getParentBounds(this._tempBounds);this.updateDimensions(a.width,
a.height,!0)},reflowCanvas:function(){this.incorrectOrientation||(this.width=b.Math.clamp(this.width,this.minWidth||0,this.maxWidth||this.width),this.height=b.Math.clamp(this.height,this.minHeight||0,this.maxHeight||this.height));this.resetCanvas();this.compatibility.noMargins||(this.isFullScreen&&this._createdFullScreenTarget?this.alignCanvas(!0,!0):this.alignCanvas(this.pageAlignHorizontally,this.pageAlignVertically));this.updateScalingAndBounds()},resetCanvas:function(a,c){void 0===a&&(a=this.width+
"px");void 0===c&&(c=this.height+"px");var b=this.game.canvas;this.compatibility.noMargins||(b.style.marginLeft="",b.style.marginTop="",b.style.marginRight="",b.style.marginBottom="");b.style.width=a;b.style.height=c},queueUpdate:function(a){a&&(this._parentBounds.width=0,this._parentBounds.height=0);this._updateThrottle=this._updateThrottleReset},reset:function(a){a&&this.grid.reset()},setMaximum:function(){this.width=this.dom.visualBounds.width;this.height=this.dom.visualBounds.height},setShowAll:function(a){var c=
this.getParentBounds(this._tempBounds),b=c.width,c=c.height;a=a?Math.max(c/this.game.height,b/this.game.width):Math.min(c/this.game.height,b/this.game.width);this.width=Math.round(this.game.width*a);this.height=Math.round(this.game.height*a)},setExactFit:function(){var a=this.getParentBounds(this._tempBounds);this.width=a.width;this.height=a.height;this.isFullScreen||(this.maxWidth&&(this.width=Math.min(this.width,this.maxWidth)),this.maxHeight&&(this.height=Math.min(this.height,this.maxHeight)))},
createFullScreenTarget:function(){var a=document.createElement("div");a.style.margin="0";a.style.padding="0";a.style.background="#000";return a},startFullScreen:function(a,c){if(this.isFullScreen)return!1;if(this.compatibility.supportsFullScreen){if("when-not-mouse"===this.compatibility.clickTrampoline){var d=this.game.input;if(d.activePointer&&d.activePointer!==d.mousePointer&&(c||!1!==c)){d.activePointer.addClickTrampoline("startFullScreen",this.startFullScreen,this,[a,!1]);return}}"undefined"!==
typeof a&&this.game.renderType===b.CANVAS&&(this.game.stage.smoothed=a);d=this.fullScreenTarget;d||(this.cleanupCreatedTarget(),d=this._createdFullScreenTarget=this.createFullScreenTarget());this.onFullScreenInit.dispatch(this,{targetElement:d});if(this._createdFullScreenTarget){var e=this.game.canvas;e.parentNode.insertBefore(d,e);d.appendChild(e)}if(this.game.device.fullscreenKeyboard)d[this.game.device.requestFullscreen](Element.ALLOW_KEYBOARD_INPUT);else d[this.game.device.requestFullscreen]();
return!0}var g=this;setTimeout(function(){g.fullScreenError()},10)},stopFullScreen:function(){if(!this.isFullScreen||!this.compatibility.supportsFullScreen)return!1;document[this.game.device.cancelFullscreen]();return!0},cleanupCreatedTarget:function(){var a=this._createdFullScreenTarget;if(a&&a.parentNode){var c=a.parentNode;c.insertBefore(this.game.canvas,a);c.removeChild(a)}this._createdFullScreenTarget=null},prepScreenMode:function(a){var c=!!this._createdFullScreenTarget,d=this._createdFullScreenTarget||
this.fullScreenTarget;a?!c&&this.fullScreenScaleMode!==b.ScaleManager.EXACT_FIT||d===this.game.canvas||(this._fullScreenRestore={targetWidth:d.style.width,targetHeight:d.style.height},d.style.width="100%",d.style.height="100%"):(this._fullScreenRestore&&(d.style.width=this._fullScreenRestore.targetWidth,d.style.height=this._fullScreenRestore.targetHeight,this._fullScreenRestore=null),this.updateDimensions(this._gameSize.width,this._gameSize.height,!0),this.resetCanvas())},fullScreenChange:function(a){this.event=
a;this.isFullScreen?(this.prepScreenMode(!0),this.updateLayout(),this.queueUpdate(!0),this.enterFullScreen.dispatch(this.width,this.height)):(this.prepScreenMode(!1),this.cleanupCreatedTarget(),this.updateLayout(),this.queueUpdate(!0),this.leaveFullScreen.dispatch(this.width,this.height));this.onFullScreenChange.dispatch(this)},fullScreenError:function(a){this.event=a;this.cleanupCreatedTarget();console.warn("Phaser.ScaleManager: requestFullscreen failed or device does not support the Fullscreen API");
this.onFullScreenError.dispatch(this)},scaleSprite:function(a,c,b,e){void 0===c&&(c=this.width);void 0===b&&(b=this.height);void 0===e&&(e=!1);if(!a||!a.scale)return a;a.scale.x=1;a.scale.y=1;if(0>=a.width||0>=a.height||0>=c||0>=b)return a;var g=a.height*c/a.width,l=a.width*b/a.height;(e=l>c?e:!e)?(a.width=Math.floor(c),a.height=Math.floor(g)):(a.width=Math.floor(l),a.height=Math.floor(b));return a},destroy:function(){this.game.onResume.remove(this._gameResumed,this);window.removeEventListener("orientationchange",
this._orientationChange,!1);window.removeEventListener("resize",this._windowResize,!1);this.compatibility.supportsFullScreen&&(document.removeEventListener("webkitfullscreenchange",this._fullScreenChange,!1),document.removeEventListener("mozfullscreenchange",this._fullScreenChange,!1),document.removeEventListener("MSFullscreenChange",this._fullScreenChange,!1),document.removeEventListener("fullscreenchange",this._fullScreenChange,!1),document.removeEventListener("webkitfullscreenerror",this._fullScreenError,
!1),document.removeEventListener("mozfullscreenerror",this._fullScreenError,!1),document.removeEventListener("MSFullscreenError",this._fullScreenError,!1),document.removeEventListener("fullscreenerror",this._fullScreenError,!1))}};b.ScaleManager.prototype.constructor=b.ScaleManager;Object.defineProperty(b.ScaleManager.prototype,"boundingParent",{get:function(){return this.parentIsWindow||this.isFullScreen&&!this._createdFullScreenTarget?null:this.game.canvas&&this.game.canvas.parentNode||null}});
Object.defineProperty(b.ScaleManager.prototype,"scaleMode",{get:function(){return this._scaleMode},set:function(a){a!==this._scaleMode&&(this.isFullScreen||(this.updateDimensions(this._gameSize.width,this._gameSize.height,!0),this.queueUpdate(!0)),this._scaleMode=a);return this._scaleMode}});Object.defineProperty(b.ScaleManager.prototype,"fullScreenScaleMode",{get:function(){return this._fullScreenScaleMode},set:function(a){a!==this._fullScreenScaleMode&&(this.isFullScreen?(this.prepScreenMode(!1),
this._fullScreenScaleMode=a,this.prepScreenMode(!0),this.queueUpdate(!0)):this._fullScreenScaleMode=a);return this._fullScreenScaleMode}});Object.defineProperty(b.ScaleManager.prototype,"currentScaleMode",{get:function(){return this.isFullScreen?this._fullScreenScaleMode:this._scaleMode}});Object.defineProperty(b.ScaleManager.prototype,"pageAlignHorizontally",{get:function(){return this._pageAlignHorizontally},set:function(a){a!==this._pageAlignHorizontally&&(this._pageAlignHorizontally=a,this.queueUpdate(!0))}});
Object.defineProperty(b.ScaleManager.prototype,"pageAlignVertically",{get:function(){return this._pageAlignVertically},set:function(a){a!==this._pageAlignVertically&&(this._pageAlignVertically=a,this.queueUpdate(!0))}});Object.defineProperty(b.ScaleManager.prototype,"isFullScreen",{get:function(){return!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)}});Object.defineProperty(b.ScaleManager.prototype,"isPortrait",{get:function(){return"portrait"===
this.classifyOrientation(this.screenOrientation)}});Object.defineProperty(b.ScaleManager.prototype,"isLandscape",{get:function(){return"landscape"===this.classifyOrientation(this.screenOrientation)}});Object.defineProperty(b.ScaleManager.prototype,"isGamePortrait",{get:function(){return this.height>this.width}});Object.defineProperty(b.ScaleManager.prototype,"isGameLandscape",{get:function(){return this.width>this.height}});b.Game=function(a,c,d,e,g,l,p,f){this.id=b.GAMES.push(this)-1;this.config=
null;this.physicsConfig=f;this.parent="";this.width=800;this.height=600;this.resolution=1;this._width=800;this._height=600;this.transparent=!1;this.antialias=!0;this.preserveDrawingBuffer=!1;this.renderer=null;this.renderType=b.AUTO;this.state=null;this.isRunning=this.isBooted=!1;this.rnd=this.plugins=this.physics=this.world=this.tweens=this.time=this.stage=this.sound=this.scale=this.net=this.math=this.load=this.input=this.cache=this.make=this.add=this.raf=null;this.device=b.Device;this.create=this.particles=
this.debug=this.context=this.canvas=this.camera=null;this.pendingStep=this.stepping=this.lockRender=!1;this.stepCount=0;this.onFocus=this.onBlur=this.onResume=this.onPause=null;this._codePaused=this._paused=!1;this.currentUpdateID=0;this.updatesThisFrame=1;this._spiraling=this._lastCount=this._deltaTime=0;this._kickstart=!0;this.fpsProblemNotifier=new b.Signal;this.forceSingleUpdate=!1;this._nextFpsNotification=0;1===arguments.length&&"object"===typeof arguments[0]?this.parseConfig(arguments[0]):
(this.config={enableDebug:!0},"undefined"!==typeof a&&(this._width=a),"undefined"!==typeof c&&(this._height=c),"undefined"!==typeof d&&(this.renderType=d),"undefined"!==typeof e&&(this.parent=e),"undefined"!==typeof l&&(this.transparent=l),"undefined"!==typeof p&&(this.antialias=p),this.rnd=new b.RandomDataGenerator([(Date.now()*Math.random()).toString()]),this.state=new b.StateManager(this,g));this.device.whenReady(this.boot,this);return this};b.Game.prototype={parseConfig:function(a){this.config=
a;void 0===a.enableDebug&&(this.config.enableDebug=!0);a.width&&(this._width=a.width);a.height&&(this._height=a.height);a.renderer&&(this.renderType=a.renderer);a.parent&&(this.parent=a.parent);a.transparent&&(this.transparent=a.transparent);a.antialias&&(this.antialias=a.antialias);a.resolution&&(this.resolution=a.resolution);a.preserveDrawingBuffer&&(this.preserveDrawingBuffer=a.preserveDrawingBuffer);a.physicsConfig&&(this.physicsConfig=a.physicsConfig);var c=[(Date.now()*Math.random()).toString()];
a.seed&&(c=a.seed);this.rnd=new b.RandomDataGenerator(c);c=null;a.state&&(c=a.state);this.state=new b.StateManager(this,c)},boot:function(){this.isBooted||(this.onPause=new b.Signal,this.onResume=new b.Signal,this.onBlur=new b.Signal,this.onFocus=new b.Signal,this.isBooted=!0,this.math=b.Math,this.scale=new b.ScaleManager(this,this._width,this._height),this.stage=new b.Stage(this),this.setUpRenderer(),this.world=new b.World(this),this.add=new b.GameObjectFactory(this),this.make=new b.GameObjectCreator(this),
this.cache=new b.Cache(this),this.load=new b.Loader(this),this.time=new b.Time(this),this.tweens=new b.TweenManager(this),this.input=new b.Input(this),this.sound=new b.SoundManager(this),this.physics=new b.Physics(this,this.physicsConfig),this.particles=new b.Particles(this),this.create=new b.Create(this),this.plugins=new b.PluginManager(this),this.net=new b.Net(this),this.time.boot(),this.stage.boot(),this.world.boot(),this.scale.boot(),this.input.boot(),this.sound.boot(),this.state.boot(),this.config.enableDebug?
(this.debug=new b.Utils.Debug(this),this.debug.boot()):this.debug={preUpdate:function(){},update:function(){},reset:function(){}},this.showDebugHeader(),this.isRunning=!0,this.raf=this.config&&this.config.forceSetTimeOut?new b.RequestAnimationFrame(this,this.config.forceSetTimeOut):new b.RequestAnimationFrame(this,!1),this._kickstart=!0,window.focus&&(!window.PhaserGlobal||window.PhaserGlobal&&!window.PhaserGlobal.stopFocus)&&window.focus(),this.raf.start())},showDebugHeader:function(){if(!window.PhaserGlobal||
!window.PhaserGlobal.hideBanner){var a=b.VERSION,c="Canvas",d="HTML Audio",e=1;this.renderType===b.WEBGL?(c="WebGL",e++):this.renderType==b.HEADLESS&&(c="Headless");this.device.webAudio&&(d="WebAudio",e++);if(this.device.chrome){a=["%c %c %c Phaser v"+a+" | Pixi.js "+PIXI.VERSION+" | "+c+" | "+d+"  %c %c %c http://phaser.io %c\u2665%c\u2665%c\u2665","background: #9854d8","background: #6c2ca7","color: #ffffff; background: #450f78;","background: #6c2ca7","background: #9854d8","background: #ffffff"];
for(c=0;3>c;c++)c<e?a.push("color: #ff2424; background: #fff"):a.push("color: #959595; background: #fff");console.log.apply(console,a)}else window.console&&console.log("Phaser v"+a+" | Pixi.js "+PIXI.VERSION+" | "+c+" | "+d+" | http://phaser.io")}},setUpRenderer:function(){this.canvas=this.config.canvasID?b.Canvas.create(this.width,this.height,this.config.canvasID):b.Canvas.create(this.width,this.height);this.config.canvasStyle?this.canvas.style=this.config.canvasStyle:this.canvas.style["-webkit-full-screen"]=
"width: 100%; height: 100%";this.device.cocoonJS&&(this.canvas.screencanvas=this.renderType===b.CANVAS?!0:!1);if(this.renderType===b.HEADLESS||this.renderType===b.CANVAS||this.renderType===b.AUTO&&!1===this.device.webGL)if(this.device.canvas)this.renderType===b.AUTO&&(this.renderType=b.CANVAS),this.renderer=new PIXI.CanvasRenderer(this.width,this.height,{view:this.canvas,transparent:this.transparent,resolution:this.resolution,clearBeforeRender:!0}),this.context=this.renderer.context;else throw Error("Phaser.Game - cannot create Canvas or WebGL context, aborting.");
else this.renderType=b.WEBGL,this.renderer=new PIXI.WebGLRenderer(this.width,this.height,{view:this.canvas,transparent:this.transparent,resolution:this.resolution,antialias:this.antialias,preserveDrawingBuffer:this.preserveDrawingBuffer}),this.context=null,this.canvas.addEventListener("webglcontextlost",this.contextLost.bind(this),!1),this.canvas.addEventListener("webglcontextrestored",this.contextRestored.bind(this),!1);this.renderType!==b.HEADLESS&&(this.stage.smoothed=this.antialias,b.Canvas.addToDOM(this.canvas,
this.parent,!1),b.Canvas.setTouchAction(this.canvas))},contextLost:function(a){a.preventDefault();this.renderer.contextLost=!0},contextRestored:function(){this.renderer.initContext();this.cache.clearGLTextures();this.renderer.contextLost=!1},update:function(a){this.time.update(a);if(this._kickstart)this.updateLogic(1/this.time.desiredFps),this.stage.updateTransform(),this.updateRender(this.time.slowMotion*this.time.desiredFps),this._kickstart=!1;else if(1<this._spiraling&&!this.forceSingleUpdate)this.time.time>
this._nextFpsNotification&&(this._nextFpsNotification=this.time.time+1E4,this.fpsProblemNotifier.dispatch()),this._spiraling=this._deltaTime=0,this.updateRender(this.time.slowMotion*this.time.desiredFps);else{a=1E3*this.time.slowMotion/this.time.desiredFps;this._deltaTime+=Math.max(Math.min(3*a,this.time.elapsed),0);var c=0;this.updatesThisFrame=Math.floor(this._deltaTime/a);this.forceSingleUpdate&&(this.updatesThisFrame=Math.min(1,this.updatesThisFrame));for(;this._deltaTime>=a&&(this._deltaTime-=
a,this.currentUpdateID=c,this.updateLogic(1/this.time.desiredFps),this.stage.updateTransform(),c++,!this.forceSingleUpdate||1!==c););c>this._lastCount?this._spiraling++:c<this._lastCount&&(this._spiraling=0);this._lastCount=c;this.updateRender(this._deltaTime/a)}},updateLogic:function(a){this._paused||this.pendingStep?(this.scale.pauseUpdate(),this.state.pauseUpdate(),this.debug.preUpdate()):(this.stepping&&(this.pendingStep=!0),this.scale.preUpdate(),this.debug.preUpdate(),this.world.camera.preUpdate(),
this.physics.preUpdate(),this.state.preUpdate(a),this.plugins.preUpdate(a),this.stage.preUpdate(),this.state.update(),this.stage.update(),this.tweens.update(a),this.sound.update(),this.input.update(),this.physics.update(),this.particles.update(),this.plugins.update(),this.stage.postUpdate(),this.plugins.postUpdate())},updateRender:function(a){this.lockRender||(this.state.preRender(a),this.renderer.render(this.stage),this.plugins.render(a),this.state.render(a),this.plugins.postRender(a))},enableStep:function(){this.stepping=
!0;this.pendingStep=!1;this.stepCount=0},disableStep:function(){this.pendingStep=this.stepping=!1},step:function(){this.pendingStep=!1;this.stepCount++},destroy:function(){this.raf.stop();this.state.destroy();this.sound.destroy();this.scale.destroy();this.stage.destroy();this.input.destroy();this.physics.destroy();this.world=this.time=this.stage=this.sound=this.load=this.input=this.cache=this.state=null;this.isBooted=!1;this.renderer.destroy(!1);b.Canvas.removeFromDOM(this.canvas);b.GAMES[this.id]=
null},gamePaused:function(a){this._paused||(this._paused=!0,this.time.gamePaused(),this.sound.setMute(),this.onPause.dispatch(a),this.device.cordova&&this.device.iOS&&(this.lockRender=!0))},gameResumed:function(a){this._paused&&!this._codePaused&&(this._paused=!1,this.time.gameResumed(),this.input.reset(),this.sound.unsetMute(),this.onResume.dispatch(a),this.device.cordova&&this.device.iOS&&(this.lockRender=!1))},focusLoss:function(a){this.onBlur.dispatch(a);this.stage.disableVisibilityChange||this.gamePaused(a)},
focusGain:function(a){this.onFocus.dispatch(a);this.stage.disableVisibilityChange||this.gameResumed(a)}};b.Game.prototype.constructor=b.Game;Object.defineProperty(b.Game.prototype,"paused",{get:function(){return this._paused},set:function(a){!0===a?(!1===this._paused&&(this._paused=!0,this.sound.setMute(),this.time.gamePaused(),this.onPause.dispatch(this)),this._codePaused=!0):(this._paused&&(this._paused=!1,this.input.reset(),this.sound.unsetMute(),this.time.gameResumed(),this.onResume.dispatch(this)),
this._codePaused=!1)}});b.Input=function(a){this.game=a;this.hitContext=this.hitCanvas=null;this.moveCallbacks=[];this.pollRate=0;this.enabled=!0;this.multiInputOverride=b.Input.MOUSE_TOUCH_COMBINE;this.scale=this.circle=this.speed=this.position=null;this.maxPointers=-1;this.tapRate=200;this.doubleTapRate=300;this.holdRate=2E3;this.justReleasedRate=this.justPressedRate=200;this.recordPointerHistory=!1;this.recordLimit=this.recordRate=100;this.pointer10=this.pointer9=this.pointer8=this.pointer7=this.pointer6=
this.pointer5=this.pointer4=this.pointer3=this.pointer2=this.pointer1=null;this.pointers=[];this.gamepad=this.mspointer=this.touch=this.keyboard=this.mouse=this.mousePointer=this.activePointer=null;this.resetLocked=!1;this.onHold=this.onTap=this.onUp=this.onDown=null;this.minPriorityID=0;this.interactiveItems=new b.ArraySet;this._localPoint=new b.Point;this._pollCounter=0;this._oldPosition=null;this._y=this._x=0};b.Input.MOUSE_OVERRIDES_TOUCH=0;b.Input.TOUCH_OVERRIDES_MOUSE=1;b.Input.MOUSE_TOUCH_COMBINE=
2;b.Input.MAX_POINTERS=10;b.Input.prototype={boot:function(){this.mousePointer=new b.Pointer(this.game,0);this.addPointer();this.addPointer();this.mouse=new b.Mouse(this.game);this.touch=new b.Touch(this.game);this.mspointer=new b.MSPointer(this.game);b.Keyboard&&(this.keyboard=new b.Keyboard(this.game));b.Gamepad&&(this.gamepad=new b.Gamepad(this.game));this.onDown=new b.Signal;this.onUp=new b.Signal;this.onTap=new b.Signal;this.onHold=new b.Signal;this.scale=new b.Point(1,1);this.speed=new b.Point;
this.position=new b.Point;this._oldPosition=new b.Point;this.circle=new b.Circle(0,0,44);this.activePointer=this.mousePointer;this.hitCanvas=document.createElement("canvas");this.hitCanvas.width=1;this.hitCanvas.height=1;this.hitContext=this.hitCanvas.getContext("2d");this.mouse.start();this.touch.start();this.mspointer.start();this.mousePointer.active=!0;this.keyboard&&this.keyboard.start();var a=this;this._onClickTrampoline=function(c){a.onClickTrampoline(c)};this.game.canvas.addEventListener("click",
this._onClickTrampoline,!1)},destroy:function(){this.mouse.stop();this.touch.stop();this.mspointer.stop();this.keyboard&&this.keyboard.stop();this.gamepad&&this.gamepad.stop();this.moveCallbacks=[];this.game.canvas.removeEventListener("click",this._onClickTrampoline)},addMoveCallback:function(a,c){this.moveCallbacks.push({callback:a,context:c})},deleteMoveCallback:function(a,c){for(var b=this.moveCallbacks.length;b--;)if(this.moveCallbacks[b].callback===a&&this.moveCallbacks[b].context===c){this.moveCallbacks.splice(b,
1);break}},addPointer:function(){if(this.pointers.length>=b.Input.MAX_POINTERS)return console.warn("Phaser.Input.addPointer: Maximum limit of "+b.Input.MAX_POINTERS+" pointers reached."),null;var a=this.pointers.length+1,c=new b.Pointer(this.game,a);this.pointers.push(c);return this["pointer"+a]=c},update:function(){this.keyboard&&this.keyboard.update();if(0<this.pollRate&&this._pollCounter<this.pollRate)this._pollCounter++;else{this.speed.x=this.position.x-this._oldPosition.x;this.speed.y=this.position.y-
this._oldPosition.y;this._oldPosition.copyFrom(this.position);this.mousePointer.update();this.gamepad&&this.gamepad.active&&this.gamepad.update();for(var a=0;a<this.pointers.length;a++)this.pointers[a].update();this._pollCounter=0}},reset:function(a){if(this.game.isBooted&&!this.resetLocked){void 0===a&&(a=!1);this.mousePointer.reset();this.keyboard&&this.keyboard.reset(a);this.gamepad&&this.gamepad.reset();for(var c=0;c<this.pointers.length;c++)this.pointers[c].reset();"none"!==this.game.canvas.style.cursor&&
(this.game.canvas.style.cursor="inherit");a&&(this.onDown.dispose(),this.onUp.dispose(),this.onTap.dispose(),this.onHold.dispose(),this.onDown=new b.Signal,this.onUp=new b.Signal,this.onTap=new b.Signal,this.onHold=new b.Signal,this.moveCallbacks=[]);this._pollCounter=0}},resetSpeed:function(a,c){this._oldPosition.setTo(a,c);this.speed.setTo(0,0)},startPointer:function(a){if(0<=this.maxPointers&&this.countActivePointers(this.maxPointers)>=this.maxPointers)return null;if(!this.pointer1.active)return this.pointer1.start(a);
if(!this.pointer2.active)return this.pointer2.start(a);for(var c=2;c<this.pointers.length;c++){var b=this.pointers[c];if(!b.active)return b.start(a)}return null},updatePointer:function(a){if(this.pointer1.active&&this.pointer1.identifier===a.identifier)return this.pointer1.move(a);if(this.pointer2.active&&this.pointer2.identifier===a.identifier)return this.pointer2.move(a);for(var c=2;c<this.pointers.length;c++){var b=this.pointers[c];if(b.active&&b.identifier===a.identifier)return b.move(a)}return null},
stopPointer:function(a){if(this.pointer1.active&&this.pointer1.identifier===a.identifier)return this.pointer1.stop(a);if(this.pointer2.active&&this.pointer2.identifier===a.identifier)return this.pointer2.stop(a);for(var c=2;c<this.pointers.length;c++){var b=this.pointers[c];if(b.active&&b.identifier===a.identifier)return b.stop(a)}return null},countActivePointers:function(a){void 0===a&&(a=this.pointers.length);for(var c=a,b=0;b<this.pointers.length&&0<c;b++)this.pointers[b].active&&c--;return a-
c},getPointer:function(a){void 0===a&&(a=!1);for(var c=0;c<this.pointers.length;c++){var b=this.pointers[c];if(b.active===a)return b}return null},getPointerFromIdentifier:function(a){for(var c=0;c<this.pointers.length;c++){var b=this.pointers[c];if(b.identifier===a)return b}return null},getPointerFromId:function(a){for(var c=0;c<this.pointers.length;c++){var b=this.pointers[c];if(b.pointerId===a)return b}return null},getLocalPosition:function(a,c,d){void 0===d&&(d=new b.Point);a=a.worldTransform;
var e=1/(a.a*a.d+a.c*-a.b);return d.setTo(a.d*e*c.x+-a.c*e*c.y+(a.ty*a.c-a.tx*a.d)*e,a.a*e*c.y+-a.b*e*c.x+(-a.ty*a.a+a.tx*a.b)*e)},hitTest:function(a,c,d){if(!a.worldVisible)return!1;this.getLocalPosition(a,c,this._localPoint);d.copyFrom(this._localPoint);if(a.hitArea&&a.hitArea.contains)return a.hitArea.contains(this._localPoint.x,this._localPoint.y);if(a instanceof b.TileSprite){var e=a.width,g=a.height,l=-e*a.anchor.x;if(this._localPoint.x>=l&&this._localPoint.x<l+e&&(e=-g*a.anchor.y,this._localPoint.y>=
e&&this._localPoint.y<e+g))return!0}else if(a instanceof PIXI.Sprite){if(e=a.texture.frame.width,g=a.texture.frame.height,l=-e*a.anchor.x,this._localPoint.x>=l&&this._localPoint.x<l+e&&(e=-g*a.anchor.y,this._localPoint.y>=e&&this._localPoint.y<e+g))return!0}else if(a instanceof b.Graphics)for(g=0;g<a.graphicsData.length;g++)if(e=a.graphicsData[g],e.fill&&e.shape&&e.shape.contains(this._localPoint.x,this._localPoint.y))return!0;g=0;for(e=a.children.length;g<e;g++)if(this.hitTest(a.children[g],c,d))return!0;
return!1},onClickTrampoline:function(){this.activePointer.processClickTrampolines()}};b.Input.prototype.constructor=b.Input;Object.defineProperty(b.Input.prototype,"x",{get:function(){return this._x},set:function(a){this._x=Math.floor(a)}});Object.defineProperty(b.Input.prototype,"y",{get:function(){return this._y},set:function(a){this._y=Math.floor(a)}});Object.defineProperty(b.Input.prototype,"pollLocked",{get:function(){return 0<this.pollRate&&this._pollCounter<this.pollRate}});Object.defineProperty(b.Input.prototype,
"totalInactivePointers",{get:function(){return this.pointers.length-this.countActivePointers()}});Object.defineProperty(b.Input.prototype,"totalActivePointers",{get:function(){return this.countActivePointers()}});Object.defineProperty(b.Input.prototype,"worldX",{get:function(){return this.game.camera.view.x+this.x}});Object.defineProperty(b.Input.prototype,"worldY",{get:function(){return this.game.camera.view.y+this.y}});b.Mouse=function(a){this.game=a;this.input=a.input;this.callbackContext=this.game;
this.mouseWheelCallback=this.mouseOverCallback=this.mouseOutCallback=this.mouseUpCallback=this.mouseDownCallback=null;this.capture=!1;this.button=-1;this.wheelDelta=0;this.enabled=!0;this.stopOnGameOut=this.locked=!1;this.pointerLock=new b.Signal;this._wheelEvent=this._onMouseWheel=this._onMouseOver=this._onMouseOut=this._onMouseUp=this._onMouseMove=this._onMouseDown=this.event=null};b.Mouse.NO_BUTTON=-1;b.Mouse.LEFT_BUTTON=0;b.Mouse.MIDDLE_BUTTON=1;b.Mouse.RIGHT_BUTTON=2;b.Mouse.BACK_BUTTON=3;b.Mouse.FORWARD_BUTTON=
4;b.Mouse.WHEEL_UP=1;b.Mouse.WHEEL_DOWN=-1;b.Mouse.prototype={start:function(){if((!this.game.device.android||!1!==this.game.device.chrome)&&null===this._onMouseDown){var a=this;this._onMouseDown=function(c){return a.onMouseDown(c)};this._onMouseMove=function(c){return a.onMouseMove(c)};this._onMouseUp=function(c){return a.onMouseUp(c)};this._onMouseUpGlobal=function(c){return a.onMouseUpGlobal(c)};this._onMouseOut=function(c){return a.onMouseOut(c)};this._onMouseOver=function(c){return a.onMouseOver(c)};
this._onMouseWheel=function(c){return a.onMouseWheel(c)};var c=this.game.canvas;c.addEventListener("mousedown",this._onMouseDown,!0);c.addEventListener("mousemove",this._onMouseMove,!0);c.addEventListener("mouseup",this._onMouseUp,!0);this.game.device.cocoonJS||(window.addEventListener("mouseup",this._onMouseUpGlobal,!0),c.addEventListener("mouseover",this._onMouseOver,!0),c.addEventListener("mouseout",this._onMouseOut,!0));var b=this.game.device.wheelEvent;b&&(c.addEventListener(b,this._onMouseWheel,
!0),"mousewheel"===b?this._wheelEvent=new f(-.025,1):"DOMMouseScroll"===b&&(this._wheelEvent=new f(1,1)))}},onMouseDown:function(a){this.event=a;this.capture&&a.preventDefault();this.mouseDownCallback&&this.mouseDownCallback.call(this.callbackContext,a);this.input.enabled&&this.enabled&&(a.identifier=0,this.input.mousePointer.start(a))},onMouseMove:function(a){this.event=a;this.capture&&a.preventDefault();this.mouseMoveCallback&&this.mouseMoveCallback.call(this.callbackContext,a);this.input.enabled&&
this.enabled&&(a.identifier=0,this.input.mousePointer.move(a))},onMouseUp:function(a){this.event=a;this.capture&&a.preventDefault();this.mouseUpCallback&&this.mouseUpCallback.call(this.callbackContext,a);this.input.enabled&&this.enabled&&(a.identifier=0,this.input.mousePointer.stop(a))},onMouseUpGlobal:function(a){this.input.mousePointer.withinGame||(this.mouseUpCallback&&this.mouseUpCallback.call(this.callbackContext,a),a.identifier=0,this.input.mousePointer.stop(a))},onMouseOut:function(a){this.event=
a;this.capture&&a.preventDefault();this.input.mousePointer.withinGame=!1;this.mouseOutCallback&&this.mouseOutCallback.call(this.callbackContext,a);this.input.enabled&&this.enabled&&this.stopOnGameOut&&(a.identifier=0,this.input.mousePointer.stop(a))},onMouseWheel:function(a){this._wheelEvent&&(a=this._wheelEvent.bindEvent(a));this.event=a;this.capture&&a.preventDefault();this.wheelDelta=b.Math.clamp(-a.deltaY,-1,1);this.mouseWheelCallback&&this.mouseWheelCallback.call(this.callbackContext,a)},onMouseOver:function(a){this.event=
a;this.capture&&a.preventDefault();this.input.mousePointer.withinGame=!0;this.mouseOverCallback&&this.mouseOverCallback.call(this.callbackContext,a)},requestPointerLock:function(){if(this.game.device.pointerLock){var a=this.game.canvas;a.requestPointerLock=a.requestPointerLock||a.mozRequestPointerLock||a.webkitRequestPointerLock;a.requestPointerLock();var c=this;this._pointerLockChange=function(a){return c.pointerLockChange(a)};document.addEventListener("pointerlockchange",this._pointerLockChange,
!0);document.addEventListener("mozpointerlockchange",this._pointerLockChange,!0);document.addEventListener("webkitpointerlockchange",this._pointerLockChange,!0)}},pointerLockChange:function(a){var c=this.game.canvas;document.pointerLockElement===c||document.mozPointerLockElement===c||document.webkitPointerLockElement===c?(this.locked=!0,this.pointerLock.dispatch(!0,a)):(this.locked=!1,this.pointerLock.dispatch(!1,a))},releasePointerLock:function(){document.exitPointerLock=document.exitPointerLock||
document.mozExitPointerLock||document.webkitExitPointerLock;document.exitPointerLock();document.removeEventListener("pointerlockchange",this._pointerLockChange,!0);document.removeEventListener("mozpointerlockchange",this._pointerLockChange,!0);document.removeEventListener("webkitpointerlockchange",this._pointerLockChange,!0)},stop:function(){var a=this.game.canvas;a.removeEventListener("mousedown",this._onMouseDown,!0);a.removeEventListener("mousemove",this._onMouseMove,!0);a.removeEventListener("mouseup",
this._onMouseUp,!0);a.removeEventListener("mouseover",this._onMouseOver,!0);a.removeEventListener("mouseout",this._onMouseOut,!0);var c=this.game.device.wheelEvent;c&&a.removeEventListener(c,this._onMouseWheel,!0);window.removeEventListener("mouseup",this._onMouseUpGlobal,!0);document.removeEventListener("pointerlockchange",this._pointerLockChange,!0);document.removeEventListener("mozpointerlockchange",this._pointerLockChange,!0);document.removeEventListener("webkitpointerlockchange",this._pointerLockChange,
!0)}};b.Mouse.prototype.constructor=b.Mouse;f.prototype={};f.prototype.constructor=f;f.prototype.bindEvent=function(a){if(!f._stubsGenerated&&a){var c=function(a){return function(){var c=this.originalEvent[a];return"function"!==typeof c?c:c.bind(this.originalEvent)}},b;for(b in a)b in f.prototype||Object.defineProperty(f.prototype,b,{get:c(b)});f._stubsGenerated=!0}this.originalEvent=a;return this};Object.defineProperties(f.prototype,{type:{value:"wheel"},deltaMode:{get:function(){return this._deltaMode}},
deltaY:{get:function(){return this._scaleFactor*(this.originalEvent.wheelDelta||this.originalEvent.detail)||0}},deltaX:{get:function(){return this._scaleFactor*this.originalEvent.wheelDeltaX||0}},deltaZ:{value:0}});b.MSPointer=function(a){this.game=a;this.input=a.input;this.callbackContext=this.game;this.pointerUpCallback=this.pointerMoveCallback=this.pointerDownCallback=null;this.capture=!0;this.button=-1;this.event=null;this.enabled=!0;this._onMSPointerUp=this._onMSPointerMove=this._onMSPointerDown=
null};b.MSPointer.prototype={start:function(){if(null===this._onMSPointerDown){var a=this;if(this.game.device.mspointer){this._onMSPointerDown=function(c){return a.onPointerDown(c)};this._onMSPointerMove=function(c){return a.onPointerMove(c)};this._onMSPointerUp=function(c){return a.onPointerUp(c)};var c=this.game.canvas;c.addEventListener("MSPointerDown",this._onMSPointerDown,!1);c.addEventListener("MSPointerMove",this._onMSPointerMove,!1);c.addEventListener("MSPointerUp",this._onMSPointerUp,!1);
c.addEventListener("pointerDown",this._onMSPointerDown,!1);c.addEventListener("pointerMove",this._onMSPointerMove,!1);c.addEventListener("pointerUp",this._onMSPointerUp,!1);c.style["-ms-content-zooming"]="none";c.style["-ms-touch-action"]="none"}}},onPointerDown:function(a){this.event=a;this.capture&&a.preventDefault();this.pointerDownCallback&&this.pointerDownCallback.call(this.callbackContext,a);this.input.enabled&&this.enabled&&(a.identifier=a.pointerId,"mouse"===a.pointerType||4===a.pointerType?
this.input.mousePointer.start(a):this.input.startPointer(a))},onPointerMove:function(a){this.event=a;this.capture&&a.preventDefault();this.pointerMoveCallback&&this.pointerMoveCallback.call(this.callbackContext,a);this.input.enabled&&this.enabled&&(a.identifier=a.pointerId,"mouse"===a.pointerType||4===a.pointerType?this.input.mousePointer.move(a):this.input.updatePointer(a))},onPointerUp:function(a){this.event=a;this.capture&&a.preventDefault();this.pointerUpCallback&&this.pointerUpCallback.call(this.callbackContext,
a);this.input.enabled&&this.enabled&&(a.identifier=a.pointerId,"mouse"===a.pointerType||4===a.pointerType?this.input.mousePointer.stop(a):this.input.stopPointer(a))},stop:function(){var a=this.game.canvas;a.removeEventListener("MSPointerDown",this._onMSPointerDown);a.removeEventListener("MSPointerMove",this._onMSPointerMove);a.removeEventListener("MSPointerUp",this._onMSPointerUp);a.removeEventListener("pointerDown",this._onMSPointerDown);a.removeEventListener("pointerMove",this._onMSPointerMove);
a.removeEventListener("pointerUp",this._onMSPointerUp)}};b.MSPointer.prototype.constructor=b.MSPointer;b.DeviceButton=function(a,c){this.parent=a;this.game=a.game;this.event=null;this.isDown=!1;this.isUp=!0;this.repeats=this.timeUp=this.duration=this.timeDown=0;this.ctrlKey=this.shiftKey=this.altKey=!1;this.value=0;this.buttonCode=c;this.onDown=new b.Signal;this.onUp=new b.Signal;this.onFloat=new b.Signal};b.DeviceButton.prototype={start:function(a,c){this.isDown||(this.isDown=!0,this.isUp=!1,this.timeDown=
this.game.time.time,this.repeats=this.duration=0,this.event=a,this.value=c,a&&(this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.ctrlKey=a.ctrlKey),this.onDown.dispatch(this,c))},stop:function(a,c){this.isUp||(this.isDown=!1,this.isUp=!0,this.timeUp=this.game.time.time,this.event=a,this.value=c,a&&(this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.ctrlKey=a.ctrlKey),this.onUp.dispatch(this,c))},padFloat:function(a){this.value=a;this.onFloat.dispatch(this,a)},justPressed:function(a){return this.isDown&&
this.timeDown+(a||250)>this.game.time.time},justReleased:function(a){return this.isUp&&this.timeUp+(a||250)>this.game.time.time},reset:function(){this.isDown=!1;this.isUp=!0;this.timeDown=this.game.time.time;this.repeats=this.duration=0;this.ctrlKey=this.shiftKey=this.altKey=!1},destroy:function(){this.onDown.dispose();this.onUp.dispose();this.onFloat.dispose();this.game=this.parent=null}};b.DeviceButton.prototype.constructor=b.DeviceButton;Object.defineProperty(b.DeviceButton.prototype,"duration",
{get:function(){return this.isUp?-1:this.game.time.time-this.timeDown}});b.Pointer=function(a,c){this.game=a;this.id=c;this.type=b.POINTER;this.exists=!0;this.identifier=0;this.button=this.target=this.pointerId=null;this.leftButton=new b.DeviceButton(this,b.Pointer.LEFT_BUTTON);this.middleButton=new b.DeviceButton(this,b.Pointer.MIDDLE_BUTTON);this.rightButton=new b.DeviceButton(this,b.Pointer.RIGHT_BUTTON);this.backButton=new b.DeviceButton(this,b.Pointer.BACK_BUTTON);this.forwardButton=new b.DeviceButton(this,
b.Pointer.FORWARD_BUTTON);this.eraserButton=new b.DeviceButton(this,b.Pointer.ERASER_BUTTON);this._holdSent=!1;this._history=[];this._nextDrop=0;this.withinGame=this._stateReset=!1;this.screenY=this.screenX=this.pageY=this.pageX=this.clientY=this.clientX=-1;this.movementY=this.movementX=this.rawMovementY=this.rawMovementX=0;this.y=this.x=-1;this.isMouse=0===c;this.isDown=!1;this.isUp=!0;this.totalTouches=this.previousTapTime=this.timeUp=this.timeDown=0;this.msSinceLastClick=Number.MAX_VALUE;this.targetObject=
null;this.dirty=this.active=!1;this.position=new b.Point;this.positionDown=new b.Point;this.positionUp=new b.Point;this.circle=new b.Circle(0,0,44);this._trampolineTargetObject=this._clickTrampolines=null};b.Pointer.NO_BUTTON=0;b.Pointer.LEFT_BUTTON=1;b.Pointer.RIGHT_BUTTON=2;b.Pointer.MIDDLE_BUTTON=4;b.Pointer.BACK_BUTTON=8;b.Pointer.FORWARD_BUTTON=16;b.Pointer.ERASER_BUTTON=32;b.Pointer.prototype={resetButtons:function(){this.isDown=!1;this.isUp=!0;this.isMouse&&(this.leftButton.reset(),this.middleButton.reset(),
this.rightButton.reset(),this.backButton.reset(),this.forwardButton.reset(),this.eraserButton.reset())},processButtonsDown:function(a,c){b.Pointer.LEFT_BUTTON&a&&this.leftButton.start(c);b.Pointer.RIGHT_BUTTON&a&&this.rightButton.start(c);b.Pointer.MIDDLE_BUTTON&a&&this.middleButton.start(c);b.Pointer.BACK_BUTTON&a&&this.backButton.start(c);b.Pointer.FORWARD_BUTTON&a&&this.forwardButton.start(c);b.Pointer.ERASER_BUTTON&a&&this.eraserButton.start(c)},processButtonsUp:function(a,c){a===b.Mouse.LEFT_BUTTON&&
this.leftButton.stop(c);a===b.Mouse.RIGHT_BUTTON&&this.rightButton.stop(c);a===b.Mouse.MIDDLE_BUTTON&&this.middleButton.stop(c);a===b.Mouse.BACK_BUTTON&&this.backButton.stop(c);a===b.Mouse.FORWARD_BUTTON&&this.forwardButton.stop(c);5===a&&this.eraserButton.stop(c)},updateButtons:function(a){this.button=a.button;var c="down"===a.type.toLowerCase().substr(-4);void 0!==a.buttons?c?this.processButtonsDown(a.buttons,a):this.processButtonsUp(a.button,a):c?this.leftButton.start(a):(this.leftButton.stop(a),
this.rightButton.stop(a));a.ctrlKey&&this.leftButton.isDown&&this.rightButton.start(a);this.isUp=!0;this.isDown=!1;if(this.leftButton.isDown||this.rightButton.isDown||this.middleButton.isDown||this.backButton.isDown||this.forwardButton.isDown||this.eraserButton.isDown)this.isUp=!1,this.isDown=!0},start:function(a){a.pointerId&&(this.pointerId=a.pointerId);this.identifier=a.identifier;this.target=a.target;this.isMouse?this.updateButtons(a):(this.isDown=!0,this.isUp=!1);this._history=[];this.withinGame=
this.active=!0;this.dirty=!1;this._trampolineTargetObject=this._clickTrampolines=null;this.msSinceLastClick=this.game.time.time-this.timeDown;this.timeDown=this.game.time.time;this._holdSent=!1;this.move(a,!0);this.positionDown.setTo(this.x,this.y);if(this.game.input.multiInputOverride===b.Input.MOUSE_OVERRIDES_TOUCH||this.game.input.multiInputOverride===b.Input.MOUSE_TOUCH_COMBINE||this.game.input.multiInputOverride===b.Input.TOUCH_OVERRIDES_MOUSE&&0===this.game.input.totalActivePointers)this.game.input.x=
this.x,this.game.input.y=this.y,this.game.input.position.setTo(this.x,this.y),this.game.input.onDown.dispatch(this,a),this.game.input.resetSpeed(this.x,this.y);this._stateReset=!1;this.totalTouches++;null!==this.targetObject&&this.targetObject._touchedHandler(this);return this},update:function(){this.active&&(this.dirty&&(0<this.game.input.interactiveItems.total&&this.processInteractiveObjects(!1),this.dirty=!1),!1===this._holdSent&&this.duration>=this.game.input.holdRate&&((this.game.input.multiInputOverride===
b.Input.MOUSE_OVERRIDES_TOUCH||this.game.input.multiInputOverride===b.Input.MOUSE_TOUCH_COMBINE||this.game.input.multiInputOverride===b.Input.TOUCH_OVERRIDES_MOUSE&&0===this.game.input.totalActivePointers)&&this.game.input.onHold.dispatch(this),this._holdSent=!0),this.game.input.recordPointerHistory&&this.game.time.time>=this._nextDrop&&(this._nextDrop=this.game.time.time+this.game.input.recordRate,this._history.push({x:this.position.x,y:this.position.y}),this._history.length>this.game.input.recordLimit&&
this._history.shift()))},move:function(a,c){if(!this.game.input.pollLocked){void 0===c&&(c=!1);void 0!==a.button&&(this.button=a.button);c&&this.isMouse&&this.updateButtons(a);this.clientX=a.clientX;this.clientY=a.clientY;this.pageX=a.pageX;this.pageY=a.pageY;this.screenX=a.screenX;this.screenY=a.screenY;this.isMouse&&this.game.input.mouse.locked&&!c&&(this.rawMovementX=a.movementX||a.mozMovementX||a.webkitMovementX||0,this.rawMovementY=a.movementY||a.mozMovementY||a.webkitMovementY||0,this.movementX+=
this.rawMovementX,this.movementY+=this.rawMovementY);this.x=(this.pageX-this.game.scale.offset.x)*this.game.input.scale.x;this.y=(this.pageY-this.game.scale.offset.y)*this.game.input.scale.y;this.position.setTo(this.x,this.y);this.circle.x=this.x;this.circle.y=this.y;if(this.game.input.multiInputOverride===b.Input.MOUSE_OVERRIDES_TOUCH||this.game.input.multiInputOverride===b.Input.MOUSE_TOUCH_COMBINE||this.game.input.multiInputOverride===b.Input.TOUCH_OVERRIDES_MOUSE&&0===this.game.input.totalActivePointers)this.game.input.activePointer=
this,this.game.input.x=this.x,this.game.input.y=this.y,this.game.input.position.setTo(this.game.input.x,this.game.input.y),this.game.input.circle.x=this.game.input.x,this.game.input.circle.y=this.game.input.y;this.withinGame=this.game.scale.bounds.contains(this.pageX,this.pageY);if(this.game.paused)return this;for(var d=this.game.input.moveCallbacks.length;d--;)this.game.input.moveCallbacks[d].callback.call(this.game.input.moveCallbacks[d].context,this,this.x,this.y,c);null!==this.targetObject&&!0===
this.targetObject.isDragged?!1===this.targetObject.update(this)&&(this.targetObject=null):0<this.game.input.interactiveItems.total&&this.processInteractiveObjects(c);return this}},processInteractiveObjects:function(a){for(var c=Number.MAX_VALUE,b=-1,e=null,g=this.game.input.interactiveItems.first;g;)g.checked=!1,g.validForInput(b,c,!1)&&(g.checked=!0,a&&g.checkPointerDown(this,!0)||!a&&g.checkPointerOver(this,!0))&&(c=g.sprite.renderOrderID,b=g.priorityID,e=g),g=this.game.input.interactiveItems.next;
for(g=this.game.input.interactiveItems.first;g;)!g.checked&&g.validForInput(b,c,!0)&&(a&&g.checkPointerDown(this,!1)||!a&&g.checkPointerOver(this,!1))&&(c=g.sprite.renderOrderID,b=g.priorityID,e=g),g=this.game.input.interactiveItems.next;null===e?this.targetObject&&(this.targetObject._pointerOutHandler(this),this.targetObject=null):null===this.targetObject?(this.targetObject=e,e._pointerOverHandler(this)):this.targetObject===e?!1===e.update(this)&&(this.targetObject=null):(this.targetObject._pointerOutHandler(this),
this.targetObject=e,this.targetObject._pointerOverHandler(this));return null!==this.targetObject},leave:function(a){this.withinGame=!1;this.move(a,!1)},stop:function(a){if(this._stateReset&&this.withinGame)a.preventDefault();else{this.isMouse?this.updateButtons(a):(this.isDown=!1,this.isUp=!0);this.timeUp=this.game.time.time;if(this.game.input.multiInputOverride===b.Input.MOUSE_OVERRIDES_TOUCH||this.game.input.multiInputOverride===b.Input.MOUSE_TOUCH_COMBINE||this.game.input.multiInputOverride===
b.Input.TOUCH_OVERRIDES_MOUSE&&0===this.game.input.totalActivePointers)this.game.input.onUp.dispatch(this,a),0<=this.duration&&this.duration<=this.game.input.tapRate&&(this.timeUp-this.previousTapTime<this.game.input.doubleTapRate?this.game.input.onTap.dispatch(this,!0):this.game.input.onTap.dispatch(this,!1),this.previousTapTime=this.timeUp);0<this.id&&(this.active=!1);this.withinGame=!1;this.identifier=this.pointerId=null;this.positionUp.setTo(this.x,this.y);!1===this.isMouse&&this.game.input.currentPointers--;
this.game.input.interactiveItems.callAll("_releasedHandler",this);this._clickTrampolines&&(this._trampolineTargetObject=this.targetObject);this.targetObject=null;return this}},justPressed:function(a){a=a||this.game.input.justPressedRate;return!0===this.isDown&&this.timeDown+a>this.game.time.time},justReleased:function(a){a=a||this.game.input.justReleasedRate;return this.isUp&&this.timeUp+a>this.game.time.time},addClickTrampoline:function(a,c,b,e){if(this.isDown){for(var g=this._clickTrampolines=this._clickTrampolines||
[],l=0;l<g.length;l++)if(g[l].name===a){g.splice(l,1);break}g.push({name:a,targetObject:this.targetObject,callback:c,callbackContext:b,callbackArgs:e})}},processClickTrampolines:function(){var a=this._clickTrampolines;if(a){for(var c=0;c<a.length;c++){var b=a[c];b.targetObject===this._trampolineTargetObject&&b.callback.apply(b.callbackContext,b.callbackArgs)}this._trampolineTargetObject=this._clickTrampolines=null}},reset:function(){!1===this.isMouse&&(this.active=!1);this.identifier=this.pointerId=
null;this.dirty=!1;this.totalTouches=0;this._holdSent=!1;this._history.length=0;this._stateReset=!0;this.resetButtons();this.targetObject&&this.targetObject._releasedHandler(this);this.targetObject=null},resetMovement:function(){this.movementY=this.movementX=0}};b.Pointer.prototype.constructor=b.Pointer;Object.defineProperty(b.Pointer.prototype,"duration",{get:function(){return this.isUp?-1:this.game.time.time-this.timeDown}});Object.defineProperty(b.Pointer.prototype,"worldX",{get:function(){return this.game.world.camera.x+
this.x}});Object.defineProperty(b.Pointer.prototype,"worldY",{get:function(){return this.game.world.camera.y+this.y}});b.Touch=function(a){this.game=a;this.enabled=!0;this.touchLockCallbacks=[];this.callbackContext=this.game;this.touchCancelCallback=this.touchLeaveCallback=this.touchEnterCallback=this.touchEndCallback=this.touchMoveCallback=this.touchStartCallback=null;this.preventDefault=!0;this._onTouchMove=this._onTouchCancel=this._onTouchLeave=this._onTouchEnter=this._onTouchEnd=this._onTouchMove=
this._onTouchStart=this.event=null};b.Touch.prototype={start:function(){if(null===this._onTouchStart){var a=this;this.game.device.touch&&(this._onTouchStart=function(c){return a.onTouchStart(c)},this._onTouchMove=function(c){return a.onTouchMove(c)},this._onTouchEnd=function(c){return a.onTouchEnd(c)},this._onTouchEnter=function(c){return a.onTouchEnter(c)},this._onTouchLeave=function(c){return a.onTouchLeave(c)},this._onTouchCancel=function(c){return a.onTouchCancel(c)},this.game.canvas.addEventListener("touchstart",
this._onTouchStart,!1),this.game.canvas.addEventListener("touchmove",this._onTouchMove,!1),this.game.canvas.addEventListener("touchend",this._onTouchEnd,!1),this.game.canvas.addEventListener("touchcancel",this._onTouchCancel,!1),this.game.device.cocoonJS||(this.game.canvas.addEventListener("touchenter",this._onTouchEnter,!1),this.game.canvas.addEventListener("touchleave",this._onTouchLeave,!1)))}},consumeDocumentTouches:function(){this._documentTouchMove=function(a){a.preventDefault()};document.addEventListener("touchmove",
this._documentTouchMove,!1)},addTouchLockCallback:function(a,c){this.touchLockCallbacks.push({callback:a,context:c})},removeTouchLockCallback:function(a,c){for(var b=this.touchLockCallbacks.length;b--;)if(this.touchLockCallbacks[b].callback===a&&this.touchLockCallbacks[b].context===c)return this.touchLockCallbacks.splice(b,1),!0;return!1},onTouchStart:function(a){for(var c=this.touchLockCallbacks.length;c--;)this.touchLockCallbacks[c].callback.call(this.touchLockCallbacks[c].context,this,a)&&this.touchLockCallbacks.splice(c,
1);this.event=a;if(this.game.input.enabled&&this.enabled)for(this.touchStartCallback&&this.touchStartCallback.call(this.callbackContext,a),this.preventDefault&&a.preventDefault(),c=0;c<a.changedTouches.length;c++)this.game.input.startPointer(a.changedTouches[c])},onTouchCancel:function(a){this.event=a;this.touchCancelCallback&&this.touchCancelCallback.call(this.callbackContext,a);if(this.game.input.enabled&&this.enabled){this.preventDefault&&a.preventDefault();for(var c=0;c<a.changedTouches.length;c++)this.game.input.stopPointer(a.changedTouches[c])}},
onTouchEnter:function(a){this.event=a;this.touchEnterCallback&&this.touchEnterCallback.call(this.callbackContext,a);this.game.input.enabled&&this.enabled&&this.preventDefault&&a.preventDefault()},onTouchLeave:function(a){this.event=a;this.touchLeaveCallback&&this.touchLeaveCallback.call(this.callbackContext,a);this.preventDefault&&a.preventDefault()},onTouchMove:function(a){this.event=a;this.touchMoveCallback&&this.touchMoveCallback.call(this.callbackContext,a);this.preventDefault&&a.preventDefault();
for(var c=0;c<a.changedTouches.length;c++)this.game.input.updatePointer(a.changedTouches[c])},onTouchEnd:function(a){this.event=a;this.touchEndCallback&&this.touchEndCallback.call(this.callbackContext,a);this.preventDefault&&a.preventDefault();for(var c=0;c<a.changedTouches.length;c++)this.game.input.stopPointer(a.changedTouches[c])},stop:function(){this.game.device.touch&&(this.game.canvas.removeEventListener("touchstart",this._onTouchStart),this.game.canvas.removeEventListener("touchmove",this._onTouchMove),
this.game.canvas.removeEventListener("touchend",this._onTouchEnd),this.game.canvas.removeEventListener("touchenter",this._onTouchEnter),this.game.canvas.removeEventListener("touchleave",this._onTouchLeave),this.game.canvas.removeEventListener("touchcancel",this._onTouchCancel))}};b.Touch.prototype.constructor=b.Touch;b.InputHandler=function(a){this.sprite=a;this.game=a.game;this.checked=this.enabled=!1;this.priorityID=0;this.isDragged=this._setHandCursor=this.useHandCursor=!1;this.allowVerticalDrag=
this.allowHorizontalDrag=!0;this.bringToTop=!1;this.snapOffset=null;this.snapOnRelease=this.snapOnDrag=!1;this.snapOffsetY=this.snapOffsetX=this.snapY=this.snapX=0;this.pixelPerfectClick=this.pixelPerfectOver=!1;this.pixelPerfectAlpha=255;this.draggable=!1;this.boundsSprite=this.boundsRect=null;this.scaleLayer=this.consumePointerEvent=!1;this.dragOffset=new b.Point;this.dragFromCenter=!1;this.dragStartPoint=new b.Point;this.snapPoint=new b.Point;this._dragPoint=new b.Point;this._wasEnabled=this._dragPhase=
!1;this._tempPoint=new b.Point;this._pointerData=[];this._pointerData.push({id:0,x:0,y:0,isDown:!1,isUp:!1,isOver:!1,isOut:!1,timeOver:0,timeOut:0,timeDown:0,timeUp:0,downDuration:0,isDragged:!1})};b.InputHandler.prototype={start:function(a,c){a=a||0;void 0===c&&(c=!1);if(!1===this.enabled){this.game.input.interactiveItems.add(this);this.useHandCursor=c;this.priorityID=a;for(var d=0;10>d;d++)this._pointerData[d]={id:d,x:0,y:0,isDown:!1,isUp:!1,isOver:!1,isOut:!1,timeOver:0,timeOut:0,timeDown:0,timeUp:0,
downDuration:0,isDragged:!1};this.snapOffset=new b.Point;this._wasEnabled=this.enabled=!0}this.sprite.events.onAddedToGroup.add(this.addedToGroup,this);this.sprite.events.onRemovedFromGroup.add(this.removedFromGroup,this);this.flagged=!1;return this.sprite},addedToGroup:function(){this._dragPhase||this._wasEnabled&&!this.enabled&&this.start()},removedFromGroup:function(){this._dragPhase||(this.enabled?(this._wasEnabled=!0,this.stop()):this._wasEnabled=!1)},reset:function(){this.flagged=this.enabled=
!1;for(var a=0;10>a;a++)this._pointerData[a]={id:a,x:0,y:0,isDown:!1,isUp:!1,isOver:!1,isOut:!1,timeOver:0,timeOut:0,timeDown:0,timeUp:0,downDuration:0,isDragged:!1}},stop:function(){!1!==this.enabled&&(this.enabled=!1,this.game.input.interactiveItems.remove(this))},destroy:function(){this.sprite&&(this._setHandCursor&&(this.game.canvas.style.cursor="default",this._setHandCursor=!1),this.enabled=!1,this.game.input.interactiveItems.remove(this),this._pointerData.length=0,this.sprite=this.boundsSprite=
this.boundsRect=null)},validForInput:function(a,c,b){void 0===b&&(b=!0);return 0===this.sprite.scale.x||0===this.sprite.scale.y||this.priorityID<this.game.input.minPriorityID||!b&&(this.pixelPerfectClick||this.pixelPerfectOver)?!1:this.priorityID>a||this.priorityID===a&&this.sprite.renderOrderID<c?!0:!1},isPixelPerfect:function(){return this.pixelPerfectClick||this.pixelPerfectOver},pointerX:function(a){return this._pointerData[a||0].x},pointerY:function(a){return this._pointerData[a||0].y},pointerDown:function(a){return this._pointerData[a||
0].isDown},pointerUp:function(a){return this._pointerData[a||0].isUp},pointerTimeDown:function(a){return this._pointerData[a||0].timeDown},pointerTimeUp:function(a){return this._pointerData[a||0].timeUp},pointerOver:function(a){if(this.enabled)if(void 0===a)for(a=0;10>a;a++){if(this._pointerData[a].isOver)return!0}else return this._pointerData[a].isOver;return!1},pointerOut:function(a){if(this.enabled)if(void 0===a)for(a=0;10>a;a++){if(this._pointerData[a].isOut)return!0}else return this._pointerData[a].isOut;
return!1},pointerTimeOver:function(a){return this._pointerData[a||0].timeOver},pointerTimeOut:function(a){return this._pointerData[a||0].timeOut},pointerDragged:function(a){return this._pointerData[a||0].isDragged},checkPointerDown:function(a,c){return a.isDown&&this.enabled&&this.sprite&&this.sprite.parent&&this.sprite.visible&&this.sprite.parent.visible?this.game.input.hitTest(this.sprite,a,this._tempPoint)?(void 0===c&&(c=!1),!c&&this.pixelPerfectClick?this.checkPixel(this._tempPoint.x,this._tempPoint.y):
!0):!1:!1},checkPointerOver:function(a,c){return this.enabled&&this.sprite&&this.sprite.parent&&this.sprite.visible&&this.sprite.parent.visible?this.game.input.hitTest(this.sprite,a,this._tempPoint)?(void 0===c&&(c=!1),!c&&this.pixelPerfectOver?this.checkPixel(this._tempPoint.x,this._tempPoint.y):!0):!1:!1},checkPixel:function(a,c,b){if(this.sprite.texture.baseTexture.source){null===a&&null===c&&(this.game.input.getLocalPosition(this.sprite,b,this._tempPoint),a=this._tempPoint.x,c=this._tempPoint.y);
0!==this.sprite.anchor.x&&(a-=-this.sprite.texture.frame.width*this.sprite.anchor.x);0!==this.sprite.anchor.y&&(c-=-this.sprite.texture.frame.height*this.sprite.anchor.y);a+=this.sprite.texture.frame.x;c+=this.sprite.texture.frame.y;if(this.sprite.texture.trim&&(a-=this.sprite.texture.trim.x,c-=this.sprite.texture.trim.y,a<this.sprite.texture.crop.x||a>this.sprite.texture.crop.right||c<this.sprite.texture.crop.y||c>this.sprite.texture.crop.bottom))return this._dx=a,this._dy=c,!1;this._dx=a;this._dy=
c;this.game.input.hitContext.clearRect(0,0,1,1);this.game.input.hitContext.drawImage(this.sprite.texture.baseTexture.source,a,c,1,1,0,0,1,1);if(this.game.input.hitContext.getImageData(0,0,1,1).data[3]>=this.pixelPerfectAlpha)return!0}return!1},update:function(a){if(null!==this.sprite&&void 0!==this.sprite.parent){if(!this.enabled||!this.sprite.visible||!this.sprite.parent.visible)return this._pointerOutHandler(a),!1;if(this.draggable&&this._draggedPointerID===a.id)return this.updateDrag(a);if(this._pointerData[a.id].isOver){if(this.checkPointerOver(a))return this._pointerData[a.id].x=
a.x-this.sprite.x,this._pointerData[a.id].y=a.y-this.sprite.y,!0;this._pointerOutHandler(a);return!1}}},_pointerOverHandler:function(a){if(null!==this.sprite&&(!1===this._pointerData[a.id].isOver||a.dirty)&&(this._pointerData[a.id].isOver=!0,this._pointerData[a.id].isOut=!1,this._pointerData[a.id].timeOver=this.game.time.time,this._pointerData[a.id].x=a.x-this.sprite.x,this._pointerData[a.id].y=a.y-this.sprite.y,this.useHandCursor&&!1===this._pointerData[a.id].isDragged&&(this.game.canvas.style.cursor=
"pointer",this._setHandCursor=!0),this.sprite&&this.sprite.events))this.sprite.events.onInputOver$dispatch(this.sprite,a)},_pointerOutHandler:function(a){if(null!==this.sprite&&(this._pointerData[a.id].isOver=!1,this._pointerData[a.id].isOut=!0,this._pointerData[a.id].timeOut=this.game.time.time,this.useHandCursor&&!1===this._pointerData[a.id].isDragged&&(this.game.canvas.style.cursor="default",this._setHandCursor=!1),this.sprite&&this.sprite.events))this.sprite.events.onInputOut$dispatch(this.sprite,
a)},_touchedHandler:function(a){if(null!==this.sprite){if(!this._pointerData[a.id].isDown&&this._pointerData[a.id].isOver){if(this.pixelPerfectClick&&!this.checkPixel(null,null,a))return;this._pointerData[a.id].isDown=!0;this._pointerData[a.id].isUp=!1;this._pointerData[a.id].timeDown=this.game.time.time;if(this.sprite&&this.sprite.events)this.sprite.events.onInputDown$dispatch(this.sprite,a);a.dirty=!0;this.draggable&&!1===this.isDragged&&this.startDrag(a);this.bringToTop&&this.sprite.bringToTop()}return this.consumePointerEvent}},
_releasedHandler:function(a){if(null!==this.sprite&&this._pointerData[a.id].isDown&&a.isUp){this._pointerData[a.id].isDown=!1;this._pointerData[a.id].isUp=!0;this._pointerData[a.id].timeUp=this.game.time.time;this._pointerData[a.id].downDuration=this._pointerData[a.id].timeUp-this._pointerData[a.id].timeDown;if(this.checkPointerOver(a)){if(this.sprite&&this.sprite.events)this.sprite.events.onInputUp$dispatch(this.sprite,a,!0)}else{if(this.sprite&&this.sprite.events)this.sprite.events.onInputUp$dispatch(this.sprite,
a,!1);this.useHandCursor&&(this.game.canvas.style.cursor="default",this._setHandCursor=!1)}a.dirty=!0;this.draggable&&this.isDragged&&this._draggedPointerID===a.id&&this.stopDrag(a)}},updateDrag:function(a){if(a.isUp)return this.stopDrag(a),!1;var c=this.globalToLocalX(a.x)+this._dragPoint.x+this.dragOffset.x,b=this.globalToLocalY(a.y)+this._dragPoint.y+this.dragOffset.y;this.sprite.fixedToCamera?(this.allowHorizontalDrag&&(this.sprite.cameraOffset.x=c),this.allowVerticalDrag&&(this.sprite.cameraOffset.y=
b),this.boundsRect&&this.checkBoundsRect(),this.boundsSprite&&this.checkBoundsSprite(),this.snapOnDrag&&(this.sprite.cameraOffset.x=Math.round((this.sprite.cameraOffset.x-this.snapOffsetX%this.snapX)/this.snapX)*this.snapX+this.snapOffsetX%this.snapX,this.sprite.cameraOffset.y=Math.round((this.sprite.cameraOffset.y-this.snapOffsetY%this.snapY)/this.snapY)*this.snapY+this.snapOffsetY%this.snapY,this.snapPoint.set(this.sprite.cameraOffset.x,this.sprite.cameraOffset.y))):(this.allowHorizontalDrag&&(this.sprite.x=
c),this.allowVerticalDrag&&(this.sprite.y=b),this.boundsRect&&this.checkBoundsRect(),this.boundsSprite&&this.checkBoundsSprite(),this.snapOnDrag&&(this.sprite.x=Math.round((this.sprite.x-this.snapOffsetX%this.snapX)/this.snapX)*this.snapX+this.snapOffsetX%this.snapX,this.sprite.y=Math.round((this.sprite.y-this.snapOffsetY%this.snapY)/this.snapY)*this.snapY+this.snapOffsetY%this.snapY,this.snapPoint.set(this.sprite.x,this.sprite.y)));this.sprite.events.onDragUpdate.dispatch(this.sprite,a,c,b,this.snapPoint);
return!0},justOver:function(a,c){a=a||0;c=c||500;return this._pointerData[a].isOver&&this.overDuration(a)<c},justOut:function(a,c){a=a||0;return this._pointerData[a].isOut&&this.game.time.time-this._pointerData[a].timeOut<(c||500)},justPressed:function(a,c){a=a||0;c=c||500;return this._pointerData[a].isDown&&this.downDuration(a)<c},justReleased:function(a,c){a=a||0;return this._pointerData[a].isUp&&this.game.time.time-this._pointerData[a].timeUp<(c||500)},overDuration:function(a){a=a||0;return this._pointerData[a].isOver?
this.game.time.time-this._pointerData[a].timeOver:-1},downDuration:function(a){a=a||0;return this._pointerData[a].isDown?this.game.time.time-this._pointerData[a].timeDown:-1},enableDrag:function(a,c,d,e,g,l){void 0===a&&(a=!1);void 0===c&&(c=!1);void 0===d&&(d=!1);void 0===e&&(e=255);void 0===g&&(g=null);void 0===l&&(l=null);this._dragPoint=new b.Point;this.draggable=!0;this.bringToTop=c;this.dragOffset=new b.Point;this.dragFromCenter=a;this.pixelPerfectClick=d;this.pixelPerfectAlpha=e;g&&(this.boundsRect=
g);l&&(this.boundsSprite=l)},disableDrag:function(){if(this._pointerData)for(var a=0;10>a;a++)this._pointerData[a].isDragged=!1;this.isDragged=this.draggable=!1;this._draggedPointerID=-1},startDrag:function(a){var c=this.sprite.x,b=this.sprite.y;this.isDragged=!0;this._draggedPointerID=a.id;this._pointerData[a.id].isDragged=!0;if(this.sprite.fixedToCamera)this.dragFromCenter&&this.sprite.centerOn(a.x,a.y),this._dragPoint.setTo(this.sprite.cameraOffset.x-a.x,this.sprite.cameraOffset.y-a.y);else{if(this.dragFromCenter){var e=
this.sprite.getBounds();this.sprite.x=this.globalToLocalX(a.x)+(this.sprite.x-e.centerX);this.sprite.y=this.globalToLocalY(a.y)+(this.sprite.y-e.centerY)}this._dragPoint.setTo(this.sprite.x-this.globalToLocalX(a.x),this.sprite.y-this.globalToLocalY(a.y))}this.updateDrag(a);this.bringToTop&&(this._dragPhase=!0,this.sprite.bringToTop());this.dragStartPoint.set(c,b);this.sprite.events.onDragStart$dispatch(this.sprite,a,c,b)},globalToLocalX:function(a){this.scaleLayer&&(a-=this.game.scale.grid.boundsFluid.x,
a*=this.game.scale.grid.scaleFluidInversed.x);return a},globalToLocalY:function(a){this.scaleLayer&&(a-=this.game.scale.grid.boundsFluid.y,a*=this.game.scale.grid.scaleFluidInversed.y);return a},stopDrag:function(a){this.isDragged=!1;this._draggedPointerID=-1;this._dragPhase=this._pointerData[a.id].isDragged=!1;this.snapOnRelease&&(this.sprite.fixedToCamera?(this.sprite.cameraOffset.x=Math.round((this.sprite.cameraOffset.x-this.snapOffsetX%this.snapX)/this.snapX)*this.snapX+this.snapOffsetX%this.snapX,
this.sprite.cameraOffset.y=Math.round((this.sprite.cameraOffset.y-this.snapOffsetY%this.snapY)/this.snapY)*this.snapY+this.snapOffsetY%this.snapY):(this.sprite.x=Math.round((this.sprite.x-this.snapOffsetX%this.snapX)/this.snapX)*this.snapX+this.snapOffsetX%this.snapX,this.sprite.y=Math.round((this.sprite.y-this.snapOffsetY%this.snapY)/this.snapY)*this.snapY+this.snapOffsetY%this.snapY));this.sprite.events.onDragStop$dispatch(this.sprite,a);!1===this.checkPointerOver(a)&&this._pointerOutHandler(a)},
setDragLock:function(a,c){void 0===a&&(a=!0);void 0===c&&(c=!0);this.allowHorizontalDrag=a;this.allowVerticalDrag=c},enableSnap:function(a,c,b,e,g,l){void 0===b&&(b=!0);void 0===e&&(e=!1);void 0===g&&(g=0);void 0===l&&(l=0);this.snapX=a;this.snapY=c;this.snapOffsetX=g;this.snapOffsetY=l;this.snapOnDrag=b;this.snapOnRelease=e},disableSnap:function(){this.snapOnRelease=this.snapOnDrag=!1},checkBoundsRect:function(){this.sprite.fixedToCamera?(this.sprite.cameraOffset.x<this.boundsRect.left?this.sprite.cameraOffset.x=
this.boundsRect.left:this.sprite.cameraOffset.x+this.sprite.width>this.boundsRect.right&&(this.sprite.cameraOffset.x=this.boundsRect.right-this.sprite.width),this.sprite.cameraOffset.y<this.boundsRect.top?this.sprite.cameraOffset.y=this.boundsRect.top:this.sprite.cameraOffset.y+this.sprite.height>this.boundsRect.bottom&&(this.sprite.cameraOffset.y=this.boundsRect.bottom-this.sprite.height)):(this.sprite.left<this.boundsRect.left?this.sprite.x=this.boundsRect.x+this.sprite.offsetX:this.sprite.right>
this.boundsRect.right&&(this.sprite.x=this.boundsRect.right-(this.sprite.width-this.sprite.offsetX)),this.sprite.top<this.boundsRect.top?this.sprite.y=this.boundsRect.top+this.sprite.offsetY:this.sprite.bottom>this.boundsRect.bottom&&(this.sprite.y=this.boundsRect.bottom-(this.sprite.height-this.sprite.offsetY)))},checkBoundsSprite:function(){this.sprite.fixedToCamera&&this.boundsSprite.fixedToCamera?(this.sprite.cameraOffset.x<this.boundsSprite.cameraOffset.x?this.sprite.cameraOffset.x=this.boundsSprite.cameraOffset.x:
this.sprite.cameraOffset.x+this.sprite.width>this.boundsSprite.cameraOffset.x+this.boundsSprite.width&&(this.sprite.cameraOffset.x=this.boundsSprite.cameraOffset.x+this.boundsSprite.width-this.sprite.width),this.sprite.cameraOffset.y<this.boundsSprite.cameraOffset.y?this.sprite.cameraOffset.y=this.boundsSprite.cameraOffset.y:this.sprite.cameraOffset.y+this.sprite.height>this.boundsSprite.cameraOffset.y+this.boundsSprite.height&&(this.sprite.cameraOffset.y=this.boundsSprite.cameraOffset.y+this.boundsSprite.height-
this.sprite.height)):(this.sprite.left<this.boundsSprite.left?this.sprite.x=this.boundsSprite.left+this.sprite.offsetX:this.sprite.right>this.boundsSprite.right&&(this.sprite.x=this.boundsSprite.right-(this.sprite.width-this.sprite.offsetX)),this.sprite.top<this.boundsSprite.top?this.sprite.y=this.boundsSprite.top+this.sprite.offsetY:this.sprite.bottom>this.boundsSprite.bottom&&(this.sprite.y=this.boundsSprite.bottom-(this.sprite.height-this.sprite.offsetY)))}};b.InputHandler.prototype.constructor=
b.InputHandler;b.Gamepad=function(a){this.game=a;this._gamepadIndexMap={};this._rawPads=[];this._active=!1;this.enabled=!0;this._gamepadSupportAvailable=!!navigator.webkitGetGamepads||!!navigator.webkitGamepads||-1!=navigator.userAgent.indexOf("Firefox/")||!!navigator.getGamepads;this._prevRawGamepadTypes=[];this._prevTimestamps=[];this.callbackContext=this;this._gamepaddisconnected=this._ongamepadconnected=this.onFloatCallback=this.onAxisCallback=this.onUpCallback=this.onDownCallback=this.onDisconnectCallback=
this.onConnectCallback=null;this._gamepads=[new b.SinglePad(a,this),new b.SinglePad(a,this),new b.SinglePad(a,this),new b.SinglePad(a,this)]};b.Gamepad.prototype={addCallbacks:function(a,c){"undefined"!==typeof c&&(this.onConnectCallback="function"===typeof c.onConnect?c.onConnect:this.onConnectCallback,this.onDisconnectCallback="function"===typeof c.onDisconnect?c.onDisconnect:this.onDisconnectCallback,this.onDownCallback="function"===typeof c.onDown?c.onDown:this.onDownCallback,this.onUpCallback=
"function"===typeof c.onUp?c.onUp:this.onUpCallback,this.onAxisCallback="function"===typeof c.onAxis?c.onAxis:this.onAxisCallback,this.onFloatCallback="function"===typeof c.onFloat?c.onFloat:this.onFloatCallback,this.callbackContext=a)},start:function(){if(!this._active){this._active=!0;var a=this;this._onGamepadConnected=function(c){return a.onGamepadConnected(c)};this._onGamepadDisconnected=function(c){return a.onGamepadDisconnected(c)};window.addEventListener("gamepadconnected",this._onGamepadConnected,
!1);window.addEventListener("gamepaddisconnected",this._onGamepadDisconnected,!1)}},onGamepadConnected:function(a){a=a.gamepad;this._rawPads.push(a);this._gamepads[a.index].connect(a)},onGamepadDisconnected:function(a){a=a.gamepad;for(var c in this._rawPads)this._rawPads[c].index===a.index&&this._rawPads.splice(c,1);this._gamepads[a.index].disconnect()},update:function(){this._pollGamepads();this.pad1.pollStatus();this.pad2.pollStatus();this.pad3.pollStatus();this.pad4.pollStatus()},_pollGamepads:function(){if(navigator.getGamepads)var a=
navigator.getGamepads();else navigator.webkitGetGamepads?a=navigator.webkitGetGamepads():navigator.webkitGamepads&&(a=navigator.webkitGamepads());if(a){this._rawPads=[];for(var c=!1,b=0;b<a.length&&(typeof a[b]!==this._prevRawGamepadTypes[b]&&(c=!0,this._prevRawGamepadTypes[b]=typeof a[b]),a[b]&&this._rawPads.push(a[b]),3!==b);b++);if(c){for(var a={},c={},e=0;e<this._gamepads.length;e++)if(b=this._gamepads[e],b.connected)for(var g=0;g<this._rawPads.length;g++)this._rawPads[g].index===b.index&&(a[b.index]=
!0,c[e]=!0);for(e=0;e<this._gamepads.length;e++)if(b=this._gamepads[e],!c[e])for(1>this._rawPads.length&&b.disconnect(),g=0;g<this._rawPads.length&&!c[e];g++){var l=this._rawPads[g];l?a[l.index]?b.disconnect():(b.connect(l),a[l.index]=!0,c[e]=!0):b.disconnect()}}}},setDeadZones:function(a){for(var c=0;c<this._gamepads.length;c++)this._gamepads[c].deadZone=a},stop:function(){this._active=!1;window.removeEventListener("gamepadconnected",this._onGamepadConnected);window.removeEventListener("gamepaddisconnected",
this._onGamepadDisconnected)},reset:function(){this.update();for(var a=0;a<this._gamepads.length;a++)this._gamepads[a].reset()},justPressed:function(a,c){for(var b=0;b<this._gamepads.length;b++)if(!0===this._gamepads[b].justPressed(a,c))return!0;return!1},justReleased:function(a,c){for(var b=0;b<this._gamepads.length;b++)if(!0===this._gamepads[b].justReleased(a,c))return!0;return!1},isDown:function(a){for(var c=0;c<this._gamepads.length;c++)if(!0===this._gamepads[c].isDown(a))return!0;return!1},destroy:function(){this.stop();
for(var a=0;a<this._gamepads.length;a++)this._gamepads[a].destroy()}};b.Gamepad.prototype.constructor=b.Gamepad;Object.defineProperty(b.Gamepad.prototype,"active",{get:function(){return this._active}});Object.defineProperty(b.Gamepad.prototype,"supported",{get:function(){return this._gamepadSupportAvailable}});Object.defineProperty(b.Gamepad.prototype,"padsConnected",{get:function(){return this._rawPads.length}});Object.defineProperty(b.Gamepad.prototype,"pad1",{get:function(){return this._gamepads[0]}});
Object.defineProperty(b.Gamepad.prototype,"pad2",{get:function(){return this._gamepads[1]}});Object.defineProperty(b.Gamepad.prototype,"pad3",{get:function(){return this._gamepads[2]}});Object.defineProperty(b.Gamepad.prototype,"pad4",{get:function(){return this._gamepads[3]}});b.Gamepad.BUTTON_0=0;b.Gamepad.BUTTON_1=1;b.Gamepad.BUTTON_2=2;b.Gamepad.BUTTON_3=3;b.Gamepad.BUTTON_4=4;b.Gamepad.BUTTON_5=5;b.Gamepad.BUTTON_6=6;b.Gamepad.BUTTON_7=7;b.Gamepad.BUTTON_8=8;b.Gamepad.BUTTON_9=9;b.Gamepad.BUTTON_10=
10;b.Gamepad.BUTTON_11=11;b.Gamepad.BUTTON_12=12;b.Gamepad.BUTTON_13=13;b.Gamepad.BUTTON_14=14;b.Gamepad.BUTTON_15=15;b.Gamepad.AXIS_0=0;b.Gamepad.AXIS_1=1;b.Gamepad.AXIS_2=2;b.Gamepad.AXIS_3=3;b.Gamepad.AXIS_4=4;b.Gamepad.AXIS_5=5;b.Gamepad.AXIS_6=6;b.Gamepad.AXIS_7=7;b.Gamepad.AXIS_8=8;b.Gamepad.AXIS_9=9;b.Gamepad.XBOX360_A=0;b.Gamepad.XBOX360_B=1;b.Gamepad.XBOX360_X=2;b.Gamepad.XBOX360_Y=3;b.Gamepad.XBOX360_LEFT_BUMPER=4;b.Gamepad.XBOX360_RIGHT_BUMPER=5;b.Gamepad.XBOX360_LEFT_TRIGGER=6;b.Gamepad.XBOX360_RIGHT_TRIGGER=
7;b.Gamepad.XBOX360_BACK=8;b.Gamepad.XBOX360_START=9;b.Gamepad.XBOX360_STICK_LEFT_BUTTON=10;b.Gamepad.XBOX360_STICK_RIGHT_BUTTON=11;b.Gamepad.XBOX360_DPAD_LEFT=14;b.Gamepad.XBOX360_DPAD_RIGHT=15;b.Gamepad.XBOX360_DPAD_UP=12;b.Gamepad.XBOX360_DPAD_DOWN=13;b.Gamepad.XBOX360_STICK_LEFT_X=0;b.Gamepad.XBOX360_STICK_LEFT_Y=1;b.Gamepad.XBOX360_STICK_RIGHT_X=2;b.Gamepad.XBOX360_STICK_RIGHT_Y=3;b.Gamepad.PS3XC_X=0;b.Gamepad.PS3XC_CIRCLE=1;b.Gamepad.PS3XC_SQUARE=2;b.Gamepad.PS3XC_TRIANGLE=3;b.Gamepad.PS3XC_L1=
4;b.Gamepad.PS3XC_R1=5;b.Gamepad.PS3XC_L2=6;b.Gamepad.PS3XC_R2=7;b.Gamepad.PS3XC_SELECT=8;b.Gamepad.PS3XC_START=9;b.Gamepad.PS3XC_STICK_LEFT_BUTTON=10;b.Gamepad.PS3XC_STICK_RIGHT_BUTTON=11;b.Gamepad.PS3XC_DPAD_UP=12;b.Gamepad.PS3XC_DPAD_DOWN=13;b.Gamepad.PS3XC_DPAD_LEFT=14;b.Gamepad.PS3XC_DPAD_RIGHT=15;b.Gamepad.PS3XC_STICK_LEFT_X=0;b.Gamepad.PS3XC_STICK_LEFT_Y=1;b.Gamepad.PS3XC_STICK_RIGHT_X=2;b.Gamepad.PS3XC_STICK_RIGHT_Y=3;b.SinglePad=function(a,c){this.game=a;this.index=null;this.connected=!1;
this.callbackContext=this;this.onFloatCallback=this.onAxisCallback=this.onUpCallback=this.onDownCallback=this.onDisconnectCallback=this.onConnectCallback=null;this.deadZone=.26;this._padParent=c;this._prevTimestamp=this._rawPad=null;this._buttons=[];this._buttonsLen=0;this._axes=[];this._axesLen=0};b.SinglePad.prototype={addCallbacks:function(a,c){"undefined"!==typeof c&&(this.onConnectCallback="function"===typeof c.onConnect?c.onConnect:this.onConnectCallback,this.onDisconnectCallback="function"===
typeof c.onDisconnect?c.onDisconnect:this.onDisconnectCallback,this.onDownCallback="function"===typeof c.onDown?c.onDown:this.onDownCallback,this.onUpCallback="function"===typeof c.onUp?c.onUp:this.onUpCallback,this.onAxisCallback="function"===typeof c.onAxis?c.onAxis:this.onAxisCallback,this.onFloatCallback="function"===typeof c.onFloat?c.onFloat:this.onFloatCallback)},getButton:function(a){return this._buttons[a]?this._buttons[a]:null},pollStatus:function(){if(this.connected&&this.game.input.enabled&&
this.game.input.gamepad.enabled&&(!this._rawPad.timestamp||this._rawPad.timestamp!==this._prevTimestamp)){for(var a=0;a<this._buttonsLen;a++){var c=isNaN(this._rawPad.buttons[a])?this._rawPad.buttons[a].value:this._rawPad.buttons[a];c!==this._buttons[a].value&&(1===c?this.processButtonDown(a,c):0===c?this.processButtonUp(a,c):this.processButtonFloat(a,c))}for(a=0;a<this._axesLen;a++)c=this._rawPad.axes[a],0<c&&c>this.deadZone||0>c&&c<-this.deadZone?this.processAxisChange(a,c):this.processAxisChange(a,
0);this._prevTimestamp=this._rawPad.timestamp}},connect:function(a){var c=!this.connected;this.connected=!0;this.index=a.index;this._rawPad=a;this._buttons=[];this._buttonsLen=a.buttons.length;this._axes=[];this._axesLen=a.axes.length;for(var d=0;d<this._axesLen;d++)this._axes[d]=a.axes[d];for(var e in a.buttons)e=parseInt(e,10),this._buttons[e]=new b.DeviceButton(this,e);c&&this._padParent.onConnectCallback&&this._padParent.onConnectCallback.call(this._padParent.callbackContext,this.index);c&&this.onConnectCallback&&
this.onConnectCallback.call(this.callbackContext)},disconnect:function(){var a=this.connected,c=this.index;this.connected=!1;this.index=null;this._rawPad=void 0;for(var b=0;b<this._buttonsLen;b++)this._buttons[b].destroy();this._buttons=[];this._buttonsLen=0;this._axes=[];this._axesLen=0;a&&this._padParent.onDisconnectCallback&&this._padParent.onDisconnectCallback.call(this._padParent.callbackContext,c);a&&this.onDisconnectCallback&&this.onDisconnectCallback.call(this.callbackContext)},destroy:function(){this._rawPad=
void 0;for(var a=0;a<this._buttonsLen;a++)this._buttons[a].destroy();this._buttons=[];this._buttonsLen=0;this._axes=[];this._axesLen=0;this.onFloatCallback=this.onAxisCallback=this.onUpCallback=this.onDownCallback=this.onDisconnectCallback=this.onConnectCallback=null},processAxisChange:function(a,c){this._axes[a]!==c&&(this._axes[a]=c,this._padParent.onAxisCallback&&this._padParent.onAxisCallback.call(this._padParent.callbackContext,this,a,c),this.onAxisCallback&&this.onAxisCallback.call(this.callbackContext,
this,a,c))},processButtonDown:function(a,c){this._padParent.onDownCallback&&this._padParent.onDownCallback.call(this._padParent.callbackContext,a,c,this.index);this.onDownCallback&&this.onDownCallback.call(this.callbackContext,a,c);this._buttons[a]&&this._buttons[a].start(null,c)},processButtonUp:function(a,c){this._padParent.onUpCallback&&this._padParent.onUpCallback.call(this._padParent.callbackContext,a,c,this.index);this.onUpCallback&&this.onUpCallback.call(this.callbackContext,a,c);this._buttons[a]&&
this._buttons[a].stop(null,c)},processButtonFloat:function(a,c){this._padParent.onFloatCallback&&this._padParent.onFloatCallback.call(this._padParent.callbackContext,a,c,this.index);this.onFloatCallback&&this.onFloatCallback.call(this.callbackContext,a,c);this._buttons[a]&&this._buttons[a].padFloat(c)},axis:function(a){return this._axes[a]?this._axes[a]:!1},isDown:function(a){return this._buttons[a]?this._buttons[a].isDown:!1},isUp:function(a){return this._buttons[a]?this._buttons[a].isUp:!1},justReleased:function(a,
c){if(this._buttons[a])return this._buttons[a].justReleased(c)},justPressed:function(a,c){if(this._buttons[a])return this._buttons[a].justPressed(c)},buttonValue:function(a){return this._buttons[a]?this._buttons[a].value:null},reset:function(){for(var a=0;a<this._axes.length;a++)this._axes[a]=0}};b.SinglePad.prototype.constructor=b.SinglePad;b.Key=function(a,c){this.game=a;this._enabled=!0;this.event=null;this.isDown=!1;this.isUp=!0;this.shiftKey=this.ctrlKey=this.altKey=!1;this.duration=this.timeDown=
0;this.timeUp=-2500;this.repeats=0;this.keyCode=c;this.onDown=new b.Signal;this.onHoldContext=this.onHoldCallback=null;this.onUp=new b.Signal;this._justUp=this._justDown=!1};b.Key.prototype={update:function(){this._enabled&&this.isDown&&(this.duration=this.game.time.time-this.timeDown,this.repeats++,this.onHoldCallback&&this.onHoldCallback.call(this.onHoldContext,this))},processKeyDown:function(a){this._enabled&&(this.event=a,this.isDown||(this.altKey=a.altKey,this.ctrlKey=a.ctrlKey,this.shiftKey=
a.shiftKey,this.isDown=!0,this.isUp=!1,this.timeDown=this.game.time.time,this.repeats=this.duration=0,this._justDown=!0,this.onDown.dispatch(this)))},processKeyUp:function(a){this._enabled&&(this.event=a,this.isUp||(this.isDown=!1,this.isUp=!0,this.timeUp=this.game.time.time,this.duration=this.game.time.time-this.timeDown,this._justUp=!0,this.onUp.dispatch(this)))},reset:function(a){void 0===a&&(a=!0);this.isDown=!1;this.isUp=!0;this.timeUp=this.game.time.time;this.duration=0;this._enabled=!0;this._justUp=
this._justDown=!1;a&&(this.onDown.removeAll(),this.onUp.removeAll(),this.onHoldContext=this.onHoldCallback=null)},downDuration:function(a){void 0===a&&(a=50);return this.isDown&&this.duration<a},upDuration:function(a){void 0===a&&(a=50);return!this.isDown&&this.game.time.time-this.timeUp<a}};Object.defineProperty(b.Key.prototype,"justDown",{get:function(){var a=this._justDown;this._justDown=!1;return a}});Object.defineProperty(b.Key.prototype,"justUp",{get:function(){var a=this._justUp;this._justUp=
!1;return a}});Object.defineProperty(b.Key.prototype,"enabled",{get:function(){return this._enabled},set:function(a){a=!!a;a!==this._enabled&&(a||this.reset(!1),this._enabled=a)}});b.Key.prototype.constructor=b.Key;b.Keyboard=function(a){this.game=a;this.enabled=!0;this.pressEvent=this.event=null;this.callbackContext=this;this.onUpCallback=this.onPressCallback=this.onDownCallback=null;this._keys=[];this._capture=[];this._onKeyUp=this._onKeyPress=this._onKeyDown=null;this._k=this._i=0};b.Keyboard.prototype=
{addCallbacks:function(a,c,b,e){this.callbackContext=a;"undefined"!==typeof c&&(this.onDownCallback=c);"undefined"!==typeof b&&(this.onUpCallback=b);"undefined"!==typeof e&&(this.onPressCallback=e)},addKey:function(a){this._keys[a]||(this._keys[a]=new b.Key(this.game,a),this.addKeyCapture(a));return this._keys[a]},addKeys:function(a){var c={},b;for(b in a)c[b]=this.addKey(a[b]);return c},removeKey:function(a){this._keys[a]&&(this._keys[a]=null,this.removeKeyCapture(a))},createCursorKeys:function(){return this.addKeys({up:b.Keyboard.UP,
down:b.Keyboard.DOWN,left:b.Keyboard.LEFT,right:b.Keyboard.RIGHT})},start:function(){if(!this.game.device.cocoonJS&&null===this._onKeyDown){var a=this;this._onKeyDown=function(c){return a.processKeyDown(c)};this._onKeyUp=function(c){return a.processKeyUp(c)};this._onKeyPress=function(c){return a.processKeyPress(c)};window.addEventListener("keydown",this._onKeyDown,!1);window.addEventListener("keyup",this._onKeyUp,!1);window.addEventListener("keypress",this._onKeyPress,!1)}},stop:function(){window.removeEventListener("keydown",
this._onKeyDown);window.removeEventListener("keyup",this._onKeyUp);window.removeEventListener("keypress",this._onKeyPress);this._onKeyPress=this._onKeyUp=this._onKeyDown=null},destroy:function(){this.stop();this.clearCaptures();this._i=this._keys.length=0},addKeyCapture:function(a){if("object"===typeof a)for(var c in a)this._capture[a[c]]=!0;else this._capture[a]=!0},removeKeyCapture:function(a){delete this._capture[a]},clearCaptures:function(){this._capture={}},update:function(){for(this._i=this._keys.length;this._i--;)this._keys[this._i]&&
this._keys[this._i].update()},processKeyDown:function(a){this.event=a;this.game.input.enabled&&this.enabled&&(this._capture[a.keyCode]&&a.preventDefault(),this._keys[a.keyCode]||(this._keys[a.keyCode]=new b.Key(this.game,a.keyCode)),this._keys[a.keyCode].processKeyDown(a),this._k=a.keyCode,this.onDownCallback&&this.onDownCallback.call(this.callbackContext,a))},processKeyPress:function(a){this.pressEvent=a;this.game.input.enabled&&this.enabled&&this.onPressCallback&&this.onPressCallback.call(this.callbackContext,
String.fromCharCode(a.charCode),a)},processKeyUp:function(a){this.event=a;this.game.input.enabled&&this.enabled&&(this._capture[a.keyCode]&&a.preventDefault(),this._keys[a.keyCode]||(this._keys[a.keyCode]=new b.Key(this.game,a.keyCode)),this._keys[a.keyCode].processKeyUp(a),this.onUpCallback&&this.onUpCallback.call(this.callbackContext,a))},reset:function(a){void 0===a&&(a=!0);this.event=null;for(var c=this._keys.length;c--;)this._keys[c]&&this._keys[c].reset(a)},downDuration:function(a,c){return this._keys[a]?
this._keys[a].downDuration(c):null},upDuration:function(a,c){return this._keys[a]?this._keys[a].upDuration(c):null},isDown:function(a){return this._keys[a]?this._keys[a].isDown:null}};Object.defineProperty(b.Keyboard.prototype,"lastChar",{get:function(){return 32===this.event.charCode?"":String.fromCharCode(this.pressEvent.charCode)}});Object.defineProperty(b.Keyboard.prototype,"lastKey",{get:function(){return this._keys[this._k]}});b.Keyboard.prototype.constructor=b.Keyboard;b.Keyboard.A=65;b.Keyboard.B=
66;b.Keyboard.C=67;b.Keyboard.D=68;b.Keyboard.E=69;b.Keyboard.F=70;b.Keyboard.G=71;b.Keyboard.H=72;b.Keyboard.I=73;b.Keyboard.J=74;b.Keyboard.K=75;b.Keyboard.L=76;b.Keyboard.M=77;b.Keyboard.N=78;b.Keyboard.O=79;b.Keyboard.P=80;b.Keyboard.Q=81;b.Keyboard.R=82;b.Keyboard.S=83;b.Keyboard.T=84;b.Keyboard.U=85;b.Keyboard.V=86;b.Keyboard.W=87;b.Keyboard.X=88;b.Keyboard.Y=89;b.Keyboard.Z=90;b.Keyboard.ZERO=48;b.Keyboard.ONE=49;b.Keyboard.TWO=50;b.Keyboard.THREE=51;b.Keyboard.FOUR=52;b.Keyboard.FIVE=53;b.Keyboard.SIX=
54;b.Keyboard.SEVEN=55;b.Keyboard.EIGHT=56;b.Keyboard.NINE=57;b.Keyboard.NUMPAD_0=96;b.Keyboard.NUMPAD_1=97;b.Keyboard.NUMPAD_2=98;b.Keyboard.NUMPAD_3=99;b.Keyboard.NUMPAD_4=100;b.Keyboard.NUMPAD_5=101;b.Keyboard.NUMPAD_6=102;b.Keyboard.NUMPAD_7=103;b.Keyboard.NUMPAD_8=104;b.Keyboard.NUMPAD_9=105;b.Keyboard.NUMPAD_MULTIPLY=106;b.Keyboard.NUMPAD_ADD=107;b.Keyboard.NUMPAD_ENTER=108;b.Keyboard.NUMPAD_SUBTRACT=109;b.Keyboard.NUMPAD_DECIMAL=110;b.Keyboard.NUMPAD_DIVIDE=111;b.Keyboard.F1=112;b.Keyboard.F2=
113;b.Keyboard.F3=114;b.Keyboard.F4=115;b.Keyboard.F5=116;b.Keyboard.F6=117;b.Keyboard.F7=118;b.Keyboard.F8=119;b.Keyboard.F9=120;b.Keyboard.F10=121;b.Keyboard.F11=122;b.Keyboard.F12=123;b.Keyboard.F13=124;b.Keyboard.F14=125;b.Keyboard.F15=126;b.Keyboard.COLON=186;b.Keyboard.EQUALS=187;b.Keyboard.COMMA=188;b.Keyboard.UNDERSCORE=189;b.Keyboard.PERIOD=190;b.Keyboard.QUESTION_MARK=191;b.Keyboard.TILDE=192;b.Keyboard.OPEN_BRACKET=219;b.Keyboard.BACKWARD_SLASH=220;b.Keyboard.CLOSED_BRACKET=221;b.Keyboard.QUOTES=
222;b.Keyboard.BACKSPACE=8;b.Keyboard.TAB=9;b.Keyboard.CLEAR=12;b.Keyboard.ENTER=13;b.Keyboard.SHIFT=16;b.Keyboard.CONTROL=17;b.Keyboard.ALT=18;b.Keyboard.CAPS_LOCK=20;b.Keyboard.ESC=27;b.Keyboard.SPACEBAR=32;b.Keyboard.PAGE_UP=33;b.Keyboard.PAGE_DOWN=34;b.Keyboard.END=35;b.Keyboard.HOME=36;b.Keyboard.LEFT=37;b.Keyboard.UP=38;b.Keyboard.RIGHT=39;b.Keyboard.DOWN=40;b.Keyboard.PLUS=43;b.Keyboard.MINUS=44;b.Keyboard.INSERT=45;b.Keyboard.DELETE=46;b.Keyboard.HELP=47;b.Keyboard.NUM_LOCK=144;b.Component=
function(){};b.Component.Angle=function(){};b.Component.Angle.prototype={angle:{get:function(){return b.Math.wrapAngle(b.Math.radToDeg(this.rotation))},set:function(a){this.rotation=b.Math.degToRad(b.Math.wrapAngle(a))}}};b.Component.Animation=function(){};b.Component.Animation.prototype={play:function(a,c,b,e){if(this.animations)return this.animations.play(a,c,b,e)}};b.Component.AutoCull=function(){};b.Component.AutoCull.prototype={autoCull:!1,inCamera:{get:function(){this.autoCull||this.checkWorldBounds||
(this._bounds.copyFrom(this.getBounds()),this._bounds.x+=this.game.camera.view.x,this._bounds.y+=this.game.camera.view.y);return this.game.world.camera.view.intersects(this._bounds)}}};b.Component.Bounds=function(){};b.Component.Bounds.prototype={offsetX:{get:function(){return this.anchor.x*this.width}},offsetY:{get:function(){return this.anchor.y*this.height}},left:{get:function(){return this.x-this.offsetX}},right:{get:function(){return this.x+this.width-this.offsetX}},top:{get:function(){return this.y-
this.offsetY}},bottom:{get:function(){return this.y+this.height-this.offsetY}}};b.Component.BringToTop=function(){};b.Component.BringToTop.prototype.bringToTop=function(){this.parent&&this.parent.bringToTop(this);return this};b.Component.BringToTop.prototype.sendToBack=function(){this.parent&&this.parent.sendToBack(this);return this};b.Component.BringToTop.prototype.moveUp=function(){this.parent&&this.parent.moveUp(this);return this};b.Component.BringToTop.prototype.moveDown=function(){this.parent&&
this.parent.moveDown(this);return this};b.Component.Core=function(){};b.Component.Core.install=function(a){b.Utils.mixinPrototype(this,b.Component.Core.prototype);this.components={};for(var c=0;c<a.length;c++){var d=a[c],e=!1;"Destroy"===d&&(e=!0);b.Utils.mixinPrototype(this,b.Component[d].prototype,e);this.components[d]=!0}};b.Component.Core.init=function(a,c,d,e,g){this.game=a;this.key=e;this.position.set(c,d);this.world=new b.Point(c,d);this.previousPosition=new b.Point(c,d);this.events=new b.Events(this);
this._bounds=new b.Rectangle;this.components.PhysicsBody&&(this.body=this.body);this.components.Animation&&(this.animations=new b.AnimationManager(this));this.components.LoadTexture&&null!==e&&this.loadTexture(e,g);this.components.FixedToCamera&&(this.cameraOffset=new b.Point(c,d))};b.Component.Core.preUpdate=function(){if(this.pendingDestroy)this.destroy();else{this.previousPosition.set(this.world.x,this.world.y);this.previousRotation=this.rotation;if(!this.exists||!this.parent.exists)return this.renderOrderID=
-1,!1;this.world.setTo(this.game.camera.x+this.worldTransform.tx,this.game.camera.y+this.worldTransform.ty);this.visible&&(this.renderOrderID=this.game.stage.currentRenderOrderID++);this.texture&&(this.texture.requiresReTint=!1);this.animations&&this.animations.update();this.body&&this.body.preUpdate();for(var a=0;a<this.children.length;a++)this.children[a].preUpdate();return!0}};b.Component.Core.prototype={game:null,name:"",components:{},z:0,events:void 0,animations:void 0,key:"",world:null,debug:!1,
previousPosition:null,previousRotation:0,renderOrderID:0,fresh:!0,pendingDestroy:!1,_bounds:null,_exists:!0,exists:{get:function(){return this._exists},set:function(a){a?(this._exists=!0,this.body&&this.body.type===b.Physics.P2JS&&this.body.addToWorld(),this.visible=!0):(this._exists=!1,this.body&&this.body.type===b.Physics.P2JS&&this.body.removeFromWorld(),this.visible=!1)}},update:function(){},postUpdate:function(){this.customRender&&this.key.render();this.components.PhysicsBody&&b.Component.PhysicsBody.postUpdate.call(this);
this.components.FixedToCamera&&b.Component.FixedToCamera.postUpdate.call(this);for(var a=0;a<this.children.length;a++)this.children[a].postUpdate()}};b.Component.Crop=function(){};b.Component.Crop.prototype={cropRect:null,_crop:null,crop:function(a,c){void 0===c&&(c=!1);a?(c&&null!==this.cropRect?this.cropRect.setTo(a.x,a.y,a.width,a.height):this.cropRect=c&&null===this.cropRect?new b.Rectangle(a.x,a.y,a.width,a.height):a,this.updateCrop()):(this.cropRect=this._crop=null,this.resetFrame())},updateCrop:function(){if(this.cropRect){this._crop=
b.Rectangle.clone(this.cropRect,this._crop);this._crop.x+=this._frame.x;this._crop.y+=this._frame.y;var a=Math.max(this._frame.x,this._crop.x),c=Math.max(this._frame.y,this._crop.y),d=Math.min(this._frame.right,this._crop.right)-a,e=Math.min(this._frame.bottom,this._crop.bottom)-c;this.texture.crop.x=a;this.texture.crop.y=c;this.texture.crop.width=d;this.texture.crop.height=e;this.texture.frame.width=Math.min(d,this.cropRect.width);this.texture.frame.height=Math.min(e,this.cropRect.height);this.texture.width=
this.texture.frame.width;this.texture.height=this.texture.frame.height;this.texture._updateUvs()}}};b.Component.Delta=function(){};b.Component.Delta.prototype={deltaX:{get:function(){return this.world.x-this.previousPosition.x}},deltaY:{get:function(){return this.world.y-this.previousPosition.y}},deltaZ:{get:function(){return this.rotation-this.previousRotation}}};b.Component.Destroy=function(){};b.Component.Destroy.prototype={destroyPhase:!1,destroy:function(a){if(null!==this.game&&!this.destroyPhase){void 0===
a&&(a=!0);this.destroyPhase=!0;if(this.events)this.events.onDestroy$dispatch(this);this.parent&&(this.parent instanceof b.Group?this.parent.remove(this):this.parent.removeChild(this));this.input&&this.input.destroy();this.animations&&this.animations.destroy();this.body&&this.body.destroy();this.events&&this.events.destroy();var c=this.children.length;if(a)for(;c--;)this.children[c].destroy(a);else for(;c--;)this.removeChild(this.children[c]);this._crop&&(this._crop=null);this._frame&&(this._frame=
null);b.Video&&this.key instanceof b.Video&&this.key.onChangeSource.remove(this.resizeFrame,this);b.BitmapText&&this._glyphs&&(this._glyphs=[]);this.visible=this.exists=this.alive=!1;this.game=this.mask=this.filters=null;this.renderable=!1;this._mask=this._currentBounds=this._bounds=this.filterArea=this.worldTransform=this.stage=this.parent=this.hitArea=this.transformCallbackContext=this.transformCallback=null;this._destroyCachedSprite();this.pendingDestroy=this.destroyPhase=!1}}};b.Events=function(a){this.parent=
a};b.Events.prototype={destroy:function(){this._parent=null;this._onDestroy&&this._onDestroy.dispose();this._onAddedToGroup&&this._onAddedToGroup.dispose();this._onRemovedFromGroup&&this._onRemovedFromGroup.dispose();this._onRemovedFromWorld&&this._onRemovedFromWorld.dispose();this._onKilled&&this._onKilled.dispose();this._onRevived&&this._onRevived.dispose();this._onEnterBounds&&this._onEnterBounds.dispose();this._onOutOfBounds&&this._onOutOfBounds.dispose();this._onInputOver&&this._onInputOver.dispose();
this._onInputOut&&this._onInputOut.dispose();this._onInputDown&&this._onInputDown.dispose();this._onInputUp&&this._onInputUp.dispose();this._onDragStart&&this._onDragStart.dispose();this._onDragUpdate&&this._onDragUpdate.dispose();this._onDragStop&&this._onDragStop.dispose();this._onAnimationStart&&this._onAnimationStart.dispose();this._onAnimationComplete&&this._onAnimationComplete.dispose();this._onAnimationLoop&&this._onAnimationLoop.dispose()},onAddedToGroup:null,onRemovedFromGroup:null,onRemovedFromWorld:null,
onDestroy:null,onKilled:null,onRevived:null,onOutOfBounds:null,onEnterBounds:null,onInputOver:null,onInputOut:null,onInputDown:null,onInputUp:null,onDragStart:null,onDragUpdate:null,onDragStop:null,onAnimationStart:null,onAnimationComplete:null,onAnimationLoop:null};b.Events.prototype.constructor=b.Events;for(var m in b.Events.prototype)b.Events.prototype.hasOwnProperty(m)&&0===m.indexOf("on")&&null===b.Events.prototype[m]&&function(a,c){Object.defineProperty(b.Events.prototype,a,{get:function(){return this[c]||
(this[c]=new b.Signal)}});b.Events.prototype[a+"$dispatch"]=function(){return this[c]?this[c].dispatch.apply(this[c],arguments):null}}(m,"_"+m);b.Component.FixedToCamera=function(){};b.Component.FixedToCamera.postUpdate=function(){this.fixedToCamera&&(this.position.x=(this.game.camera.view.x+this.cameraOffset.x)/this.game.camera.scale.x,this.position.y=(this.game.camera.view.y+this.cameraOffset.y)/this.game.camera.scale.y)};b.Component.FixedToCamera.prototype={_fixedToCamera:!1,fixedToCamera:{get:function(){return this._fixedToCamera},
set:function(a){a?(this._fixedToCamera=!0,this.cameraOffset.set(this.x,this.y)):this._fixedToCamera=!1}},cameraOffset:new b.Point};b.Component.Health=function(){};b.Component.Health.prototype={health:1,maxHealth:100,damage:function(a){this.alive&&(this.health-=a,0>=this.health&&this.kill());return this},heal:function(a){this.alive&&(this.health+=a,this.health>this.maxHealth&&(this.health=this.maxHealth));return this}};b.Component.InCamera=function(){};b.Component.InCamera.prototype={inCamera:{get:function(){return this.game.world.camera.view.intersects(this._bounds)}}};
b.Component.InputEnabled=function(){};b.Component.InputEnabled.prototype={input:null,inputEnabled:{get:function(){return this.input&&this.input.enabled},set:function(a){a?null===this.input?(this.input=new b.InputHandler(this),this.input.start()):this.input&&!this.input.enabled&&this.input.start():this.input&&this.input.enabled&&this.input.stop()}}};b.Component.InWorld=function(){};b.Component.InWorld.preUpdate=function(){if(this.autoCull||this.checkWorldBounds)if(this._bounds.copyFrom(this.getBounds()),
this._bounds.x+=this.game.camera.view.x,this._bounds.y+=this.game.camera.view.y,this.autoCull&&(this.game.world.camera.view.intersects(this._bounds)?(this.renderable=!0,this.game.world.camera.totalInView++):this.renderable=!1),this.checkWorldBounds)if(this._outOfBoundsFired&&this.game.world.bounds.intersects(this._bounds))this._outOfBoundsFired=!1,this.events.onEnterBounds$dispatch(this);else if(!this._outOfBoundsFired&&!this.game.world.bounds.intersects(this._bounds)&&(this._outOfBoundsFired=!0,
this.events.onOutOfBounds$dispatch(this),this.outOfBoundsKill))return this.kill(),!1;return!0};b.Component.InWorld.prototype={checkWorldBounds:!1,outOfBoundsKill:!1,_outOfBoundsFired:!1,inWorld:{get:function(){return this.game.world.bounds.intersects(this.getBounds())}}};b.Component.LifeSpan=function(){};b.Component.LifeSpan.preUpdate=function(){return 0<this.lifespan&&(this.lifespan-=this.game.time.physicsElapsedMS,0>=this.lifespan)?(this.kill(),!1):!0};b.Component.LifeSpan.prototype={alive:!0,lifespan:0,
revive:function(a){void 0===a&&(a=1);this.visible=this.exists=this.alive=!0;"number"===typeof this.health&&(this.health=a);if(this.events)this.events.onRevived$dispatch(this);return this},kill:function(){this.visible=this.exists=this.alive=!1;if(this.events)this.events.onKilled$dispatch(this);return this}};b.Component.LoadTexture=function(){};b.Component.LoadTexture.prototype={customRender:!1,_frame:null,loadTexture:function(a,c,d){c=c||0;(d||void 0===d)&&this.animations&&this.animations.stop();this.key=
a;this.customRender=!1;var e=this.game.cache,g=!0;d=!this.texture.baseTexture.scaleMode;b.RenderTexture&&a instanceof b.RenderTexture?(this.key=a.key,this.setTexture(a)):b.BitmapData&&a instanceof b.BitmapData?(this.customRender=!0,this.setTexture(a.texture),e.hasFrameData(a.key,b.Cache.BITMAPDATA)&&(g=!this.animations.loadFrameData(e.getFrameData(a.key,b.Cache.BITMAPDATA),c))):b.Video&&a instanceof b.Video?(this.customRender=!0,c=a.texture.valid,this.setTexture(a.texture),this.setFrame(a.texture.frame.clone()),
a.onChangeSource.add(this.resizeFrame,this),this.texture.valid=c):a instanceof PIXI.Texture?this.setTexture(a):(a=e.getImage(a,!0),this.key=a.key,this.setTexture(new PIXI.Texture(a.base)),g=!this.animations.loadFrameData(a.frameData,c));g&&(this._frame=b.Rectangle.clone(this.texture.frame));d||(this.texture.baseTexture.scaleMode=1)},setFrame:function(a){this._frame=a;this.texture.frame.x=a.x;this.texture.frame.y=a.y;this.texture.frame.width=a.width;this.texture.frame.height=a.height;this.texture.crop.x=
a.x;this.texture.crop.y=a.y;this.texture.crop.width=a.width;this.texture.crop.height=a.height;a.trimmed?(this.texture.trim?(this.texture.trim.x=a.spriteSourceSizeX,this.texture.trim.y=a.spriteSourceSizeY,this.texture.trim.width=a.sourceSizeW,this.texture.trim.height=a.sourceSizeH):this.texture.trim={x:a.spriteSourceSizeX,y:a.spriteSourceSizeY,width:a.sourceSizeW,height:a.sourceSizeH},this.texture.width=a.sourceSizeW,this.texture.height=a.sourceSizeH,this.texture.frame.width=a.sourceSizeW,this.texture.frame.height=
a.sourceSizeH):!a.trimmed&&this.texture.trim&&(this.texture.trim=null);this.cropRect&&this.updateCrop();this.texture.requiresReTint=!0;this.texture._updateUvs();this.tilingTexture&&(this.refreshTexture=!0)},resizeFrame:function(a,c,b){this.texture.frame.resize(c,b);this.texture.setFrame(this.texture.frame)},resetFrame:function(){this._frame&&this.setFrame(this._frame)},frame:{get:function(){return this.animations.frame},set:function(a){this.animations.frame=a}},frameName:{get:function(){return this.animations.frameName},
set:function(a){this.animations.frameName=a}}};b.Component.Overlap=function(){};b.Component.Overlap.prototype={overlap:function(a){return b.Rectangle.intersects(this.getBounds(),a.getBounds())}};b.Component.PhysicsBody=function(){};b.Component.PhysicsBody.preUpdate=function(){if(this.fresh&&this.exists)return this.world.setTo(this.parent.position.x+this.position.x,this.parent.position.y+this.position.y),this.worldTransform.tx=this.world.x,this.worldTransform.ty=this.world.y,this.previousPosition.set(this.world.x,
this.world.y),this.previousRotation=this.rotation,this.body&&this.body.preUpdate(),this.fresh=!1;this.previousPosition.set(this.world.x,this.world.y);this.previousRotation=this.rotation;return this._exists&&this.parent.exists?!0:(this.renderOrderID=-1,!1)};b.Component.PhysicsBody.postUpdate=function(){this.exists&&this.body&&this.body.postUpdate()};b.Component.PhysicsBody.prototype={body:null,x:{get:function(){return this.position.x},set:function(a){this.position.x=a;this.body&&!this.body.dirty&&
(this.body._reset=!0)}},y:{get:function(){return this.position.y},set:function(a){this.position.y=a;this.body&&!this.body.dirty&&(this.body._reset=!0)}}};b.Component.Reset=function(){};b.Component.Reset.prototype.reset=function(a,c,b){void 0===b&&(b=1);this.world.set(a,c);this.position.set(a,c);this.renderable=this.visible=this.exists=this.fresh=!0;this.components.InWorld&&(this._outOfBoundsFired=!1);this.components.LifeSpan&&(this.alive=!0,this.health=b);this.components.PhysicsBody&&this.body&&this.body.reset(a,
c,!1,!1);return this};b.Component.ScaleMinMax=function(){};b.Component.ScaleMinMax.prototype={transformCallback:this.checkTransform,transformCallbackContext:this,scaleMin:null,scaleMax:null,checkTransform:function(a){this.scaleMin&&(a.a<this.scaleMin.x&&(a.a=this.scaleMin.x),a.d<this.scaleMin.y&&(a.d=this.scaleMin.y));this.scaleMax&&(a.a>this.scaleMax.x&&(a.a=this.scaleMax.x),a.d>this.scaleMax.y&&(a.d=this.scaleMax.y))},setScaleMinMax:function(a,c,d,e){void 0===c?c=d=e=a:void 0===d&&(d=e=c,c=a);null===
a?this.scaleMin=null:this.scaleMin?this.scaleMin.set(a,c):this.scaleMin=new b.Point(a,c);null===d?this.scaleMax=null:this.scaleMax?this.scaleMax.set(d,e):this.scaleMax=new b.Point(d,e)}};b.Component.Smoothed=function(){};b.Component.Smoothed.prototype={smoothed:{get:function(){return!this.texture.baseTexture.scaleMode},set:function(a){a?this.texture&&(this.texture.baseTexture.scaleMode=0):this.texture&&(this.texture.baseTexture.scaleMode=1)}}};b.GameObjectFactory=function(a){this.game=a;this.world=
this.game.world};b.GameObjectFactory.prototype={existing:function(a){return this.world.add(a)},image:function(a,c,d,e,g){void 0===g&&(g=this.world);return g.add(new b.Image(this.game,a,c,d,e))},sprite:function(a,c,b,e,g){void 0===g&&(g=this.world);return g.create(a,c,b,e)},creature:function(a,c,d,e,g){void 0===g&&(g=this.world);a=new b.Creature(this.game,a,c,d,e);g.add(a);return a},tween:function(a){return this.game.tweens.create(a)},group:function(a,c,d,e,g){return new b.Group(this.game,a,c,d,e,
g)},physicsGroup:function(a,c,d,e){return new b.Group(this.game,c,d,e,!0,a)},spriteBatch:function(a,c,d){void 0===a&&(a=null);void 0===c&&(c="group");void 0===d&&(d=!1);return new b.SpriteBatch(this.game,a,c,d)},audio:function(a,c,b,e){return this.game.sound.add(a,c,b,e)},sound:function(a,c,b,e){return this.game.sound.add(a,c,b,e)},audioSprite:function(a){return this.game.sound.addSprite(a)},tileSprite:function(a,c,d,e,g,l,p){void 0===p&&(p=this.world);return p.add(new b.TileSprite(this.game,a,c,
d,e,g,l))},rope:function(a,c,d,e,g,l){void 0===l&&(l=this.world);return l.add(new b.Rope(this.game,a,c,d,e,g))},text:function(a,c,d,e,g){void 0===g&&(g=this.world);return g.add(new b.Text(this.game,a,c,d,e))},button:function(a,c,d,e,g,l,p,f,h,k){void 0===k&&(k=this.world);return k.add(new b.Button(this.game,a,c,d,e,g,l,p,f,h))},graphics:function(a,c,d){void 0===d&&(d=this.world);return d.add(new b.Graphics(this.game,a,c))},emitter:function(a,c,d){return this.game.particles.add(new b.Particles.Arcade.Emitter(this.game,
a,c,d))},retroFont:function(a,c,d,e,g,l,p,f,h){return new b.RetroFont(this.game,a,c,d,e,g,l,p,f,h)},bitmapText:function(a,c,d,e,g,l){void 0===l&&(l=this.world);return l.add(new b.BitmapText(this.game,a,c,d,e,g))},tilemap:function(a,c,d,e,g){return new b.Tilemap(this.game,a,c,d,e,g)},renderTexture:function(a,c,d,e){if(void 0===d||""===d)d=this.game.rnd.uuid();void 0===e&&(e=!1);a=new b.RenderTexture(this.game,a,c,d);e&&this.game.cache.addRenderTexture(d,a);return a},video:function(a,c){return new b.Video(this.game,
a,c)},bitmapData:function(a,c,d,e){void 0===e&&(e=!1);if(void 0===d||""===d)d=this.game.rnd.uuid();a=new b.BitmapData(this.game,d,a,c);e&&this.game.cache.addBitmapData(d,a);return a},filter:function(a){var c=Array.prototype.splice.call(arguments,1);a=new b.Filter[a](this.game);a.init.apply(a,c);return a},plugin:function(a){return this.game.plugins.add(a)}};b.GameObjectFactory.prototype.constructor=b.GameObjectFactory;b.GameObjectCreator=function(a){this.game=a;this.world=this.game.world};b.GameObjectCreator.prototype=
{image:function(a,c,d,e){return new b.Image(this.game,a,c,d,e)},sprite:function(a,c,d,e){return new b.Sprite(this.game,a,c,d,e)},tween:function(a){return new b.Tween(a,this.game,this.game.tweens)},group:function(a,c,d,e,g){return new b.Group(this.game,a,c,d,e,g)},spriteBatch:function(a,c,d){void 0===c&&(c="group");void 0===d&&(d=!1);return new b.SpriteBatch(this.game,a,c,d)},audio:function(a,c,b,e){return this.game.sound.add(a,c,b,e)},audioSprite:function(a){return this.game.sound.addSprite(a)},sound:function(a,
c,b,e){return this.game.sound.add(a,c,b,e)},tileSprite:function(a,c,d,e,g,l){return new b.TileSprite(this.game,a,c,d,e,g,l)},rope:function(a,c,d,e,g){return new b.Rope(this.game,a,c,d,e,g)},text:function(a,c,d,e){return new b.Text(this.game,a,c,d,e)},button:function(a,c,d,e,g,l,p,f,h){return new b.Button(this.game,a,c,d,e,g,l,p,f,h)},graphics:function(a,c){return new b.Graphics(this.game,a,c)},emitter:function(a,c,d){return new b.Particles.Arcade.Emitter(this.game,a,c,d)},retroFont:function(a,c,d,
e,g,l,p,f,h){return new b.RetroFont(this.game,a,c,d,e,g,l,p,f,h)},bitmapText:function(a,c,d,e,g,l){return new b.BitmapText(this.game,a,c,d,e,g,l)},tilemap:function(a,c,d,e,g){return new b.Tilemap(this.game,a,c,d,e,g)},renderTexture:function(a,c,d,e){if(void 0===d||""===d)d=this.game.rnd.uuid();void 0===e&&(e=!1);a=new b.RenderTexture(this.game,a,c,d);e&&this.game.cache.addRenderTexture(d,a);return a},bitmapData:function(a,c,d,e){void 0===e&&(e=!1);if(void 0===d||""===d)d=this.game.rnd.uuid();a=new b.BitmapData(this.game,
d,a,c);e&&this.game.cache.addBitmapData(d,a);return a},filter:function(a){var c=Array.prototype.splice.call(arguments,1);a=new b.Filter[a](this.game);a.init.apply(a,c);return a}};b.GameObjectCreator.prototype.constructor=b.GameObjectCreator;b.Sprite=function(a,c,d,e,g){c=c||0;d=d||0;e=e||null;g=g||null;this.physicsType=this.type=b.SPRITE;PIXI.Sprite.call(this,PIXI.TextureCache.__default);b.Component.Core.init.call(this,a,c,d,e,g)};b.Sprite.prototype=Object.create(PIXI.Sprite.prototype);b.Sprite.prototype.constructor=
b.Sprite;b.Component.Core.install.call(b.Sprite.prototype,"Angle Animation AutoCull Bounds BringToTop Crop Delta Destroy FixedToCamera Health InCamera InputEnabled InWorld LifeSpan LoadTexture Overlap PhysicsBody Reset ScaleMinMax Smoothed".split(" "));b.Sprite.prototype.preUpdatePhysics=b.Component.PhysicsBody.preUpdate;b.Sprite.prototype.preUpdateLifeSpan=b.Component.LifeSpan.preUpdate;b.Sprite.prototype.preUpdateInWorld=b.Component.InWorld.preUpdate;b.Sprite.prototype.preUpdateCore=b.Component.Core.preUpdate;
b.Sprite.prototype.preUpdate=function(){return this.preUpdatePhysics()&&this.preUpdateLifeSpan()&&this.preUpdateInWorld()?this.preUpdateCore():!1};b.Image=function(a,c,d,e,g){c=c||0;d=d||0;e=e||null;g=g||null;this.type=b.IMAGE;PIXI.Sprite.call(this,PIXI.TextureCache.__default);b.Component.Core.init.call(this,a,c,d,e,g)};b.Image.prototype=Object.create(PIXI.Sprite.prototype);b.Image.prototype.constructor=b.Image;b.Component.Core.install.call(b.Image.prototype,"Angle Animation AutoCull Bounds BringToTop Crop Destroy FixedToCamera InputEnabled LifeSpan LoadTexture Overlap Reset Smoothed".split(" "));
b.Image.prototype.preUpdateInWorld=b.Component.InWorld.preUpdate;b.Image.prototype.preUpdateCore=b.Component.Core.preUpdate;b.Image.prototype.preUpdate=function(){return this.preUpdateInWorld()?this.preUpdateCore():!1};b.TileSprite=function(a,c,d,e,g,l,p){c=c||0;d=d||0;e=e||256;g=g||256;l=l||null;p=p||null;this.type=b.TILESPRITE;this.physicsType=b.SPRITE;this._scroll=new b.Point;var f=a.cache.getImage("__default",!0);PIXI.TilingSprite.call(this,new PIXI.Texture(f.base),e,g);b.Component.Core.init.call(this,
a,c,d,l,p)};b.TileSprite.prototype=Object.create(PIXI.TilingSprite.prototype);b.TileSprite.prototype.constructor=b.TileSprite;b.Component.Core.install.call(b.TileSprite.prototype,"Angle Animation AutoCull Bounds BringToTop Destroy FixedToCamera Health InCamera InputEnabled InWorld LifeSpan LoadTexture Overlap PhysicsBody Reset Smoothed".split(" "));b.TileSprite.prototype.preUpdatePhysics=b.Component.PhysicsBody.preUpdate;b.TileSprite.prototype.preUpdateLifeSpan=b.Component.LifeSpan.preUpdate;b.TileSprite.prototype.preUpdateInWorld=
b.Component.InWorld.preUpdate;b.TileSprite.prototype.preUpdateCore=b.Component.Core.preUpdate;b.TileSprite.prototype.preUpdate=function(){0!==this._scroll.x&&(this.tilePosition.x+=this._scroll.x*this.game.time.physicsElapsed);0!==this._scroll.y&&(this.tilePosition.y+=this._scroll.y*this.game.time.physicsElapsed);return this.preUpdatePhysics()&&this.preUpdateLifeSpan()&&this.preUpdateInWorld()?this.preUpdateCore():!1};b.TileSprite.prototype.autoScroll=function(a,c){this._scroll.set(a,c)};b.TileSprite.prototype.stopScroll=
function(){this._scroll.set(0,0)};b.TileSprite.prototype.destroy=function(a){b.Component.Destroy.prototype.destroy.call(this,a);PIXI.TilingSprite.prototype.destroy.call(this)};b.TileSprite.prototype.reset=function(a,c){b.Component.Reset.prototype.reset.call(this,a,c);this.tilePosition.x=0;this.tilePosition.y=0;return this};b.Rope=function(a,c,d,e,g,l){this.points=[];this.points=l;this._hasUpdateAnimation=!1;this._updateAnimationCallback=null;c=c||0;d=d||0;e=e||null;g=g||null;this.type=b.ROPE;this._scroll=
new b.Point;PIXI.Rope.call(this,PIXI.TextureCache.__default,this.points);b.Component.Core.init.call(this,a,c,d,e,g)};b.Rope.prototype=Object.create(PIXI.Rope.prototype);b.Rope.prototype.constructor=b.Rope;b.Component.Core.install.call(b.Rope.prototype,"Angle Animation AutoCull Bounds BringToTop Crop Delta Destroy FixedToCamera InputEnabled InWorld LifeSpan LoadTexture Overlap PhysicsBody Reset ScaleMinMax Smoothed".split(" "));b.Rope.prototype.preUpdatePhysics=b.Component.PhysicsBody.preUpdate;b.Rope.prototype.preUpdateLifeSpan=
b.Component.LifeSpan.preUpdate;b.Rope.prototype.preUpdateInWorld=b.Component.InWorld.preUpdate;b.Rope.prototype.preUpdateCore=b.Component.Core.preUpdate;b.Rope.prototype.preUpdate=function(){0!==this._scroll.x&&(this.tilePosition.x+=this._scroll.x*this.game.time.physicsElapsed);0!==this._scroll.y&&(this.tilePosition.y+=this._scroll.y*this.game.time.physicsElapsed);return this.preUpdatePhysics()&&this.preUpdateLifeSpan()&&this.preUpdateInWorld()?this.preUpdateCore():!1};b.Rope.prototype.update=function(){this._hasUpdateAnimation&&
this.updateAnimation.call(this)};b.Rope.prototype.reset=function(a,c){b.Component.Reset.prototype.reset.call(this,a,c);this.tilePosition.x=0;this.tilePosition.y=0;return this};Object.defineProperty(b.Rope.prototype,"updateAnimation",{get:function(){return this._updateAnimation},set:function(a){a&&"function"===typeof a?(this._hasUpdateAnimation=!0,this._updateAnimation=a):(this._hasUpdateAnimation=!1,this._updateAnimation=null)}});Object.defineProperty(b.Rope.prototype,"segments",{get:function(){for(var a=
[],c,d,e,g,l=0;l<this.points.length;l++)c=4*l,d=this.vertices[c]*this.scale.x,e=this.vertices[c+1]*this.scale.y,g=this.vertices[c+4]*this.scale.x,c=this.vertices[c+3]*this.scale.y,g=b.Math.difference(d,g),c=b.Math.difference(e,c),d+=this.world.x,e+=this.world.y,d=new b.Rectangle(d,e,g,c),a.push(d);return a}});b.Button=function(a,c,d,e,g,l,p,f,h,k){g=g||null;l=l||this;b.Image.call(this,a,c||0,d||0,e||null,f);this.type=b.BUTTON;this.physicsType=b.SPRITE;this.onUpSound=this.onDownSound=this.onOutSound=
this.onOverSound=this._onUpFrame=this._onDownFrame=this._onOutFrame=this._onOverFrame=null;this.onUpSoundMarker=this.onDownSoundMarker=this.onOutSoundMarker=this.onOverSoundMarker="";this.onInputOver=new b.Signal;this.onInputOut=new b.Signal;this.onInputDown=new b.Signal;this.onInputUp=new b.Signal;this.forceOut=this.freezeFrames=this.onOverMouseOnly=!1;this.inputEnabled=!0;this.input.start(0,!0);this.input.useHandCursor=!0;this.setFrames(p,f,h,k);null!==g&&this.onInputUp.add(g,l);this.events.onInputOver.add(this.onInputOverHandler,
this);this.events.onInputOut.add(this.onInputOutHandler,this);this.events.onInputDown.add(this.onInputDownHandler,this);this.events.onInputUp.add(this.onInputUpHandler,this);this.events.onRemovedFromWorld.add(this.removedFromWorld,this)};b.Button.prototype=Object.create(b.Image.prototype);b.Button.prototype.constructor=b.Button;b.Button.prototype.clearFrames=function(){this.setFrames(null,null,null,null)};b.Button.prototype.removedFromWorld=function(){this.inputEnabled=!1};b.Button.prototype.setStateFrame=
function(a,c,b){var e="_on"+a+"Frame";null!==c?(this[e]=c,b&&this.changeStateFrame(a)):this[e]=null};b.Button.prototype.changeStateFrame=function(a){if(this.freezeFrames)return!1;a=this["_on"+a+"Frame"];return"string"===typeof a?(this.frameName=a,!0):"number"===typeof a?(this.frame=a,!0):!1};b.Button.prototype.setFrames=function(a,c,b,e){this.setStateFrame("Over",a,this.input.pointerOver());this.setStateFrame("Out",c,!this.input.pointerOver());this.setStateFrame("Down",b,this.input.pointerDown());
this.setStateFrame("Up",e,this.input.pointerUp())};b.Button.prototype.setStateSound=function(a,c,d){var e="on"+a+"Sound";a="on"+a+"SoundMarker";c instanceof b.Sound||c instanceof b.AudioSprite?(this[e]=c,this[a]="string"===typeof d?d:""):(this[e]=null,this[a]="")};b.Button.prototype.playStateSound=function(a){var c=this["on"+a+"Sound"];return c?(c.play(this["on"+a+"SoundMarker"]),!0):!1};b.Button.prototype.setSounds=function(a,c,b,e,g,l,p,f){this.setStateSound("Over",a,c);this.setStateSound("Out",
g,l);this.setStateSound("Down",b,e);this.setStateSound("Up",p,f)};b.Button.prototype.setOverSound=function(a,c){this.setStateSound("Over",a,c)};b.Button.prototype.setOutSound=function(a,c){this.setStateSound("Out",a,c)};b.Button.prototype.setDownSound=function(a,c){this.setStateSound("Down",a,c)};b.Button.prototype.setUpSound=function(a,c){this.setStateSound("Up",a,c)};b.Button.prototype.onInputOverHandler=function(a,c){c.justReleased()||(this.changeStateFrame("Over"),this.onOverMouseOnly&&!c.isMouse)||
(this.playStateSound("Over"),this.onInputOver&&this.onInputOver.dispatch(this,c))};b.Button.prototype.onInputOutHandler=function(a,c){this.changeStateFrame("Out");this.playStateSound("Out");this.onInputOut&&this.onInputOut.dispatch(this,c)};b.Button.prototype.onInputDownHandler=function(a,c){this.changeStateFrame("Down");this.playStateSound("Down");this.onInputDown&&this.onInputDown.dispatch(this,c)};b.Button.prototype.onInputUpHandler=function(a,c,b){this.playStateSound("Up");this.onInputUp&&this.onInputUp.dispatch(this,
c,b);this.freezeFrames||(this.forceOut?this.changeStateFrame("Out"):this.changeStateFrame("Up")||(b?this.changeStateFrame("Over"):this.changeStateFrame("Out")))};b.SpriteBatch=function(a,c,d,e){if(void 0===c||null===c)c=a.world;PIXI.SpriteBatch.call(this);b.Group.call(this,a,c,d,e);this.type=b.SPRITEBATCH};b.SpriteBatch.prototype=b.Utils.extend(!0,b.SpriteBatch.prototype,b.Group.prototype,PIXI.SpriteBatch.prototype);b.SpriteBatch.prototype.constructor=b.SpriteBatch;b.Particle=function(a,c,d,e,g){b.Sprite.call(this,
a,c,d,e,g);this.autoScale=!1;this.scaleData=null;this._s=0;this.autoAlpha=!1;this.alphaData=null;this._a=0};b.Particle.prototype=Object.create(b.Sprite.prototype);b.Particle.prototype.constructor=b.Particle;b.Particle.prototype.update=function(){this.autoScale&&(this._s--,this._s?this.scale.set(this.scaleData[this._s].x,this.scaleData[this._s].y):this.autoScale=!1);this.autoAlpha&&(this._a--,this._a?this.alpha=this.alphaData[this._a].v:this.autoAlpha=!1)};b.Particle.prototype.onEmit=function(){};
b.Particle.prototype.setAlphaData=function(a){this.alphaData=a;this._a=a.length-1;this.alpha=this.alphaData[this._a].v;this.autoAlpha=!0};b.Particle.prototype.setScaleData=function(a){this.scaleData=a;this._s=a.length-1;this.scale.set(this.scaleData[this._s].x,this.scaleData[this._s].y);this.autoScale=!0};b.Particle.prototype.reset=function(a,c,d){b.Component.Reset.prototype.reset.call(this,a,c,d);this.alpha=1;this.scale.set(1);this.autoAlpha=this.autoScale=!1;return this};b.BitmapData=function(a,
c,d,e){if(void 0===d||0===d)d=256;if(void 0===e||0===e)e=256;this.game=a;this.key=c;this.width=d;this.height=e;this.canvas=b.Canvas.create(d,e,"",!0);this.ctx=this.context=this.canvas.getContext("2d",{alpha:!0});this.imageData=this.context.getImageData(0,0,d,e);this.data=null;this.imageData&&(this.data=this.imageData.data);this.pixels=null;this.data&&(this.imageData.data.buffer?(this.buffer=this.imageData.data.buffer,this.pixels=new Uint32Array(this.buffer)):window.ArrayBuffer?(this.buffer=new ArrayBuffer(this.imageData.data.length),
this.pixels=new Uint32Array(this.buffer)):this.pixels=this.imageData.data);this.baseTexture=new PIXI.BaseTexture(this.canvas);this.texture=new PIXI.Texture(this.baseTexture);this.textureFrame=new b.Frame(0,0,0,d,e,"bitmapData");this.texture.frame=this.textureFrame;this.type=b.BITMAPDATA;this.dirty=this.disableTextureUpload=!1;this.cls=this.clear;this._image=null;this._pos=new b.Point;this._size=new b.Point;this._scale=new b.Point;this._rotate=0;this._alpha={prev:1,current:1};this._anchor=new b.Point;
this._tempB=this._tempG=this._tempR=0;this._circle=new b.Circle;this._swapCanvas=b.Canvas.create(d,e,"",!0)};b.BitmapData.prototype={move:function(a,c){0!==a&&this.moveH(a);0!==c&&this.moveV(c);return this},moveH:function(a){var c=this._swapCanvas.getContext("2d"),b=this.height,e=this.canvas;c.clearRect(0,0,this.width,this.height);if(0>a){a=Math.abs(a);var g=this.width-a;c.drawImage(e,0,0,a,b,g,0,a,b);c.drawImage(e,a,0,g,b,0,0,g,b)}else g=this.width-a,c.drawImage(e,g,0,a,b,0,0,a,b),c.drawImage(e,
0,0,g,b,a,0,g,b);this.clear();return this.copy(this._swapCanvas)},moveV:function(a){var c=this._swapCanvas.getContext("2d"),b=this.width,e=this.canvas;c.clearRect(0,0,this.width,this.height);if(0>a){a=Math.abs(a);var g=this.height-a;c.drawImage(e,0,0,b,a,0,g,b,a);c.drawImage(e,0,a,b,g,0,0,b,g)}else g=this.height-a,c.drawImage(e,0,g,b,a,0,0,b,a),c.drawImage(e,0,0,b,g,0,a,b,g);this.clear();return this.copy(this._swapCanvas)},add:function(a){if(Array.isArray(a))for(var c=0;c<a.length;c++)a[c].loadTexture&&
a[c].loadTexture(this);else a.loadTexture(this);return this},load:function(a){"string"===typeof a&&(a=this.game.cache.getImage(a));if(a)return this.resize(a.width,a.height),this.cls(),this.draw(a),this.update(),this},clear:function(a,c,b,e){void 0===a&&(a=0);void 0===c&&(c=0);void 0===b&&(b=this.width);void 0===e&&(e=this.height);this.context.clearRect(a,c,b,e);this.dirty=!0;return this},fill:function(a,c,b,e){void 0===e&&(e=1);this.context.fillStyle="rgba("+a+","+c+","+b+","+e+")";this.context.fillRect(0,
0,this.width,this.height);this.dirty=!0;return this},generateTexture:function(a){var c=new Image;c.src=this.canvas.toDataURL("image/png");a=this.game.cache.addImage(a,"",c);return new PIXI.Texture(a.base)},resize:function(a,c){if(a!==this.width||c!==this.height)this.width=a,this.height=c,this.canvas.width=a,this.canvas.height=c,this._swapCanvas.width=a,this._swapCanvas.height=c,this.baseTexture.width=a,this.baseTexture.height=c,this.textureFrame.width=a,this.textureFrame.height=c,this.texture.width=
a,this.texture.height=c,this.texture.crop.width=a,this.texture.crop.height=c,this.update(),this.dirty=!0;return this},update:function(a,c,b,e){void 0===a&&(a=0);void 0===c&&(c=0);void 0===b&&(b=Math.max(1,this.width));void 0===e&&(e=Math.max(1,this.height));this.imageData=this.context.getImageData(a,c,b,e);this.data=this.imageData.data;this.imageData.data.buffer?(this.buffer=this.imageData.data.buffer,this.pixels=new Uint32Array(this.buffer)):window.ArrayBuffer?(this.buffer=new ArrayBuffer(this.imageData.data.length),
this.pixels=new Uint32Array(this.buffer)):this.pixels=this.imageData.data;return this},processPixelRGB:function(a,c,d,e,g,l){void 0===d&&(d=0);void 0===e&&(e=0);void 0===g&&(g=this.width);void 0===l&&(l=this.height);g=d+g;l=e+l;for(var p=b.Color.createColor(),f={r:0,g:0,b:0,a:0},h=!1;e<l;e++)for(var k=d;k<g;k++)b.Color.unpackPixel(this.getPixel32(k,e),p),f=a.call(c,p,k,e),!1!==f&&null!==f&&void 0!==f&&(this.setPixel32(k,e,f.r,f.g,f.b,f.a,!1),h=!0);h&&(this.context.putImageData(this.imageData,0,0),
this.dirty=!0);return this},processPixel:function(a,c,b,e,g,l){void 0===b&&(b=0);void 0===e&&(e=0);void 0===g&&(g=this.width);void 0===l&&(l=this.height);g=b+g;l=e+l;for(var f=0,h=0,k=!1;e<l;e++)for(var m=b;m<g;m++)f=this.getPixel32(m,e),h=a.call(c,f,m,e),h!==f&&(this.pixels[e*this.width+m]=h,k=!0);k&&(this.context.putImageData(this.imageData,0,0),this.dirty=!0);return this},replaceRGB:function(a,c,d,e,g,l,f,h,k){var m=0,n=0,t=this.width,r=this.height;a=b.Color.packPixel(a,c,d,e);void 0!==k&&k instanceof
b.Rectangle&&(m=k.x,n=k.y,t=k.width,r=k.height);for(k=0;k<r;k++)for(c=0;c<t;c++)this.getPixel32(m+c,n+k)===a&&this.setPixel32(m+c,n+k,g,l,f,h,!1);this.context.putImageData(this.imageData,0,0);this.dirty=!0;return this},setHSL:function(a,c,d,e){if(void 0===a||null===a)a=!1;if(void 0===c||null===c)c=!1;if(void 0===d||null===d)d=!1;if(a||c||d){void 0===e&&(e=new b.Rectangle(0,0,this.width,this.height));for(var g=b.Color.createColor(),l=e.y;l<e.bottom;l++)for(var f=e.x;f<e.right;f++)b.Color.unpackPixel(this.getPixel32(f,
l),g,!0),a&&(g.h=a),c&&(g.s=c),d&&(g.l=d),b.Color.HSLtoRGB(g.h,g.s,g.l,g),this.setPixel32(f,l,g.r,g.g,g.b,g.a,!1);this.context.putImageData(this.imageData,0,0);this.dirty=!0;return this}},shiftHSL:function(a,c,d,e){if(void 0===a||null===a)a=!1;if(void 0===c||null===c)c=!1;if(void 0===d||null===d)d=!1;if(a||c||d){void 0===e&&(e=new b.Rectangle(0,0,this.width,this.height));for(var g=b.Color.createColor(),l=e.y;l<e.bottom;l++)for(var f=e.x;f<e.right;f++)b.Color.unpackPixel(this.getPixel32(f,l),g,!0),
a&&(g.h=this.game.math.wrap(g.h+a,0,1)),c&&(g.s=this.game.math.limitValue(g.s+c,0,1)),d&&(g.l=this.game.math.limitValue(g.l+d,0,1)),b.Color.HSLtoRGB(g.h,g.s,g.l,g),this.setPixel32(f,l,g.r,g.g,g.b,g.a,!1);this.context.putImageData(this.imageData,0,0);this.dirty=!0;return this}},setPixel32:function(a,c,d,e,g,l,f){void 0===f&&(f=!0);0<=a&&a<=this.width&&0<=c&&c<=this.height&&(this.pixels[c*this.width+a]=b.Device.LITTLE_ENDIAN?l<<24|g<<16|e<<8|d:d<<24|e<<16|g<<8|l,f&&(this.context.putImageData(this.imageData,
0,0),this.dirty=!0));return this},setPixel:function(a,c,b,e,g,l){return this.setPixel32(a,c,b,e,g,255,l)},getPixel:function(a,c,d){d||(d=b.Color.createColor());a=~~(a+c*this.width);a*=4;d.r=this.data[a];d.g=this.data[++a];d.b=this.data[++a];d.a=this.data[++a];return d},getPixel32:function(a,c){if(0<=a&&a<=this.width&&0<=c&&c<=this.height)return this.pixels[c*this.width+a]},getPixelRGB:function(a,c,d,e,g){return b.Color.unpackPixel(this.getPixel32(a,c),d,e,g)},getPixels:function(a){return this.context.getImageData(a.x,
a.y,a.width,a.height)},getFirstPixel:function(a){void 0===a&&(a=0);var c=b.Color.createColor(),d=0,e=0,g=1,l=!1;1===a?(g=-1,e=this.height):3===a&&(g=-1,d=this.width);do if(b.Color.unpackPixel(this.getPixel32(d,e),c),0===a||1===a){if(d++,d===this.width&&(d=0,e+=g,e>=this.height||0>=e))l=!0}else if(2===a||3===a)if(e++,e===this.height&&(e=0,d+=g,d>=this.width||0>=d))l=!0;while(0===c.a&&!l);c.x=d;c.y=e;return c},getBounds:function(a){void 0===a&&(a=new b.Rectangle);a.x=this.getFirstPixel(2).x;if(a.x===
this.width)return a.setTo(0,0,0,0);a.y=this.getFirstPixel(0).y;a.width=this.getFirstPixel(3).x-a.x+1;a.height=this.getFirstPixel(1).y-a.y+1;return a},addToWorld:function(a,c,b,e,g,l){g=g||1;l=l||1;a=this.game.add.image(a,c,this);a.anchor.set(b,e);a.scale.set(g,l);return a},copy:function(a,c,d,e,g,l,f,h,k,m,n,t,r,x,v,A,C){if(void 0===a||null===a)a=this;this._image=a;if(a instanceof b.Sprite||a instanceof b.Image||a instanceof b.Text){this._pos.set(a.texture.crop.x,a.texture.crop.y);this._size.set(a.texture.crop.width,
a.texture.crop.height);this._scale.set(a.scale.x,a.scale.y);this._anchor.set(a.anchor.x,a.anchor.y);this._rotate=a.rotation;this._alpha.current=a.alpha;this._image=a.texture.baseTexture.source;if(void 0===l||null===l)l=a.x;if(void 0===f||null===f)f=a.y;a.texture.trim&&(l+=a.texture.trim.x-a.anchor.x*a.texture.trim.width,f+=a.texture.trim.y-a.anchor.y*a.texture.trim.height);16777215!==a.tint&&(a.cachedTint!==a.tint&&(a.cachedTint=a.tint,a.tintedTexture=PIXI.CanvasTinter.getTintedTexture(a,a.tint)),
this._image=a.tintedTexture)}else{this._pos.set(0);this._scale.set(1);this._anchor.set(0);this._rotate=0;this._alpha.current=1;if(a instanceof b.BitmapData)this._image=a.canvas;else if("string"===typeof a){a=this.game.cache.getImage(a);if(null===a)return;this._image=a}this._size.set(this._image.width,this._image.height)}if(void 0===c||null===c)c=0;if(void 0===d||null===d)d=0;e&&(this._size.x=e);g&&(this._size.y=g);if(void 0===l||null===l)l=c;if(void 0===f||null===f)f=d;if(void 0===h||null===h)h=this._size.x;
if(void 0===k||null===k)k=this._size.y;"number"===typeof m&&(this._rotate=m);"number"===typeof n&&(this._anchor.x=n);"number"===typeof t&&(this._anchor.y=t);"number"===typeof r&&(this._scale.x=r);"number"===typeof x&&(this._scale.y=x);"number"===typeof v&&(this._alpha.current=v);void 0===A&&(A=null);void 0===C&&(C=!1);if(!(0>=this._alpha.current||0===this._scale.x||0===this._scale.y||0===this._size.x||0===this._size.y))return this._alpha.prev=this.context.globalAlpha,this.context.save(),this.context.globalAlpha=
this._alpha.current,A&&(this.context.globalCompositeOperation=A),C&&(l|=0,f|=0),this.context.translate(l,f),this.context.scale(this._scale.x,this._scale.y),this.context.rotate(this._rotate),this.context.drawImage(this._image,this._pos.x+c,this._pos.y+d,this._size.x,this._size.y,-h*this._anchor.x,-k*this._anchor.y,h,k),this.context.restore(),this.context.globalAlpha=this._alpha.prev,this.dirty=!0,this},copyRect:function(a,c,b,e,g,l,f){return this.copy(a,c.x,c.y,c.width,c.height,b,e,c.width,c.height,
0,0,0,1,1,g,l,f)},draw:function(a,c,b,e,g,l,f){return this.copy(a,null,null,null,null,c,b,e,g,null,null,null,null,null,null,l,f)},drawGroup:function(a,c,b){0<a.total&&a.forEachExists(this.copy,this,null,null,null,null,null,null,null,null,null,null,null,null,null,null,c,b);return this},shadow:function(a,c,b,e){void 0===a||null===a?this.context.shadowColor="rgba(0,0,0,0)":(this.context.shadowColor=a,this.context.shadowBlur=c||5,this.context.shadowOffsetX=b||10,this.context.shadowOffsetY=e||10)},alphaMask:function(a,
c,b,e){void 0===e||null===e?this.draw(c).blendSourceAtop():this.draw(c,e.x,e.y,e.width,e.height).blendSourceAtop();void 0===b||null===b?this.draw(a).blendReset():this.draw(a,b.x,b.y,b.width,b.height).blendReset();return this},extract:function(a,c,b,e,g,l,f,h,k){void 0===g&&(g=255);void 0===l&&(l=!1);void 0===f&&(f=c);void 0===h&&(h=b);void 0===k&&(k=e);l&&a.resize(this.width,this.height);this.processPixelRGB(function(l,m,n){l.r===c&&l.g===b&&l.b===e&&a.setPixel32(m,n,f,h,k,g,!1);return!1},this);a.context.putImageData(a.imageData,
0,0);a.dirty=!0;return a},rect:function(a,c,b,e,g){"undefined"!==typeof g&&(this.context.fillStyle=g);this.context.fillRect(a,c,b,e);return this},text:function(a,c,b,e,g,l){void 0===c&&(c=0);void 0===b&&(b=0);void 0===e&&(e="14px Courier");void 0===g&&(g="rgb(255,255,255)");void 0===l&&(l=!0);var f=this.context.font;this.context.font=e;l&&(this.context.fillStyle="rgb(0,0,0)",this.context.fillText(a,c+1,b+1));this.context.fillStyle=g;this.context.fillText(a,c,b);this.context.font=f},circle:function(a,
c,b,e){"undefined"!==typeof e&&(this.context.fillStyle=e);this.context.beginPath();this.context.arc(a,c,b,0,2*Math.PI,!1);this.context.closePath();this.context.fill();return this},textureLine:function(a,c,d){void 0===d&&(d="repeat-x");if("string"===typeof c&&(c=this.game.cache.getImage(c),!c))return;var e=a.length;"no-repeat"===d&&e>c.width&&(e=c.width);this.context.fillStyle=this.context.createPattern(c,d);this._circle=new b.Circle(a.start.x,a.start.y,c.height);this._circle.circumferencePoint(a.angle-
1.5707963267948966,!1,this._pos);this.context.save();this.context.translate(this._pos.x,this._pos.y);this.context.rotate(a.angle);this.context.fillRect(0,0,e,c.height);this.context.restore();this.dirty=!0;return this},render:function(){!this.disableTextureUpload&&this.dirty&&(this.baseTexture.dirty(),this.dirty=!1);return this},blendReset:function(){this.context.globalCompositeOperation="source-over";return this},blendSourceOver:function(){this.context.globalCompositeOperation="source-over";return this},
blendSourceIn:function(){this.context.globalCompositeOperation="source-in";return this},blendSourceOut:function(){this.context.globalCompositeOperation="source-out";return this},blendSourceAtop:function(){this.context.globalCompositeOperation="source-atop";return this},blendDestinationOver:function(){this.context.globalCompositeOperation="destination-over";return this},blendDestinationIn:function(){this.context.globalCompositeOperation="destination-in";return this},blendDestinationOut:function(){this.context.globalCompositeOperation=
"destination-out";return this},blendDestinationAtop:function(){this.context.globalCompositeOperation="destination-atop";return this},blendXor:function(){this.context.globalCompositeOperation="xor";return this},blendAdd:function(){this.context.globalCompositeOperation="lighter";return this},blendMultiply:function(){this.context.globalCompositeOperation="multiply";return this},blendScreen:function(){this.context.globalCompositeOperation="screen";return this},blendOverlay:function(){this.context.globalCompositeOperation=
"overlay";return this},blendDarken:function(){this.context.globalCompositeOperation="darken";return this},blendLighten:function(){this.context.globalCompositeOperation="lighten";return this},blendColorDodge:function(){this.context.globalCompositeOperation="color-dodge";return this},blendColorBurn:function(){this.context.globalCompositeOperation="color-burn";return this},blendHardLight:function(){this.context.globalCompositeOperation="hard-light";return this},blendSoftLight:function(){this.context.globalCompositeOperation=
"soft-light";return this},blendDifference:function(){this.context.globalCompositeOperation="difference";return this},blendExclusion:function(){this.context.globalCompositeOperation="exclusion";return this},blendHue:function(){this.context.globalCompositeOperation="hue";return this},blendSaturation:function(){this.context.globalCompositeOperation="saturation";return this},blendColor:function(){this.context.globalCompositeOperation="color";return this},blendLuminosity:function(){this.context.globalCompositeOperation=
"luminosity";return this}};Object.defineProperty(b.BitmapData.prototype,"smoothed",{get:function(){b.Canvas.getSmoothingEnabled(this.context)},set:function(a){b.Canvas.setSmoothingEnabled(this.context,a)}});b.BitmapData.getTransform=function(a,c,b,e,g,l){"number"!==typeof a&&(a=0);"number"!==typeof c&&(c=0);"number"!==typeof b&&(b=1);"number"!==typeof e&&(e=1);"number"!==typeof g&&(g=0);"number"!==typeof l&&(l=0);return{sx:b,sy:e,scaleX:b,scaleY:e,skewX:g,skewY:l,translateX:a,translateY:c,tx:a,ty:c}};
b.BitmapData.prototype.constructor=b.BitmapData;PIXI.Graphics=function(){PIXI.DisplayObjectContainer.call(this);this.renderable=!0;this.fillAlpha=1;this.lineColor=this.lineWidth=0;this.graphicsData=[];this.tint=16777215;this.blendMode=PIXI.blendModes.NORMAL;this.currentPath=null;this._webGL=[];this.isMask=!1;this.boundsPadding=0;this._localBounds=new PIXI.Rectangle(0,0,1,1);this.dirty=!0;this.cachedSpriteDirty=this.webGLDirty=!1};PIXI.Graphics.prototype=Object.create(PIXI.DisplayObjectContainer.prototype);
PIXI.Graphics.prototype.constructor=PIXI.Graphics;PIXI.Graphics.prototype.lineStyle=function(a,c,b){this.lineWidth=a||0;this.lineColor=c||0;this.lineAlpha=void 0===b?1:b;this.currentPath&&(this.currentPath.shape.points.length?this.drawShape(new PIXI.Polygon(this.currentPath.shape.points.slice(-2))):(this.currentPath.lineWidth=this.lineWidth,this.currentPath.lineColor=this.lineColor,this.currentPath.lineAlpha=this.lineAlpha));return this};PIXI.Graphics.prototype.moveTo=function(a,c){this.drawShape(new PIXI.Polygon([a,
c]));return this};PIXI.Graphics.prototype.lineTo=function(a,c){this.currentPath||this.moveTo(0,0);this.currentPath.shape.points.push(a,c);this.dirty=!0;return this};PIXI.Graphics.prototype.quadraticCurveTo=function(a,c,b,e){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var g,l,f=this.currentPath.shape.points;0===f.length&&this.moveTo(0,0);for(var h=f[f.length-2],k=f[f.length-1],m=0,n=1;20>=n;++n)m=n/20,g=h+(a-h)*m,l=k+(c-k)*m,f.push(g+
(a+(b-a)*m-g)*m,l+(c+(e-c)*m-l)*m);this.dirty=!0;return this};PIXI.Graphics.prototype.bezierCurveTo=function(a,c,b,e,g,l){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);for(var f,h,k,m,n,t=this.currentPath.shape.points,r=t[t.length-2],x=t[t.length-1],v=0,A=1;20>=A;++A)v=A/20,f=1-v,h=f*f,k=h*f,m=v*v,n=m*v,t.push(k*r+3*h*v*a+3*f*m*b+n*g,k*x+3*h*v*c+3*f*m*e+n*l);this.dirty=!0;return this};PIXI.Graphics.prototype.arcTo=function(a,c,b,
e,g){this.currentPath?0===this.currentPath.shape.points.length&&this.currentPath.shape.points.push(a,c):this.moveTo(a,c);var l=this.currentPath.shape.points,f=l[l.length-1]-c,h=l[l.length-2]-a;e-=c;b-=a;var k=Math.abs(f*b-h*e);if(1E-8>k||0===g)l[l.length-2]===a&&l[l.length-1]===c||l.push(a,c);else{var m=f*f+h*h,n=e*e+b*b,t=f*e+h*b,l=g*Math.sqrt(m)/k,k=g*Math.sqrt(n)/k,m=l*t/m,n=k*t/n,t=l*b+k*h,r=l*e+k*f;this.arc(t+a,r+c,g,Math.atan2(f*(k+m)-r,h*(k+m)-t),Math.atan2(e*(l+n)-r,b*(l+n)-t),h*e>b*f)}this.dirty=
!0;return this};PIXI.Graphics.prototype.arc=function(a,c,b,e,g,l){if(e===g)return this;void 0===l&&(l=!1);!l&&g<=e?g+=2*Math.PI:l&&e<=g&&(e+=2*Math.PI);g=l?-1*(e-g):g-e;var f=40*Math.ceil(Math.abs(g)/(2*Math.PI));if(0===g)return this;var h=a+Math.cos(e)*b,k=c+Math.sin(e)*b;l&&this.filling?this.moveTo(a,c):this.moveTo(h,k);l=this.currentPath.shape.points;g/=2*f;for(var h=2*g,k=Math.cos(g),m=Math.sin(g),f=f-1,n=f%1/f,t=0;t<=f;t++){var r=g+e+h*(t+n*t),x=Math.cos(r),r=-Math.sin(r);l.push((k*x+m*r)*b+
a,(k*-r+m*x)*b+c)}this.dirty=!0;return this};PIXI.Graphics.prototype.beginFill=function(a,c){this.filling=!0;this.fillColor=a||0;this.fillAlpha=void 0===c?1:c;this.currentPath&&2>=this.currentPath.shape.points.length&&(this.currentPath.fill=this.filling,this.currentPath.fillColor=this.fillColor,this.currentPath.fillAlpha=this.fillAlpha);return this};PIXI.Graphics.prototype.endFill=function(){this.filling=!1;this.fillColor=null;this.fillAlpha=1;return this};PIXI.Graphics.prototype.drawRect=function(a,
c,b,e){this.drawShape(new PIXI.Rectangle(a,c,b,e));return this};PIXI.Graphics.prototype.drawRoundedRect=function(a,c,b,e,g){this.drawShape(new PIXI.RoundedRectangle(a,c,b,e,g));return this};PIXI.Graphics.prototype.drawCircle=function(a,c,b){this.drawShape(new PIXI.Circle(a,c,b));return this};PIXI.Graphics.prototype.drawEllipse=function(a,c,b,e){this.drawShape(new PIXI.Ellipse(a,c,b,e));return this};PIXI.Graphics.prototype.drawPolygon=function(a){if(a instanceof b.Polygon||a instanceof PIXI.Polygon)a=
a.points;var c=a;if(!Array.isArray(c))for(var c=Array(arguments.length),d=0;d<c.length;++d)c[d]=arguments[d];this.drawShape(new b.Polygon(c));return this};PIXI.Graphics.prototype.clear=function(){this.lineWidth=0;this.filling=!1;this.clearDirty=this.dirty=!0;this.graphicsData=[];return this};PIXI.Graphics.prototype.generateTexture=function(a,c){a=a||1;var b=this.getBounds(),e=new PIXI.CanvasBuffer(b.width*a,b.height*a),g=PIXI.Texture.fromCanvas(e.canvas,c);g.baseTexture.resolution=a;e.context.scale(a,
a);e.context.translate(-b.x,-b.y);PIXI.CanvasGraphics.renderGraphics(this,e.context);return g};PIXI.Graphics.prototype._renderWebGL=function(a){if(!1!==this.visible&&0!==this.alpha&&!0!==this.isMask)if(this._cacheAsBitmap){if(this.dirty||this.cachedSpriteDirty)this._generateCachedSprite(),this.updateCachedSpriteTexture(),this.dirty=this.cachedSpriteDirty=!1;this._cachedSprite.worldAlpha=this.worldAlpha;PIXI.Sprite.prototype._renderWebGL.call(this._cachedSprite,a)}else{a.spriteBatch.stop();a.blendModeManager.setBlendMode(this.blendMode);
this._mask&&a.maskManager.pushMask(this._mask,a);this._filters&&a.filterManager.pushFilter(this._filterBlock);if(this.blendMode!==a.spriteBatch.currentBlendMode){a.spriteBatch.currentBlendMode=this.blendMode;var c=PIXI.blendModesWebGL[a.spriteBatch.currentBlendMode];a.spriteBatch.gl.blendFunc(c[0],c[1])}this.webGLDirty&&(this.dirty=!0,this.webGLDirty=!1);PIXI.WebGLGraphics.renderGraphics(this,a);if(this.children.length){a.spriteBatch.start();for(c=0;c<this.children.length;c++)this.children[c]._renderWebGL(a);
a.spriteBatch.stop()}this._filters&&a.filterManager.popFilter();this._mask&&a.maskManager.popMask(this.mask,a);a.drawCount++;a.spriteBatch.start()}};PIXI.Graphics.prototype._renderCanvas=function(a){if(!1!==this.visible&&0!==this.alpha&&!0!==this.isMask)if(this._prevTint!==this.tint&&(this.dirty=!0,this._prevTint=this.tint),this._cacheAsBitmap){if(this.dirty||this.cachedSpriteDirty)this._generateCachedSprite(),this.updateCachedSpriteTexture(),this.dirty=this.cachedSpriteDirty=!1;this._cachedSprite.alpha=
this.alpha;PIXI.Sprite.prototype._renderCanvas.call(this._cachedSprite,a)}else{var c=a.context,b=this.worldTransform;this.blendMode!==a.currentBlendMode&&(a.currentBlendMode=this.blendMode,c.globalCompositeOperation=PIXI.blendModesCanvas[a.currentBlendMode]);this._mask&&a.maskManager.pushMask(this._mask,a);var e=a.resolution;c.setTransform(b.a*e,b.b*e,b.c*e,b.d*e,b.tx*e,b.ty*e);PIXI.CanvasGraphics.renderGraphics(this,c);for(c=0;c<this.children.length;c++)this.children[c]._renderCanvas(a);this._mask&&
a.maskManager.popMask(a)}};PIXI.Graphics.prototype.getBounds=function(a){if(!this._currentBounds){if(!this.renderable)return PIXI.EmptyRectangle;this.dirty&&(this.updateLocalBounds(),this.cachedSpriteDirty=this.webGLDirty=!0,this.dirty=!1);var c=this._localBounds,b=c.x,e=c.width+c.x,g=c.y,l=c.height+c.y;a=a||this.worldTransform;var f=a.a,h=a.b,k=a.c,m=a.d,n=a.tx,t=a.ty,r=f*e+k*l+n,c=m*l+h*e+t;a=f*b+k*l+n;var l=m*l+h*b+t,x=f*b+k*g+n,b=m*g+h*b+t,f=f*e+k*g+n,e=m*g+h*e+t,g=r,h=c,r=a<r?a:r,r=x<r?x:r,r=
f<r?f:r,c=l<c?l:c,c=b<c?b:c,c=e<c?e:c,g=a>g?a:g,g=x>g?x:g,h=l>h?l:h,h=b>h?b:h;this._bounds.x=r;this._bounds.width=(f>g?f:g)-r;this._bounds.y=c;this._bounds.height=(e>h?e:h)-c;this._currentBounds=this._bounds}return this._currentBounds};PIXI.Graphics.prototype.containsPoint=function(a){this.worldTransform.applyInverse(a,tempPoint);a=this.graphicsData;for(var c=0;c<a.length;c++){var b=a[c];if(b.fill&&b.shape&&b.shape.contains(tempPoint.x,tempPoint.y))return!0}return!1};PIXI.Graphics.prototype.updateLocalBounds=
function(){var a=Infinity,c=-Infinity,d=Infinity,e=-Infinity;if(this.graphicsData.length)for(var g,l,f,h,k,m=0;m<this.graphicsData.length;m++)if(f=this.graphicsData[m],l=f.type,k=f.lineWidth,g=f.shape,l===PIXI.Graphics.RECT||l===PIXI.Graphics.RREC)l=g.x-k/2,f=g.y-k/2,h=g.width+k,k=g.height+k,a=l<a?l:a,c=l+h>c?l+h:c,d=f<d?f:d,e=f+k>e?f+k:e;else if(l===PIXI.Graphics.CIRC)l=g.x,f=g.y,h=g.radius+k/2,k=g.radius+k/2,a=l-h<a?l-h:a,c=l+h>c?l+h:c,d=f-k<d?f-k:d,e=f+k>e?f+k:e;else if(l===PIXI.Graphics.ELIP)l=
g.x,f=g.y,h=g.width+k/2,k=g.height+k/2,a=l-h<a?l-h:a,c=l+h>c?l+h:c,d=f-k<d?f-k:d,e=f+k>e?f+k:e;else for(g=g.points,h=0;h<g.length;h++)g[h]instanceof b.Point?(l=g[h].x,f=g[h].y):(l=g[h],f=g[h+1],h<g.length-1&&h++),a=l-k<a?l-k:a,c=l+k>c?l+k:c,d=f-k<d?f-k:d,e=f+k>e?f+k:e;else e=d=c=a=0;m=this.boundsPadding;this._localBounds.x=a-m;this._localBounds.width=c-a+2*m;this._localBounds.y=d-m;this._localBounds.height=e-d+2*m};PIXI.Graphics.prototype._generateCachedSprite=function(){var a=this.getLocalBounds();
if(this._cachedSprite)this._cachedSprite.buffer.resize(a.width,a.height);else{var c=new PIXI.CanvasBuffer(a.width,a.height),b=PIXI.Texture.fromCanvas(c.canvas);this._cachedSprite=new PIXI.Sprite(b);this._cachedSprite.buffer=c;this._cachedSprite.worldTransform=this.worldTransform}this._cachedSprite.anchor.x=-(a.x/a.width);this._cachedSprite.anchor.y=-(a.y/a.height);this._cachedSprite.buffer.context.translate(-a.x,-a.y);this.worldAlpha=1;PIXI.CanvasGraphics.renderGraphics(this,this._cachedSprite.buffer.context);
this._cachedSprite.alpha=this.alpha};PIXI.Graphics.prototype.updateCachedSpriteTexture=function(){var a=this._cachedSprite,c=a.texture,b=a.buffer.canvas;c.baseTexture.width=b.width;c.baseTexture.height=b.height;c.crop.width=c.frame.width=b.width;c.crop.height=c.frame.height=b.height;a._width=b.width;a._height=b.height;c.baseTexture.dirty()};PIXI.Graphics.prototype.destroyCachedSprite=function(){this._cachedSprite.texture.destroy(!0);this._cachedSprite=null};PIXI.Graphics.prototype.drawShape=function(a){this.currentPath&&
2>=this.currentPath.shape.points.length&&this.graphicsData.pop();this.currentPath=null;a instanceof b.Polygon&&(a=a.clone(),a.flatten());a=new PIXI.GraphicsData(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.filling,a);this.graphicsData.push(a);a.type===PIXI.Graphics.POLY&&(a.shape.closed=this.filling,this.currentPath=a);this.dirty=!0;return a};Object.defineProperty(PIXI.Graphics.prototype,"cacheAsBitmap",{get:function(){return this._cacheAsBitmap},set:function(a){(this._cacheAsBitmap=
a)?this._generateCachedSprite():(this.destroyCachedSprite(),this.dirty=!0)}});PIXI.GraphicsData=function(a,c,b,e,g,l,f){this.lineWidth=a;this.lineColor=c;this.lineAlpha=b;this._lineTint=c;this.fillColor=e;this.fillAlpha=g;this._fillTint=e;this.fill=l;this.shape=f;this.type=f.type};PIXI.GraphicsData.prototype.constructor=PIXI.GraphicsData;PIXI.GraphicsData.prototype.clone=function(){return new GraphicsData(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)};
b.Graphics=function(a,c,d){void 0===c&&(c=0);void 0===d&&(d=0);this.type=b.GRAPHICS;this.physicsType=b.SPRITE;PIXI.Graphics.call(this);b.Component.Core.init.call(this,a,c,d,"",null)};b.Graphics.prototype=Object.create(PIXI.Graphics.prototype);b.Graphics.prototype.constructor=b.Graphics;b.Component.Core.install.call(b.Graphics.prototype,"Angle AutoCull Bounds Destroy FixedToCamera InputEnabled InWorld LifeSpan PhysicsBody Reset".split(" "));b.Graphics.prototype.preUpdatePhysics=b.Component.PhysicsBody.preUpdate;
b.Graphics.prototype.preUpdateLifeSpan=b.Component.LifeSpan.preUpdate;b.Graphics.prototype.preUpdateInWorld=b.Component.InWorld.preUpdate;b.Graphics.prototype.preUpdateCore=b.Component.Core.preUpdate;b.Graphics.prototype.preUpdate=function(){return this.preUpdatePhysics()&&this.preUpdateLifeSpan()&&this.preUpdateInWorld()?this.preUpdateCore():!1};b.Graphics.prototype.destroy=function(a){this.clear();b.Component.Destroy.prototype.destroy.call(this,a)};b.Graphics.prototype.drawTriangle=function(a,c){void 0===
c&&(c=!1);var d=new b.Polygon(a);if(c){var e=new b.Point(this.game.camera.x-a[0].x,this.game.camera.y-a[0].y),g=new b.Point(a[1].x-a[0].x,a[1].y-a[0].y),g=(new b.Point(a[1].x-a[2].x,a[1].y-a[2].y)).cross(g);0<e.dot(g)&&this.drawPolygon(d)}else this.drawPolygon(d)};b.Graphics.prototype.drawTriangles=function(a,c,d){void 0===d&&(d=!1);var e=new b.Point,g=new b.Point,l=new b.Point,f=[],h;if(c)if(a[0]instanceof b.Point)for(h=0;h<c.length/3;h++)f.push(a[c[3*h]]),f.push(a[c[3*h+1]]),f.push(a[c[3*h+2]]),
3===f.length&&(this.drawTriangle(f,d),f=[]);else for(h=0;h<c.length;h++)e.x=a[2*c[h]],e.y=a[2*c[h]+1],f.push(e.copyTo({})),3===f.length&&(this.drawTriangle(f,d),f=[]);else if(a[0]instanceof b.Point)for(h=0;h<a.length/3;h++)this.drawTriangle([a[3*h],a[3*h+1],a[3*h+2]],d);else for(h=0;h<a.length/6;h++)e.x=a[6*h+0],e.y=a[6*h+1],g.x=a[6*h+2],g.y=a[6*h+3],l.x=a[6*h+4],l.y=a[6*h+5],this.drawTriangle([e,g,l],d)};b.RenderTexture=function(a,c,d,e,g,l){void 0===e&&(e="");void 0===g&&(g=b.scaleModes.DEFAULT);
void 0===l&&(l=1);this.game=a;this.key=e;this.type=b.RENDERTEXTURE;this._tempMatrix=new PIXI.Matrix;PIXI.RenderTexture.call(this,c,d,this.game.renderer,g,l);this.render=b.RenderTexture.prototype.render};b.RenderTexture.prototype=Object.create(PIXI.RenderTexture.prototype);b.RenderTexture.prototype.constructor=b.RenderTexture;b.RenderTexture.prototype.renderXY=function(a,c,b,e){a.updateTransform();this._tempMatrix.copyFrom(a.worldTransform);this._tempMatrix.tx=c;this._tempMatrix.ty=b;this.renderer.type===
PIXI.WEBGL_RENDERER?this.renderWebGL(a,this._tempMatrix,e):this.renderCanvas(a,this._tempMatrix,e)};b.RenderTexture.prototype.renderRawXY=function(a,c,b,e){this._tempMatrix.identity().translate(c,b);this.renderer.type===PIXI.WEBGL_RENDERER?this.renderWebGL(a,this._tempMatrix,e):this.renderCanvas(a,this._tempMatrix,e)};b.RenderTexture.prototype.render=function(a,c,b){void 0===c||null===c?this._tempMatrix.copyFrom(a.worldTransform):this._tempMatrix.copyFrom(c);this.renderer.type===PIXI.WEBGL_RENDERER?
this.renderWebGL(a,this._tempMatrix,b):this.renderCanvas(a,this._tempMatrix,b)};b.Text=function(a,c,d,e,g){c=c||0;d=d||0;e=e.toString()||"";g=g||{};this.type=b.TEXT;this.physicsType=b.SPRITE;this.padding=new b.Point;this.textBounds=null;this.canvas=document.createElement("canvas");this.context=this.canvas.getContext("2d");this.colors=[];this.strokeColors=[];this.autoRound=!1;this._res=a.renderer.resolution;this._text=e;this._fontComponents=null;this._height=this._width=this._charCount=this._lineSpacing=
0;b.Sprite.call(this,a,c,d,PIXI.Texture.fromCanvas(this.canvas));this.setStyle(g);""!==e&&this.updateText()};b.Text.prototype=Object.create(b.Sprite.prototype);b.Text.prototype.constructor=b.Text;b.Text.prototype.preUpdate=function(){return this.preUpdatePhysics()&&this.preUpdateLifeSpan()&&this.preUpdateInWorld()?this.preUpdateCore():!1};b.Text.prototype.update=function(){};b.Text.prototype.destroy=function(a){this.texture.destroy(!0);this.canvas&&this.canvas.parentNode?this.canvas.parentNode.removeChild(this.canvas):
this.context=this.canvas=null;b.Component.Destroy.prototype.destroy.call(this,a)};b.Text.prototype.setShadow=function(a,c,b,e,g,l){void 0===a&&(a=0);void 0===c&&(c=0);void 0===b&&(b="rgba(0, 0, 0, 1)");void 0===e&&(e=0);void 0===g&&(g=!0);void 0===l&&(l=!0);this.style.shadowOffsetX=a;this.style.shadowOffsetY=c;this.style.shadowColor=b;this.style.shadowBlur=e;this.style.shadowStroke=g;this.style.shadowFill=l;this.dirty=!0;return this};b.Text.prototype.setStyle=function(a){a=a||{};a.font=a.font||"bold 20pt Arial";
a.backgroundColor=a.backgroundColor||null;a.fill=a.fill||"black";a.align=a.align||"left";a.boundsAlignH=a.boundsAlignH||"left";a.boundsAlignV=a.boundsAlignV||"top";a.stroke=a.stroke||"black";a.strokeThickness=a.strokeThickness||0;a.wordWrap=a.wordWrap||!1;a.wordWrapWidth=a.wordWrapWidth||100;a.shadowOffsetX=a.shadowOffsetX||0;a.shadowOffsetY=a.shadowOffsetY||0;a.shadowColor=a.shadowColor||"rgba(0,0,0,0)";a.shadowBlur=a.shadowBlur||0;a.tabs=a.tabs||0;var c=this.fontToComponents(a.font);a.fontStyle&&
(c.fontStyle=a.fontStyle);a.fontVariant&&(c.fontVariant=a.fontVariant);a.fontWeight&&(c.fontWeight=a.fontWeight);a.fontSize&&("number"===typeof a.fontSize&&(a.fontSize+="px"),c.fontSize=a.fontSize);this._fontComponents=c;a.font=this.componentsToFont(this._fontComponents);this.style=a;this.dirty=!0;return this};b.Text.prototype.updateText=function(){this.texture.baseTexture.resolution=this._res;this.context.font=this.style.font;var a=this.text;this.style.wordWrap&&(a=this.runWordWrap(this.text));for(var a=
a.split(/(?:\r\n|\r|\n)/),c=this.style.tabs,b=[],e=0,g=this.determineFontProperties(this.style.font),l=0;l<a.length;l++){if(0===c)var f=this.context.measureText(a[l]).width+this.style.strokeThickness+this.padding.x;else{var h=a[l].split(/(?:\t)/),f=this.padding.x+this.style.strokeThickness;if(Array.isArray(c))for(var k=0,m=0;m<h.length;m++)f=Math.ceil(this.context.measureText(h[m]).width),0<m&&(k+=c[m-1]),f=k+f;else for(m=0;m<h.length;m++)f+=Math.ceil(this.context.measureText(h[m]).width),k=this.game.math.snapToCeil(f,
c)-f,f+=k}b[l]=Math.ceil(f);e=Math.max(e,b[l])}this.canvas.width=(e+this.style.strokeThickness)*this._res;h=g.fontSize+this.style.strokeThickness+this.padding.y;l=h*a.length;m=this._lineSpacing;0>m&&Math.abs(m)>h&&(m=-h);0!==m&&(k=m*(a.length-1),l+=k);this.canvas.height=l*this._res;this.context.scale(this._res,this._res);navigator.isCocoonJS&&this.context.clearRect(0,0,this.canvas.width,this.canvas.height);this.style.backgroundColor&&(this.context.fillStyle=this.style.backgroundColor,this.context.fillRect(0,
0,this.canvas.width,this.canvas.height));this.context.fillStyle=this.style.fill;this.context.font=this.style.font;this.context.strokeStyle=this.style.stroke;this.context.textBaseline="alphabetic";this.context.lineWidth=this.style.strokeThickness;this.context.lineCap="round";this.context.lineJoin="round";for(l=this._charCount=0;l<a.length;l++)k=this.style.strokeThickness/2,f=this.style.strokeThickness/2+l*h+g.ascent,0<l&&(f+=m*l),"right"===this.style.align?k+=e-b[l]:"center"===this.style.align&&(k+=
(e-b[l])/2),this.autoRound&&(k=Math.round(k),f=Math.round(f)),0<this.colors.length||0<this.strokeColors.length?this.updateLine(a[l],k,f):(this.style.stroke&&this.style.strokeThickness&&(this.updateShadow(this.style.shadowStroke),0===c?this.context.strokeText(a[l],k,f):this.renderTabLine(a[l],k,f,!1)),this.style.fill&&(this.updateShadow(this.style.shadowFill),0===c?this.context.fillText(a[l],k,f):this.renderTabLine(a[l],k,f,!0)));this.updateTexture()};b.Text.prototype.renderTabLine=function(a,c,b,
e){a=a.split(/(?:\t)/);var g=this.style.tabs,l=0;if(Array.isArray(g))for(var f=0,h=0;h<a.length;h++)0<h&&(f+=g[h-1]),l=c+f,e?this.context.fillText(a[h],l,b):this.context.strokeText(a[h],l,b);else for(h=0;h<a.length;h++)f=Math.ceil(this.context.measureText(a[h]).width),l=this.game.math.snapToCeil(c,g),e?this.context.fillText(a[h],l,b):this.context.strokeText(a[h],l,b),c=l+f};b.Text.prototype.updateShadow=function(a){a?(this.context.shadowOffsetX=this.style.shadowOffsetX,this.context.shadowOffsetY=
this.style.shadowOffsetY,this.context.shadowColor=this.style.shadowColor,this.context.shadowBlur=this.style.shadowBlur):(this.context.shadowOffsetX=0,this.context.shadowOffsetY=0,this.context.shadowColor=0,this.context.shadowBlur=0)};b.Text.prototype.updateLine=function(a,c,b){for(var e=0;e<a.length;e++){var g=a[e];this.style.stroke&&this.style.strokeThickness&&(this.strokeColors[this._charCount]&&(this.context.strokeStyle=this.strokeColors[this._charCount]),this.updateShadow(this.style.shadowStroke),
this.context.strokeText(g,c,b));this.style.fill&&(this.colors[this._charCount]&&(this.context.fillStyle=this.colors[this._charCount]),this.updateShadow(this.style.shadowFill),this.context.fillText(g,c,b));c+=this.context.measureText(g).width;this._charCount++}};b.Text.prototype.clearColors=function(){this.colors=[];this.strokeColors=[];this.dirty=!0;return this};b.Text.prototype.addColor=function(a,c){this.colors[c]=a;this.dirty=!0;return this};b.Text.prototype.addStrokeColor=function(a,c){this.strokeColors[c]=
a;this.dirty=!0;return this};b.Text.prototype.runWordWrap=function(a){var c="";a=a.split("\n");for(var b=0;b<a.length;b++){for(var e=this.style.wordWrapWidth,g=a[b].split(" "),l=0;l<g.length;l++){var f=this.context.measureText(g[l]).width,h=f+this.context.measureText(" ").width;h>e?(0<l&&(c+="\n"),c+=g[l]+" ",e=this.style.wordWrapWidth-f):(e-=h,c+=g[l]+" ")}b<a.length-1&&(c+="\n")}return c};b.Text.prototype.updateFont=function(a){a=this.componentsToFont(a);this.style.font!==a&&(this.style.font=a,
this.dirty=!0,this.parent&&this.updateTransform())};b.Text.prototype.fontToComponents=function(a){var c=a.match(/^\s*(?:\b(normal|italic|oblique|inherit)?\b)\s*(?:\b(normal|small-caps|inherit)?\b)\s*(?:\b(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit)?\b)\s*(?:\b(xx-small|x-small|small|medium|large|x-large|xx-large|larger|smaller|0|\d*(?:[.]\d*)?(?:%|[a-z]{2,5}))?\b)\s*(.*)\s*$/);if(c)return{font:a,fontStyle:c[1]||"normal",fontVariant:c[2]||"normal",fontWeight:c[3]||"normal",
fontSize:c[4]||"medium",fontFamily:c[5]};console.warn("Phaser.Text - unparsable CSS font: "+a);return{font:a}};b.Text.prototype.componentsToFont=function(a){var c=[],b;(b=a.fontStyle)&&"normal"!==b&&c.push(b);(b=a.fontVariant)&&"normal"!==b&&c.push(b);(b=a.fontWeight)&&"normal"!==b&&c.push(b);(b=a.fontSize)&&"medium"!==b&&c.push(b);(b=a.fontFamily)&&c.push(b);c.length||c.push(a.font);return c.join(" ")};b.Text.prototype.setText=function(a){this.text=a.toString()||"";this.dirty=!0;return this};b.Text.prototype.parseList=
function(a){if(Array.isArray(a))for(var c="",b=0;b<a.length;b++)Array.isArray(a[b])?(c+=a[b].join("\t"),b<a.length-1&&(c+="\n")):(c+=a[b],b<a.length-1&&(c+="\t"));else return this;this.text=c;this.dirty=!0;return this};b.Text.prototype.setTextBounds=function(a,c,d,e){void 0===a?this.textBounds=null:(this.textBounds?this.textBounds.setTo(a,c,d,e):this.textBounds=new b.Rectangle(a,c,d,e),this.style.wordWrapWidth>d&&(this.style.wordWrapWidth=d));this.updateTexture();return this};b.Text.prototype.updateTexture=
function(){var a=this.texture.baseTexture,c=this.texture.crop,b=this.texture.frame,e=this.canvas.width,g=this.canvas.height;a.width=e;a.height=g;c.width=e;c.height=g;b.width=e;b.height=g;this.texture.width=e;this.texture.height=g;this._width=e;this._height=g;this.textBounds&&(a=this.textBounds.x,c=this.textBounds.y,"right"===this.style.boundsAlignH?a=this.textBounds.width-this.canvas.width:"center"===this.style.boundsAlignH&&(a=this.textBounds.halfWidth-this.canvas.width/2),"bottom"===this.style.boundsAlignV?
c=this.textBounds.height-this.canvas.height:"middle"===this.style.boundsAlignV&&(c=this.textBounds.halfHeight-this.canvas.height/2),this.pivot.x=-a,this.pivot.y=-c);this.renderable=0!==e&&0!==g;this.texture.baseTexture.dirty()};b.Text.prototype._renderWebGL=function(a){this.dirty&&(this.updateText(),this.dirty=!1);PIXI.Sprite.prototype._renderWebGL.call(this,a)};b.Text.prototype._renderCanvas=function(a){this.dirty&&(this.updateText(),this.dirty=!1);PIXI.Sprite.prototype._renderCanvas.call(this,a)};
b.Text.prototype.determineFontProperties=function(a){var c=b.Text.fontPropertiesCache[a];if(!c){var c={},d=b.Text.fontPropertiesCanvas,e=b.Text.fontPropertiesContext;e.font=a;var g=Math.ceil(e.measureText("|M\u00c9q").width),l=Math.ceil(e.measureText("|M\u00c9q").width),f=2*l,l=1.4*l|0;d.width=g;d.height=f;e.fillStyle="#f00";e.fillRect(0,0,g,f);e.font=a;e.textBaseline="alphabetic";e.fillStyle="#000";e.fillText("|M\u00c9q",0,l);if(!e.getImageData(0,0,g,f))return c.ascent=l,c.descent=l+6,c.fontSize=
c.ascent+c.descent,b.Text.fontPropertiesCache[a]=c;var d=e.getImageData(0,0,g,f).data,e=d.length,g=4*g,h,k,m=0,n=!1;for(h=0;h<l;h++){for(k=0;k<g;k+=4)if(255!==d[m+k]){n=!0;break}if(n)break;else m+=g}c.ascent=l-h;m=e-g;n=!1;for(h=f;h>l;h--){for(k=0;k<g;k+=4)if(255!==d[m+k]){n=!0;break}if(n)break;else m-=g}c.descent=h-l;c.descent+=6;c.fontSize=c.ascent+c.descent;b.Text.fontPropertiesCache[a]=c}return c};b.Text.prototype.getBounds=function(a){this.dirty&&(this.updateText(),this.dirty=!1);return PIXI.Sprite.prototype.getBounds.call(this,
a)};Object.defineProperty(b.Text.prototype,"text",{get:function(){return this._text},set:function(a){a!==this._text&&(this._text=a.toString()||"",this.dirty=!0,this.parent&&this.updateTransform())}});Object.defineProperty(b.Text.prototype,"cssFont",{get:function(){return this.componentsToFont(this._fontComponents)},set:function(a){this._fontComponents=this.fontToComponents(a||"bold 20pt Arial");this.updateFont(this._fontComponents)}});Object.defineProperty(b.Text.prototype,"font",{get:function(){return this._fontComponents.fontFamily},
set:function(a){a=(a||"Arial").trim();/^(?:inherit|serif|sans-serif|cursive|fantasy|monospace)$/.exec(a)||/['",]/.exec(a)||(a="'"+a+"'");this._fontComponents.fontFamily=a;this.updateFont(this._fontComponents)}});Object.defineProperty(b.Text.prototype,"fontSize",{get:function(){var a=this._fontComponents.fontSize;return a&&/(?:^0$|px$)/.exec(a)?parseInt(a,10):a},set:function(a){a=a||"0";"number"===typeof a&&(a+="px");this._fontComponents.fontSize=a;this.updateFont(this._fontComponents)}});Object.defineProperty(b.Text.prototype,
"fontWeight",{get:function(){return this._fontComponents.fontWeight||"normal"},set:function(a){this._fontComponents.fontWeight=a||"normal";this.updateFont(this._fontComponents)}});Object.defineProperty(b.Text.prototype,"fontStyle",{get:function(){return this._fontComponents.fontStyle||"normal"},set:function(a){this._fontComponents.fontStyle=a||"normal";this.updateFont(this._fontComponents)}});Object.defineProperty(b.Text.prototype,"fontVariant",{get:function(){return this._fontComponents.fontVariant||
"normal"},set:function(a){this._fontComponents.fontVariant=a||"normal";this.updateFont(this._fontComponents)}});Object.defineProperty(b.Text.prototype,"fill",{get:function(){return this.style.fill},set:function(a){a!==this.style.fill&&(this.style.fill=a,this.dirty=!0)}});Object.defineProperty(b.Text.prototype,"align",{get:function(){return this.style.align},set:function(a){a!==this.style.align&&(this.style.align=a,this.dirty=!0)}});Object.defineProperty(b.Text.prototype,"resolution",{get:function(){return this._res},
set:function(a){a!==this._res&&(this._res=a,this.dirty=!0)}});Object.defineProperty(b.Text.prototype,"tabs",{get:function(){return this.style.tabs},set:function(a){a!==this.style.tabs&&(this.style.tabs=a,this.dirty=!0)}});Object.defineProperty(b.Text.prototype,"boundsAlignH",{get:function(){return this.style.boundsAlignH},set:function(a){a!==this.style.boundsAlignH&&(this.style.boundsAlignH=a,this.dirty=!0)}});Object.defineProperty(b.Text.prototype,"boundsAlignV",{get:function(){return this.style.boundsAlignV},
set:function(a){a!==this.style.boundsAlignV&&(this.style.boundsAlignV=a,this.dirty=!0)}});Object.defineProperty(b.Text.prototype,"stroke",{get:function(){return this.style.stroke},set:function(a){a!==this.style.stroke&&(this.style.stroke=a,this.dirty=!0)}});Object.defineProperty(b.Text.prototype,"strokeThickness",{get:function(){return this.style.strokeThickness},set:function(a){a!==this.style.strokeThickness&&(this.style.strokeThickness=a,this.dirty=!0)}});Object.defineProperty(b.Text.prototype,
"wordWrap",{get:function(){return this.style.wordWrap},set:function(a){a!==this.style.wordWrap&&(this.style.wordWrap=a,this.dirty=!0)}});Object.defineProperty(b.Text.prototype,"wordWrapWidth",{get:function(){return this.style.wordWrapWidth},set:function(a){a!==this.style.wordWrapWidth&&(this.style.wordWrapWidth=a,this.dirty=!0)}});Object.defineProperty(b.Text.prototype,"lineSpacing",{get:function(){return this._lineSpacing},set:function(a){a!==this._lineSpacing&&(this._lineSpacing=parseFloat(a),this.dirty=
!0,this.parent&&this.updateTransform())}});Object.defineProperty(b.Text.prototype,"shadowOffsetX",{get:function(){return this.style.shadowOffsetX},set:function(a){a!==this.style.shadowOffsetX&&(this.style.shadowOffsetX=a,this.dirty=!0)}});Object.defineProperty(b.Text.prototype,"shadowOffsetY",{get:function(){return this.style.shadowOffsetY},set:function(a){a!==this.style.shadowOffsetY&&(this.style.shadowOffsetY=a,this.dirty=!0)}});Object.defineProperty(b.Text.prototype,"shadowColor",{get:function(){return this.style.shadowColor},
set:function(a){a!==this.style.shadowColor&&(this.style.shadowColor=a,this.dirty=!0)}});Object.defineProperty(b.Text.prototype,"shadowBlur",{get:function(){return this.style.shadowBlur},set:function(a){a!==this.style.shadowBlur&&(this.style.shadowBlur=a,this.dirty=!0)}});Object.defineProperty(b.Text.prototype,"shadowStroke",{get:function(){return this.style.shadowStroke},set:function(a){a!==this.style.shadowStroke&&(this.style.shadowStroke=a,this.dirty=!0)}});Object.defineProperty(b.Text.prototype,
"shadowFill",{get:function(){return this.style.shadowFill},set:function(a){a!==this.style.shadowFill&&(this.style.shadowFill=a,this.dirty=!0)}});Object.defineProperty(b.Text.prototype,"width",{get:function(){this.dirty&&(this.updateText(),this.dirty=!1);return this.scale.x*this.texture.frame.width},set:function(a){this.scale.x=a/this.texture.frame.width;this._width=a}});Object.defineProperty(b.Text.prototype,"height",{get:function(){this.dirty&&(this.updateText(),this.dirty=!1);return this.scale.y*
this.texture.frame.height},set:function(a){this.scale.y=a/this.texture.frame.height;this._height=a}});b.Text.fontPropertiesCache={};b.Text.fontPropertiesCanvas=document.createElement("canvas");b.Text.fontPropertiesContext=b.Text.fontPropertiesCanvas.getContext("2d");b.BitmapText=function(a,c,d,e,g,l,f){c=c||0;d=d||0;e=e||"";g=g||"";l=l||32;f=f||"left";PIXI.DisplayObjectContainer.call(this);this.type=b.BITMAPTEXT;this.physicsType=b.SPRITE;this.textHeight=this.textWidth=0;this.anchor=new b.Point;this._prevAnchor=
new b.Point;this._glyphs=[];this._maxWidth=0;this._text=g;this._data=a.cache.getBitmapFont(e);this._font=e;this._fontSize=l;this._align=f;this._tint=16777215;this.updateText();this.dirty=!1;b.Component.Core.init.call(this,a,c,d,"",null)};b.BitmapText.prototype=Object.create(PIXI.DisplayObjectContainer.prototype);b.BitmapText.prototype.constructor=b.BitmapText;b.Component.Core.install.call(b.BitmapText.prototype,"Angle AutoCull Bounds Destroy FixedToCamera InputEnabled InWorld LifeSpan PhysicsBody Reset".split(" "));
b.BitmapText.prototype.preUpdatePhysics=b.Component.PhysicsBody.preUpdate;b.BitmapText.prototype.preUpdateLifeSpan=b.Component.LifeSpan.preUpdate;b.BitmapText.prototype.preUpdateInWorld=b.Component.InWorld.preUpdate;b.BitmapText.prototype.preUpdateCore=b.Component.Core.preUpdate;b.BitmapText.prototype.preUpdate=function(){return this.preUpdatePhysics()&&this.preUpdateLifeSpan()&&this.preUpdateInWorld()?this.preUpdateCore():!1};b.BitmapText.prototype.postUpdate=function(){b.Component.PhysicsBody.postUpdate.call(this);
b.Component.FixedToCamera.postUpdate.call(this);this.body&&this.body.type===b.Physics.ARCADE&&(this.textWidth===this.body.sourceWidth&&this.textHeight===this.body.sourceHeight||this.body.setSize(this.textWidth,this.textHeight))};b.BitmapText.prototype.setText=function(a){this.text=a};b.BitmapText.prototype.scanLine=function(a,c,b){for(var e=0,g=0,l=-1,f=null,h=0<this._maxWidth?this._maxWidth:null,k=[],m=0;m<b.length;m++){var n=m===b.length-1?!0:!1;if(/(?:\r\n|\r|\n)/.test(b.charAt(m)))return{width:g,
text:b.substr(0,m),end:n,chars:k};var t=b.charCodeAt(m),r=a.chars[t],x=0;if(r){f=f&&r.kerning[f]?r.kerning[f]:0;l=/(\s)/.test(b.charAt(m))?m:l;x=(f+r.texture.width+r.xOffset)*c;if(h&&g+x>=h&&-1<l)return{width:g,text:b.substr(0,m-(m-l)),end:n,chars:k};g+=r.xAdvance*c;k.push(e+r.xOffset*c);e+=r.xAdvance*c;f=t}}return{width:g,text:b,end:n,chars:k}};b.BitmapText.prototype.updateText=function(){var a=this._data.font;if(a){var c=this.text,b=this._fontSize/a.size,e=[],g=0;this.textWidth=0;do{var l=this.scanLine(a,
b,c);l.y=g;e.push(l);l.width>this.textWidth&&(this.textWidth=l.width);g+=a.lineHeight*b;c=c.substr(l.text.length+1)}while(!1===l.end);this.textHeight=g;for(var g=c=0,f=this.textWidth*this.anchor.x,h=this.textHeight*this.anchor.y,k=0;k<e.length;k++){l=e[k];"right"===this._align?g=this.textWidth-l.width:"center"===this._align&&(g=(this.textWidth-l.width)/2);for(var m=0;m<l.text.length;m++){var n=l.text.charCodeAt(m),n=a.chars[n],t=this._glyphs[c];t?t.texture=n.texture:(t=new PIXI.Sprite(n.texture),
t.name=l.text[m],this._glyphs.push(t));t.position.x=l.chars[m]+g-f;t.position.y=l.y+n.yOffset*b-h;t.scale.set(b);t.tint=this.tint;t.parent||this.addChild(t);c++}}for(k=c;k<this._glyphs.length;k++)this.removeChild(this._glyphs[k])}};b.BitmapText.prototype.purgeGlyphs=function(){for(var a=this._glyphs.length,c=[],b=0;b<this._glyphs.length;b++)this._glyphs[b].parent!==this?this._glyphs[b].destroy():c.push(this._glyphs[b]);this._glyphs=[];this._glyphs=c;this.updateText();return a-c.length};b.BitmapText.prototype.updateTransform=
function(){if(this.dirty||!this.anchor.equals(this._prevAnchor))this.updateText(),this.dirty=!1,this._prevAnchor.copyFrom(this.anchor);PIXI.DisplayObjectContainer.prototype.updateTransform.call(this)};Object.defineProperty(b.BitmapText.prototype,"align",{get:function(){return this._align},set:function(a){a===this._align||"left"!==a&&"center"!==a&&"right"!==a||(this._align=a,this.updateText())}});Object.defineProperty(b.BitmapText.prototype,"tint",{get:function(){return this._tint},set:function(a){a!==
this._tint&&(this._tint=a,this.updateText())}});Object.defineProperty(b.BitmapText.prototype,"font",{get:function(){return this._font},set:function(a){a!==this._font&&(this._font=a.trim(),this.updateText())}});Object.defineProperty(b.BitmapText.prototype,"fontSize",{get:function(){return this._fontSize},set:function(a){a=parseInt(a,10);a!==this._fontSize&&0<a&&(this._fontSize=a,this.updateText())}});Object.defineProperty(b.BitmapText.prototype,"text",{get:function(){return this._text},set:function(a){a!==
this._text&&(this._text=a.toString()||"",this.updateText())}});Object.defineProperty(b.BitmapText.prototype,"maxWidth",{get:function(){return this._maxWidth},set:function(a){a!==this._maxWidth&&(this._maxWidth=a,this.updateText())}});b.RetroFont=function(a,c,d,e,g,l,f,h,k,m){if(!a.cache.checkImageKey(c))return!1;if(void 0===l||null===l)l=a.cache.getImage(c).width/d;this.characterWidth=d;this.characterHeight=e;this.characterSpacingX=f||0;this.characterSpacingY=h||0;this.characterPerRow=l;this.offsetX=
k||0;this.offsetY=m||0;this.align="left";this.multiLine=!1;this.autoUpperCase=!0;this.fixedWidth=this.customSpacingY=this.customSpacingX=0;this.fontSet=a.cache.getImage(c);this._text="";this.grabData=[];this.frameData=new b.FrameData;d=this.offsetX;e=this.offsetY;for(f=l=0;f<g.length;f++)h=this.frameData.addFrame(new b.Frame(f,d,e,this.characterWidth,this.characterHeight)),this.grabData[g.charCodeAt(f)]=h.index,l++,l===this.characterPerRow?(l=0,d=this.offsetX,e+=this.characterHeight+this.characterSpacingY):
d+=this.characterWidth+this.characterSpacingX;a.cache.updateFrameData(c,this.frameData);this.stamp=new b.Image(a,0,0,c,0);b.RenderTexture.call(this,a,100,100,"",b.scaleModes.NEAREST);this.type=b.RETROFONT};b.RetroFont.prototype=Object.create(b.RenderTexture.prototype);b.RetroFont.prototype.constructor=b.RetroFont;b.RetroFont.ALIGN_LEFT="left";b.RetroFont.ALIGN_RIGHT="right";b.RetroFont.ALIGN_CENTER="center";b.RetroFont.TEXT_SET1=" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~";
b.RetroFont.TEXT_SET2=" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ";b.RetroFont.TEXT_SET3="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 ";b.RetroFont.TEXT_SET4="ABCDEFGHIJKLMNOPQRSTUVWXYZ 0123456789";b.RetroFont.TEXT_SET5="ABCDEFGHIJKLMNOPQRSTUVWXYZ.,/() '!?-*:0123456789";b.RetroFont.TEXT_SET6="ABCDEFGHIJKLMNOPQRSTUVWXYZ!?:;0123456789\"(),-.' ";b.RetroFont.TEXT_SET7="AGMSY+:4BHNTZ!;5CIOU.?06DJPV,(17EKQW\")28FLRX-'39";b.RetroFont.TEXT_SET8="0123456789 .ABCDEFGHIJKLMNOPQRSTUVWXYZ";b.RetroFont.TEXT_SET9=
"ABCDEFGHIJKLMNOPQRSTUVWXYZ()-0123456789.:,'\"?!";b.RetroFont.TEXT_SET10="ABCDEFGHIJKLMNOPQRSTUVWXYZ";b.RetroFont.TEXT_SET11="ABCDEFGHIJKLMNOPQRSTUVWXYZ.,\"-+!?()':;0123456789";b.RetroFont.prototype.setFixedWidth=function(a,c){void 0===c&&(c="left");this.fixedWidth=a;this.align=c};b.RetroFont.prototype.setText=function(a,c,b,e,g,l){this.multiLine=c||!1;this.customSpacingX=b||0;this.customSpacingY=e||0;this.align=g||"left";this.autoUpperCase=l?!1:!0;0<a.length&&(this.text=a)};b.RetroFont.prototype.buildRetroFontText=
function(){var a=0,c=0;this.clear();if(this.multiLine){var d=this._text.split("\n");0<this.fixedWidth?this.resize(this.fixedWidth,d.length*(this.characterHeight+this.customSpacingY)-this.customSpacingY,!0):this.resize(this.getLongestLine()*(this.characterWidth+this.customSpacingX),d.length*(this.characterHeight+this.customSpacingY)-this.customSpacingY,!0);for(var e=0;e<d.length;e++)a=0,this.align===b.RetroFont.ALIGN_RIGHT?a=this.width-d[e].length*(this.characterWidth+this.customSpacingX):this.align===
b.RetroFont.ALIGN_CENTER&&(a=this.width/2-d[e].length*(this.characterWidth+this.customSpacingX)/2,a+=this.customSpacingX/2),0>a&&(a=0),this.pasteLine(d[e],a,c,this.customSpacingX),c+=this.characterHeight+this.customSpacingY}else 0<this.fixedWidth?this.resize(this.fixedWidth,this.characterHeight,!0):this.resize(this._text.length*(this.characterWidth+this.customSpacingX),this.characterHeight,!0),a=0,this.align===b.RetroFont.ALIGN_RIGHT?a=this.width-this._text.length*(this.characterWidth+this.customSpacingX):
this.align===b.RetroFont.ALIGN_CENTER&&(a=this.width/2-this._text.length*(this.characterWidth+this.customSpacingX)/2,a+=this.customSpacingX/2),0>a&&(a=0),this.pasteLine(this._text,a,0,this.customSpacingX);this.requiresReTint=!0};b.RetroFont.prototype.pasteLine=function(a,c,b,e){for(var g=0;g<a.length;g++)if(" "===a.charAt(g))c+=this.characterWidth+e;else if(0<=this.grabData[a.charCodeAt(g)]&&(this.stamp.frame=this.grabData[a.charCodeAt(g)],this.renderXY(this.stamp,c,b,!1),c+=this.characterWidth+e,
c>this.width))break};b.RetroFont.prototype.getLongestLine=function(){var a=0;if(0<this._text.length)for(var c=this._text.split("\n"),b=0;b<c.length;b++)c[b].length>a&&(a=c[b].length);return a};b.RetroFont.prototype.removeUnsupportedCharacters=function(a){for(var c="",b=0;b<this._text.length;b++){var e=this._text[b],g=e.charCodeAt(0);if(0<=this.grabData[g]||!a&&"\n"===e)c=c.concat(e)}return c};b.RetroFont.prototype.updateOffset=function(a,c){if(this.offsetX!==a||this.offsetY!==c){for(var b=a-this.offsetX,
e=c-this.offsetY,g=this.game.cache.getFrameData(this.stamp.key).getFrames(),l=g.length;l--;)g[l].x+=b,g[l].y+=e;this.buildRetroFontText()}};Object.defineProperty(b.RetroFont.prototype,"text",{get:function(){return this._text},set:function(a){a=this.autoUpperCase?a.toUpperCase():a;a!==this._text&&(this._text=a,this.removeUnsupportedCharacters(this.multiLine),this.buildRetroFontText())}});Object.defineProperty(b.RetroFont.prototype,"smoothed",{get:function(){return this.stamp.smoothed},set:function(a){this.stamp.smoothed=
a;this.buildRetroFontText()}});b.Rope=function(a,c,d,e,g,l){this.points=[];this.points=l;this._hasUpdateAnimation=!1;this._updateAnimationCallback=null;c=c||0;d=d||0;e=e||null;g=g||null;this.type=b.ROPE;this._scroll=new b.Point;PIXI.Rope.call(this,PIXI.TextureCache.__default,this.points);b.Component.Core.init.call(this,a,c,d,e,g)};b.Rope.prototype=Object.create(PIXI.Rope.prototype);b.Rope.prototype.constructor=b.Rope;b.Component.Core.install.call(b.Rope.prototype,"Angle Animation AutoCull Bounds BringToTop Crop Delta Destroy FixedToCamera InputEnabled InWorld LifeSpan LoadTexture Overlap PhysicsBody Reset ScaleMinMax Smoothed".split(" "));
b.Rope.prototype.preUpdatePhysics=b.Component.PhysicsBody.preUpdate;b.Rope.prototype.preUpdateLifeSpan=b.Component.LifeSpan.preUpdate;b.Rope.prototype.preUpdateInWorld=b.Component.InWorld.preUpdate;b.Rope.prototype.preUpdateCore=b.Component.Core.preUpdate;b.Rope.prototype.preUpdate=function(){0!==this._scroll.x&&(this.tilePosition.x+=this._scroll.x*this.game.time.physicsElapsed);0!==this._scroll.y&&(this.tilePosition.y+=this._scroll.y*this.game.time.physicsElapsed);return this.preUpdatePhysics()&&
this.preUpdateLifeSpan()&&this.preUpdateInWorld()?this.preUpdateCore():!1};b.Rope.prototype.update=function(){this._hasUpdateAnimation&&this.updateAnimation.call(this)};b.Rope.prototype.reset=function(a,c){b.Component.Reset.prototype.reset.call(this,a,c);this.tilePosition.x=0;this.tilePosition.y=0;return this};Object.defineProperty(b.Rope.prototype,"updateAnimation",{get:function(){return this._updateAnimation},set:function(a){a&&"function"===typeof a?(this._hasUpdateAnimation=!0,this._updateAnimation=
a):(this._hasUpdateAnimation=!1,this._updateAnimation=null)}});Object.defineProperty(b.Rope.prototype,"segments",{get:function(){for(var a=[],c,d,e,g,l=0;l<this.points.length;l++)c=4*l,d=this.vertices[c]*this.scale.x,e=this.vertices[c+1]*this.scale.y,g=this.vertices[c+4]*this.scale.x,c=this.vertices[c+3]*this.scale.y,g=b.Math.difference(d,g),c=b.Math.difference(e,c),d+=this.world.x,e+=this.world.y,d=new b.Rectangle(d,e,g,c),a.push(d);return a}});b.TileSprite=function(a,c,d,e,g,l,f){c=c||0;d=d||0;
e=e||256;g=g||256;l=l||null;f=f||null;this.type=b.TILESPRITE;this.physicsType=b.SPRITE;this._scroll=new b.Point;var h=a.cache.getImage("__default",!0);PIXI.TilingSprite.call(this,new PIXI.Texture(h.base),e,g);b.Component.Core.init.call(this,a,c,d,l,f)};b.TileSprite.prototype=Object.create(PIXI.TilingSprite.prototype);b.TileSprite.prototype.constructor=b.TileSprite;b.Component.Core.install.call(b.TileSprite.prototype,"Angle Animation AutoCull Bounds BringToTop Destroy FixedToCamera Health InCamera InputEnabled InWorld LifeSpan LoadTexture Overlap PhysicsBody Reset Smoothed".split(" "));
b.TileSprite.prototype.preUpdatePhysics=b.Component.PhysicsBody.preUpdate;b.TileSprite.prototype.preUpdateLifeSpan=b.Component.LifeSpan.preUpdate;b.TileSprite.prototype.preUpdateInWorld=b.Component.InWorld.preUpdate;b.TileSprite.prototype.preUpdateCore=b.Component.Core.preUpdate;b.TileSprite.prototype.preUpdate=function(){0!==this._scroll.x&&(this.tilePosition.x+=this._scroll.x*this.game.time.physicsElapsed);0!==this._scroll.y&&(this.tilePosition.y+=this._scroll.y*this.game.time.physicsElapsed);return this.preUpdatePhysics()&&
this.preUpdateLifeSpan()&&this.preUpdateInWorld()?this.preUpdateCore():!1};b.TileSprite.prototype.autoScroll=function(a,c){this._scroll.set(a,c)};b.TileSprite.prototype.stopScroll=function(){this._scroll.set(0,0)};b.TileSprite.prototype.destroy=function(a){b.Component.Destroy.prototype.destroy.call(this,a);PIXI.TilingSprite.prototype.destroy.call(this)};b.TileSprite.prototype.reset=function(a,c){b.Component.Reset.prototype.reset.call(this,a,c);this.tilePosition.x=0;this.tilePosition.y=0;return this};
b.Device=function(){this.deviceReadyAt=0;this.canvas=this.windowsPhone=this.windows=this.macOS=this.linux=this.chromeOS=this.android=this.crosswalk=this.ejecta=this.electron=this.nodeWebkit=this.node=this.cordova=this.cocoonJSApp=this.cocoonJS=this.iOS=this.desktop=this.initialized=!1;this.canvasBitBltShift=null;this.vibration=this.typedArray=this.pointerLock=this.css3D=this.worker=this.localStorage=this.fileSystem=this.file=this.webGL=!1;this.getUserMedia=!0;this.mspointer=this.touch=this.quirksMode=
!1;this.wheelEvent=null;this.chrome=this.arora=!1;this.chromeVersion=0;this.firefox=this.epiphany=!1;this.firefoxVersion=0;this.ie=!1;this.ieVersion=0;this.trident=!1;this.tridentVersion=0;this.iPad=this.iPhone4=this.iPhone=this.hlsVideo=this.vp9Video=this.webmVideo=this.mp4Video=this.h264Video=this.oggVideo=this.webm=this.m4a=this.wav=this.mp3=this.opus=this.ogg=this.webAudio=this.audioData=this.silk=this.webApp=this.safari=this.opera=this.midori=this.mobileSafari=!1;this.pixelRatio=0;this.fullscreen=
this.support32bit=this.LITTLE_ENDIAN=this.littleEndian=!1;this.cancelFullscreen=this.requestFullscreen="";this.fullscreenKeyboard=!1};b.Device=new b.Device;b.Device.onInitialized=new b.Signal;b.Device.whenReady=function(a,c,b){var e=this._readyCheck;this.deviceReadyAt||!e?a.call(c,this):e._monitor||b?(e._queue=e._queue||[],e._queue.push([a,c])):(e._monitor=e.bind(this),e._queue=e._queue||[],e._queue.push([a,c]),a="undefined"!==typeof window.cordova,c=navigator.isCocoonJS,"complete"===document.readyState||
"interactive"===document.readyState?window.setTimeout(e._monitor,0):a&&!c?document.addEventListener("deviceready",e._monitor,!1):(document.addEventListener("DOMContentLoaded",e._monitor,!1),window.addEventListener("load",e._monitor,!1)))};b.Device._readyCheck=function(){var a=this._readyCheck;if(!document.body)window.setTimeout(a._monitor,20);else if(!this.deviceReadyAt){this.deviceReadyAt=Date.now();document.removeEventListener("deviceready",a._monitor);document.removeEventListener("DOMContentLoaded",
a._monitor);window.removeEventListener("load",a._monitor);this._initialize();this.initialized=!0;this.onInitialized.dispatch(this);for(var c;c=a._queue.shift();)c[0].call(c[1],this);this.onInitialized=this._initialize=this._readyCheck=null}};b.Device._initialize=function(){function a(){var a=new ArrayBuffer(4),c=new Uint8Array(a),a=new Uint32Array(a);c[0]=161;c[1]=178;c[2]=195;c[3]=212;return 3569595041==a[0]?!0:2712847316==a[0]?!1:null}function c(){if(void 0===Uint8ClampedArray)return!1;var a=document.createElement("canvas").getContext("2d");
return a?a.createImageData(1,1).data instanceof Uint8ClampedArray:!1}var b=this;(function(){var a=navigator.userAgent;/Playstation Vita/.test(a)?b.vita=!0:/Kindle/.test(a)||/\bKF[A-Z][A-Z]+/.test(a)||/Silk.*Mobile Safari/.test(a)?b.kindle=!0:/Android/.test(a)?b.android=!0:/CrOS/.test(a)?b.chromeOS=!0:/iP[ao]d|iPhone/i.test(a)?b.iOS=!0:/Linux/.test(a)?b.linux=!0:/Mac OS/.test(a)?b.macOS=!0:/Windows/.test(a)&&(b.windows=!0);if(/Windows Phone/i.test(a)||/IEMobile/i.test(a))b.android=!1,b.iOS=!1,b.macOS=
!1,b.windows=!0,b.windowsPhone=!0;var c=/Silk/.test(a);if(b.windows||b.macOS||b.linux&&!c||b.chromeOS)b.desktop=!0;if(b.windowsPhone||/Windows NT/i.test(a)&&/Touch/i.test(a))b.desktop=!1})();(function(){b.audioData=!!window.Audio;b.webAudio=!(!window.AudioContext&&!window.webkitAudioContext);var a=document.createElement("audio");try{if(a.canPlayType){a.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,"")&&(b.ogg=!0);if(a.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,"")||a.canPlayType("audio/opus;").replace(/^no$/,
""))b.opus=!0;a.canPlayType("audio/mpeg;").replace(/^no$/,"")&&(b.mp3=!0);a.canPlayType('audio/wav; codecs="1"').replace(/^no$/,"")&&(b.wav=!0);if(a.canPlayType("audio/x-m4a;")||a.canPlayType("audio/aac;").replace(/^no$/,""))b.m4a=!0;a.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")&&(b.webm=!0)}}catch(c){}})();(function(){var a=document.createElement("video");try{a.canPlayType&&(a.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,"")&&(b.oggVideo=!0),a.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,
"")&&(b.h264Video=!0,b.mp4Video=!0),a.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,"")&&(b.webmVideo=!0),a.canPlayType('video/webm; codecs="vp9"').replace(/^no$/,"")&&(b.vp9Video=!0),a.canPlayType('application/x-mpegURL; codecs="avc1.42E01E"').replace(/^no$/,"")&&(b.hlsVideo=!0))}catch(c){}})();(function(){var a=navigator.userAgent;/Arora/.test(a)?b.arora=!0:/Chrome\/(\d+)/.test(a)&&!b.windowsPhone?(b.chrome=!0,b.chromeVersion=parseInt(RegExp.$1,10)):/Epiphany/.test(a)?b.epiphany=
!0:/Firefox\D+(\d+)/.test(a)?(b.firefox=!0,b.firefoxVersion=parseInt(RegExp.$1,10)):/AppleWebKit/.test(a)&&b.iOS?b.mobileSafari=!0:/MSIE (\d+\.\d+);/.test(a)?(b.ie=!0,b.ieVersion=parseInt(RegExp.$1,10)):/Midori/.test(a)?b.midori=!0:/Opera/.test(a)?b.opera=!0:/Safari/.test(a)&&!b.windowsPhone?b.safari=!0:/Trident\/(\d+\.\d+)(.*)rv:(\d+\.\d+)/.test(a)&&(b.ie=!0,b.trident=!0,b.tridentVersion=parseInt(RegExp.$1,10),b.ieVersion=parseInt(RegExp.$3,10));/Silk/.test(a)&&(b.silk=!0);navigator.standalone&&
(b.webApp=!0);"undefined"!==typeof window.cordova&&(b.cordova=!0);"undefined"!==typeof process&&"undefined"!==typeof require&&(b.node=!0);b.node&&"object"===typeof process.versions&&(b.nodeWebkit=!!process.versions["node-webkit"],b.electron=!!process.versions.electron);navigator.isCocoonJS&&(b.cocoonJS=!0);if(b.cocoonJS)try{b.cocoonJSApp="undefined"!==typeof CocoonJS}catch(c){b.cocoonJSApp=!1}"undefined"!==typeof window.ejecta&&(b.ejecta=!0);/Crosswalk/.test(a)&&(b.crosswalk=!0)})();(function(){var a=
document.createElement("p"),c,l={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};document.body.insertBefore(a,null);for(var f in l)void 0!==a.style[f]&&(a.style[f]="translate3d(1px,1px,1px)",c=window.getComputedStyle(a).getPropertyValue(l[f]));document.body.removeChild(a);b.css3D=void 0!==c&&0<c.length&&"none"!==c})();b.pixelRatio=window.devicePixelRatio||1;b.iPhone=-1!=navigator.userAgent.toLowerCase().indexOf("iphone");
b.iPhone4=2==b.pixelRatio&&b.iPhone;b.iPad=-1!=navigator.userAgent.toLowerCase().indexOf("ipad");b.typedArray="undefined"!==typeof Int8Array?!0:!1;"undefined"!==typeof ArrayBuffer&&"undefined"!==typeof Uint8Array&&"undefined"!==typeof Uint32Array&&(b.littleEndian=a(),b.LITTLE_ENDIAN=b.littleEndian);b.support32bit="undefined"!==typeof ArrayBuffer&&"undefined"!==typeof Uint8ClampedArray&&"undefined"!==typeof Int32Array&&null!==b.littleEndian&&c();navigator.vibrate=navigator.vibrate||navigator.webkitVibrate||
navigator.mozVibrate||navigator.msVibrate;navigator.vibrate&&(b.vibration=!0);(function(){b.canvas=!!window.CanvasRenderingContext2D||b.cocoonJS;try{b.localStorage=!!localStorage.getItem}catch(a){b.localStorage=!1}b.file=!!window.File&&!!window.FileReader&&!!window.FileList&&!!window.Blob;b.fileSystem=!!window.requestFileSystem;var c;try{var g=document.createElement("canvas");g.screencanvas=!1;c=!!window.WebGLRenderingContext&&(g.getContext("webgl")||g.getContext("experimental-webgl"))}catch(a){c=
!1}b.webGL=c;b.webGL=!!b.webGL;b.worker=!!window.Worker;b.pointerLock="pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document;b.quirksMode="CSS1Compat"===document.compatMode?!1:!0;navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia||navigator.oGetUserMedia;window.URL=window.URL||window.webkitURL||window.mozURL||window.msURL;b.getUserMedia=b.getUserMedia&&!!navigator.getUserMedia&&
!!window.URL;b.firefox&&21>b.firefoxVersion&&(b.getUserMedia=!1);!b.iOS&&(b.ie||b.firefox||b.chrome)&&(b.canvasBitBltShift=!0);if(b.safari||b.mobileSafari)b.canvasBitBltShift=!1})();(function(){for(var a="requestFullscreen requestFullScreen webkitRequestFullscreen webkitRequestFullScreen msRequestFullscreen msRequestFullScreen mozRequestFullScreen mozRequestFullscreen".split(" "),c=document.createElement("div"),l=0;l<a.length;l++)if(c[a[l]]){b.fullscreen=!0;b.requestFullscreen=a[l];break}a="cancelFullScreen exitFullscreen webkitCancelFullScreen webkitExitFullscreen msCancelFullScreen msExitFullscreen mozCancelFullScreen mozExitFullscreen".split(" ");
if(b.fullscreen)for(l=0;l<a.length;l++)if(document[a[l]]){b.cancelFullscreen=a[l];break}window.Element&&Element.ALLOW_KEYBOARD_INPUT&&(b.fullscreenKeyboard=!0)})();if("ontouchstart"in document.documentElement||window.navigator.maxTouchPoints&&1<=window.navigator.maxTouchPoints)b.touch=!0;if(window.navigator.msPointerEnabled||window.navigator.pointerEnabled)b.mspointer=!0;b.cocoonJS||("onwheel"in window||b.ie&&"WheelEvent"in window?b.wheelEvent="wheel":"onmousewheel"in window?b.wheelEvent="mousewheel":
b.firefox&&"MouseScrollEvent"in window&&(b.wheelEvent="DOMMouseScroll"))};b.Device.canPlayAudio=function(a){return"mp3"===a&&this.mp3||"ogg"===a&&(this.ogg||this.opus)||"m4a"===a&&this.m4a||"opus"===a&&this.opus||"wav"===a&&this.wav||"webm"===a&&this.webm?!0:!1};b.Device.canPlayVideo=function(a){return"webm"===a&&(this.webmVideo||this.vp9Video)||"mp4"===a&&(this.mp4Video||this.h264Video)||("ogg"===a||"ogv"===a)&&this.oggVideo||"mpeg"===a&&this.hlsVideo?!0:!1};b.Device.isConsoleOpen=function(){return window.console&&
window.console.firebug?!0:window.console&&(console.profile(),console.profileEnd(),console.clear&&console.clear(),console.profiles)?0<console.profiles.length:!1};b.Device.isAndroidStockBrowser=function(){var a=window.navigator.userAgent.match(/Android.*AppleWebKit\/([\d.]+)/);return a&&537>a[1]};b.DOM={getOffset:function(a,c){c=c||new b.Point;var d=a.getBoundingClientRect(),e=b.DOM.scrollY,g=document.documentElement.clientTop;c.x=d.left+b.DOM.scrollX-document.documentElement.clientLeft;c.y=d.top+e-
g;return c},getBounds:function(a,c){void 0===c&&(c=0);return(a=a&&!a.nodeType?a[0]:a)&&1===a.nodeType?this.calibrate(a.getBoundingClientRect(),c):!1},calibrate:function(a,c){c=+c||0;var b={width:0,height:0,left:0,right:0,top:0,bottom:0};b.width=(b.right=a.right+c)-(b.left=a.left-c);b.height=(b.bottom=a.bottom+c)-(b.top=a.top-c);return b},getAspectRatio:function(a){a=null==a?this.visualBounds:1===a.nodeType?this.getBounds(a):a;var c=a.width,b=a.height;"function"===typeof c&&(c=c.call(a));"function"===
typeof b&&(b=b.call(a));return c/b},inLayoutViewport:function(a,c){var b=this.getBounds(a,c);return!!b&&0<=b.bottom&&0<=b.right&&b.top<=this.layoutBounds.width&&b.left<=this.layoutBounds.height},getScreenOrientation:function(a){var c=window.screen,b=c.orientation||c.mozOrientation||c.msOrientation;if(b&&"string"===typeof b.type)return b.type;if("string"===typeof b)return b;if("screen"===a)return c.height>c.width?"portrait-primary":"landscape-primary";if("viewport"!==a){if("window.orientation"===a&&
"number"===typeof window.orientation)return 0===window.orientation||180===window.orientation?"portrait-primary":"landscape-primary";if(window.matchMedia){if(window.matchMedia("(orientation: portrait)").matches)return"portrait-primary";if(window.matchMedia("(orientation: landscape)").matches)return"landscape-primary"}}return this.visualBounds.height>this.visualBounds.width?"portrait-primary":"landscape-primary"},visualBounds:new b.Rectangle,layoutBounds:new b.Rectangle,documentBounds:new b.Rectangle};
b.Device.whenReady(function(a){var c=window&&"pageXOffset"in window?function(){return window.pageXOffset}:function(){return document.documentElement.scrollLeft},d=window&&"pageYOffset"in window?function(){return window.pageYOffset}:function(){return document.documentElement.scrollTop};Object.defineProperty(b.DOM,"scrollX",{get:c});Object.defineProperty(b.DOM,"scrollY",{get:d});Object.defineProperty(b.DOM.visualBounds,"x",{get:c});Object.defineProperty(b.DOM.visualBounds,"y",{get:d});Object.defineProperty(b.DOM.layoutBounds,
"x",{value:0});Object.defineProperty(b.DOM.layoutBounds,"y",{value:0});a.desktop&&document.documentElement.clientWidth<=window.innerWidth&&document.documentElement.clientHeight<=window.innerHeight?(a=function(){return Math.max(window.innerWidth,document.documentElement.clientWidth)},c=function(){return Math.max(window.innerHeight,document.documentElement.clientHeight)},Object.defineProperty(b.DOM.visualBounds,"width",{get:a}),Object.defineProperty(b.DOM.visualBounds,"height",{get:c}),Object.defineProperty(b.DOM.layoutBounds,
"width",{get:a}),Object.defineProperty(b.DOM.layoutBounds,"height",{get:c})):(Object.defineProperty(b.DOM.visualBounds,"width",{get:function(){return window.innerWidth}}),Object.defineProperty(b.DOM.visualBounds,"height",{get:function(){return window.innerHeight}}),Object.defineProperty(b.DOM.layoutBounds,"width",{get:function(){var a=document.documentElement.clientWidth,c=window.innerWidth;return a<c?c:a}}),Object.defineProperty(b.DOM.layoutBounds,"height",{get:function(){var a=document.documentElement.clientHeight,
c=window.innerHeight;return a<c?c:a}}));Object.defineProperty(b.DOM.documentBounds,"x",{value:0});Object.defineProperty(b.DOM.documentBounds,"y",{value:0});Object.defineProperty(b.DOM.documentBounds,"width",{get:function(){var a=document.documentElement;return Math.max(a.clientWidth,a.offsetWidth,a.scrollWidth)}});Object.defineProperty(b.DOM.documentBounds,"height",{get:function(){var a=document.documentElement;return Math.max(a.clientHeight,a.offsetHeight,a.scrollHeight)}})},null,!0);b.Canvas={create:function(a,
c,b){a=a||256;c=c||256;var e=document.createElement("canvas");"string"===typeof b&&""!==b&&(e.id=b);e.width=a;e.height=c;e.style.display="block";return e},setBackgroundColor:function(a,c){a.style.backgroundColor=c||"rgb(0,0,0)";return a},setTouchAction:function(a,c){c=c||"none";a.style.msTouchAction=c;a.style["ms-touch-action"]=c;a.style["touch-action"]=c;return a},setUserSelect:function(a,c){c=c||"none";a.style["-webkit-touch-callout"]=c;a.style["-webkit-user-select"]=c;a.style["-khtml-user-select"]=
c;a.style["-moz-user-select"]=c;a.style["-ms-user-select"]=c;a.style["user-select"]=c;a.style["-webkit-tap-highlight-color"]="rgba(0, 0, 0, 0)";return a},addToDOM:function(a,c,b){var e;void 0===b&&(b=!0);c&&("string"===typeof c?e=document.getElementById(c):"object"===typeof c&&1===c.nodeType&&(e=c));e||(e=document.body);b&&e.style&&(e.style.overflow="hidden");e.appendChild(a);return a},removeFromDOM:function(a){a.parentNode&&a.parentNode.removeChild(a)},setTransform:function(a,c,b,e,g,l,f){a.setTransform(e,
l,f,g,c,b);return a},setSmoothingEnabled:function(a,c){var b=["i","mozI","oI","webkitI","msI"],e;for(e in b){var g=b[e]+"mageSmoothingEnabled";if(g in a){a[g]=c;break}}return a},getSmoothingEnabled:function(a){return a.imageSmoothingEnabled||a.mozImageSmoothingEnabled||a.oImageSmoothingEnabled||a.webkitImageSmoothingEnabled||a.msImageSmoothingEnabled},setImageRenderingCrisp:function(a){a.style["image-rendering"]="optimizeSpeed";a.style["image-rendering"]="crisp-edges";a.style["image-rendering"]="-moz-crisp-edges";
a.style["image-rendering"]="-webkit-optimize-contrast";a.style["image-rendering"]="optimize-contrast";a.style["image-rendering"]="pixelated";a.style.msInterpolationMode="nearest-neighbor";return a},setImageRenderingBicubic:function(a){a.style["image-rendering"]="auto";a.style.msInterpolationMode="bicubic";return a}};b.RequestAnimationFrame=function(a,c){void 0===c&&(c=!1);this.game=a;this.isRunning=!1;this.forceSetTimeOut=c;for(var b=["ms","moz","webkit","o"],e=0;e<b.length&&!window.requestAnimationFrame;e++)window.requestAnimationFrame=
window[b[e]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[e]+"CancelAnimationFrame"];this._isSetTimeOut=!1;this._timeOutID=this._onLoop=null};b.RequestAnimationFrame.prototype={start:function(){this.isRunning=!0;var a=this;!window.requestAnimationFrame||this.forceSetTimeOut?(this._isSetTimeOut=!0,this._onLoop=function(){return a.updateSetTimeout()},this._timeOutID=window.setTimeout(this._onLoop,0)):(this._isSetTimeOut=!1,this._onLoop=function(c){return a.updateRAF(c)},this._timeOutID=
window.requestAnimationFrame(this._onLoop))},updateRAF:function(a){this.game.update(Math.floor(a));this._timeOutID=window.requestAnimationFrame(this._onLoop)},updateSetTimeout:function(){this.game.update(Date.now());this._timeOutID=window.setTimeout(this._onLoop,this.game.time.timeToCall)},stop:function(){this._isSetTimeOut?clearTimeout(this._timeOutID):window.cancelAnimationFrame(this._timeOutID);this.isRunning=!1},isSetTimeOut:function(){return this._isSetTimeOut},isRAF:function(){return!1===this._isSetTimeOut}};
b.RequestAnimationFrame.prototype.constructor=b.RequestAnimationFrame;b.Math={PI2:2*Math.PI,fuzzyEqual:function(a,c,b){void 0===b&&(b=1E-4);return Math.abs(a-c)<b},fuzzyLessThan:function(a,c,b){void 0===b&&(b=1E-4);return a<c+b},fuzzyGreaterThan:function(a,c,b){void 0===b&&(b=1E-4);return a>c-b},fuzzyCeil:function(a,c){void 0===c&&(c=1E-4);return Math.ceil(a-c)},fuzzyFloor:function(a,c){void 0===c&&(c=1E-4);return Math.floor(a+c)},average:function(){for(var a=0,c=0;c<arguments.length;c++)a+=+arguments[c];
return a/arguments.length},shear:function(a){return a%1},snapTo:function(a,c,b){void 0===b&&(b=0);if(0===c)return a;a=c*Math.round((a-b)/c);return b+a},snapToFloor:function(a,c,b){void 0===b&&(b=0);if(0===c)return a;a=c*Math.floor((a-b)/c);return b+a},snapToCeil:function(a,c,b){void 0===b&&(b=0);if(0===c)return a;a=c*Math.ceil((a-b)/c);return b+a},roundTo:function(a,c,b){void 0===c&&(c=0);void 0===b&&(b=10);c=Math.pow(b,-c);return Math.round(a*c)/c},floorTo:function(a,c,b){void 0===c&&(c=0);void 0===
b&&(b=10);c=Math.pow(b,-c);return Math.floor(a*c)/c},ceilTo:function(a,c,b){void 0===c&&(c=0);void 0===b&&(b=10);c=Math.pow(b,-c);return Math.ceil(a*c)/c},angleBetween:function(a,c,b,e){return Math.atan2(e-c,b-a)},angleBetweenY:function(a,c,b,e){return Math.atan2(b-a,e-c)},angleBetweenPoints:function(a,c){return Math.atan2(c.y-a.y,c.x-a.x)},angleBetweenPointsY:function(a,c){return Math.atan2(c.x-a.x,c.y-a.y)},reverseAngle:function(a){return this.normalizeAngle(a+Math.PI,!0)},normalizeAngle:function(a){a%=
2*Math.PI;return 0<=a?a:a+2*Math.PI},maxAdd:function(a,c,b){return Math.min(a+c,b)},minSub:function(a,c,b){return Math.max(a-c,b)},wrap:function(a,c,b){b-=c;if(0>=b)return 0;a=(a-c)%b;0>a&&(a+=b);return a+c},wrapValue:function(a,c,b){a=Math.abs(a);c=Math.abs(c);b=Math.abs(b);return(a+c)%b},isOdd:function(a){return!!(a&1)},isEven:function(a){return!(a&1)},min:function(){for(var a=1===arguments.length&&"object"===typeof arguments[0]?arguments[0]:arguments,c=1,b=0,e=a.length;c<e;c++)a[c]<a[b]&&(b=c);
return a[b]},max:function(){for(var a=1===arguments.length&&"object"===typeof arguments[0]?arguments[0]:arguments,c=1,b=0,e=a.length;c<e;c++)a[c]>a[b]&&(b=c);return a[b]},minProperty:function(a){for(var c=2===arguments.length&&"object"===typeof arguments[1]?arguments[1]:arguments.slice(1),b=1,e=0,g=c.length;b<g;b++)c[b][a]<c[e][a]&&(e=b);return c[e][a]},maxProperty:function(a){for(var c=2===arguments.length&&"object"===typeof arguments[1]?arguments[1]:arguments.slice(1),b=1,e=0,g=c.length;b<g;b++)c[b][a]>
c[e][a]&&(e=b);return c[e][a]},wrapAngle:function(a,c){return c?this.wrap(a,-Math.PI,Math.PI):this.wrap(a,-180,180)},linearInterpolation:function(a,c){var b=a.length-1,e=b*c,g=Math.floor(e);return 0>c?this.linear(a[0],a[1],e):1<c?this.linear(a[b],a[b-1],b-e):this.linear(a[g],a[g+1>b?b:g+1],e-g)},bezierInterpolation:function(a,c){for(var b=0,e=a.length-1,g=0;g<=e;g++)b+=Math.pow(1-c,e-g)*Math.pow(c,g)*a[g]*this.bernstein(e,g);return b},catmullRomInterpolation:function(a,c){var b=a.length-1,e=b*c,g=
Math.floor(e);return a[0]===a[b]?(0>c&&(g=Math.floor(e=b*(1+c))),this.catmullRom(a[(g-1+b)%b],a[g],a[(g+1)%b],a[(g+2)%b],e-g)):0>c?a[0]-(this.catmullRom(a[0],a[0],a[1],a[1],-e)-a[0]):1<c?a[b]-(this.catmullRom(a[b],a[b],a[b-1],a[b-1],e-b)-a[b]):this.catmullRom(a[g?g-1:0],a[g],a[b<g+1?b:g+1],a[b<g+2?b:g+2],e-g)},linear:function(a,c,b){return(c-a)*b+a},bernstein:function(a,c){return this.factorial(a)/this.factorial(c)/this.factorial(a-c)},factorial:function(a){if(0===a)return 1;for(var c=a;--a;)c*=a;
return c},catmullRom:function(a,c,b,e,g){a=.5*(b-a);e=.5*(e-c);var l=g*g;return(2*c-2*b+a+e)*g*l+(-3*c+3*b-2*a-e)*l+a*g+c},difference:function(a,c){return Math.abs(a-c)},roundAwayFromZero:function(a){return 0<a?Math.ceil(a):Math.floor(a)},sinCosGenerator:function(a,c,b,e){void 0===c&&(c=1);void 0===b&&(b=1);void 0===e&&(e=1);e=e*Math.PI/a;for(var g=[],l=[],f=0;f<a;f++)b-=c*e,c+=b*e,g[f]=b,l[f]=c;return{sin:l,cos:g,length:a}},distance:function(a,c,b,e){a-=b;c-=e;return Math.sqrt(a*a+c*c)},distanceSq:function(a,
c,b,e){a-=b;c-=e;return a*a+c*c},distancePow:function(a,c,b,e,g){void 0===g&&(g=2);return Math.sqrt(Math.pow(b-a,g)+Math.pow(e-c,g))},clamp:function(a,c,b){return a<c?c:a>b?b:a},clampBottom:function(a,c){return a<c?c:a},within:function(a,c,b){return Math.abs(a-c)<=b},mapLinear:function(a,c,b,e,g){return e+(a-c)*(g-e)/(b-c)},smoothstep:function(a,c,b){a=Math.max(0,Math.min(1,(a-c)/(b-c)));return a*a*(3-2*a)},smootherstep:function(a,c,b){a=Math.max(0,Math.min(1,(a-c)/(b-c)));return a*a*a*(a*(6*a-15)+
10)},sign:function(a){return 0>a?-1:0<a?1:0},percent:function(a,c,b){void 0===b&&(b=0);return a>c||b>c?1:a<b||b>a?0:(a-b)/c}};var k=Math.PI/180,n=180/Math.PI;b.Math.degToRad=function(a){return a*k};b.Math.radToDeg=function(a){return a*n};b.RandomDataGenerator=function(a){void 0===a&&(a=[]);this.c=1;this.s2=this.s1=this.s0=0;this.sow(a)};b.RandomDataGenerator.prototype={rnd:function(){var a=2091639*this.s0+2.3283064365386963E-10*this.c;this.c=a|0;this.s0=this.s1;this.s1=this.s2;return this.s2=a-this.c},
sow:function(a){this.s0=this.hash(" ");this.s1=this.hash(this.s0);this.s2=this.hash(this.s1);this.c=1;if(a)for(var c=0;c<a.length&&null!=a[c];c++){var b=a[c];this.s0-=this.hash(b);this.s0+=~~(0>this.s0);this.s1-=this.hash(b);this.s1+=~~(0>this.s1);this.s2-=this.hash(b);this.s2+=~~(0>this.s2)}},hash:function(a){var c,b,e;e=4022871197;a=a.toString();for(b=0;b<a.length;b++)e+=a.charCodeAt(b),c=.02519603282416938*e,e=c>>>0,c-=e,c*=e,e=c>>>0,c-=e,e+=4294967296*c;return 2.3283064365386963E-10*(e>>>0)},
integer:function(){return 4294967296*this.rnd.apply(this)},frac:function(){return this.rnd.apply(this)+1.1102230246251565E-16*(2097152*this.rnd.apply(this)|0)},real:function(){return this.integer()+this.frac()},integerInRange:function(a,c){return Math.floor(this.realInRange(0,c-a+1)+a)},between:function(a,c){return this.integerInRange(a,c)},realInRange:function(a,c){return this.frac()*(c-a)+a},normal:function(){return 1-2*this.frac()},uuid:function(){for(var a="",c="",c=a="";36>a++;c+=~a%5|3*a&4?
(a^15?8^this.frac()*(a^20?16:4):4).toString(16):"-");return c},pick:function(a){return a[this.integerInRange(0,a.length-1)]},weightedPick:function(a){return a[~~(Math.pow(this.frac(),2)*(a.length-1)+.5)]},timestamp:function(a,c){return this.realInRange(a||9466848E5,c||1577862E6)},angle:function(){return this.integerInRange(-180,180)}};b.RandomDataGenerator.prototype.constructor=b.RandomDataGenerator;b.QuadTree=function(a,c,b,e,g,l,f){this.maxObjects=10;this.maxLevels=4;this.level=0;this.bounds={};
this.objects=[];this.nodes=[];this._empty=[];this.reset(a,c,b,e,g,l,f)};b.QuadTree.prototype={reset:function(a,c,b,e,g,l,f){this.maxObjects=g||10;this.maxLevels=l||4;this.level=f||0;this.bounds={x:Math.round(a),y:Math.round(c),width:b,height:e,subWidth:Math.floor(b/2),subHeight:Math.floor(e/2),right:Math.round(a)+Math.floor(b/2),bottom:Math.round(c)+Math.floor(e/2)};this.objects.length=0;this.nodes.length=0},populate:function(a){a.forEach(this.populateHandler,this,!0)},populateHandler:function(a){a.body&&
a.exists&&this.insert(a.body)},split:function(){this.nodes[0]=new b.QuadTree(this.bounds.right,this.bounds.y,this.bounds.subWidth,this.bounds.subHeight,this.maxObjects,this.maxLevels,this.level+1);this.nodes[1]=new b.QuadTree(this.bounds.x,this.bounds.y,this.bounds.subWidth,this.bounds.subHeight,this.maxObjects,this.maxLevels,this.level+1);this.nodes[2]=new b.QuadTree(this.bounds.x,this.bounds.bottom,this.bounds.subWidth,this.bounds.subHeight,this.maxObjects,this.maxLevels,this.level+1);this.nodes[3]=
new b.QuadTree(this.bounds.right,this.bounds.bottom,this.bounds.subWidth,this.bounds.subHeight,this.maxObjects,this.maxLevels,this.level+1)},insert:function(a){var c=0,b;if(null!=this.nodes[0]&&(b=this.getIndex(a),-1!==b)){this.nodes[b].insert(a);return}this.objects.push(a);if(this.objects.length>this.maxObjects&&this.level<this.maxLevels)for(null==this.nodes[0]&&this.split();c<this.objects.length;)b=this.getIndex(this.objects[c]),-1!==b?this.nodes[b].insert(this.objects.splice(c,1)[0]):c++},getIndex:function(a){var c=
-1;a.x<this.bounds.right&&a.right<this.bounds.right?a.y<this.bounds.bottom&&a.bottom<this.bounds.bottom?c=1:a.y>this.bounds.bottom&&(c=2):a.x>this.bounds.right&&(a.y<this.bounds.bottom&&a.bottom<this.bounds.bottom?c=0:a.y>this.bounds.bottom&&(c=3));return c},retrieve:function(a){if(a instanceof b.Rectangle)var c=this.objects,d=this.getIndex(a);else{if(!a.body)return this._empty;c=this.objects;d=this.getIndex(a.body)}this.nodes[0]&&(-1!==d?c=c.concat(this.nodes[d].retrieve(a)):(c=c.concat(this.nodes[0].retrieve(a)),
c=c.concat(this.nodes[1].retrieve(a)),c=c.concat(this.nodes[2].retrieve(a)),c=c.concat(this.nodes[3].retrieve(a))));return c},clear:function(){this.objects.length=0;for(var a=this.nodes.length;a--;)this.nodes[a].clear(),this.nodes.splice(a,1);this.nodes.length=0}};b.QuadTree.prototype.constructor=b.QuadTree;b.Net=function(a){this.game=a};b.Net.prototype={getHostName:function(){return window.location&&window.location.hostname?window.location.hostname:null},checkDomainName:function(a){return-1!==window.location.hostname.indexOf(a)},
updateQueryString:function(a,c,b,e){void 0===b&&(b=!1);if(void 0===e||""===e)e=window.location.href;var g="",g=new RegExp("([?|&])"+a+"=.*?(&|#|$)(.*)","gi");if(g.test(e))g="undefined"!==typeof c&&null!==c?e.replace(g,"$1"+a+"="+c+"$2$3"):e.replace(g,"$1$3").replace(/(&|\?)$/,"");else{if("undefined"!==typeof c&&null!==c){var g=-1!==e.indexOf("?")?"&":"?",l=e.split("#");e=l[0]+g+a+"="+c;l[1]&&(e+="#"+l[1])}g=e}if(b)window.location.href=g;else return g},getQueryString:function(a){void 0===a&&(a="");
var c={},b=location.search.substring(1).split("&"),e;for(e in b){var g=b[e].split("=");if(1<g.length){if(a&&a==this.decodeURI(g[0]))return this.decodeURI(g[1]);c[this.decodeURI(g[0])]=this.decodeURI(g[1])}}return c},decodeURI:function(a){return decodeURIComponent(a.replace(/\+/g," "))}};b.Net.prototype.constructor=b.Net;b.TweenManager=function(a){this.game=a;this._tweens=[];this._add=[];this.easeMap={Power0:b.Easing.Power0,Power1:b.Easing.Power1,Power2:b.Easing.Power2,Power3:b.Easing.Power3,Power4:b.Easing.Power4,
Linear:b.Easing.Linear.None,Quad:b.Easing.Quadratic.Out,Cubic:b.Easing.Cubic.Out,Quart:b.Easing.Quartic.Out,Quint:b.Easing.Quintic.Out,Sine:b.Easing.Sinusoidal.Out,Expo:b.Easing.Exponential.Out,Circ:b.Easing.Circular.Out,Elastic:b.Easing.Elastic.Out,Back:b.Easing.Back.Out,Bounce:b.Easing.Bounce.Out,"Quad.easeIn":b.Easing.Quadratic.In,"Cubic.easeIn":b.Easing.Cubic.In,"Quart.easeIn":b.Easing.Quartic.In,"Quint.easeIn":b.Easing.Quintic.In,"Sine.easeIn":b.Easing.Sinusoidal.In,"Expo.easeIn":b.Easing.Exponential.In,
"Circ.easeIn":b.Easing.Circular.In,"Elastic.easeIn":b.Easing.Elastic.In,"Back.easeIn":b.Easing.Back.In,"Bounce.easeIn":b.Easing.Bounce.In,"Quad.easeOut":b.Easing.Quadratic.Out,"Cubic.easeOut":b.Easing.Cubic.Out,"Quart.easeOut":b.Easing.Quartic.Out,"Quint.easeOut":b.Easing.Quintic.Out,"Sine.easeOut":b.Easing.Sinusoidal.Out,"Expo.easeOut":b.Easing.Exponential.Out,"Circ.easeOut":b.Easing.Circular.Out,"Elastic.easeOut":b.Easing.Elastic.Out,"Back.easeOut":b.Easing.Back.Out,"Bounce.easeOut":b.Easing.Bounce.Out,
"Quad.easeInOut":b.Easing.Quadratic.InOut,"Cubic.easeInOut":b.Easing.Cubic.InOut,"Quart.easeInOut":b.Easing.Quartic.InOut,"Quint.easeInOut":b.Easing.Quintic.InOut,"Sine.easeInOut":b.Easing.Sinusoidal.InOut,"Expo.easeInOut":b.Easing.Exponential.InOut,"Circ.easeInOut":b.Easing.Circular.InOut,"Elastic.easeInOut":b.Easing.Elastic.InOut,"Back.easeInOut":b.Easing.Back.InOut,"Bounce.easeInOut":b.Easing.Bounce.InOut};this.game.onPause.add(this._pauseAll,this);this.game.onResume.add(this._resumeAll,this)};
b.TweenManager.prototype={getAll:function(){return this._tweens},removeAll:function(){for(var a=0;a<this._tweens.length;a++)this._tweens[a].pendingDelete=!0;this._add=[]},removeFrom:function(a,c){void 0===c&&(c=!0);var d,e;if(Array.isArray(a))for(d=0,e=a.length;d<e;d++)this.removeFrom(a[d]);else if(a.type===b.GROUP&&c)for(d=0,e=a.children.length;d<e;d++)this.removeFrom(a.children[d]);else{d=0;for(e=this._tweens.length;d<e;d++)a===this._tweens[d].target&&this.remove(this._tweens[d]);d=0;for(e=this._add.length;d<
e;d++)a===this._add[d].target&&this.remove(this._add[d])}},add:function(a){a._manager=this;this._add.push(a)},create:function(a){return new b.Tween(a,this.game,this)},remove:function(a){var c=this._tweens.indexOf(a);-1!==c?this._tweens[c].pendingDelete=!0:(c=this._add.indexOf(a),-1!==c&&(this._add[c].pendingDelete=!0))},update:function(){var a=this._add.length,c=this._tweens.length;if(0===c&&0===a)return!1;for(var b=0;b<c;)this._tweens[b].update(this.game.time.time)?b++:(this._tweens.splice(b,1),
c--);0<a&&(this._tweens=this._tweens.concat(this._add),this._add.length=0);return!0},isTweening:function(a){return this._tweens.some(function(c){return c.target===a})},_pauseAll:function(){for(var a=this._tweens.length-1;0<=a;a--)this._tweens[a]._pause()},_resumeAll:function(){for(var a=this._tweens.length-1;0<=a;a--)this._tweens[a]._resume()},pauseAll:function(){for(var a=this._tweens.length-1;0<=a;a--)this._tweens[a].pause()},resumeAll:function(){for(var a=this._tweens.length-1;0<=a;a--)this._tweens[a].resume(!0)}};
b.TweenManager.prototype.constructor=b.TweenManager;b.Tween=function(a,c,d){this.game=c;this.target=a;this.manager=d;this.timeline=[];this.reverse=!1;this.timeScale=1;this.repeatCounter=0;this.pendingDelete=!1;this.onStart=new b.Signal;this.onLoop=new b.Signal;this.onRepeat=new b.Signal;this.onChildComplete=new b.Signal;this.onComplete=new b.Signal;this.isRunning=!1;this.current=0;this.properties={};this.chainedTween=null;this.isPaused=!1;this._onUpdateCallbackContext=this._onUpdateCallback=null;
this._pausedTime=0;this._hasStarted=this._codePaused=!1};b.Tween.prototype={to:function(a,c,d,e,g,l,f){if(void 0===c||0>=c)c=1E3;if(void 0===d||null===d)d=b.Easing.Default;void 0===e&&(e=!1);void 0===g&&(g=0);void 0===l&&(l=0);void 0===f&&(f=!1);"string"===typeof d&&this.manager.easeMap[d]&&(d=this.manager.easeMap[d]);if(this.isRunning)return console.warn("Phaser.Tween.to cannot be called after Tween.start"),this;this.timeline.push((new b.TweenData(this)).to(a,c,d,g,l,f));e&&this.start();return this},
from:function(a,c,d,e,g,l,f){void 0===c&&(c=1E3);if(void 0===d||null===d)d=b.Easing.Default;void 0===e&&(e=!1);void 0===g&&(g=0);void 0===l&&(l=0);void 0===f&&(f=!1);"string"===typeof d&&this.manager.easeMap[d]&&(d=this.manager.easeMap[d]);if(this.isRunning)return console.warn("Phaser.Tween.from cannot be called after Tween.start"),this;this.timeline.push((new b.TweenData(this)).from(a,c,d,g,l,f));e&&this.start();return this},start:function(a){void 0===a&&(a=0);if(null===this.game||null===this.target||
0===this.timeline.length||this.isRunning)return this;for(var c=0;c<this.timeline.length;c++)for(var b in this.timeline[c].vEnd)this.properties[b]=this.target[b]||0,Array.isArray(this.properties[b])||(this.properties[b]*=1);for(c=0;c<this.timeline.length;c++)this.timeline[c].loadValues();this.manager.add(this);this.isRunning=!0;if(0>a||a>this.timeline.length-1)a=0;this.current=a;this.timeline[this.current].start();return this},stop:function(a){void 0===a&&(a=!1);this.isRunning=!1;this._onUpdateCallbackContext=
this._onUpdateCallback=null;a&&(this.onComplete.dispatch(this.target,this),this.chainedTween&&this.chainedTween.start());this.manager.remove(this);return this},updateTweenData:function(a,c,b){if(0===this.timeline.length)return this;void 0===b&&(b=0);if(-1===b)for(b=0;b<this.timeline.length;b++)this.timeline[b][a]=c;else this.timeline[b][a]=c;return this},delay:function(a,c){return this.updateTweenData("delay",a,c)},repeat:function(a,c,b){void 0===c&&(c=0);this.updateTweenData("repeatCounter",a,b);
return this.updateTweenData("repeatDelay",c,b)},repeatDelay:function(a,c){return this.updateTweenData("repeatDelay",a,c)},yoyo:function(a,c,b){void 0===c&&(c=0);this.updateTweenData("yoyo",a,b);return this.updateTweenData("yoyoDelay",c,b)},yoyoDelay:function(a,c){return this.updateTweenData("yoyoDelay",a,c)},easing:function(a,c){"string"===typeof a&&this.manager.easeMap[a]&&(a=this.manager.easeMap[a]);return this.updateTweenData("easingFunction",a,c)},interpolation:function(a,c,d){void 0===c&&(c=
b.Math);this.updateTweenData("interpolationFunction",a,d);return this.updateTweenData("interpolationContext",c,d)},repeatAll:function(a){void 0===a&&(a=0);this.repeatCounter=a;return this},chain:function(){for(var a=arguments.length;a--;)0<a?arguments[a-1].chainedTween=arguments[a]:this.chainedTween=arguments[a];return this},loop:function(a){void 0===a&&(a=!0);a?this.repeatAll(-1):this.repeatCounter=0;return this},onUpdateCallback:function(a,c){this._onUpdateCallback=a;this._onUpdateCallbackContext=
c;return this},pause:function(){this._codePaused=this.isPaused=!0;this._pausedTime=this.game.time.time},_pause:function(){this._codePaused||(this.isPaused=!0,this._pausedTime=this.game.time.time)},resume:function(){if(this.isPaused){this._codePaused=this.isPaused=!1;for(var a=0;a<this.timeline.length;a++)this.timeline[a].isRunning||(this.timeline[a].startTime+=this.game.time.time-this._pausedTime)}},_resume:function(){this._codePaused||this.resume()},update:function(a){if(this.pendingDelete)return!1;
if(this.isPaused)return!0;a=this.timeline[this.current].update(a);if(a===b.TweenData.PENDING)return!0;if(a===b.TweenData.RUNNING)return this._hasStarted||(this.onStart.dispatch(this.target,this),this._hasStarted=!0),null!==this._onUpdateCallback&&this._onUpdateCallback.call(this._onUpdateCallbackContext,this,this.timeline[this.current].value,this.timeline[this.current]),this.isRunning;if(a===b.TweenData.LOOPED)return this.onLoop.dispatch(this.target,this),!0;if(a===b.TweenData.COMPLETE){a=!1;this.reverse?
(this.current--,0>this.current&&(this.current=this.timeline.length-1,a=!0)):(this.current++,this.current===this.timeline.length&&(this.current=0,a=!0));if(a){if(-1===this.repeatCounter)return this.timeline[this.current].start(),this.onRepeat.dispatch(this.target,this),!0;if(0<this.repeatCounter)return this.repeatCounter--,this.timeline[this.current].start(),this.onRepeat.dispatch(this.target,this),!0;this.isRunning=!1;this.onComplete.dispatch(this.target,this);this.chainedTween&&this.chainedTween.start();
return!1}this.onChildComplete.dispatch(this.target,this);this.timeline[this.current].start();return!0}},generateData:function(a,c){if(null===this.game||null===this.target)return null;void 0===a&&(a=60);void 0===c&&(c=[]);for(var b=0;b<this.timeline.length;b++)for(var e in this.timeline[b].vEnd)this.properties[e]=this.target[e]||0,Array.isArray(this.properties[e])||(this.properties[e]*=1);for(b=0;b<this.timeline.length;b++)this.timeline[b].loadValues();for(b=0;b<this.timeline.length;b++)c=c.concat(this.timeline[b].generateData(a));
return c}};Object.defineProperty(b.Tween.prototype,"totalDuration",{get:function(){for(var a=0,b=0;b<this.timeline.length;b++)a+=this.timeline[b].duration;return a}});b.Tween.prototype.constructor=b.Tween;b.TweenData=function(a){this.parent=a;this.game=a.game;this.vStart={};this.vStartCache={};this.vEnd={};this.vEndCache={};this.duration=1E3;this.repeatDelay=this.repeatCounter=this.value=this.percent=0;this.yoyo=this.interpolate=!1;this.yoyoDelay=0;this.inReverse=!1;this.dt=this.delay=0;this.startTime=
null;this.easingFunction=b.Easing.Default;this.interpolationFunction=b.Math.linearInterpolation;this.interpolationContext=b.Math;this.isFrom=this.isRunning=!1};b.TweenData.PENDING=0;b.TweenData.RUNNING=1;b.TweenData.LOOPED=2;b.TweenData.COMPLETE=3;b.TweenData.prototype={to:function(a,b,d,e,g,l){this.vEnd=a;this.duration=b;this.easingFunction=d;this.delay=e;this.repeatCounter=g;this.yoyo=l;this.isFrom=!1;return this},from:function(a,b,d,e,g,l){this.vEnd=a;this.duration=b;this.easingFunction=d;this.delay=
e;this.repeatCounter=g;this.yoyo=l;this.isFrom=!0;return this},start:function(){this.startTime=this.game.time.time+this.delay;this.dt=this.parent.reverse?this.duration:0;this.isRunning=0<this.delay?!1:!0;if(this.isFrom)for(var a in this.vStartCache)this.vStart[a]=this.vEndCache[a],this.vEnd[a]=this.vStartCache[a],this.parent.target[a]=this.vStart[a];this.yoyoCounter=this.value=0;return this},loadValues:function(){for(var a in this.parent.properties){this.vStart[a]=this.parent.properties[a];if(Array.isArray(this.vEnd[a])){if(0===
this.vEnd[a].length)continue;0===this.percent&&(this.vEnd[a]=[this.vStart[a]].concat(this.vEnd[a]))}"undefined"!==typeof this.vEnd[a]?("string"===typeof this.vEnd[a]&&(this.vEnd[a]=this.vStart[a]+parseFloat(this.vEnd[a],10)),this.parent.properties[a]=this.vEnd[a]):this.vEnd[a]=this.vStart[a];this.vStartCache[a]=this.vStart[a];this.vEndCache[a]=this.vEnd[a]}return this},update:function(a){if(!this.isRunning)if(a>=this.startTime)this.isRunning=!0;else return b.TweenData.PENDING;else if(a<this.startTime)return b.TweenData.RUNNING;
this.parent.reverse?(this.dt-=this.game.time.elapsedMS*this.parent.timeScale,this.dt=Math.max(this.dt,0)):(this.dt+=this.game.time.elapsedMS*this.parent.timeScale,this.dt=Math.min(this.dt,this.duration));this.percent=this.dt/this.duration;this.value=this.easingFunction(this.percent);for(var c in this.vEnd){a=this.vStart[c];var d=this.vEnd[c];Array.isArray(d)?this.parent.target[c]=this.interpolationFunction.call(this.interpolationContext,d,this.value):this.parent.target[c]=a+(d-a)*this.value}return!this.parent.reverse&&
1===this.percent||this.parent.reverse&&0===this.percent?this.repeat():b.TweenData.RUNNING},generateData:function(a){this.dt=this.parent.reverse?this.duration:0;var b=[],d=!1;a=1/a*1E3;do{this.parent.reverse?(this.dt-=a,this.dt=Math.max(this.dt,0)):(this.dt+=a,this.dt=Math.min(this.dt,this.duration));this.percent=this.dt/this.duration;this.value=this.easingFunction(this.percent);var e={},g;for(g in this.vEnd){var l=this.vStart[g],f=this.vEnd[g];Array.isArray(f)?e[g]=this.interpolationFunction(f,this.value):
e[g]=l+(f-l)*this.value}b.push(e);if(!this.parent.reverse&&1===this.percent||this.parent.reverse&&0===this.percent)d=!0}while(!d);this.yoyo&&(d=b.slice(),d.reverse(),b=b.concat(d));return b},repeat:function(){if(this.yoyo){if(this.inReverse&&0===this.repeatCounter)return b.TweenData.COMPLETE;this.inReverse=!this.inReverse}else if(0===this.repeatCounter)return b.TweenData.COMPLETE;if(this.inReverse)for(var a in this.vStartCache)this.vStart[a]=this.vEndCache[a],this.vEnd[a]=this.vStartCache[a];else{for(a in this.vStartCache)this.vStart[a]=
this.vStartCache[a],this.vEnd[a]=this.vEndCache[a];0<this.repeatCounter&&this.repeatCounter--}this.startTime=this.game.time.time;this.yoyo&&this.inReverse?this.startTime+=this.yoyoDelay:this.inReverse||(this.startTime+=this.repeatDelay);this.dt=this.parent.reverse?this.duration:0;return b.TweenData.LOOPED}};b.TweenData.prototype.constructor=b.TweenData;b.Easing={Linear:{None:function(a){return a}},Quadratic:{In:function(a){return a*a},Out:function(a){return a*(2-a)},InOut:function(a){return 1>(a*=
2)?.5*a*a:-.5*(--a*(a-2)-1)}},Cubic:{In:function(a){return a*a*a},Out:function(a){return--a*a*a+1},InOut:function(a){return 1>(a*=2)?.5*a*a*a:.5*((a-=2)*a*a+2)}},Quartic:{In:function(a){return a*a*a*a},Out:function(a){return 1- --a*a*a*a},InOut:function(a){return 1>(a*=2)?.5*a*a*a*a:-.5*((a-=2)*a*a*a-2)}},Quintic:{In:function(a){return a*a*a*a*a},Out:function(a){return--a*a*a*a*a+1},InOut:function(a){return 1>(a*=2)?.5*a*a*a*a*a:.5*((a-=2)*a*a*a*a+2)}},Sinusoidal:{In:function(a){return 0===a?0:1===
a?1:1-Math.cos(a*Math.PI/2)},Out:function(a){return 0===a?0:1===a?1:Math.sin(a*Math.PI/2)},InOut:function(a){return 0===a?0:1===a?1:.5*(1-Math.cos(Math.PI*a))}},Exponential:{In:function(a){return 0===a?0:Math.pow(1024,a-1)},Out:function(a){return 1===a?1:1-Math.pow(2,-10*a)},InOut:function(a){return 0===a?0:1===a?1:1>(a*=2)?.5*Math.pow(1024,a-1):.5*(-Math.pow(2,-10*(a-1))+2)}},Circular:{In:function(a){return 1-Math.sqrt(1-a*a)},Out:function(a){return Math.sqrt(1- --a*a)},InOut:function(a){return 1>
(a*=2)?-.5*(Math.sqrt(1-a*a)-1):.5*(Math.sqrt(1-(a-=2)*a)+1)}},Elastic:{In:function(a){var b,d=.1;if(0===a)return 0;if(1===a)return 1;!d||1>d?(d=1,b=.1):b=.4*Math.asin(1/d)/(2*Math.PI);return-(d*Math.pow(2,10*--a)*Math.sin(2*(a-b)*Math.PI/.4))},Out:function(a){var b,d=.1;if(0===a)return 0;if(1===a)return 1;!d||1>d?(d=1,b=.1):b=.4*Math.asin(1/d)/(2*Math.PI);return d*Math.pow(2,-10*a)*Math.sin(2*(a-b)*Math.PI/.4)+1},InOut:function(a){var b,d=.1;if(0===a)return 0;if(1===a)return 1;!d||1>d?(d=1,b=.1):
b=.4*Math.asin(1/d)/(2*Math.PI);return 1>(a*=2)?-.5*d*Math.pow(2,10*--a)*Math.sin(2*(a-b)*Math.PI/.4):d*Math.pow(2,-10*--a)*Math.sin(2*(a-b)*Math.PI/.4)*.5+1}},Back:{In:function(a){return a*a*(2.70158*a-1.70158)},Out:function(a){return--a*a*(2.70158*a+1.70158)+1},InOut:function(a){return 1>(a*=2)?.5*a*a*(3.5949095*a-2.5949095):.5*((a-=2)*a*(3.5949095*a+2.5949095)+2)}},Bounce:{In:function(a){return 1-b.Easing.Bounce.Out(1-a)},Out:function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*
a+.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375},InOut:function(a){return.5>a?.5*b.Easing.Bounce.In(2*a):.5*b.Easing.Bounce.Out(2*a-1)+.5}}};b.Easing.Default=b.Easing.Linear.None;b.Easing.Power0=b.Easing.Linear.None;b.Easing.Power1=b.Easing.Quadratic.Out;b.Easing.Power2=b.Easing.Cubic.Out;b.Easing.Power3=b.Easing.Quartic.Out;b.Easing.Power4=b.Easing.Quintic.Out;b.Time=function(a){this.game=a;this.physicsElapsedMS=this.physicsElapsed=this.elapsedMS=this.elapsed=this.now=
this.prevTime=this.time=0;this.desiredFps=60;this.suggestedFps=null;this.slowMotion=1;this.advancedTiming=!1;this.fps=this.frames=0;this.fpsMin=1E3;this.fpsMax=0;this.msMin=1E3;this.timeExpected=this.timeToCall=this.pauseDuration=this.msMax=0;this.events=new b.Timer(this.game,!1);this._pauseStarted=this._timeLastSecond=this._started=this._elapsedAccumulator=this._frameCount=0;this._justResumed=!1;this._timers=[]};b.Time.prototype={boot:function(){this._started=Date.now();this.time=Date.now();this.events.start()},
add:function(a){this._timers.push(a);return a},create:function(a){void 0===a&&(a=!0);a=new b.Timer(this.game,a);this._timers.push(a);return a},removeAll:function(){for(var a=0;a<this._timers.length;a++)this._timers[a].destroy();this._timers=[];this.events.removeAll()},update:function(a){this.game.raf._isSetTimeOut?this.updateSetTimeout(a):this.updateRAF(a);this.advancedTiming&&this.updateAdvancedTiming();this.game.paused||(this.events.update(this.time),this._timers.length&&this.updateTimers())},updateSetTimeout:function(a){var b=
this.time;this.time=a;this.elapsedMS=this.time-b;this.prevTime=this.now;this.now=a;this.elapsed=this.now-this.prevTime;this.timeToCall=Math.floor(Math.max(0,1E3/this.desiredFps-(this.timeCallExpected-a)));this.timeCallExpected=a+this.timeToCall;this.physicsElapsed=1/this.desiredFps;this.physicsElapsedMS=1E3*this.physicsElapsed},updateRAF:function(a){var b=this.time;this.time=Date.now();this.elapsedMS=this.time-b;this.prevTime=this.now;this.now=a;this.elapsed=this.now-this.prevTime;this.physicsElapsed=
1/this.desiredFps;this.physicsElapsedMS=1E3*this.physicsElapsed},updateTimers:function(){for(var a=0,b=this._timers.length;a<b;)this._timers[a].update(this.time)?a++:(this._timers.splice(a,1),b--)},updateAdvancedTiming:function(){this._frameCount++;this._elapsedAccumulator+=this.elapsed;this._frameCount>=2*this.desiredFps&&(this.suggestedFps=5*Math.floor(200/(this._elapsedAccumulator/this._frameCount)),this._elapsedAccumulator=this._frameCount=0);this.msMin=Math.min(this.msMin,this.elapsed);this.msMax=
Math.max(this.msMax,this.elapsed);this.frames++;this.now>this._timeLastSecond+1E3&&(this.fps=Math.round(1E3*this.frames/(this.now-this._timeLastSecond)),this.fpsMin=Math.min(this.fpsMin,this.fps),this.fpsMax=Math.max(this.fpsMax,this.fps),this._timeLastSecond=this.now,this.frames=0)},gamePaused:function(){this._pauseStarted=Date.now();this.events.pause();for(var a=this._timers.length;a--;)this._timers[a]._pause()},gameResumed:function(){this.time=Date.now();this.pauseDuration=this.time-this._pauseStarted;
this.events.resume();for(var a=this._timers.length;a--;)this._timers[a]._resume()},totalElapsedSeconds:function(){return.001*(this.time-this._started)},elapsedSince:function(a){return this.time-a},elapsedSecondsSince:function(a){return.001*(this.time-a)},reset:function(){this._started=this.time;this.removeAll()}};b.Time.prototype.constructor=b.Time;b.Timer=function(a,c){void 0===c&&(c=!0);this.game=a;this.running=!1;this.autoDestroy=c;this.expired=!1;this.elapsed=0;this.events=[];this.onComplete=
new b.Signal;this.nextTick=0;this.timeCap=1E3;this._codePaused=this.paused=!1;this._pauseTotal=this._pauseStarted=this._started=0;this._now=Date.now();this._newTick=this._diff=this._i=this._marked=this._len=0};b.Timer.MINUTE=6E4;b.Timer.SECOND=1E3;b.Timer.HALF=500;b.Timer.QUARTER=250;b.Timer.prototype={create:function(a,c,d,e,g,l){var f=a=Math.round(a),f=0===this._now?f+this.game.time.time:f+this._now;a=new b.TimerEvent(this,a,f,d,c,e,g,l);this.events.push(a);this.order();this.expired=!1;return a},
add:function(a,b,d){return this.create(a,!1,0,b,d,Array.prototype.splice.call(arguments,3))},repeat:function(a,b,d,e){return this.create(a,!1,b,d,e,Array.prototype.splice.call(arguments,4))},loop:function(a,b,d){return this.create(a,!0,0,b,d,Array.prototype.splice.call(arguments,3))},start:function(a){if(!this.running)for(this._started=this.game.time.time+(a||0),this.running=!0,a=0;a<this.events.length;a++)this.events[a].tick=this.events[a].delay+this._started},stop:function(a){this.running=!1;void 0===
a&&(a=!0);a&&(this.events.length=0)},remove:function(a){for(var b=0;b<this.events.length;b++)if(this.events[b]===a)return this.events[b].pendingDelete=!0;return!1},order:function(){0<this.events.length&&(this.events.sort(this.sortHandler),this.nextTick=this.events[0].tick)},sortHandler:function(a,b){return a.tick<b.tick?-1:a.tick>b.tick?1:0},clearPendingEvents:function(){for(this._i=this.events.length;this._i--;)this.events[this._i].pendingDelete&&this.events.splice(this._i,1);this._len=this.events.length;
this._i=0},update:function(a){if(this.paused)return!0;this.elapsed=a-this._now;this._now=a;this.elapsed>this.timeCap&&this.adjustEvents(a-this.elapsed);this._marked=0;this.clearPendingEvents();if(this.running&&this._now>=this.nextTick&&0<this._len){for(;this._i<this._len&&this.running;)if(this._now>=this.events[this._i].tick&&!this.events[this._i].pendingDelete)this._newTick=this._now+this.events[this._i].delay-(this._now-this.events[this._i].tick),0>this._newTick&&(this._newTick=this._now+this.events[this._i].delay),
!0===this.events[this._i].loop?this.events[this._i].tick=this._newTick:0<this.events[this._i].repeatCount?(this.events[this._i].repeatCount--,this.events[this._i].tick=this._newTick):(this._marked++,this.events[this._i].pendingDelete=!0),this.events[this._i].callback.apply(this.events[this._i].callbackContext,this.events[this._i].args),this._i++;else break;this.events.length>this._marked?this.order():(this.expired=!0,this.onComplete.dispatch(this))}return this.expired&&this.autoDestroy?!1:!0},pause:function(){this.running&&
(this._codePaused=!0,this.paused||(this._pauseStarted=this.game.time.time,this.paused=!0))},_pause:function(){!this.paused&&this.running&&(this._pauseStarted=this.game.time.time,this.paused=!0)},adjustEvents:function(a){for(var b=0;b<this.events.length;b++)if(!this.events[b].pendingDelete){var d=this.events[b].tick-a;0>d&&(d=0);this.events[b].tick=this._now+d}a=this.nextTick-a;this.nextTick=0>a?this._now:this._now+a},resume:function(){if(this.paused){var a=this.game.time.time;this._pauseTotal+=a-
this._now;this._now=a;this.adjustEvents(this._pauseStarted);this._codePaused=this.paused=!1}},_resume:function(){this._codePaused||this.resume()},removeAll:function(){this.onComplete.removeAll();this._i=this._len=this.events.length=0},destroy:function(){this.onComplete.removeAll();this.running=!1;this.events=[];this._i=this._len=0}};Object.defineProperty(b.Timer.prototype,"next",{get:function(){return this.nextTick}});Object.defineProperty(b.Timer.prototype,"duration",{get:function(){return this.running&&
this.nextTick>this._now?this.nextTick-this._now:0}});Object.defineProperty(b.Timer.prototype,"length",{get:function(){return this.events.length}});Object.defineProperty(b.Timer.prototype,"ms",{get:function(){return this.running?this._now-this._started-this._pauseTotal:0}});Object.defineProperty(b.Timer.prototype,"seconds",{get:function(){return this.running?.001*this.ms:0}});b.Timer.prototype.constructor=b.Timer;b.TimerEvent=function(a,b,d,e,g,l,f,h){this.timer=a;this.delay=b;this.tick=d;this.repeatCount=
e-1;this.loop=g;this.callback=l;this.callbackContext=f;this.args=h;this.pendingDelete=!1};b.TimerEvent.prototype.constructor=b.TimerEvent;b.AnimationManager=function(a){this.sprite=a;this.game=a.game;this.currentAnim=this.currentFrame=null;this.updateIfVisible=!0;this.isLoaded=!1;this._frameData=null;this._anims={};this._outputFrames=[]};b.AnimationManager.prototype={loadFrameData:function(a,b){if(void 0===a)return!1;if(this.isLoaded)for(var d in this._anims)this._anims[d].updateFrameData(a);this._frameData=
a;void 0===b||null===b?this.frame=0:"string"===typeof b?this.frameName=b:this.frame=b;return this.isLoaded=!0},copyFrameData:function(a,b){this._frameData=a.clone();if(this.isLoaded)for(var d in this._anims)this._anims[d].updateFrameData(this._frameData);void 0===b||null===b?this.frame=0:"string"===typeof b?this.frameName=b:this.frame=b;return this.isLoaded=!0},add:function(a,c,d,e,g){c=c||[];d=d||60;void 0===e&&(e=!1);void 0===g&&(g=c&&"number"===typeof c[0]?!0:!1);this._outputFrames=[];this._frameData.getFrameIndexes(c,
g,this._outputFrames);this._anims[a]=new b.Animation(this.game,this.sprite,a,this._frameData,this._outputFrames,d,e);this.currentAnim=this._anims[a];this.sprite.tilingTexture&&(this.sprite.refreshTexture=!0);return this._anims[a]},validateFrames:function(a,b){void 0===b&&(b=!0);for(var d=0;d<a.length;d++)if(!0===b){if(a[d]>this._frameData.total)return!1}else if(!1===this._frameData.checkFrameName(a[d]))return!1;return!0},play:function(a,b,d,e){if(this._anims[a]){if(this.currentAnim===this._anims[a])return!1===
this.currentAnim.isPlaying?(this.currentAnim.paused=!1,this.currentAnim.play(b,d,e)):this.currentAnim;this.currentAnim&&this.currentAnim.isPlaying&&this.currentAnim.stop();this.currentAnim=this._anims[a];this.currentAnim.paused=!1;this.currentFrame=this.currentAnim.currentFrame;return this.currentAnim.play(b,d,e)}},stop:function(a,b){void 0===b&&(b=!1);"string"===typeof a?this._anims[a]&&(this.currentAnim=this._anims[a],this.currentAnim.stop(b)):this.currentAnim&&this.currentAnim.stop(b)},update:function(){return this.updateIfVisible&&
!this.sprite.visible?!1:this.currentAnim&&this.currentAnim.update()?(this.currentFrame=this.currentAnim.currentFrame,!0):!1},next:function(a){this.currentAnim&&(this.currentAnim.next(a),this.currentFrame=this.currentAnim.currentFrame)},previous:function(a){this.currentAnim&&(this.currentAnim.previous(a),this.currentFrame=this.currentAnim.currentFrame)},getAnimation:function(a){return"string"===typeof a&&this._anims[a]?this._anims[a]:null},refreshFrame:function(){this.sprite.setTexture(PIXI.TextureCache[this.currentFrame.uuid])},
destroy:function(){var a=null;for(a in this._anims)this._anims.hasOwnProperty(a)&&this._anims[a].destroy();this._anims={};this._outputFrames=[];this.game=this.sprite=this.currentFrame=this.currentAnim=this._frameData=null}};b.AnimationManager.prototype.constructor=b.AnimationManager;Object.defineProperty(b.AnimationManager.prototype,"frameData",{get:function(){return this._frameData}});Object.defineProperty(b.AnimationManager.prototype,"frameTotal",{get:function(){return this._frameData.total}});
Object.defineProperty(b.AnimationManager.prototype,"paused",{get:function(){return this.currentAnim.isPaused},set:function(a){this.currentAnim.paused=a}});Object.defineProperty(b.AnimationManager.prototype,"name",{get:function(){if(this.currentAnim)return this.currentAnim.name}});Object.defineProperty(b.AnimationManager.prototype,"frame",{get:function(){if(this.currentFrame)return this.currentFrame.index},set:function(a){"number"===typeof a&&this._frameData&&null!==this._frameData.getFrame(a)&&(this.currentFrame=
this._frameData.getFrame(a))&&this.sprite.setFrame(this.currentFrame)}});Object.defineProperty(b.AnimationManager.prototype,"frameName",{get:function(){if(this.currentFrame)return this.currentFrame.name},set:function(a){if("string"===typeof a&&this._frameData&&null!==this._frameData.getFrameByName(a)){if(this.currentFrame=this._frameData.getFrameByName(a))this._frameIndex=this.currentFrame.index,this.sprite.setFrame(this.currentFrame)}else console.warn("Cannot set frameName: "+a)}});b.Animation=function(a,
c,d,e,g,l,f){void 0===f&&(f=!1);this.game=a;this._parent=c;this._frameData=e;this.name=d;this._frames=[];this._frames=this._frames.concat(g);this.delay=1E3/l;this.loop=f;this.loopCount=0;this.isPaused=this.isPlaying=this.isFinished=this.killOnComplete=!1;this._frameDiff=this._frameIndex=this._pauseStartTime=0;this._frameSkip=1;this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex]);this.onStart=new b.Signal;this.onUpdate=null;this.onComplete=new b.Signal;this.onLoop=new b.Signal;
this.game.onPause.add(this.onPause,this);this.game.onResume.add(this.onResume,this)};b.Animation.prototype={play:function(a,b,d){"number"===typeof a&&(this.delay=1E3/a);"boolean"===typeof b&&(this.loop=b);"undefined"!==typeof d&&(this.killOnComplete=d);this.isPlaying=!0;this.paused=this.isFinished=!1;this.loopCount=0;this._timeLastFrame=this.game.time.time;this._timeNextFrame=this.game.time.time+this.delay;this._frameIndex=0;this.updateCurrentFrame(!1,!0);this._parent.events.onAnimationStart$dispatch(this._parent,
this);this.onStart.dispatch(this._parent,this);this._parent.animations.currentAnim=this;this._parent.animations.currentFrame=this.currentFrame;return this},restart:function(){this.isPlaying=!0;this.paused=this.isFinished=!1;this.loopCount=0;this._timeLastFrame=this.game.time.time;this._timeNextFrame=this.game.time.time+this.delay;this._frameIndex=0;this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex]);this._parent.setFrame(this.currentFrame);this._parent.animations.currentAnim=
this;this._parent.animations.currentFrame=this.currentFrame;this.onStart.dispatch(this._parent,this)},setFrame:function(a,b){var d;void 0===b&&(b=!1);if("string"===typeof a)for(var e=0;e<this._frames.length;e++)this._frameData.getFrame(this._frames[e]).name===a&&(d=e);else if("number"===typeof a)if(b)d=a;else for(e=0;e<this._frames.length;e++)this._frames[e]===d&&(d=e);d&&(this._frameIndex=d-1,this._timeNextFrame=this.game.time.time,this.update())},stop:function(a,b){void 0===a&&(a=!1);void 0===b&&
(b=!1);this.isPlaying=!1;this.isFinished=!0;this.paused=!1;a&&(this.currentFrame=this._frameData.getFrame(this._frames[0]),this._parent.setFrame(this.currentFrame));b&&(this._parent.events.onAnimationComplete$dispatch(this._parent,this),this.onComplete.dispatch(this._parent,this))},onPause:function(){this.isPlaying&&(this._frameDiff=this._timeNextFrame-this.game.time.time)},onResume:function(){this.isPlaying&&(this._timeNextFrame=this.game.time.time+this._frameDiff)},update:function(){if(this.isPaused)return!1;
if(this.isPlaying&&this.game.time.time>=this._timeNextFrame)if(this._frameSkip=1,this._frameDiff=this.game.time.time-this._timeNextFrame,this._timeLastFrame=this.game.time.time,this._frameDiff>this.delay&&(this._frameSkip=Math.floor(this._frameDiff/this.delay),this._frameDiff-=this._frameSkip*this.delay),this._timeNextFrame=this.game.time.time+(this.delay-this._frameDiff),this._frameIndex+=this._frameSkip,this._frameIndex>=this._frames.length){if(this.loop)return this._frameIndex%=this._frames.length,
(this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex]))&&this._parent.setFrame(this.currentFrame),this.loopCount++,this._parent.events.onAnimationLoop$dispatch(this._parent,this),this.onLoop.dispatch(this._parent,this),this.onUpdate?(this.onUpdate.dispatch(this,this.currentFrame),!!this._frameData):!0;this.complete()}else return this.updateCurrentFrame(!0);return!1},updateCurrentFrame:function(a,b){void 0===b&&(b=!1);if(!this._frameData)return!1;var d=this.currentFrame.index;
(this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex]))&&(b||!b&&d!==this.currentFrame.index)&&this._parent.setFrame(this.currentFrame);return this.onUpdate&&a?(this.onUpdate.dispatch(this,this.currentFrame),!!this._frameData):!0},next:function(a){void 0===a&&(a=1);a=this._frameIndex+a;a>=this._frames.length&&(a=this.loop?a%this._frames.length:this._frames.length-1);a!==this._frameIndex&&(this._frameIndex=a,this.updateCurrentFrame(!0))},previous:function(a){void 0===a&&(a=1);
a=this._frameIndex-a;0>a&&(this.loop?a=this._frames.length+a:a++);a!==this._frameIndex&&(this._frameIndex=a,this.updateCurrentFrame(!0))},updateFrameData:function(a){this.currentFrame=(this._frameData=a)?this._frameData.getFrame(this._frames[this._frameIndex%this._frames.length]):null},destroy:function(){this._frameData&&(this.game.onPause.remove(this.onPause,this),this.game.onResume.remove(this.onResume,this),this.currentFrame=this._frameData=this._frames=this._parent=this.game=null,this.isPlaying=
!1,this.onStart.dispose(),this.onLoop.dispose(),this.onComplete.dispose(),this.onUpdate&&this.onUpdate.dispose())},complete:function(){this._frameIndex=this._frames.length-1;this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex]);this.isPlaying=!1;this.isFinished=!0;this.paused=!1;this._parent.events.onAnimationComplete$dispatch(this._parent,this);this.onComplete.dispatch(this._parent,this);this.killOnComplete&&this._parent.kill()}};b.Animation.prototype.constructor=b.Animation;
Object.defineProperty(b.Animation.prototype,"paused",{get:function(){return this.isPaused},set:function(a){(this.isPaused=a)?this._pauseStartTime=this.game.time.time:this.isPlaying&&(this._timeNextFrame=this.game.time.time+this.delay)}});Object.defineProperty(b.Animation.prototype,"frameTotal",{get:function(){return this._frames.length}});Object.defineProperty(b.Animation.prototype,"frame",{get:function(){return null!==this.currentFrame?this.currentFrame.index:this._frameIndex},set:function(a){this.currentFrame=
this._frameData.getFrame(this._frames[a]);null!==this.currentFrame&&(this._frameIndex=a,this._parent.setFrame(this.currentFrame),this.onUpdate&&this.onUpdate.dispatch(this,this.currentFrame))}});Object.defineProperty(b.Animation.prototype,"speed",{get:function(){return Math.round(1E3/this.delay)},set:function(a){1<=a&&(this.delay=1E3/a)}});Object.defineProperty(b.Animation.prototype,"enableUpdate",{get:function(){return null!==this.onUpdate},set:function(a){a&&null===this.onUpdate?this.onUpdate=new b.Signal:
a||null===this.onUpdate||(this.onUpdate.dispose(),this.onUpdate=null)}});b.Animation.generateFrameNames=function(a,c,d,e,g){void 0===e&&(e="");var l=[],f="";if(c<d)for(;c<=d;c++)f="number"===typeof g?b.Utils.pad(c.toString(),g,"0",1):c.toString(),f=a+f+e,l.push(f);else for(;c>=d;c--)f="number"===typeof g?b.Utils.pad(c.toString(),g,"0",1):c.toString(),f=a+f+e,l.push(f);return l};b.Frame=function(a,c,d,e,g,l){this.index=a;this.x=c;this.y=d;this.width=e;this.height=g;this.name=l;this.centerX=Math.floor(e/
2);this.centerY=Math.floor(g/2);this.distance=b.Math.distance(0,0,e,g);this.rotated=!1;this.rotationDirection="cw";this.trimmed=!1;this.sourceSizeW=e;this.sourceSizeH=g;this.spriteSourceSizeH=this.spriteSourceSizeW=this.spriteSourceSizeY=this.spriteSourceSizeX=0;this.right=this.x+this.width;this.bottom=this.y+this.height};b.Frame.prototype={resize:function(a,c){this.width=a;this.height=c;this.centerX=Math.floor(a/2);this.centerY=Math.floor(c/2);this.distance=b.Math.distance(0,0,a,c);this.sourceSizeW=
a;this.sourceSizeH=c;this.right=this.x+a;this.bottom=this.y+c},setTrim:function(a,b,d,e,g,l,f){if(this.trimmed=a)this.sourceSizeW=b,this.sourceSizeH=d,this.centerX=Math.floor(b/2),this.centerY=Math.floor(d/2),this.spriteSourceSizeX=e,this.spriteSourceSizeY=g,this.spriteSourceSizeW=l,this.spriteSourceSizeH=f},clone:function(){var a=new b.Frame(this.index,this.x,this.y,this.width,this.height,this.name),c;for(c in this)this.hasOwnProperty(c)&&(a[c]=this[c]);return a},getRect:function(a){void 0===a?a=
new b.Rectangle(this.x,this.y,this.width,this.height):a.setTo(this.x,this.y,this.width,this.height);return a}};b.Frame.prototype.constructor=b.Frame;b.FrameData=function(){this._frames=[];this._frameNames=[]};b.FrameData.prototype={addFrame:function(a){a.index=this._frames.length;this._frames.push(a);""!==a.name&&(this._frameNames[a.name]=a.index);return a},getFrame:function(a){a>=this._frames.length&&(a=0);return this._frames[a]},getFrameByName:function(a){return"number"===typeof this._frameNames[a]?
this._frames[this._frameNames[a]]:null},checkFrameName:function(a){return null==this._frameNames[a]?!1:!0},clone:function(){for(var a=new b.FrameData,c=0;c<this._frames.length;c++)a._frames.push(this._frames[c].clone());for(var d in this._frameNames)this._frameNames.hasOwnProperty(d)&&a._frameNames.push(this._frameNames[d]);return a},getFrameRange:function(a,b,d){for(void 0===d&&(d=[]);a<=b;a++)d.push(this._frames[a]);return d},getFrames:function(a,b,d){void 0===b&&(b=!0);void 0===d&&(d=[]);if(void 0===
a||0===a.length)for(var e=0;e<this._frames.length;e++)d.push(this._frames[e]);else for(e=0;e<a.length;e++)b?d.push(this.getFrame(a[e])):d.push(this.getFrameByName(a[e]));return d},getFrameIndexes:function(a,b,d){void 0===b&&(b=!0);void 0===d&&(d=[]);if(void 0===a||0===a.length)for(var e=0;e<this._frames.length;e++)d.push(this._frames[e].index);else for(e=0;e<a.length;e++)b?d.push(this._frames[a[e]].index):this.getFrameByName(a[e])&&d.push(this.getFrameByName(a[e]).index);return d}};b.FrameData.prototype.constructor=
b.FrameData;Object.defineProperty(b.FrameData.prototype,"total",{get:function(){return this._frames.length}});b.AnimationParser={spriteSheet:function(a,c,d,e,g,l,f){var h=c;"string"===typeof c&&(h=a.cache.getImage(c));if(null===h)return null;a=h.width;var k=h.height;0>=d&&(d=Math.floor(-a/Math.min(-1,d)));0>=e&&(e=Math.floor(-k/Math.min(-1,e)));h=Math.floor((a-l)/(d+f))*Math.floor((k-l)/(e+f));-1!==g&&(h=g);if(0===a||0===k||a<d||k<e||0===h)return console.warn("Phaser.AnimationParser.spriteSheet: '"+
c+"'s width/height zero or width/height < given frameWidth/frameHeight"),null;c=new b.FrameData;for(var k=g=l,m=0;m<h;m++)c.addFrame(new b.Frame(m,g,k,d,e,"")),g+=d+f,g+d>a&&(g=l,k+=e+f);return c},JSONData:function(a,c){if(c.frames){for(var d=new b.FrameData,e=c.frames,g,l=0;l<e.length;l++)g=d.addFrame(new b.Frame(l,e[l].frame.x,e[l].frame.y,e[l].frame.w,e[l].frame.h,e[l].filename)),e[l].trimmed&&g.setTrim(e[l].trimmed,e[l].sourceSize.w,e[l].sourceSize.h,e[l].spriteSourceSize.x,e[l].spriteSourceSize.y,
e[l].spriteSourceSize.w,e[l].spriteSourceSize.h);return d}console.warn("Phaser.AnimationParser.JSONData: Invalid Texture Atlas JSON given, missing 'frames' array");console.log(c)},JSONDataHash:function(a,c){if(c.frames){var d=new b.FrameData,e=c.frames,g,l=0,f;for(f in e)g=d.addFrame(new b.Frame(l,e[f].frame.x,e[f].frame.y,e[f].frame.w,e[f].frame.h,f)),e[f].trimmed&&g.setTrim(e[f].trimmed,e[f].sourceSize.w,e[f].sourceSize.h,e[f].spriteSourceSize.x,e[f].spriteSourceSize.y,e[f].spriteSourceSize.w,e[f].spriteSourceSize.h),
l++;return d}console.warn("Phaser.AnimationParser.JSONDataHash: Invalid Texture Atlas JSON given, missing 'frames' object");console.log(c)},XMLData:function(a,c){if(c.getElementsByTagName("TextureAtlas")){for(var d=new b.FrameData,e=c.getElementsByTagName("SubTexture"),g,l,f,h,k,m,n,t,r,x,v=0;v<e.length;v++)l=e[v].attributes,g=l.name.value,f=parseInt(l.x.value,10),h=parseInt(l.y.value,10),k=parseInt(l.width.value,10),m=parseInt(l.height.value,10),t=n=null,l.frameX&&(n=Math.abs(parseInt(l.frameX.value,
10)),t=Math.abs(parseInt(l.frameY.value,10)),r=parseInt(l.frameWidth.value,10),x=parseInt(l.frameHeight.value,10)),g=d.addFrame(new b.Frame(v,f,h,k,m,g)),null===n&&null===t||g.setTrim(!0,k,m,n,t,r,x);return d}console.warn("Phaser.AnimationParser.XMLData: Invalid Texture Atlas XML given, missing <TextureAtlas> tag")}};b.Cache=function(a){this.game=a;this.autoResolveURL=!1;this._cache={canvas:{},image:{},texture:{},sound:{},video:{},text:{},json:{},xml:{},physics:{},tilemap:{},binary:{},bitmapData:{},
bitmapFont:{},shader:{},renderTexture:{}};this._urlMap={};this._urlResolver=new Image;this._urlTemp=null;this.onSoundUnlock=new b.Signal;this._cacheMap=[];this._cacheMap[b.Cache.CANVAS]=this._cache.canvas;this._cacheMap[b.Cache.IMAGE]=this._cache.image;this._cacheMap[b.Cache.TEXTURE]=this._cache.texture;this._cacheMap[b.Cache.SOUND]=this._cache.sound;this._cacheMap[b.Cache.TEXT]=this._cache.text;this._cacheMap[b.Cache.PHYSICS]=this._cache.physics;this._cacheMap[b.Cache.TILEMAP]=this._cache.tilemap;
this._cacheMap[b.Cache.BINARY]=this._cache.binary;this._cacheMap[b.Cache.BITMAPDATA]=this._cache.bitmapData;this._cacheMap[b.Cache.BITMAPFONT]=this._cache.bitmapFont;this._cacheMap[b.Cache.JSON]=this._cache.json;this._cacheMap[b.Cache.XML]=this._cache.xml;this._cacheMap[b.Cache.VIDEO]=this._cache.video;this._cacheMap[b.Cache.SHADER]=this._cache.shader;this._cacheMap[b.Cache.RENDER_TEXTURE]=this._cache.renderTexture;this.addDefaultImage();this.addMissingImage()};b.Cache.CANVAS=1;b.Cache.IMAGE=2;b.Cache.TEXTURE=
3;b.Cache.SOUND=4;b.Cache.TEXT=5;b.Cache.PHYSICS=6;b.Cache.TILEMAP=7;b.Cache.BINARY=8;b.Cache.BITMAPDATA=9;b.Cache.BITMAPFONT=10;b.Cache.JSON=11;b.Cache.XML=12;b.Cache.VIDEO=13;b.Cache.SHADER=14;b.Cache.RENDER_TEXTURE=15;b.Cache.prototype={addCanvas:function(a,b,d){void 0===d&&(d=b.getContext("2d"));this._cache.canvas[a]={canvas:b,context:d}},addImage:function(a,c,d){this.checkImageKey(a)&&this.removeImage(a);var e={key:a,url:c,data:d,base:new PIXI.BaseTexture(d),frame:new b.Frame(0,0,0,d.width,d.height,
a),frameData:new b.FrameData};e.frameData.addFrame(new b.Frame(0,0,0,d.width,d.height,c));this._cache.image[a]=e;this._resolveURL(c,e);return e},addDefaultImage:function(){var a=new Image;a.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgAQMAAABJtOi3AAAAA1BMVEX///+nxBvIAAAAAXRSTlMAQObYZgAAABVJREFUeF7NwIEAAAAAgKD9qdeocAMAoAABm3DkcAAAAABJRU5ErkJggg==";a=this.addImage("__default",null,a);PIXI.TextureCache.__default=new PIXI.Texture(a.base)},addMissingImage:function(){var a=new Image;a.src=
"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAIAAAD8GO2jAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJ9JREFUeNq01ssOwyAMRFG46v//Mt1ESmgh+DFmE2GPOBARKb2NVjo+17PXLD8a1+pl5+A+wSgFygymWYHBb0FtsKhJDdZlncG2IzJ4ayoMDv20wTmSMzClEgbWYNTAkQ0Z+OJ+A/eWnAaR9+oxCF4Os0H8htsMUp+pwcgBBiMNnAwF8GqIgL2hAzaGFFgZauDPKABmowZ4GL369/0rwACp2yA/ttmvsQAAAABJRU5ErkJggg==";a=this.addImage("__missing",null,a);PIXI.TextureCache.__missing=new PIXI.Texture(a.base)},addSound:function(a,b,d,e,g){void 0===e&&(e=!0,
g=!1);void 0===g&&(e=!1,g=!0);var l=!1;g&&(l=!0);this._cache.sound[a]={url:b,data:d,isDecoding:!1,decoded:l,webAudio:e,audioTag:g,locked:this.game.sound.touchLocked};this._resolveURL(b,this._cache.sound[a])},addText:function(a,b,d){this._cache.text[a]={url:b,data:d};this._resolveURL(b,this._cache.text[a])},addPhysicsData:function(a,b,d,e){this._cache.physics[a]={url:b,data:d,format:e};this._resolveURL(b,this._cache.physics[a])},addTilemap:function(a,b,d,e){this._cache.tilemap[a]={url:b,data:d,format:e};
this._resolveURL(b,this._cache.tilemap[a])},addBinary:function(a,b){this._cache.binary[a]=b},addBitmapData:function(a,c,d){c.key=a;void 0===d&&(d=new b.FrameData,d.addFrame(c.textureFrame));this._cache.bitmapData[a]={data:c,frameData:d};return c},addBitmapFont:function(a,c,d,e,g,l,f){d={url:c,data:d,font:null,base:new PIXI.BaseTexture(d)};d.font="json"===g?b.LoaderParser.jsonBitmapFont(e,d.base,l,f):b.LoaderParser.xmlBitmapFont(e,d.base,l,f);this._cache.bitmapFont[a]=d;this._resolveURL(c,d)},addJSON:function(a,
b,d){this._cache.json[a]={url:b,data:d};this._resolveURL(b,this._cache.json[a])},addXML:function(a,b,d){this._cache.xml[a]={url:b,data:d};this._resolveURL(b,this._cache.xml[a])},addVideo:function(a,b,d,e){this._cache.video[a]={url:b,data:d,isBlob:e,locked:!0};this._resolveURL(b,this._cache.video[a])},addShader:function(a,b,d){this._cache.shader[a]={url:b,data:d};this._resolveURL(b,this._cache.shader[a])},addRenderTexture:function(a,c){this._cache.renderTexture[a]={texture:c,frame:new b.Frame(0,0,
0,c.width,c.height,"","")}},addSpriteSheet:function(a,c,d,e,g,l,f,h){d={key:a,url:c,data:d,frameWidth:e,frameHeight:g,margin:f,spacing:h,base:new PIXI.BaseTexture(d),frameData:b.AnimationParser.spriteSheet(this.game,d,e,g,l,f,h)};this._cache.image[a]=d;this._resolveURL(c,d)},addTextureAtlas:function(a,c,d,e,g){d={key:a,url:c,data:d,base:new PIXI.BaseTexture(d)};g===b.Loader.TEXTURE_ATLAS_XML_STARLING?d.frameData=b.AnimationParser.XMLData(this.game,e,a):Array.isArray(e.frames)?d.frameData=b.AnimationParser.JSONData(this.game,
e,a):d.frameData=b.AnimationParser.JSONDataHash(this.game,e,a);this._cache.image[a]=d;this._resolveURL(c,d)},reloadSound:function(a){var b=this,d=this.getSound(a);d&&(d.data.src=d.url,d.data.addEventListener("canplaythrough",function(){return b.reloadSoundComplete(a)},!1),d.data.load())},reloadSoundComplete:function(a){var b=this.getSound(a);b&&(b.locked=!1,this.onSoundUnlock.dispatch(a))},updateSound:function(a,b,d){(a=this.getSound(a))&&(a[b]=d)},decodedSound:function(a,b){var d=this.getSound(a);
d.data=b;d.decoded=!0;d.isDecoding=!1},isSoundDecoded:function(a){if(a=this.getItem(a,b.Cache.SOUND,"isSoundDecoded"))return a.decoded},isSoundReady:function(a){if(a=this.getItem(a,b.Cache.SOUND,"isSoundDecoded"))return a.decoded&&!this.game.sound.touchLocked},checkKey:function(a,b){return this._cacheMap[a][b]?!0:!1},checkURL:function(a){return this._urlMap[this._resolveURL(a)]?!0:!1},checkCanvasKey:function(a){return this.checkKey(b.Cache.CANVAS,a)},checkImageKey:function(a){return this.checkKey(b.Cache.IMAGE,
a)},checkTextureKey:function(a){return this.checkKey(b.Cache.TEXTURE,a)},checkSoundKey:function(a){return this.checkKey(b.Cache.SOUND,a)},checkTextKey:function(a){return this.checkKey(b.Cache.TEXT,a)},checkPhysicsKey:function(a){return this.checkKey(b.Cache.PHYSICS,a)},checkTilemapKey:function(a){return this.checkKey(b.Cache.TILEMAP,a)},checkBinaryKey:function(a){return this.checkKey(b.Cache.BINARY,a)},checkBitmapDataKey:function(a){return this.checkKey(b.Cache.BITMAPDATA,a)},checkBitmapFontKey:function(a){return this.checkKey(b.Cache.BITMAPFONT,
a)},checkJSONKey:function(a){return this.checkKey(b.Cache.JSON,a)},checkXMLKey:function(a){return this.checkKey(b.Cache.XML,a)},checkVideoKey:function(a){return this.checkKey(b.Cache.VIDEO,a)},checkShaderKey:function(a){return this.checkKey(b.Cache.SHADER,a)},checkRenderTextureKey:function(a){return this.checkKey(b.Cache.RENDER_TEXTURE,a)},getItem:function(a,b,d,e){if(this.checkKey(b,a))return void 0===e?this._cacheMap[b][a]:this._cacheMap[b][a][e];d&&console.warn("Phaser.Cache."+d+': Key "'+a+'" not found in Cache.');
return null},getCanvas:function(a){return this.getItem(a,b.Cache.CANVAS,"getCanvas","canvas")},getImage:function(a,c){if(void 0===a||null===a)a="__default";void 0===c&&(c=!1);var d=this.getItem(a,b.Cache.IMAGE,"getImage");null===d&&(d=this.getItem("__missing",b.Cache.IMAGE,"getImage"));return c?d:d.data},getTextureFrame:function(a){return this.getItem(a,b.Cache.TEXTURE,"getTextureFrame","frame")},getSound:function(a){return this.getItem(a,b.Cache.SOUND,"getSound")},getSoundData:function(a){return this.getItem(a,
b.Cache.SOUND,"getSoundData","data")},getText:function(a){return this.getItem(a,b.Cache.TEXT,"getText","data")},getPhysicsData:function(a,c,d){var e=this.getItem(a,b.Cache.PHYSICS,"getPhysicsData","data");if(null===e||void 0===c||null===c)return e;if(e[c])if((c=e[c])&&d){for(var g in c)if(g=c[g],g.fixtureKey===d)return g;console.warn('Phaser.Cache.getPhysicsData: Could not find given fixtureKey: "'+d+" in "+a+'"')}else return c;else console.warn('Phaser.Cache.getPhysicsData: Invalid key/object: "'+
a+" / "+c+'"');return null},getTilemapData:function(a){return this.getItem(a,b.Cache.TILEMAP,"getTilemapData")},getBinary:function(a){return this.getItem(a,b.Cache.BINARY,"getBinary")},getBitmapData:function(a){return this.getItem(a,b.Cache.BITMAPDATA,"getBitmapData","data")},getBitmapFont:function(a){return this.getItem(a,b.Cache.BITMAPFONT,"getBitmapFont")},getJSON:function(a,c){var d=this.getItem(a,b.Cache.JSON,"getJSON","data");return d?c?b.Utils.extend(!0,d):d:null},getXML:function(a){return this.getItem(a,
b.Cache.XML,"getXML","data")},getVideo:function(a){return this.getItem(a,b.Cache.VIDEO,"getVideo")},getShader:function(a){return this.getItem(a,b.Cache.SHADER,"getShader","data")},getRenderTexture:function(a){return this.getItem(a,b.Cache.RENDER_TEXTURE,"getRenderTexture")},getBaseTexture:function(a,c){void 0===c&&(c=b.Cache.IMAGE);return this.getItem(a,c,"getBaseTexture","base")},getFrame:function(a,c){void 0===c&&(c=b.Cache.IMAGE);return this.getItem(a,c,"getFrame","frame")},getFrameCount:function(a,
b){var d=this.getFrameData(a,b);return d?d.total:0},getFrameData:function(a,c){void 0===c&&(c=b.Cache.IMAGE);return this.getItem(a,c,"getFrameData","frameData")},hasFrameData:function(a,c){void 0===c&&(c=b.Cache.IMAGE);return null!==this.getItem(a,c,"","frameData")},updateFrameData:function(a,c,d){void 0===d&&(d=b.Cache.IMAGE);this._cacheMap[d][a]&&(this._cacheMap[d][a].frameData=c)},getFrameByIndex:function(a,b,d){return(a=this.getFrameData(a,d))?a.getFrame(b):null},getFrameByName:function(a,b,d){return(a=
this.getFrameData(a,d))?a.getFrameByName(b):null},getPixiTexture:function(a){return PIXI.TextureCache[a]?PIXI.TextureCache[a]:(a=this.getPixiBaseTexture(a))?new PIXI.Texture(a):null},getPixiBaseTexture:function(a){if(PIXI.BaseTextureCache[a])return PIXI.BaseTextureCache[a];a=this.getItem(a,b.Cache.IMAGE,"getPixiBaseTexture");return null!==a?a.base:null},getURL:function(a){if(a=this._resolveURL(a))return this._urlMap[a];console.warn('Phaser.Cache.getUrl: Invalid url: "'+a+'" or Cache.autoResolveURL was false');
return null},getKeys:function(a){void 0===a&&(a=b.Cache.IMAGE);var c=[];if(this._cacheMap[a])for(var d in this._cacheMap[a])"__default"!==d&&"__missing"!==d&&c.push(d);return c},removeCanvas:function(a){delete this._cache.canvas[a]},removeImage:function(a,b){void 0===b&&(b=!0);var d=this.getImage(a,!0);b&&d.base&&d.base.destroy();delete this._cache.image[a]},removeSound:function(a){delete this._cache.sound[a]},removeText:function(a){delete this._cache.text[a]},removePhysics:function(a){delete this._cache.physics[a]},
removeTilemap:function(a){delete this._cache.tilemap[a]},removeBinary:function(a){delete this._cache.binary[a]},removeBitmapData:function(a){delete this._cache.bitmapData[a]},removeBitmapFont:function(a){delete this._cache.bitmapFont[a]},removeJSON:function(a){delete this._cache.json[a]},removeXML:function(a){delete this._cache.xml[a]},removeVideo:function(a){delete this._cache.video[a]},removeShader:function(a){delete this._cache.shader[a]},removeRenderTexture:function(a){delete this._cache.renderTexture[a]},
removeSpriteSheet:function(a){delete this._cache.spriteSheet[a]},removeTextureAtlas:function(a){delete this._cache.atlas[a]},clearGLTextures:function(){for(var a in this.cache.image)this.cache.image[a].base._glTextures=[]},_resolveURL:function(a,b){if(!this.autoResolveURL)return null;this._urlResolver.src=this.game.load.baseURL+a;this._urlTemp=this._urlResolver.src;this._urlResolver.src="";b&&(this._urlMap[this._urlTemp]=b);return this._urlTemp},destroy:function(){for(var a=0;a<this._cacheMap.length;a++){var b=
this._cacheMap[a],d;for(d in b)"__default"!==d&&"__missing"!==d&&(b[d].destroy&&b[d].destroy(),delete b[d])}this._urlTemp=this._urlResolver=this._urlMap=null}};b.Cache.prototype.constructor=b.Cache;b.Loader=function(a){this.game=a;this.cache=a.cache;this.hasLoaded=this.isLoading=this.resetLocked=!1;this.preloadSprite=null;this.crossOrigin=!1;this.path=this.baseURL="";this.onLoadStart=new b.Signal;this.onLoadComplete=new b.Signal;this.onPackComplete=new b.Signal;this.onFileStart=new b.Signal;this.onFileComplete=
new b.Signal;this.onFileError=new b.Signal;this._warnedAboutXDomainRequest=this.useXDomainRequest=!1;this.enableParallel=!0;this.maxParallelDownloads=4;this._withSyncPointDepth=0;this._fileList=[];this._flightQueue=[];this._processingHead=0;this._fileLoadStarted=!1;this._loadedFileCount=this._loadedPackCount=this._totalFileCount=this._totalPackCount=0};b.Loader.TEXTURE_ATLAS_JSON_ARRAY=0;b.Loader.TEXTURE_ATLAS_JSON_HASH=1;b.Loader.TEXTURE_ATLAS_XML_STARLING=2;b.Loader.PHYSICS_LIME_CORONA_JSON=3;b.Loader.PHYSICS_PHASER_JSON=
4;b.Loader.prototype={setPreloadSprite:function(a,c){c=c||0;this.preloadSprite={sprite:a,direction:c,width:a.width,height:a.height,rect:null};this.preloadSprite.rect=0===c?new b.Rectangle(0,0,1,a.height):new b.Rectangle(0,0,a.width,1);a.crop(this.preloadSprite.rect);a.visible=!0},resize:function(){this.preloadSprite&&this.preloadSprite.height!==this.preloadSprite.sprite.height&&(this.preloadSprite.rect.height=this.preloadSprite.sprite.height)},checkKeyExists:function(a,b){return-1<this.getAssetIndex(a,
b)},getAssetIndex:function(a,b){for(var d=-1,e=0;e<this._fileList.length;e++){var g=this._fileList[e];if(g.type===a&&g.key===b&&(d=e,!g.loaded&&!g.loading))break}return d},getAsset:function(a,b){var d=this.getAssetIndex(a,b);return-1<d?{index:d,file:this._fileList[d]}:!1},reset:function(a,b){void 0===b&&(b=!1);this.resetLocked||(a&&(this.preloadSprite=null),this.isLoading=!1,this._processingHead=0,this._fileList.length=0,this._flightQueue.length=0,this._fileLoadStarted=!1,this._loadedFileCount=this._loadedPackCount=
this._totalPackCount=this._totalFileCount=0,b&&(this.onLoadStart.removeAll(),this.onLoadComplete.removeAll(),this.onPackComplete.removeAll(),this.onFileStart.removeAll(),this.onFileComplete.removeAll(),this.onFileError.removeAll()))},addToFileList:function(a,b,d,e,g,l){void 0===g&&(g=!1);if(void 0===b||""===b)return console.warn("Phaser.Loader: Invalid or no key given of type "+a),this;if(void 0===d||null===d)if(l)d=b+l;else return console.warn("Phaser.Loader: No URL given for file type: "+a+" key: "+
b),this;d={type:a,key:b,path:this.path,url:d,syncPoint:0<this._withSyncPointDepth,data:null,loading:!1,loaded:!1,error:!1};if(e)for(var f in e)d[f]=e[f];a=this.getAssetIndex(a,b);g&&-1<a?(g=this._fileList[a],g.loading||g.loaded?(this._fileList.push(d),this._totalFileCount++):this._fileList[a]=d):-1===a&&(this._fileList.push(d),this._totalFileCount++);return this},replaceInFileList:function(a,b,d,e){return this.addToFileList(a,b,d,e,!0)},pack:function(a,b,d,e){void 0===b&&(b=null);void 0===d&&(d=null);
void 0===e&&(e=null);if(!b&&!d)return console.warn("Phaser.Loader.pack - Both url and data are null. One must be set."),this;a={type:"packfile",key:a,url:b,path:this.path,syncPoint:!0,data:null,loading:!1,loaded:!1,error:!1,callbackContext:e};d&&("string"===typeof d&&(d=JSON.parse(d)),a.data=d||{},a.loaded=!0);for(d=0;d<this._fileList.length+1;d++)if(b=this._fileList[d],!b||!b.loaded&&!b.loading&&"packfile"!==b.type){this._fileList.splice(d,1,a);this._totalPackCount++;break}return this},image:function(a,
b,d){return this.addToFileList("image",a,b,void 0,d,".png")},text:function(a,b,d){return this.addToFileList("text",a,b,void 0,d,".txt")},json:function(a,b,d){return this.addToFileList("json",a,b,void 0,d,".json")},shader:function(a,b,d){return this.addToFileList("shader",a,b,void 0,d,".frag")},xml:function(a,b,d){return this.addToFileList("xml",a,b,void 0,d,".xml")},script:function(a,b,d,e){void 0===d&&(d=!1);!1!==d&&void 0===e&&(e=this);return this.addToFileList("script",a,b,{syncPoint:!0,callback:d,
callbackContext:e},!1,".js")},binary:function(a,b,d,e){void 0===d&&(d=!1);!1!==d&&void 0===e&&(e=d);return this.addToFileList("binary",a,b,{callback:d,callbackContext:e},!1,".bin")},spritesheet:function(a,b,d,e,g,l,f){void 0===g&&(g=-1);void 0===l&&(l=0);void 0===f&&(f=0);return this.addToFileList("spritesheet",a,b,{frameWidth:d,frameHeight:e,frameMax:g,margin:l,spacing:f},!1,".png")},audio:function(a,b,d){if(this.game.sound.noAudio)return this;void 0===d&&(d=!0);"string"===typeof b&&(b=[b]);return this.addToFileList("audio",
a,b,{buffer:null,autoDecode:d})},audiosprite:function(a,b,d,e,g){if(this.game.sound.noAudio)return this;void 0===d&&(d=null);void 0===e&&(e=null);void 0===g&&(g=!0);this.audio(a,b,g);d?this.json(a+"-audioatlas",d):e?("string"===typeof e&&(e=JSON.parse(e)),this.cache.addJSON(a+"-audioatlas","",e)):console.warn("Phaser.Loader.audiosprite - You must specify either a jsonURL or provide a jsonData object");return this},video:function(a,b,d,e){void 0===d&&(d=this.game.device.firefox?"loadeddata":"canplaythrough");
void 0===e&&(e=!1);"string"===typeof b&&(b=[b]);return this.addToFileList("video",a,b,{buffer:null,asBlob:e,loadEvent:d})},tilemap:function(a,c,d,e){void 0===c&&(c=null);void 0===d&&(d=null);void 0===e&&(e=b.Tilemap.CSV);c||d||(c=e===b.Tilemap.CSV?a+".csv":a+".json");if(d){switch(e){case b.Tilemap.TILED_JSON:"string"===typeof d&&(d=JSON.parse(d))}this.cache.addTilemap(a,null,d,e)}else this.addToFileList("tilemap",a,c,{format:e});return this},physics:function(a,c,d,e){void 0===c&&(c=null);void 0===
d&&(d=null);void 0===e&&(e=b.Physics.LIME_CORONA_JSON);c||d||(c=a+".json");d?("string"===typeof d&&(d=JSON.parse(d)),this.cache.addPhysicsData(a,null,d,e)):this.addToFileList("physics",a,c,{format:e});return this},bitmapFont:function(a,b,d,e,g,l){if(void 0===b||null===b)b=a+".png";void 0===d&&(d=null);void 0===e&&(e=null);void 0===g&&(g=0);void 0===l&&(l=0);if(d)this.addToFileList("bitmapfont",a,b,{atlasURL:d,xSpacing:g,ySpacing:l});else if("string"===typeof e){var f,h;try{f=JSON.parse(e)}catch(k){h=
this.parseXml(e)}if(!h&&!f)throw Error("Phaser.Loader. Invalid Bitmap Font atlas given");this.addToFileList("bitmapfont",a,b,{atlasURL:null,atlasData:f||h,atlasType:f?"json":"xml",xSpacing:g,ySpacing:l})}return this},atlasJSONArray:function(a,c,d,e){return this.atlas(a,c,d,e,b.Loader.TEXTURE_ATLAS_JSON_ARRAY)},atlasJSONHash:function(a,c,d,e){return this.atlas(a,c,d,e,b.Loader.TEXTURE_ATLAS_JSON_HASH)},atlasXML:function(a,c,d,e){void 0===d&&(d=null);void 0===e&&(e=null);d||e||(d=a+".xml");return this.atlas(a,
c,d,e,b.Loader.TEXTURE_ATLAS_XML_STARLING)},atlas:function(a,c,d,e,g){if(void 0===c||null===c)c=a+".png";void 0===d&&(d=null);void 0===e&&(e=null);void 0===g&&(g=b.Loader.TEXTURE_ATLAS_JSON_ARRAY);d||e||(d=g===b.Loader.TEXTURE_ATLAS_XML_STARLING?a+".xml":a+".json");if(d)this.addToFileList("textureatlas",a,c,{atlasURL:d,format:g});else{switch(g){case b.Loader.TEXTURE_ATLAS_JSON_ARRAY:"string"===typeof e&&(e=JSON.parse(e));break;case b.Loader.TEXTURE_ATLAS_XML_STARLING:if("string"===typeof e){d=this.parseXml(e);
if(!d)throw Error("Phaser.Loader. Invalid Texture Atlas XML given");e=d}}this.addToFileList("textureatlas",a,c,{atlasURL:null,atlasData:e,format:g})}return this},withSyncPoint:function(a,b){this._withSyncPointDepth++;try{a.call(b||this,this)}finally{this._withSyncPointDepth--}return this},addSyncPoint:function(a,b){var d=this.getAsset(a,b);d&&(d.file.syncPoint=!0);return this},removeFile:function(a,b){var d=this.getAsset(a,b);d&&(d.loaded||d.loading||this._fileList.splice(d.index,1))},removeAll:function(){this._fileList.length=
0;this._flightQueue.length=0},start:function(){this.isLoading||(this.hasLoaded=!1,this.isLoading=!0,this.updateProgress(),this.processLoadQueue())},processLoadQueue:function(){if(this.isLoading){for(var a=0;a<this._flightQueue.length;a++){var c=this._flightQueue[a];if(c.loaded||c.error)this._flightQueue.splice(a,1),a--,c.loading=!1,c.requestUrl=null,c.requestObject=null,c.error&&this.onFileError.dispatch(c.key,c),"packfile"!==c.type?(this._loadedFileCount++,this.onFileComplete.dispatch(this.progress,
c.key,!c.error,this._loadedFileCount,this._totalFileCount)):"packfile"===c.type&&c.error&&(this._loadedPackCount++,this.onPackComplete.dispatch(c.key,!c.error,this._loadedPackCount,this._totalPackCount))}for(var d=!1,e=this.enableParallel?b.Math.clamp(this.maxParallelDownloads,1,12):1,a=this._processingHead;a<this._fileList.length&&!(c=this._fileList[a],"packfile"===c.type&&!c.error&&c.loaded&&a===this._processingHead&&(this.processPack(c),this._loadedPackCount++,this.onPackComplete.dispatch(c.key,
!c.error,this._loadedPackCount,this._totalPackCount)),c.loaded||c.error?a===this._processingHead&&(this._processingHead=a+1):!c.loading&&this._flightQueue.length<e&&("packfile"!==c.type||c.data?d||(this._fileLoadStarted||(this._fileLoadStarted=!0,this.onLoadStart.dispatch()),this._flightQueue.push(c),c.loading=!0,this.onFileStart.dispatch(this.progress,c.key,c.url),this.loadFile(c)):(this._flightQueue.push(c),c.loading=!0,this.loadFile(c))),!c.loaded&&c.syncPoint&&(d=!0),this._flightQueue.length>=
e||d&&this._loadedPackCount===this._totalPackCount);a++);this.updateProgress();if(this._processingHead>=this._fileList.length)this.finishedLoading();else if(!this._flightQueue.length){console.warn("Phaser.Loader - aborting: processing queue empty, loading may have stalled");var g=this;setTimeout(function(){g.finishedLoading(!0)},2E3)}}else console.warn("Phaser.Loader - active loading canceled / reset"),this.finishedLoading(!0)},finishedLoading:function(a){this.hasLoaded||(this.hasLoaded=!0,this.isLoading=
!1,a||this._fileLoadStarted||(this._fileLoadStarted=!0,this.onLoadStart.dispatch()),this.onLoadComplete.dispatch(),this.reset(),this.game.state.loadComplete())},asyncComplete:function(a,b){void 0===b&&(b="");a.loaded=!0;a.error=!!b;b&&(a.errorMessage=b,console.warn("Phaser.Loader - "+a.type+"["+a.key+"]: "+b));this.processLoadQueue()},processPack:function(a){var c=a.data[a.key];if(c)for(var d=0;d<c.length;d++){var e=c[d];switch(e.type){case "image":this.image(e.key,e.url,e.overwrite);break;case "text":this.text(e.key,
e.url,e.overwrite);break;case "json":this.json(e.key,e.url,e.overwrite);break;case "xml":this.xml(e.key,e.url,e.overwrite);break;case "script":this.script(e.key,e.url,e.callback,a.callbackContext||this);break;case "binary":this.binary(e.key,e.url,e.callback,a.callbackContext||this);break;case "spritesheet":this.spritesheet(e.key,e.url,e.frameWidth,e.frameHeight,e.frameMax,e.margin,e.spacing);break;case "video":this.video(e.key,e.urls);break;case "audio":this.audio(e.key,e.urls,e.autoDecode);break;
case "audiosprite":this.audiosprite(e.key,e.urls,e.jsonURL,e.jsonData,e.autoDecode);break;case "tilemap":this.tilemap(e.key,e.url,e.data,b.Tilemap[e.format]);break;case "physics":this.physics(e.key,e.url,e.data,b.Loader[e.format]);break;case "bitmapFont":this.bitmapFont(e.key,e.textureURL,e.atlasURL,e.atlasData,e.xSpacing,e.ySpacing);break;case "atlasJSONArray":this.atlasJSONArray(e.key,e.textureURL,e.atlasURL,e.atlasData);break;case "atlasJSONHash":this.atlasJSONHash(e.key,e.textureURL,e.atlasURL,
e.atlasData);break;case "atlasXML":this.atlasXML(e.key,e.textureURL,e.atlasURL,e.atlasData);break;case "atlas":this.atlas(e.key,e.textureURL,e.atlasURL,e.atlasData,b.Loader[e.format]);break;case "shader":this.shader(e.key,e.url,e.overwrite)}}else console.warn("Phaser.Loader - "+a.key+": pack has data, but not for pack key")},transformUrl:function(a,b){return a?"http"===a.substr(0,4)||"//"===a.substr(0,2)?a:this.baseURL+b.path+a:!1},loadFile:function(a){switch(a.type){case "packfile":this.xhrLoad(a,
this.transformUrl(a.url,a),"text",this.fileComplete);break;case "image":case "spritesheet":case "textureatlas":case "bitmapfont":this.loadImageTag(a);break;case "audio":a.url=this.getAudioURL(a.url);a.url?this.game.sound.usingWebAudio?this.xhrLoad(a,this.transformUrl(a.url,a),"arraybuffer",this.fileComplete):this.game.sound.usingAudioTag&&this.loadAudioTag(a):this.fileError(a,null,"No supported audio URL specified or device does not have audio playback support");break;case "video":a.url=this.getVideoURL(a.url);
a.url?a.asBlob?this.xhrLoad(a,this.transformUrl(a.url,a),"arraybuffer",this.fileComplete):this.loadVideoTag(a):this.fileError(a,null,"No supported video URL specified or device does not have video playback support");break;case "json":this.xhrLoad(a,this.transformUrl(a.url,a),"text",this.jsonLoadComplete);break;case "xml":this.xhrLoad(a,this.transformUrl(a.url,a),"text",this.xmlLoadComplete);break;case "tilemap":a.format===b.Tilemap.TILED_JSON?this.xhrLoad(a,this.transformUrl(a.url,a),"text",this.jsonLoadComplete):
a.format===b.Tilemap.CSV?this.xhrLoad(a,this.transformUrl(a.url,a),"text",this.csvLoadComplete):this.asyncComplete(a,"invalid Tilemap format: "+a.format);break;case "text":case "script":case "shader":case "physics":this.xhrLoad(a,this.transformUrl(a.url,a),"text",this.fileComplete);break;case "binary":this.xhrLoad(a,this.transformUrl(a.url,a),"arraybuffer",this.fileComplete)}},loadImageTag:function(a){var b=this;a.data=new Image;a.data.name=a.key;this.crossOrigin&&(a.data.crossOrigin=this.crossOrigin);
a.data.onload=function(){a.data.onload&&(a.data.onload=null,a.data.onerror=null,b.fileComplete(a))};a.data.onerror=function(){a.data.onload&&(a.data.onload=null,a.data.onerror=null,b.fileError(a))};a.data.src=this.transformUrl(a.url,a);a.data.complete&&a.data.width&&a.data.height&&(a.data.onload=null,a.data.onerror=null,this.fileComplete(a))},loadVideoTag:function(a){var c=this;a.data=document.createElement("video");a.data.name=a.key;a.data.controls=!1;a.data.autoplay=!1;var d=function(){a.data.removeEventListener(a.loadEvent,
d,!1);a.data.onerror=null;a.data.canplay=!0;b.GAMES[c.game.id].load.fileComplete(a)};a.data.onerror=function(){a.data.removeEventListener(a.loadEvent,d,!1);a.data.onerror=null;a.data.canplay=!1;c.fileError(a)};a.data.addEventListener(a.loadEvent,d,!1);a.data.src=this.transformUrl(a.url,a);a.data.load()},loadAudioTag:function(a){var c=this;if(this.game.sound.touchLocked)a.data=new Audio,a.data.name=a.key,a.data.preload="auto",a.data.src=this.transformUrl(a.url,a),this.fileComplete(a);else{a.data=new Audio;
a.data.name=a.key;var d=function(){a.data.removeEventListener("canplaythrough",d,!1);a.data.onerror=null;b.GAMES[c.game.id].load.fileComplete(a)};a.data.onerror=function(){a.data.removeEventListener("canplaythrough",d,!1);a.data.onerror=null;c.fileError(a)};a.data.preload="auto";a.data.src=this.transformUrl(a.url,a);a.data.addEventListener("canplaythrough",d,!1);a.data.load()}},xhrLoad:function(a,b,d,e,g){if(this.useXDomainRequest&&window.XDomainRequest)this.xhrLoadWithXDR(a,b,d,e,g);else{var l=new XMLHttpRequest;
l.open("GET",b,!0);l.responseType=d;g=g||this.fileError;var f=this;l.onload=function(){try{return e.call(f,a,l)}catch(b){f.hasLoaded?window.console&&console.error(b):f.asyncComplete(a,b.message||"Exception")}};l.onerror=function(){try{return g.call(f,a,l)}catch(b){f.hasLoaded?window.console&&console.error(b):f.asyncComplete(a,b.message||"Exception")}};a.requestObject=l;a.requestUrl=b;l.send()}},xhrLoadWithXDR:function(a,b,d,e,g){this._warnedAboutXDomainRequest||this.game.device.ie&&!(10<=this.game.device.ieVersion)||
(this._warnedAboutXDomainRequest=!0,console.warn("Phaser.Loader - using XDomainRequest outside of IE 9"));var l=new window.XDomainRequest;l.open("GET",b,!0);l.responseType=d;l.timeout=3E3;g=g||this.fileError;var f=this;l.onerror=function(){try{return g.call(f,a,l)}catch(b){f.asyncComplete(a,b.message||"Exception")}};l.ontimeout=function(){try{return g.call(f,a,l)}catch(b){f.asyncComplete(a,b.message||"Exception")}};l.onprogress=function(){};l.onload=function(){try{return e.call(f,a,l)}catch(b){f.asyncComplete(a,
b.message||"Exception")}};a.requestObject=l;a.requestUrl=b;setTimeout(function(){l.send()},0)},getVideoURL:function(a){for(var b=0;b<a.length;b++){var d=a[b];if(d.uri)d=d.uri,d=d.type;else{if(0===d.indexOf("blob:")||0===d.indexOf("data:"))return d;0<=d.indexOf("?")&&(d=d.substr(0,d.indexOf("?")));d=d.substr((Math.max(0,d.lastIndexOf("."))||Infinity)+1).toLowerCase()}if(this.game.device.canPlayVideo(d))return a[b]}return null},getAudioURL:function(a){if(this.game.sound.noAudio)return null;for(var b=
0;b<a.length;b++){var d=a[b];if(d.uri)d=d.uri,d=d.type;else{if(0===d.indexOf("blob:")||0===d.indexOf("data:"))return d;0<=d.indexOf("?")&&(d=d.substr(0,d.indexOf("?")));d=d.substr((Math.max(0,d.lastIndexOf("."))||Infinity)+1).toLowerCase()}if(this.game.device.canPlayAudio(d))return a[b]}return null},fileError:function(a,b,d){var e="error loading asset from URL "+(a.requestUrl||this.transformUrl(a.url,a));!d&&b&&(d=b.status);d&&(e=e+" ("+d+")");this.asyncComplete(a,e)},fileComplete:function(a,c){var d=
!0;switch(a.type){case "packfile":var e=JSON.parse(c.responseText);a.data=e||{};break;case "image":this.cache.addImage(a.key,a.url,a.data);break;case "spritesheet":this.cache.addSpriteSheet(a.key,a.url,a.data,a.frameWidth,a.frameHeight,a.frameMax,a.margin,a.spacing);break;case "textureatlas":if(null==a.atlasURL)this.cache.addTextureAtlas(a.key,a.url,a.data,a.atlasData,a.format);else if(d=!1,a.format==b.Loader.TEXTURE_ATLAS_JSON_ARRAY||a.format==b.Loader.TEXTURE_ATLAS_JSON_HASH)this.xhrLoad(a,this.transformUrl(a.atlasURL,
a),"text",this.jsonLoadComplete);else if(a.format==b.Loader.TEXTURE_ATLAS_XML_STARLING)this.xhrLoad(a,this.transformUrl(a.atlasURL,a),"text",this.xmlLoadComplete);else throw Error("Phaser.Loader. Invalid Texture Atlas format: "+a.format);break;case "bitmapfont":a.atlasURL?(d=!1,this.xhrLoad(a,this.transformUrl(a.atlasURL,a),"text",function(a,b){var c;try{c=JSON.parse(b.responseText)}catch(d){}c?(a.atlasType="json",this.jsonLoadComplete(a,b)):(a.atlasType="xml",this.xmlLoadComplete(a,b))})):this.cache.addBitmapFont(a.key,
a.url,a.data,a.atlasData,a.atlasType,a.xSpacing,a.ySpacing);break;case "video":if(a.asBlob)try{a.data=new Blob([new Uint8Array(c.response)])}catch(g){throw Error("Phaser.Loader. Unable to parse video file as Blob: "+a.key);}this.cache.addVideo(a.key,a.url,a.data,a.asBlob);break;case "audio":this.game.sound.usingWebAudio?(a.data=c.response,this.cache.addSound(a.key,a.url,a.data,!0,!1),a.autoDecode&&this.game.sound.decode(a.key)):this.cache.addSound(a.key,a.url,a.data,!1,!0);break;case "text":a.data=
c.responseText;this.cache.addText(a.key,a.url,a.data);break;case "shader":a.data=c.responseText;this.cache.addShader(a.key,a.url,a.data);break;case "physics":e=JSON.parse(c.responseText);this.cache.addPhysicsData(a.key,a.url,e,a.format);break;case "script":a.data=document.createElement("script");a.data.language="javascript";a.data.type="text/javascript";a.data.defer=!1;a.data.text=c.responseText;document.head.appendChild(a.data);a.callback&&(a.data=a.callback.call(a.callbackContext,a.key,c.responseText));
break;case "binary":a.data=a.callback?a.callback.call(a.callbackContext,a.key,c.response):c.response,this.cache.addBinary(a.key,a.data)}d&&this.asyncComplete(a)},jsonLoadComplete:function(a,b){var d=JSON.parse(b.responseText);"tilemap"===a.type?this.cache.addTilemap(a.key,a.url,d,a.format):"bitmapfont"===a.type?this.cache.addBitmapFont(a.key,a.url,a.data,d,a.atlasType,a.xSpacing,a.ySpacing):"json"===a.type?this.cache.addJSON(a.key,a.url,d):this.cache.addTextureAtlas(a.key,a.url,a.data,d,a.format);
this.asyncComplete(a)},csvLoadComplete:function(a,b){this.cache.addTilemap(a.key,a.url,b.responseText,a.format);this.asyncComplete(a)},xmlLoadComplete:function(a,b){var d=this.parseXml(b.responseText);d?("bitmapfont"===a.type?this.cache.addBitmapFont(a.key,a.url,a.data,d,a.atlasType,a.xSpacing,a.ySpacing):"textureatlas"===a.type?this.cache.addTextureAtlas(a.key,a.url,a.data,d,a.format):"xml"===a.type&&this.cache.addXML(a.key,a.url,d),this.asyncComplete(a)):(console.warn("Phaser.Loader - "+a.key+": invalid XML ("+
(b.responseType||b.contentType)+")"),this.asyncComplete(a,"invalid XML"))},parseXml:function(a){var b;try{window.DOMParser?b=(new DOMParser).parseFromString(a,"text/xml"):(b=new ActiveXObject("Microsoft.XMLDOM"),b.async="false",b.loadXML(a))}catch(d){b=null}return b&&b.documentElement&&!b.getElementsByTagName("parsererror").length?b:null},updateProgress:function(){this.preloadSprite&&(0===this.preloadSprite.direction?this.preloadSprite.rect.width=Math.floor(this.preloadSprite.width/100*this.progress):
this.preloadSprite.rect.height=Math.floor(this.preloadSprite.height/100*this.progress),this.preloadSprite.sprite?this.preloadSprite.sprite.updateCrop():this.preloadSprite=null)},totalLoadedFiles:function(){return this._loadedFileCount},totalQueuedFiles:function(){return this._totalFileCount-this._loadedFileCount},totalLoadedPacks:function(){return this._totalPackCount},totalQueuedPacks:function(){return this._totalPackCount-this._loadedPackCount}};Object.defineProperty(b.Loader.prototype,"progressFloat",
{get:function(){return b.Math.clamp(this._loadedFileCount/this._totalFileCount*100||0,0,100)}});Object.defineProperty(b.Loader.prototype,"progress",{get:function(){return Math.round(this.progressFloat)}});b.Loader.prototype.constructor=b.Loader;b.LoaderParser={bitmapFont:function(a,b,d,e){return this.xmlBitmapFont(a,b,d,e)},xmlBitmapFont:function(a,b,d,e){var g={},l=a.getElementsByTagName("info")[0],f=a.getElementsByTagName("common")[0];g.font=l.getAttribute("face");g.size=parseInt(l.getAttribute("size"),
10);g.lineHeight=parseInt(f.getAttribute("lineHeight"),10)+e;g.chars={};l=a.getElementsByTagName("char");for(e=0;e<l.length;e++)f=parseInt(l[e].getAttribute("id"),10),g.chars[f]={x:parseInt(l[e].getAttribute("x"),10),y:parseInt(l[e].getAttribute("y"),10),width:parseInt(l[e].getAttribute("width"),10),height:parseInt(l[e].getAttribute("height"),10),xOffset:parseInt(l[e].getAttribute("xoffset"),10),yOffset:parseInt(l[e].getAttribute("yoffset"),10),xAdvance:parseInt(l[e].getAttribute("xadvance"),10)+
d,kerning:{}};a=a.getElementsByTagName("kerning");for(e=0;e<a.length;e++)d=parseInt(a[e].getAttribute("first"),10),l=parseInt(a[e].getAttribute("second"),10),f=parseInt(a[e].getAttribute("amount"),10),g.chars[l].kerning[d]=f;return this.finalizeBitmapFont(b,g)},jsonBitmapFont:function(a,b,d,e){var g={font:a.font.info._face,size:parseInt(a.font.info._size,10),lineHeight:parseInt(a.font.common._lineHeight,10)+e,chars:{}};a.font.chars["char"].forEach(function(a){var b=parseInt(a._id,10);g.chars[b]={x:parseInt(a._x,
10),y:parseInt(a._y,10),width:parseInt(a._width,10),height:parseInt(a._height,10),xOffset:parseInt(a._xoffset,10),yOffset:parseInt(a._yoffset,10),xAdvance:parseInt(a._xadvance,10)+d,kerning:{}}});a.font.kernings&&a.font.kernings.kerning&&a.font.kernings.kerning.forEach(function(a){g.chars[a._second].kerning[a._first]=parseInt(a._amount,10)});return this.finalizeBitmapFont(b,g)},finalizeBitmapFont:function(a,c){Object.keys(c.chars).forEach(function(d){d=c.chars[d];d.texture=new PIXI.Texture(a,new b.Rectangle(d.x,
d.y,d.width,d.height))});return c}};b.AudioSprite=function(a,b){this.game=a;this.key=b;this.config=this.game.cache.getJSON(b+"-audioatlas");this.autoplayKey=null;this.autoplay=!1;this.sounds={};for(var d in this.config.spritemap){var e=this.config.spritemap[d],g=this.game.add.sound(this.key);g.addMarker(d,e.start,e.end-e.start,null,e.loop);this.sounds[d]=g}this.config.autoplay&&(this.autoplayKey=this.config.autoplay,this.play(this.autoplayKey),this.autoplay=this.sounds[this.autoplayKey])};b.AudioSprite.prototype=
{play:function(a,b){void 0===b&&(b=1);return this.sounds[a].play(a,null,b)},stop:function(a){if(a)this.sounds[a].stop();else for(var b in this.sounds)this.sounds[b].stop()},get:function(a){return this.sounds[a]}};b.AudioSprite.prototype.constructor=b.AudioSprite;b.Sound=function(a,c,d,e,g){void 0===d&&(d=1);void 0===e&&(e=!1);void 0===g&&(g=a.sound.connectToMaster);this.game=a;this.key=this.name=c;this.loop=e;this.volume=d;this.markers={};this.context=null;this.autoplay=!1;this.stopTime=this.position=
this.durationMS=this.duration=this.currentTime=this.startTime=this.totalDuration=0;this.paused=!1;this.pausedTime=this.pausedPosition=0;this.isPlaying=!1;this.currentMarker="";this.fadeTween=null;this.allowMultiple=this.override=this.pendingPlayback=!1;this.usingWebAudio=this.game.sound.usingWebAudio;this.usingAudioTag=this.game.sound.usingAudioTag;this._sound=this.gainNode=this.masterGainNode=this.externalNode=null;this.usingWebAudio?(this.context=this.game.sound.context,this.masterGainNode=this.game.sound.masterGain,
this.gainNode=void 0===this.context.createGain?this.context.createGainNode():this.context.createGain(),this.gainNode.gain.value=d*this.game.sound.volume,g&&this.gainNode.connect(this.masterGainNode)):this.usingAudioTag&&(this.game.cache.getSound(c)&&this.game.cache.isSoundReady(c)?(this._sound=this.game.cache.getSoundData(c),this.totalDuration=0,this._sound.duration&&(this.totalDuration=this._sound.duration)):this.game.cache.onSoundUnlock.add(this.soundHasUnlocked,this));this.onDecoded=new b.Signal;
this.onPlay=new b.Signal;this.onPause=new b.Signal;this.onResume=new b.Signal;this.onLoop=new b.Signal;this.onStop=new b.Signal;this.onMute=new b.Signal;this.onMarkerComplete=new b.Signal;this.onFadeComplete=new b.Signal;this._volume=d;this._buffer=null;this._muted=!1;this._tempLoop=this._muteVolume=this._tempVolume=this._tempPosition=this._tempMarker=0;this._onDecodedEventDispatched=this._paused=!1};b.Sound.prototype={soundHasUnlocked:function(a){a===this.key&&(this._sound=this.game.cache.getSoundData(this.key),
this.totalDuration=this._sound.duration)},addMarker:function(a,b,d,e,g){if(void 0===e||null===e)e=1;void 0===g&&(g=!1);this.markers[a]={name:a,start:b,stop:b+d,volume:e,duration:d,durationMS:1E3*d,loop:g}},removeMarker:function(a){delete this.markers[a]},onEndedHandler:function(){this.isPlaying=!1;this.stop()},update:function(){this.game.cache.checkSoundKey(this.key)?(this.isDecoded&&!this._onDecodedEventDispatched&&(this.onDecoded.dispatch(this),this._onDecodedEventDispatched=!0),this.pendingPlayback&&
this.game.cache.isSoundReady(this.key)&&(this.pendingPlayback=!1,this.play(this._tempMarker,this._tempPosition,this._tempVolume,this._tempLoop)),this.isPlaying&&(this.currentTime=this.game.time.time-this.startTime,this.currentTime>=this.durationMS&&(this.usingWebAudio?this.loop?(this.onLoop.dispatch(this),""===this.currentMarker?(this.currentTime=0,this.startTime=this.game.time.time):(this.onMarkerComplete.dispatch(this.currentMarker,this),this.play(this.currentMarker,0,this.volume,!0,!0))):""!==
this.currentMarker&&this.stop():this.loop?(this.onLoop.dispatch(this),this.play(this.currentMarker,0,this.volume,!0,!0)):this.stop()))):this.destroy()},loopFull:function(a){this.play(null,0,a,!0)},play:function(a,b,d,e,g){if(void 0===a||!1===a||null===a)a="";void 0===g&&(g=!0);if(this.isPlaying&&!this.allowMultiple&&!g&&!this.override)return this;if(this._sound&&this.isPlaying&&!this.allowMultiple&&(this.override||g))if(this.usingWebAudio)if(this.externalNode?this._sound.disconnect(this.externalNode):
this._sound.disconnect(this.gainNode),void 0===this._sound.stop)this._sound.noteOff(0);else try{this._sound.stop(0)}catch(l){}else this.usingAudioTag&&(this._sound.pause(),this._sound.currentTime=0);if(""===a&&0<Object.keys(this.markers).length)return this;if(""!==a)if(this.currentMarker=a,this.markers[a])this.position=this.markers[a].start,this.volume=this.markers[a].volume,this.loop=this.markers[a].loop,this.duration=this.markers[a].duration,this.durationMS=this.markers[a].durationMS,"undefined"!==
typeof d&&(this.volume=d),"undefined"!==typeof e&&(this.loop=e),this._tempMarker=a,this._tempPosition=this.position,this._tempVolume=this.volume,this._tempLoop=this.loop;else return this;else b=b||0,void 0===d&&(d=this._volume),void 0===e&&(e=this.loop),this.position=b,this.volume=d,this.loop=e,this.durationMS=this.duration=0,this._tempMarker=a,this._tempPosition=b,this._tempVolume=d,this._tempLoop=e;this.usingWebAudio?this.game.cache.isSoundDecoded(this.key)?(this._sound=this.context.createBufferSource(),
this.externalNode?this._sound.connect(this.externalNode):this._sound.connect(this.gainNode),this._buffer=this.game.cache.getSoundData(this.key),this._sound.buffer=this._buffer,this.loop&&""===a&&(this._sound.loop=!0),this.loop||""!==a||(this._sound.onended=this.onEndedHandler.bind(this)),this.totalDuration=this._sound.buffer.duration,0===this.duration&&(this.duration=this.totalDuration,this.durationMS=Math.ceil(1E3*this.totalDuration)),void 0===this._sound.start?this._sound.noteGrainOn(0,this.position,
this.duration):this.loop&&""===a?this._sound.start(0,0):this._sound.start(0,this.position,this.duration),this.isPlaying=!0,this.startTime=this.game.time.time,this.currentTime=0,this.stopTime=this.startTime+this.durationMS,this.onPlay.dispatch(this)):(this.pendingPlayback=!0,this.game.cache.getSound(this.key)&&!1===this.game.cache.getSound(this.key).isDecoding&&this.game.sound.decode(this.key,this)):this.game.cache.getSound(this.key)&&this.game.cache.getSound(this.key).locked?(this.game.cache.reloadSound(this.key),
this.pendingPlayback=!0):this._sound&&(this.game.device.cocoonJS||4===this._sound.readyState)?(this._sound.play(),this.totalDuration=this._sound.duration,0===this.duration&&(this.duration=this.totalDuration,this.durationMS=1E3*this.totalDuration),this._sound.currentTime=this.position,this._sound.muted=this._muted,this._sound.volume=this._muted?0:this._volume,this.isPlaying=!0,this.startTime=this.game.time.time,this.currentTime=0,this.stopTime=this.startTime+this.durationMS,this.onPlay.dispatch(this)):
this.pendingPlayback=!0;return this},restart:function(a,b,d,e){void 0===e&&(e=!1);this.play(a||"",b||0,d||1,e,!0)},pause:function(){this.isPlaying&&this._sound&&(this.paused=!0,this.pausedPosition=this.currentTime,this.pausedTime=this.game.time.time,this.onPause.dispatch(this),this.stop())},resume:function(){if(this.paused&&this._sound){if(this.usingWebAudio){var a=this.position+this.pausedPosition/1E3;this._sound=this.context.createBufferSource();this._sound.buffer=this._buffer;this.externalNode?
this._sound.connect(this.externalNode):this._sound.connect(this.gainNode);this.loop&&(this._sound.loop=!0);this.loop||""!==this.currentMarker||(this._sound.onended=this.onEndedHandler.bind(this));var b=this.duration-this.pausedPosition/1E3;void 0===this._sound.start?this._sound.noteGrainOn(0,a,b):this.loop&&this.game.device.chrome?42===this.game.device.chromeVersion?this._sound.start(0):this._sound.start(0,a):this._sound.start(0,a,b)}else this._sound.play();this.isPlaying=!0;this.paused=!1;this.startTime+=
this.game.time.time-this.pausedTime;this.onResume.dispatch(this)}},stop:function(){if(this.isPlaying&&this._sound)if(this.usingWebAudio)if(this.externalNode?this._sound.disconnect(this.externalNode):this._sound.disconnect(this.gainNode),void 0===this._sound.stop)this._sound.noteOff(0);else try{this._sound.stop(0)}catch(b){}else this.usingAudioTag&&(this._sound.pause(),this._sound.currentTime=0);this.isPlaying=this.pendingPlayback=!1;var a=this.currentMarker;""!==this.currentMarker&&this.onMarkerComplete.dispatch(this.currentMarker,
this);this.currentMarker="";null!==this.fadeTween&&this.fadeTween.stop();this.paused||this.onStop.dispatch(this,a)},fadeIn:function(a,b,d){void 0===b&&(b=!1);void 0===d&&(d=this.currentMarker);this.paused||(this.play(d,0,0,b),this.fadeTo(a,1))},fadeOut:function(a){this.fadeTo(a,0)},fadeTo:function(a,c){this.isPlaying&&!this.paused&&c!==this.volume&&(void 0===a&&(a=1E3),void 0===c?console.warn("Phaser.Sound.fadeTo: No Volume Specified."):(this.fadeTween=this.game.add.tween(this).to({volume:c},a,b.Easing.Linear.None,
!0),this.fadeTween.onComplete.add(this.fadeComplete,this)))},fadeComplete:function(){this.onFadeComplete.dispatch(this,this.volume);0===this.volume&&this.stop()},destroy:function(a){void 0===a&&(a=!0);this.stop();a?this.game.sound.remove(this):(this.markers={},this.externalNode=this._buffer=this.context=null,this.onDecoded.dispose(),this.onPlay.dispose(),this.onPause.dispose(),this.onResume.dispose(),this.onLoop.dispose(),this.onStop.dispose(),this.onMute.dispose(),this.onMarkerComplete.dispose())}};
b.Sound.prototype.constructor=b.Sound;Object.defineProperty(b.Sound.prototype,"isDecoding",{get:function(){return this.game.cache.getSound(this.key).isDecoding}});Object.defineProperty(b.Sound.prototype,"isDecoded",{get:function(){return this.game.cache.isSoundDecoded(this.key)}});Object.defineProperty(b.Sound.prototype,"mute",{get:function(){return this._muted||this.game.sound.mute},set:function(a){a=a||!1;a!==this._muted&&(a?(this._muted=!0,this._muteVolume=this._tempVolume,this.usingWebAudio?this.gainNode.gain.value=
0:this.usingAudioTag&&this._sound&&(this._sound.volume=0)):(this._muted=!1,this.usingWebAudio?this.gainNode.gain.value=this._muteVolume:this.usingAudioTag&&this._sound&&(this._sound.volume=this._muteVolume)),this.onMute.dispatch(this))}});Object.defineProperty(b.Sound.prototype,"volume",{get:function(){return this._volume},set:function(a){this.game.device.firefox&&this.usingAudioTag&&(a=this.game.math.clamp(a,0,1));this._muted?this._muteVolume=a:(this._volume=this._tempVolume=a,this.usingWebAudio?
this.gainNode.gain.value=a:this.usingAudioTag&&this._sound&&(this._sound.volume=a))}});b.SoundManager=function(a){this.game=a;this.onSoundDecode=new b.Signal;this.onVolumeChange=new b.Signal;this.onMute=new b.Signal;this.onUnMute=new b.Signal;this.context=null;this.noAudio=this.usingAudioTag=this.usingWebAudio=!1;this.connectToMaster=!0;this.touchLocked=!1;this.channels=32;this._muted=this._codeMuted=!1;this._unlockSource=null;this._volume=1;this._sounds=[];this._watchList=new b.ArraySet;this._watching=
!1;this._watchContext=this._watchCallback=null};b.SoundManager.prototype={boot:function(){this.game.device.iOS&&!1===this.game.device.webAudio&&(this.channels=1);if(window.PhaserGlobal){if(!0===window.PhaserGlobal.disableAudio){this.noAudio=!0;this.touchLocked=!1;return}if(!0===window.PhaserGlobal.disableWebAudio){this.usingAudioTag=!0;this.touchLocked=!1;return}}if(window.PhaserGlobal&&window.PhaserGlobal.audioContext)this.context=window.PhaserGlobal.audioContext;else if(window.AudioContext)try{this.context=
new window.AudioContext}catch(a){this.context=null,this.touchLocked=this.usingWebAudio=!1}else if(window.webkitAudioContext)try{this.context=new window.webkitAudioContext}catch(a){this.context=null,this.touchLocked=this.usingWebAudio=!1}if(null===this.context){if(void 0===window.Audio){this.noAudio=!0;return}this.usingAudioTag=!0}else this.usingWebAudio=!0,this.masterGain=void 0===this.context.createGain?this.context.createGainNode():this.context.createGain(),this.masterGain.gain.value=1,this.masterGain.connect(this.context.destination);
this.noAudio||(!this.game.device.cocoonJS&&this.game.device.iOS||window.PhaserGlobal&&window.PhaserGlobal.fakeiOSTouchLock)&&this.setTouchLock()},setTouchLock:function(){this.game.input.touch.addTouchLockCallback(this.unlock,this);this.touchLocked=!0},unlock:function(){if(this.noAudio||!this.touchLocked||null!==this._unlockSource)return!0;if(this.usingAudioTag)this.touchLocked=!1,this._unlockSource=null;else if(this.usingWebAudio){var a=this.context.createBuffer(1,1,22050);this._unlockSource=this.context.createBufferSource();
this._unlockSource.buffer=a;this._unlockSource.connect(this.context.destination);void 0===this._unlockSource.start?this._unlockSource.noteOn(0):this._unlockSource.start(0)}return!0},stopAll:function(){if(!this.noAudio)for(var a=0;a<this._sounds.length;a++)this._sounds[a]&&this._sounds[a].stop()},pauseAll:function(){if(!this.noAudio)for(var a=0;a<this._sounds.length;a++)this._sounds[a]&&this._sounds[a].pause()},resumeAll:function(){if(!this.noAudio)for(var a=0;a<this._sounds.length;a++)this._sounds[a]&&
this._sounds[a].resume()},decode:function(a,b){b=b||null;var d=this.game.cache.getSoundData(a);if(d&&!1===this.game.cache.isSoundDecoded(a)){this.game.cache.updateSound(a,"isDecoding",!0);var e=this;try{this.context.decodeAudioData(d,function(d){d&&(e.game.cache.decodedSound(a,d),e.onSoundDecode.dispatch(a,b))})}catch(g){}}},setDecodedCallback:function(a,c,d){"string"===typeof a&&(a=[a]);this._watchList.reset();for(var e=0;e<a.length;e++)a[e]instanceof b.Sound?this.game.cache.isSoundDecoded(a[e].key)||
this._watchList.add(a[e].key):this.game.cache.isSoundDecoded(a[e])||this._watchList.add(a[e]);0===this._watchList.total?(this._watching=!1,c.call(d)):(this._watching=!0,this._watchCallback=c,this._watchContext=d)},update:function(){if(!this.noAudio){!this.touchLocked||null===this._unlockSource||this._unlockSource.playbackState!==this._unlockSource.PLAYING_STATE&&this._unlockSource.playbackState!==this._unlockSource.FINISHED_STATE||(this.touchLocked=!1,this._unlockSource=null);for(var a=0;a<this._sounds.length;a++)this._sounds[a].update();
if(this._watching){for(a=this._watchList.first;a;)this.game.cache.isSoundDecoded(a)&&this._watchList.remove(a),a=this._watchList.next;0===this._watchList.total&&(this._watching=!1,this._watchCallback.call(this._watchContext))}}},add:function(a,c,d,e){void 0===c&&(c=1);void 0===d&&(d=!1);void 0===e&&(e=this.connectToMaster);a=new b.Sound(this.game,a,c,d,e);this._sounds.push(a);return a},addSprite:function(a){return new b.AudioSprite(this.game,a)},remove:function(a){for(var b=this._sounds.length;b--;)if(this._sounds[b]===
a)return this._sounds[b].destroy(!1),this._sounds.splice(b,1),!0;return!1},removeByKey:function(a){for(var b=this._sounds.length,d=0;b--;)this._sounds[b].key===a&&(this._sounds[b].destroy(!1),this._sounds.splice(b,1),d++);return d},play:function(a,b,d){if(!this.noAudio)return a=this.add(a,b,d),a.play(),a},setMute:function(){if(!this._muted){this._muted=!0;this.usingWebAudio&&(this._muteVolume=this.masterGain.gain.value,this.masterGain.gain.value=0);for(var a=0;a<this._sounds.length;a++)this._sounds[a].usingAudioTag&&
(this._sounds[a].mute=!0);this.onMute.dispatch()}},unsetMute:function(){if(this._muted&&!this._codeMuted){this._muted=!1;this.usingWebAudio&&(this.masterGain.gain.value=this._muteVolume);for(var a=0;a<this._sounds.length;a++)this._sounds[a].usingAudioTag&&(this._sounds[a].mute=!1);this.onUnMute.dispatch()}},destroy:function(){this.stopAll();for(var a=0;a<this._sounds.length;a++)this._sounds[a]&&this._sounds[a].destroy();this._sounds=[];this.onSoundDecode.dispose();this.context&&window.PhaserGlobal&&
(window.PhaserGlobal.audioContext=this.context)}};b.SoundManager.prototype.constructor=b.SoundManager;Object.defineProperty(b.SoundManager.prototype,"mute",{get:function(){return this._muted},set:function(a){a?this._muted||(this._codeMuted=!0,this.setMute()):this._muted&&(this._codeMuted=!1,this.unsetMute())}});Object.defineProperty(b.SoundManager.prototype,"volume",{get:function(){return this._volume},set:function(a){0>a?a=0:1<a&&(a=1);if(this._volume!==a){this._volume=a;if(this.usingWebAudio)this.masterGain.gain.value=
a;else for(var b=0;b<this._sounds.length;b++)this._sounds[b].usingAudioTag&&(this._sounds[b].volume*=a);this.onVolumeChange.dispatch(a)}}});b.Utils.Debug=function(a){this.game=a;this.context=this.canvas=this.bmd=this.sprite=null;this.font="14px Courier";this.columnWidth=100;this.lineHeight=16;this.renderShadow=!0;this.currentY=this.currentX=0;this.currentAlpha=1;this.dirty=!1};b.Utils.Debug.prototype={boot:function(){this.game.renderType===b.CANVAS?this.context=this.game.context:(this.bmd=this.game.make.bitmapData(this.game.width,
this.game.height),this.sprite=this.game.make.image(0,0,this.bmd),this.game.stage.addChild(this.sprite),this.canvas=b.Canvas.create(this.game.width,this.game.height,"",!0),this.context=this.canvas.getContext("2d"))},preUpdate:function(){this.dirty&&this.sprite&&(this.bmd.clear(),this.bmd.draw(this.canvas,0,0),this.context.clearRect(0,0,this.game.width,this.game.height),this.dirty=!1)},reset:function(){this.context&&this.context.clearRect(0,0,this.game.width,this.game.height);this.sprite&&this.bmd.clear()},
start:function(a,b,d,e){"number"!==typeof a&&(a=0);"number"!==typeof b&&(b=0);d=d||"rgb(255,255,255)";void 0===e&&(e=0);this.currentX=a;this.currentY=b;this.currentColor=d;this.columnWidth=e;this.dirty=!0;this.context.save();this.context.setTransform(1,0,0,1,0,0);this.context.strokeStyle=d;this.context.fillStyle=d;this.context.font=this.font;this.context.globalAlpha=this.currentAlpha},stop:function(){this.context.restore()},line:function(){for(var a=this.currentX,b=0;b<arguments.length;b++)this.renderShadow&&
(this.context.fillStyle="rgb(0,0,0)",this.context.fillText(arguments[b],a+1,this.currentY+1),this.context.fillStyle=this.currentColor),this.context.fillText(arguments[b],a,this.currentY),a+=this.columnWidth;this.currentY+=this.lineHeight},soundInfo:function(a,b,d,e){this.start(b,d,e);this.line("Sound: "+a.key+" Locked: "+a.game.sound.touchLocked);this.line("Is Ready?: "+this.game.cache.isSoundReady(a.key)+" Pending Playback: "+a.pendingPlayback);this.line("Decoded: "+a.isDecoded+" Decoding: "+a.isDecoding);
this.line("Total Duration: "+a.totalDuration+" Playing: "+a.isPlaying);this.line("Time: "+a.currentTime);this.line("Volume: "+a.volume+" Muted: "+a.mute);this.line("WebAudio: "+a.usingWebAudio+" Audio: "+a.usingAudioTag);""!==a.currentMarker&&(this.line("Marker: "+a.currentMarker+" Duration: "+a.duration+" (ms: "+a.durationMS+")"),this.line("Start: "+a.markers[a.currentMarker].start+" Stop: "+a.markers[a.currentMarker].stop),this.line("Position: "+a.position));this.stop()},cameraInfo:function(a,b,
d,e){this.start(b,d,e);this.line("Camera ("+a.width+" x "+a.height+")");this.line("X: "+a.x+" Y: "+a.y);a.bounds&&this.line("Bounds x: "+a.bounds.x+" Y: "+a.bounds.y+" w: "+a.bounds.width+" h: "+a.bounds.height);this.line("View x: "+a.view.x+" Y: "+a.view.y+" w: "+a.view.width+" h: "+a.view.height);this.line("Total in view: "+a.totalInView);this.stop()},timer:function(a,b,d,e){this.start(b,d,e);this.line("Timer (running: "+a.running+" expired: "+a.expired+")");this.line("Next Tick: "+a.next+" Duration: "+
a.duration);this.line("Paused: "+a.paused+" Length: "+a.length);this.stop()},pointer:function(a,b,d,e,g){null!=a&&(void 0===b&&(b=!1),d=d||"rgba(0,255,0,0.5)",e=e||"rgba(255,0,0,0.5)",!0!==b||!0!==a.isUp)&&(this.start(a.x,a.y-100,g),this.context.beginPath(),this.context.arc(a.x,a.y,a.circle.radius,0,2*Math.PI),this.context.fillStyle=a.active?d:e,this.context.fill(),this.context.closePath(),this.context.beginPath(),this.context.moveTo(a.positionDown.x,a.positionDown.y),this.context.lineTo(a.position.x,
a.position.y),this.context.lineWidth=2,this.context.stroke(),this.context.closePath(),this.line("ID: "+a.id+" Active: "+a.active),this.line("World X: "+a.worldX+" World Y: "+a.worldY),this.line("Screen X: "+a.x+" Screen Y: "+a.y),this.line("Duration: "+a.duration+" ms"),this.line("is Down: "+a.isDown+" is Up: "+a.isUp),this.stop())},spriteInputInfo:function(a,b,d,e){this.start(b,d,e);this.line("Sprite Input: ("+a.width+" x "+a.height+")");this.line("x: "+a.input.pointerX().toFixed(1)+" y: "+a.input.pointerY().toFixed(1));
this.line("over: "+a.input.pointerOver()+" duration: "+a.input.overDuration().toFixed(0));this.line("down: "+a.input.pointerDown()+" duration: "+a.input.downDuration().toFixed(0));this.line("just over: "+a.input.justOver()+" just out: "+a.input.justOut());this.stop()},key:function(a,b,d,e){this.start(b,d,e,150);this.line("Key:",a.keyCode,"isDown:",a.isDown);this.line("justDown:",a.justDown,"justUp:",a.justUp);this.line("Time Down:",a.timeDown.toFixed(0),"duration:",a.duration.toFixed(0));this.stop()},
inputInfo:function(a,b,d){this.start(a,b,d);this.line("Input");this.line("X: "+this.game.input.x+" Y: "+this.game.input.y);this.line("World X: "+this.game.input.worldX+" World Y: "+this.game.input.worldY);this.line("Scale X: "+this.game.input.scale.x.toFixed(1)+" Scale Y: "+this.game.input.scale.x.toFixed(1));this.line("Screen X: "+this.game.input.activePointer.screenX+" Screen Y: "+this.game.input.activePointer.screenY);this.stop()},spriteBounds:function(a,b,d){a=a.getBounds();a.x+=this.game.camera.x;
a.y+=this.game.camera.y;this.rectangle(a,b,d)},ropeSegments:function(a,b,d){var e=this;a.segments.forEach(function(a){e.rectangle(a,b,d)},this)},spriteInfo:function(a,b,d,e){this.start(b,d,e);this.line("Sprite:  ("+a.width+" x "+a.height+") anchor: "+a.anchor.x+" x "+a.anchor.y);this.line("x: "+a.x.toFixed(1)+" y: "+a.y.toFixed(1));this.line("angle: "+a.angle.toFixed(1)+" rotation: "+a.rotation.toFixed(1));this.line("visible: "+a.visible+" in camera: "+a.inCamera);this.line("bounds x: "+a._bounds.x.toFixed(1)+
" y: "+a._bounds.y.toFixed(1)+" w: "+a._bounds.width.toFixed(1)+" h: "+a._bounds.height.toFixed(1));this.stop()},spriteCoords:function(a,b,d,e){this.start(b,d,e,100);a.name&&this.line(a.name);this.line("x:",a.x.toFixed(2),"y:",a.y.toFixed(2));this.line("pos x:",a.position.x.toFixed(2),"pos y:",a.position.y.toFixed(2));this.line("world x:",a.world.x.toFixed(2),"world y:",a.world.y.toFixed(2));this.stop()},lineInfo:function(a,b,d,e){this.start(b,d,e,80);this.line("start.x:",a.start.x.toFixed(2),"start.y:",
a.start.y.toFixed(2));this.line("end.x:",a.end.x.toFixed(2),"end.y:",a.end.y.toFixed(2));this.line("length:",a.length.toFixed(2),"angle:",a.angle);this.stop()},pixel:function(a,b,d,e){e=e||2;this.start();this.context.fillStyle=d;this.context.fillRect(a,b,e,e);this.stop()},geom:function(a,c,d,e){void 0===d&&(d=!0);void 0===e&&(e=0);c=c||"rgba(0,255,0,0.4)";this.start();this.context.fillStyle=c;this.context.strokeStyle=c;if(a instanceof b.Rectangle||1===e)d?this.context.fillRect(a.x-this.game.camera.x,
a.y-this.game.camera.y,a.width,a.height):this.context.strokeRect(a.x-this.game.camera.x,a.y-this.game.camera.y,a.width,a.height);else if(a instanceof b.Circle||2===e)this.context.beginPath(),this.context.arc(a.x-this.game.camera.x,a.y-this.game.camera.y,a.radius,0,2*Math.PI,!1),this.context.closePath(),d?this.context.fill():this.context.stroke();else if(a instanceof b.Point||3===e)this.context.fillRect(a.x-this.game.camera.x,a.y-this.game.camera.y,4,4);else if(a instanceof b.Line||4===e)this.context.lineWidth=
1,this.context.beginPath(),this.context.moveTo(a.start.x+.5-this.game.camera.x,a.start.y+.5-this.game.camera.y),this.context.lineTo(a.end.x+.5-this.game.camera.x,a.end.y+.5-this.game.camera.y),this.context.closePath(),this.context.stroke();this.stop()},rectangle:function(a,b,d){void 0===d&&(d=!0);b=b||"rgba(0, 255, 0, 0.4)";this.start();d?(this.context.fillStyle=b,this.context.fillRect(a.x-this.game.camera.x,a.y-this.game.camera.y,a.width,a.height)):(this.context.strokeStyle=b,this.context.strokeRect(a.x-
this.game.camera.x,a.y-this.game.camera.y,a.width,a.height));this.stop()},text:function(a,b,d,e,g){e=e||"rgb(255,255,255)";g=g||"16px Courier";this.start();this.context.font=g;this.renderShadow&&(this.context.fillStyle="rgb(0,0,0)",this.context.fillText(a,b+1,d+1));this.context.fillStyle=e;this.context.fillText(a,b,d);this.stop()},quadTree:function(a,b){b=b||"rgba(255,0,0,0.3)";this.start();var d=a.bounds;if(0===a.nodes.length)for(this.context.strokeStyle=b,this.context.strokeRect(d.x,d.y,d.width,
d.height),this.text("size: "+a.objects.length,d.x+4,d.y+16,"rgb(0,200,0)","12px Courier"),this.context.strokeStyle="rgb(0,255,0)",d=0;d<a.objects.length;d++)this.context.strokeRect(a.objects[d].x,a.objects[d].y,a.objects[d].width,a.objects[d].height);else for(d=0;d<a.nodes.length;d++)this.quadTree(a.nodes[d]);this.stop()},body:function(a,c,d){a.body&&(this.start(),a.body.type===b.Physics.ARCADE?b.Physics.Arcade.Body.render(this.context,a.body,c,d):a.body.type===b.Physics.NINJA?b.Physics.Ninja.Body.render(this.context,
a.body,c,d):a.body.type===b.Physics.BOX2D&&b.Physics.Box2D.renderBody(this.context,a.body,c),this.stop())},bodyInfo:function(a,c,d,e){a.body&&(this.start(c,d,e,210),a.body.type===b.Physics.ARCADE?b.Physics.Arcade.Body.renderBodyInfo(this,a.body):a.body.type===b.Physics.BOX2D&&this.game.physics.box2d.renderBodyInfo(this,a.body),this.stop())},box2dWorld:function(){this.start();this.context.translate(-this.game.camera.view.x,-this.game.camera.view.y,0);this.game.physics.box2d.renderDebugDraw(this.context);
this.stop()},box2dBody:function(a,c){this.start();b.Physics.Box2D.renderBody(this.context,a,c);this.stop()}};b.Utils.Debug.prototype.constructor=b.Utils.Debug;b.ArraySet=function(a){this.position=0;this.list=a||[]};b.ArraySet.prototype={add:function(a){this.exists(a)||this.list.push(a);return a},getIndex:function(a){return this.list.indexOf(a)},getByKey:function(a,b){for(var d=this.list.length;d--;)if(this.list[d][a]===b)return this.list[d];return null},exists:function(a){return-1<this.list.indexOf(a)},
reset:function(){this.list.length=0},remove:function(a){var b=this.list.indexOf(a);if(-1<b)return this.list.splice(b,1),a},setAll:function(a,b){for(var d=this.list.length;d--;)this.list[d]&&(this.list[d][a]=b)},callAll:function(a){for(var b=Array.prototype.splice.call(arguments,1),d=this.list.length;d--;)this.list[d]&&this.list[d][a]&&this.list[d][a].apply(this.list[d],b)},removeAll:function(a){void 0===a&&(a=!1);for(var b=this.list.length;b--;)if(this.list[b]){var d=this.remove(this.list[b]);a&&
d.destroy()}this.position=0;this.list=[]}};Object.defineProperty(b.ArraySet.prototype,"total",{get:function(){return this.list.length}});Object.defineProperty(b.ArraySet.prototype,"first",{get:function(){this.position=0;return 0<this.list.length?this.list[0]:null}});Object.defineProperty(b.ArraySet.prototype,"next",{get:function(){return this.position<this.list.length?(this.position++,this.list[this.position]):null}});b.ArraySet.prototype.constructor=b.ArraySet;b.ArrayUtils={getRandomItem:function(a,
b,d){if(null==a)return null;void 0===b&&(b=0);void 0===d&&(d=a.length);b+=Math.floor(Math.random()*d);return void 0===a[b]?null:a[b]},removeRandomItem:function(a,b,d){if(null==a)return null;void 0===b&&(b=0);void 0===d&&(d=a.length);b+=Math.floor(Math.random()*d);return b<a.length?(a=a.splice(b,1),void 0===a[0]?null:a[0]):null},shuffle:function(a){for(var b=a.length-1;0<b;b--){var d=Math.floor(Math.random()*(b+1)),e=a[b];a[b]=a[d];a[d]=e}return a},transposeMatrix:function(a){for(var b=a.length,d=
a[0].length,e=Array(d),g=0;g<d;g++){e[g]=Array(b);for(var l=b-1;-1<l;l--)e[g][l]=a[l][g]}return e},rotateMatrix:function(a,c){"string"!==typeof c&&(c=(c%360+360)%360);if(90===c||-270===c||"rotateLeft"===c)a=b.ArrayUtils.transposeMatrix(a),a=a.reverse();else if(-90===c||270===c||"rotateRight"===c)a=a.reverse(),a=b.ArrayUtils.transposeMatrix(a);else if(180===Math.abs(c)||"rotate180"===c){for(var d=0;d<a.length;d++)a[d].reverse();a=a.reverse()}return a},findClosest:function(a,b){if(!b.length)return NaN;
if(1===b.length||a<b[0])return b[0];for(var d=1;b[d]<a;)d++;var e=b[d-1],d=d<b.length?b[d]:Number.POSITIVE_INFINITY;return d-a<=a-e?d:e},rotate:function(a){var b=a.shift();a.push(b);return b},numberArray:function(a,b){for(var d=[],e=a;e<=b;e++)d.push(e);return d},numberArrayStep:function(a,c,d){a=+a||0;var e=typeof c;"number"!==e&&"string"!==e||!d||d[c]!==a||(c=d=null);d=null==d?1:+d||0;null===c?(c=a,a=0):c=+c||0;e=-1;c=Math.max(b.Math.roundAwayFromZero((c-a)/(d||1)),0);for(var g=Array(c);++e<c;)g[e]=
a,a+=d;return g}};b.Color={packPixel:function(a,c,d,e){return b.Device.LITTLE_ENDIAN?(e<<24|d<<16|c<<8|a)>>>0:(a<<24|c<<16|d<<8|e)>>>0},unpackPixel:function(a,c,d,e){if(void 0===c||null===c)c=b.Color.createColor();if(void 0===d||null===d)d=!1;if(void 0===e||null===e)e=!1;b.Device.LITTLE_ENDIAN?(c.a=(a&4278190080)>>>24,c.b=(a&16711680)>>>16,c.g=(a&65280)>>>8,c.r=a&255):(c.r=(a&4278190080)>>>24,c.g=(a&16711680)>>>16,c.b=(a&65280)>>>8,c.a=a&255);c.color=a;c.rgba="rgba("+c.r+","+c.g+","+c.b+","+c.a/255+
")";d&&b.Color.RGBtoHSL(c.r,c.g,c.b,c);e&&b.Color.RGBtoHSV(c.r,c.g,c.b,c);return c},fromRGBA:function(a,c){c||(c=b.Color.createColor());c.r=(a&4278190080)>>>24;c.g=(a&16711680)>>>16;c.b=(a&65280)>>>8;c.a=a&255;c.rgba="rgba("+c.r+","+c.g+","+c.b+","+c.a+")";return c},toRGBA:function(a,b,d,e){return a<<24|b<<16|d<<8|e},RGBtoHSL:function(a,c,d,e){e||(e=b.Color.createColor(a,c,d,1));a/=255;c/=255;d/=255;var g=Math.min(a,c,d),l=Math.max(a,c,d);e.h=0;e.s=0;e.l=(l+g)/2;if(l!==g){var f=l-g;e.s=.5<e.l?f/(2-
l-g):f/(l+g);l===a?e.h=(c-d)/f+(c<d?6:0):l===c?e.h=(d-a)/f+2:l===d&&(e.h=(a-c)/f+4);e.h/=6}return e},HSLtoRGB:function(a,c,d,e){e?(e.r=d,e.g=d,e.b=d):e=b.Color.createColor(d,d,d);0!==c&&(c=.5>d?d*(1+c):d+c-d*c,d=2*d-c,e.r=b.Color.hueToColor(d,c,a+1/3),e.g=b.Color.hueToColor(d,c,a),e.b=b.Color.hueToColor(d,c,a-1/3));e.r=Math.floor(255*e.r|0);e.g=Math.floor(255*e.g|0);e.b=Math.floor(255*e.b|0);b.Color.updateColor(e);return e},RGBtoHSV:function(a,c,d,e){e||(e=b.Color.createColor(a,c,d,255));a/=255;c/=
255;d/=255;var g=Math.min(a,c,d),l=Math.max(a,c,d),f=l-g;e.h=0;e.s=0===l?0:f/l;e.v=l;l!==g&&(l===a?e.h=(c-d)/f+(c<d?6:0):l===c?e.h=(d-a)/f+2:l===d&&(e.h=(a-c)/f+4),e.h/=6);return e},HSVtoRGB:function(a,c,d,e){void 0===e&&(e=b.Color.createColor(0,0,0,1,a,c,0,d));var g,l,f,h=Math.floor(6*a),k=6*a-h;a=d*(1-c);var m=d*(1-k*c);c=d*(1-(1-k)*c);switch(h%6){case 0:g=d;l=c;f=a;break;case 1:g=m;l=d;f=a;break;case 2:g=a;l=d;f=c;break;case 3:g=a;l=m;f=d;break;case 4:g=c;l=a;f=d;break;case 5:g=d,l=a,f=m}e.r=Math.floor(255*
g);e.g=Math.floor(255*l);e.b=Math.floor(255*f);b.Color.updateColor(e);return e},hueToColor:function(a,b,d){0>d&&(d+=1);1<d&&--d;return d<1/6?a+6*(b-a)*d:.5>d?b:d<2/3?a+(b-a)*(2/3-d)*6:a},createColor:function(a,c,d,e,g,l,f,h){return b.Color.updateColor({r:a||0,g:c||0,b:d||0,a:e||1,h:g||0,s:l||0,l:f||0,v:h||0,color:0,color32:0,rgba:""})},updateColor:function(a){a.rgba="rgba("+a.r.toString()+","+a.g.toString()+","+a.b.toString()+","+a.a.toString()+")";a.color=b.Color.getColor(a.r,a.g,a.b);a.color32=
b.Color.getColor32(a.a,a.r,a.g,a.b);return a},getColor32:function(a,b,d,e){return a<<24|b<<16|d<<8|e},getColor:function(a,b,d){return a<<16|b<<8|d},RGBtoString:function(a,c,d,e,g){void 0===e&&(e=255);void 0===g&&(g="#");return"#"===g?"#"+(16777216+(a<<16)+(c<<8)+d).toString(16).slice(1):"0x"+b.Color.componentToHex(e)+b.Color.componentToHex(a)+b.Color.componentToHex(c)+b.Color.componentToHex(d)},hexToRGB:function(a){if(a=b.Color.hexToColor(a))return b.Color.getColor32(a.a,a.r,a.g,a.b)},hexToColor:function(a,
c){a=a.replace(/^(?:#|0x)?([a-f\d])([a-f\d])([a-f\d])$/i,function(a,b,c,d){return b+b+c+c+d+d});var d=/^(?:#|0x)?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);if(d){var e=parseInt(d[1],16),g=parseInt(d[2],16),d=parseInt(d[3],16);c?(c.r=e,c.g=g,c.b=d):c=b.Color.createColor(e,g,d)}return c},webToColor:function(a,c){c||(c=b.Color.createColor());var d=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d+(?:\.\d+)?))?\s*\)$/.exec(a);d&&(c.r=parseInt(d[1],10),c.g=parseInt(d[2],10),c.b=parseInt(d[3],
10),c.a=void 0!==d[4]?parseFloat(d[4]):1,b.Color.updateColor(c));return c},valueToColor:function(a,c){c||(c=b.Color.createColor());if("string"===typeof a){if(0===a.indexOf("rgb"))return b.Color.webToColor(a,c);c.a=1;return b.Color.hexToColor(a,c)}if("number"===typeof a){var d=b.Color.getRGB(a);c.r=d.r;c.g=d.g;c.b=d.b;c.a=d.a/255}return c},componentToHex:function(a){a=a.toString(16);return 1==a.length?"0"+a:a},HSVColorWheel:function(a,c){void 0===a&&(a=1);void 0===c&&(c=1);for(var d=[],e=0;359>=e;e++)d.push(b.Color.HSVtoRGB(e/
359,a,c));return d},HSLColorWheel:function(a,c){void 0===a&&(a=.5);void 0===c&&(c=.5);for(var d=[],e=0;359>=e;e++)d.push(b.Color.HSLtoRGB(e/359,a,c));return d},interpolateColor:function(a,c,d,e,g){void 0===g&&(g=255);a=b.Color.getRGB(a);c=b.Color.getRGB(c);return b.Color.getColor32(g,(c.red-a.red)*e/d+a.red,(c.green-a.green)*e/d+a.green,(c.blue-a.blue)*e/d+a.blue)},interpolateColorWithRGB:function(a,c,d,e,g,l){a=b.Color.getRGB(a);return b.Color.getColor((c-a.red)*l/g+a.red,(d-a.green)*l/g+a.green,
(e-a.blue)*l/g+a.blue)},interpolateRGB:function(a,c,d,e,g,l,f,h){return b.Color.getColor((e-a)*h/f+a,(g-c)*h/f+c,(l-d)*h/f+d)},getRandomColor:function(a,c,d){void 0===a&&(a=0);void 0===c&&(c=255);void 0===d&&(d=255);if(255<c||a>c)return b.Color.getColor(255,255,255);var e=a+Math.round(Math.random()*(c-a)),g=a+Math.round(Math.random()*(c-a));a+=Math.round(Math.random()*(c-a));return b.Color.getColor32(d,e,g,a)},getRGB:function(a){return 16777215<a?{alpha:a>>>24,red:a>>16&255,green:a>>8&255,blue:a&
255,a:a>>>24,r:a>>16&255,g:a>>8&255,b:a&255}:{alpha:255,red:a>>16&255,green:a>>8&255,blue:a&255,a:255,r:a>>16&255,g:a>>8&255,b:a&255}},getWebRGB:function(a){if("object"===typeof a)return"rgba("+a.r.toString()+","+a.g.toString()+","+a.b.toString()+","+(a.a/255).toString()+")";a=b.Color.getRGB(a);return"rgba("+a.r.toString()+","+a.g.toString()+","+a.b.toString()+","+(a.a/255).toString()+")"},getAlpha:function(a){return a>>>24},getAlphaFloat:function(a){return(a>>>24)/255},getRed:function(a){return a>>
16&255},getGreen:function(a){return a>>8&255},getBlue:function(a){return a&255},blendNormal:function(a){return a},blendLighten:function(a,b){return b>a?b:a},blendDarken:function(a,b){return b>a?a:b},blendMultiply:function(a,b){return a*b/255},blendAverage:function(a,b){return(a+b)/2},blendAdd:function(a,b){return Math.min(255,a+b)},blendSubtract:function(a,b){return Math.max(0,a+b-255)},blendDifference:function(a,b){return Math.abs(a-b)},blendNegation:function(a,b){return 255-Math.abs(255-a-b)},blendScreen:function(a,
b){return 255-((255-a)*(255-b)>>8)},blendExclusion:function(a,b){return a+b-2*a*b/255},blendOverlay:function(a,b){return 128>b?2*a*b/255:255-2*(255-a)*(255-b)/255},blendSoftLight:function(a,b){return 128>b?b/255*((a>>1)+64)*2:255-2*(255-((a>>1)+64))*(255-b)/255},blendHardLight:function(a,c){return b.Color.blendOverlay(c,a)},blendColorDodge:function(a,b){return 255===b?b:Math.min(255,(a<<8)/(255-b))},blendColorBurn:function(a,b){return 0===b?b:Math.max(0,255-(255-a<<8)/b)},blendLinearDodge:function(a,
c){return b.Color.blendAdd(a,c)},blendLinearBurn:function(a,c){return b.Color.blendSubtract(a,c)},blendLinearLight:function(a,c){return 128>c?b.Color.blendLinearBurn(a,2*c):b.Color.blendLinearDodge(a,2*(c-128))},blendVividLight:function(a,c){return 128>c?b.Color.blendColorBurn(a,2*c):b.Color.blendColorDodge(a,2*(c-128))},blendPinLight:function(a,c){return 128>c?b.Color.blendDarken(a,2*c):b.Color.blendLighten(a,2*(c-128))},blendHardMix:function(a,c){return 128>b.Color.blendVividLight(a,c)?0:255},blendReflect:function(a,
b){return 255===b?b:Math.min(255,a*a/(255-b))},blendGlow:function(a,c){return b.Color.blendReflect(c,a)},blendPhoenix:function(a,b){return Math.min(a,b)-Math.max(a,b)+255}};b.LinkedList=function(){this.last=this.first=this.prev=this.next=null;this.total=0};b.LinkedList.prototype={add:function(a){if(0===this.total&&null===this.first&&null===this.last)return this.next=this.last=this.first=a,a.prev=this,this.total++,a;this.last.next=a;a.prev=this.last;this.last=a;this.total++;return a},reset:function(){this.prev=
this.next=this.last=this.first=null;this.total=0},remove:function(a){1===this.total?(this.reset(),a.next=a.prev=null):(a===this.first?this.first=this.first.next:a===this.last&&(this.last=this.last.prev),a.prev&&(a.prev.next=a.next),a.next&&(a.next.prev=a.prev),a.next=a.prev=null,null===this.first&&(this.last=null),this.total--)},callAll:function(a){if(this.first&&this.last){var b=this.first;do b&&b[a]&&b[a].call(b),b=b.next;while(b!=this.last.next)}}};b.LinkedList.prototype.constructor=b.LinkedList;
b.Physics=function(a,b){b=b||{};this.game=a;this.config=b;this.matter=this.chipmunk=this.box2d=this.ninja=this.p2=this.arcade=null;this.parseConfig()};b.Physics.ARCADE=0;b.Physics.P2JS=1;b.Physics.NINJA=2;b.Physics.BOX2D=3;b.Physics.CHIPMUNK=4;b.Physics.MATTERJS=5;b.Physics.prototype={parseConfig:function(){this.config.hasOwnProperty("arcade")&&!0!==this.config.arcade||!b.Physics.hasOwnProperty("Arcade")||(this.arcade=new b.Physics.Arcade(this.game));this.config.hasOwnProperty("ninja")&&!0===this.config.ninja&&
b.Physics.hasOwnProperty("Ninja")&&(this.ninja=new b.Physics.Ninja(this.game));this.config.hasOwnProperty("p2")&&!0===this.config.p2&&b.Physics.hasOwnProperty("P2")&&(this.p2=new b.Physics.P2(this.game,this.config));this.config.hasOwnProperty("box2d")&&!0===this.config.box2d&&b.Physics.hasOwnProperty("BOX2D")&&(this.box2d=new b.Physics.BOX2D(this.game,this.config));this.config.hasOwnProperty("matter")&&!0===this.config.matter&&b.Physics.hasOwnProperty("Matter")&&(this.matter=new b.Physics.Matter(this.game,
this.config))},startSystem:function(a){a===b.Physics.ARCADE?this.arcade=new b.Physics.Arcade(this.game):a===b.Physics.P2JS?null===this.p2?this.p2=new b.Physics.P2(this.game,this.config):this.p2.reset():a===b.Physics.NINJA?this.ninja=new b.Physics.Ninja(this.game):a===b.Physics.BOX2D?null===this.box2d?this.box2d=new b.Physics.Box2D(this.game,this.config):this.box2d.reset():a===b.Physics.MATTERJS&&(null===this.matter?this.matter=new b.Physics.Matter(this.game,this.config):this.matter.reset())},enable:function(a,
c,d){void 0===c&&(c=b.Physics.ARCADE);void 0===d&&(d=!1);c===b.Physics.ARCADE?this.arcade.enable(a):c===b.Physics.P2JS&&this.p2?this.p2.enable(a,d):c===b.Physics.NINJA&&this.ninja?this.ninja.enableAABB(a):c===b.Physics.BOX2D&&this.box2d?this.box2d.enable(a):c===b.Physics.MATTERJS&&this.matter&&this.matter.enable(a)},preUpdate:function(){this.p2&&this.p2.preUpdate();this.box2d&&this.box2d.preUpdate();this.matter&&this.matter.preUpdate()},update:function(){this.p2&&this.p2.update();this.box2d&&this.box2d.update();
this.matter&&this.matter.update()},setBoundsToWorld:function(){this.arcade&&this.arcade.setBoundsToWorld();this.ninja&&this.ninja.setBoundsToWorld();this.p2&&this.p2.setBoundsToWorld();this.box2d&&this.box2d.setBoundsToWorld();this.matter&&this.matter.setBoundsToWorld()},clear:function(){this.p2&&this.p2.clear();this.box2d&&this.box2d.clear();this.matter&&this.matter.clear()},reset:function(){this.p2&&this.p2.reset();this.box2d&&this.box2d.reset();this.matter&&this.matter.reset()},destroy:function(){this.p2&&
this.p2.destroy();this.box2d&&this.box2d.destroy();this.matter&&this.matter.destroy();this.matter=this.box2d=this.p2=this.ninja=this.arcade=null}};b.Physics.prototype.constructor=b.Physics;b.Physics.Arcade=function(a){this.game=a;this.gravity=new b.Point;this.bounds=new b.Rectangle(0,0,a.world.width,a.world.height);this.checkCollision={up:!0,down:!0,left:!0,right:!0};this.maxObjects=10;this.OVERLAP_BIAS=this.maxLevels=4;this.forceX=!1;this.sortDirection=b.Physics.Arcade.LEFT_RIGHT;this.skipQuadTree=
!0;this.isPaused=!1;this.quadTree=new b.QuadTree(this.game.world.bounds.x,this.game.world.bounds.y,this.game.world.bounds.width,this.game.world.bounds.height,this.maxObjects,this.maxLevels);this._total=0;this.setBoundsToWorld()};b.Physics.Arcade.prototype.constructor=b.Physics.Arcade;b.Physics.Arcade.SORT_NONE=0;b.Physics.Arcade.LEFT_RIGHT=1;b.Physics.Arcade.RIGHT_LEFT=2;b.Physics.Arcade.TOP_BOTTOM=3;b.Physics.Arcade.BOTTOM_TOP=4;b.Physics.Arcade.prototype={setBounds:function(a,b,d,e){this.bounds.setTo(a,
b,d,e)},setBoundsToWorld:function(){this.bounds.copyFrom(this.game.world.bounds)},enable:function(a,c){void 0===c&&(c=!0);var d=1;if(Array.isArray(a))for(d=a.length;d--;)a[d]instanceof b.Group?this.enable(a[d].children,c):(this.enableBody(a[d]),c&&a[d].hasOwnProperty("children")&&0<a[d].children.length&&this.enable(a[d],!0));else a instanceof b.Group?this.enable(a.children,c):(this.enableBody(a),c&&a.hasOwnProperty("children")&&0<a.children.length&&this.enable(a.children,!0))},enableBody:function(a){a.hasOwnProperty("body")&&
null===a.body&&(a.body=new b.Physics.Arcade.Body(a),a.parent&&a.parent instanceof b.Group&&a.parent.addToHash(a))},updateMotion:function(a){var b=this.computeVelocity(0,a,a.angularVelocity,a.angularAcceleration,a.angularDrag,a.maxAngular)-a.angularVelocity;a.angularVelocity+=b;a.rotation+=a.angularVelocity*this.game.time.physicsElapsed;a.velocity.x=this.computeVelocity(1,a,a.velocity.x,a.acceleration.x,a.drag.x,a.maxVelocity.x);a.velocity.y=this.computeVelocity(2,a,a.velocity.y,a.acceleration.y,a.drag.y,
a.maxVelocity.y)},computeVelocity:function(a,b,d,e,g,l){void 0===l&&(l=1E4);1===a&&b.allowGravity?d+=(this.gravity.x+b.gravity.x)*this.game.time.physicsElapsed:2===a&&b.allowGravity&&(d+=(this.gravity.y+b.gravity.y)*this.game.time.physicsElapsed);e?d+=e*this.game.time.physicsElapsed:g&&(g*=this.game.time.physicsElapsed,d=0<d-g?d-g:0>d+g?d+g:0);d>l?d=l:d<-l&&(d=-l);return d},overlap:function(a,b,d,e,g){d=d||null;e=e||null;g=g||d;this._total=0;if(!Array.isArray(a)&&Array.isArray(b))for(var l=0;l<b.length;l++)this.collideHandler(a,
b[l],d,e,g,!0);else if(Array.isArray(a)&&!Array.isArray(b))for(l=0;l<a.length;l++)this.collideHandler(a[l],b,d,e,g,!0);else if(Array.isArray(a)&&Array.isArray(b))for(l=0;l<a.length;l++)for(var f=0;f<b.length;f++)this.collideHandler(a[l],b[f],d,e,g,!0);else this.collideHandler(a,b,d,e,g,!0);return 0<this._total},collide:function(a,b,d,e,g){d=d||null;e=e||null;g=g||d;this._total=0;if(!Array.isArray(a)&&Array.isArray(b))for(var l=0;l<b.length;l++)this.collideHandler(a,b[l],d,e,g,!1);else if(Array.isArray(a)&&
!Array.isArray(b))for(l=0;l<a.length;l++)this.collideHandler(a[l],b,d,e,g,!1);else if(Array.isArray(a)&&Array.isArray(b))for(l=0;l<a.length;l++)for(var f=0;f<b.length;f++)this.collideHandler(a[l],b[f],d,e,g,!1);else this.collideHandler(a,b,d,e,g,!1);return 0<this._total},sortLeftRight:function(a,b){return a.body&&b.body?a.body.x-b.body.x:0},sortRightLeft:function(a,b){return a.body&&b.body?b.body.x-a.body.x:0},sortTopBottom:function(a,b){return a.body&&b.body?a.body.y-b.body.y:0},sortBottomTop:function(a,
b){return a.body&&b.body?b.body.y-a.body.y:0},sort:function(a,c){null!==a.physicsSortDirection?c=a.physicsSortDirection:void 0===c&&(c=this.sortDirection);c===b.Physics.Arcade.LEFT_RIGHT?a.hash.sort(this.sortLeftRight):c===b.Physics.Arcade.RIGHT_LEFT?a.hash.sort(this.sortRightLeft):c===b.Physics.Arcade.TOP_BOTTOM?a.hash.sort(this.sortTopBottom):c===b.Physics.Arcade.BOTTOM_TOP&&a.hash.sort(this.sortBottomTop)},collideHandler:function(a,c,d,e,g,l){void 0===c&&a.physicsType===b.GROUP?(this.sort(a),this.collideGroupVsSelf(a,
d,e,g,l)):a&&c&&a.exists&&c.exists&&(this.sortDirection!==b.Physics.Arcade.SORT_NONE&&(a.physicsType===b.GROUP&&this.sort(a),c.physicsType===b.GROUP&&this.sort(c)),a.physicsType===b.SPRITE?c.physicsType===b.SPRITE?this.collideSpriteVsSprite(a,c,d,e,g,l):c.physicsType===b.GROUP?this.collideSpriteVsGroup(a,c,d,e,g,l):c.physicsType===b.TILEMAPLAYER&&this.collideSpriteVsTilemapLayer(a,c,d,e,g,l):a.physicsType===b.GROUP?c.physicsType===b.SPRITE?this.collideSpriteVsGroup(c,a,d,e,g,l):c.physicsType===b.GROUP?
this.collideGroupVsGroup(a,c,d,e,g,l):c.physicsType===b.TILEMAPLAYER&&this.collideGroupVsTilemapLayer(a,c,d,e,g,l):a.physicsType===b.TILEMAPLAYER&&(c.physicsType===b.SPRITE?this.collideSpriteVsTilemapLayer(c,a,d,e,g,l):c.physicsType===b.GROUP&&this.collideGroupVsTilemapLayer(c,a,d,e,g,l)))},collideSpriteVsSprite:function(a,b,d,e,g,l){if(!a.body||!b.body)return!1;this.separate(a.body,b.body,e,g,l)&&(d&&d.call(g,a,b),this._total++);return!0},collideSpriteVsGroup:function(a,c,d,e,g,l){if(0!==c.length&&
a.body){var f;if(this.skipQuadTree||a.body.skipQuadTree)for(var h=0;h<c.hash.length;h++){if(c.hash[h]&&c.hash[h].exists&&c.hash[h].body){f=c.hash[h].body;if(this.sortDirection===b.Physics.Arcade.LEFT_RIGHT)if(a.body.right<f.x)break;else{if(f.right<a.body.x)continue}else if(this.sortDirection===b.Physics.Arcade.RIGHT_LEFT)if(a.body.x>f.right)break;else{if(f.x>a.body.right)continue}else if(this.sortDirection===b.Physics.Arcade.TOP_BOTTOM)if(a.body.bottom<f.y)break;else{if(f.bottom<a.body.y)continue}else if(this.sortDirection===
b.Physics.Arcade.BOTTOM_TOP)if(a.body.y>f.bottom)break;else if(f.y>a.body.bottom)continue;this.collideSpriteVsSprite(a,c.hash[h],d,e,g,l)}}else for(this.quadTree.clear(),this.quadTree.reset(this.game.world.bounds.x,this.game.world.bounds.y,this.game.world.bounds.width,this.game.world.bounds.height,this.maxObjects,this.maxLevels),this.quadTree.populate(c),c=this.quadTree.retrieve(a),h=0;h<c.length;h++)this.separate(a.body,c[h],e,g,l)&&(d&&d.call(g,a,c[h].sprite),this._total++)}},collideGroupVsSelf:function(a,
c,d,e,g){if(0!==a.length)for(var l=0;l<a.hash.length;l++)if(a.hash[l]&&a.hash[l].exists&&a.hash[l].body)for(var f=a.hash[l],h=l+1;h<a.hash.length;h++)if(a.hash[h]&&a.hash[h].exists&&a.hash[h].body){var k=a.hash[h];if(this.sortDirection===b.Physics.Arcade.LEFT_RIGHT)if(f.body.right<k.body.x)break;else{if(k.body.right<f.body.x)continue}else if(this.sortDirection===b.Physics.Arcade.RIGHT_LEFT)if(f.body.x>k.body.right)continue;else{if(k.body.x>f.body.right)break}else if(this.sortDirection===b.Physics.Arcade.TOP_BOTTOM)if(f.body.bottom<
k.body.y)continue;else{if(k.body.bottom<f.body.y)break}else if(this.sortDirection===b.Physics.Arcade.BOTTOM_TOP)if(f.body.y>k.body.bottom)continue;else if(k.body.y>f.body.bottom)break;this.collideSpriteVsSprite(f,k,c,d,e,g)}},collideGroupVsGroup:function(a,c,d,e,g,l){if(0!==a.length&&0!==c.length)for(var f=0;f<a.children.length;f++)a.children[f].exists&&(a.children[f].physicsType===b.GROUP?this.collideGroupVsGroup(a.children[f],c,d,e,g,l):this.collideSpriteVsGroup(a.children[f],c,d,e,g,l))},separate:function(a,
b,d,e,g){if(!a.enable||!b.enable||!this.intersects(a,b)||d&&!1===d.call(e,a.sprite,b.sprite))return!1;d=!1;d=this.forceX||Math.abs(this.gravity.y+a.gravity.y)<Math.abs(this.gravity.x+a.gravity.x)?this.separateX(a,b,g)||this.separateY(a,b,g):this.separateY(a,b,g)||this.separateX(a,b,g);return g?!0:d},intersects:function(a,b){return a.right<=b.position.x||a.bottom<=b.position.y||a.position.x>=b.right||a.position.y>=b.bottom?!1:!0},separateX:function(a,b,d){if(a.immovable&&b.immovable)return!1;var e=
0;if(this.intersects(a,b)){var g=a.deltaAbsX()+b.deltaAbsX()+this.OVERLAP_BIAS;0===a.deltaX()&&0===b.deltaX()?(a.embedded=!0,b.embedded=!0):a.deltaX()>b.deltaX()?(e=a.right-b.x,e>g||!1===a.checkCollision.right||!1===b.checkCollision.left?e=0:(a.touching.none=!1,a.touching.right=!0,b.touching.none=!1,b.touching.left=!0)):a.deltaX()<b.deltaX()&&(e=a.x-b.width-b.x,-e>g||!1===a.checkCollision.left||!1===b.checkCollision.right?e=0:(a.touching.none=!1,a.touching.left=!0,b.touching.none=!1,b.touching.right=
!0));a.overlapX=e;b.overlapX=e;if(0!==e){if(d||a.customSeparateX||b.customSeparateX)return!0;d=a.velocity.x;g=b.velocity.x;a.immovable||b.immovable?a.immovable?b.immovable||(b.x+=e,b.velocity.x=d-g*b.bounce.x,a.moves&&(b.y+=(a.y-a.prev.y)*a.friction.y)):(a.x-=e,a.velocity.x=g-d*a.bounce.x,b.moves&&(a.y+=(b.y-b.prev.y)*b.friction.y)):(e*=.5,a.x-=e,b.x+=e,e=Math.sqrt(g*g*b.mass/a.mass)*(0<g?1:-1),d=Math.sqrt(d*d*a.mass/b.mass)*(0<d?1:-1),g=.5*(e+d),a.velocity.x=g+(e-g)*a.bounce.x,b.velocity.x=g+(d-
g)*b.bounce.x);return!0}}return!1},separateY:function(a,b,d){if(a.immovable&&b.immovable)return!1;var e=0;if(this.intersects(a,b)){var g=a.deltaAbsY()+b.deltaAbsY()+this.OVERLAP_BIAS;0===a.deltaY()&&0===b.deltaY()?(a.embedded=!0,b.embedded=!0):a.deltaY()>b.deltaY()?(e=a.bottom-b.y,e>g||!1===a.checkCollision.down||!1===b.checkCollision.up?e=0:(a.touching.none=!1,a.touching.down=!0,b.touching.none=!1,b.touching.up=!0)):a.deltaY()<b.deltaY()&&(e=a.y-b.bottom,-e>g||!1===a.checkCollision.up||!1===b.checkCollision.down?
e=0:(a.touching.none=!1,a.touching.up=!0,b.touching.none=!1,b.touching.down=!0));a.overlapY=e;b.overlapY=e;if(0!==e){if(d||a.customSeparateY||b.customSeparateY)return!0;d=a.velocity.y;g=b.velocity.y;a.immovable||b.immovable?a.immovable?b.immovable||(b.y+=e,b.velocity.y=d-g*b.bounce.y,a.moves&&(b.x+=(a.x-a.prev.x)*a.friction.x)):(a.y-=e,a.velocity.y=g-d*a.bounce.y,b.moves&&(a.x+=(b.x-b.prev.x)*b.friction.x)):(e*=.5,a.y-=e,b.y+=e,e=Math.sqrt(g*g*b.mass/a.mass)*(0<g?1:-1),d=Math.sqrt(d*d*a.mass/b.mass)*
(0<d?1:-1),g=.5*(e+d),a.velocity.y=g+(e-g)*a.bounce.y,b.velocity.y=g+(d-g)*b.bounce.y);return!0}}return!1},getObjectsUnderPointer:function(a,b,d,e){if(0!==b.length&&a.exists)return this.getObjectsAtLocation(a.x,a.y,b,d,e,a)},getObjectsAtLocation:function(a,c,d,e,g,l){this.quadTree.clear();this.quadTree.reset(this.game.world.bounds.x,this.game.world.bounds.y,this.game.world.bounds.width,this.game.world.bounds.height,this.maxObjects,this.maxLevels);this.quadTree.populate(d);var f=new b.Rectangle(a,
c,1,1);d=[];for(var f=this.quadTree.retrieve(f),h=0;h<f.length;h++)f[h].hitTest(a,c)&&(e&&e.call(g,l,f[h].sprite),d.push(f[h].sprite));return d},moveToObject:function(a,b,d,e){void 0===d&&(d=60);void 0===e&&(e=0);var g=Math.atan2(b.y-a.y,b.x-a.x);0<e&&(d=this.distanceBetween(a,b)/(e/1E3));a.body.velocity.x=Math.cos(g)*d;a.body.velocity.y=Math.sin(g)*d;return g},moveToPointer:function(a,b,d,e){void 0===b&&(b=60);d=d||this.game.input.activePointer;void 0===e&&(e=0);var g=this.angleToPointer(a,d);0<
e&&(b=this.distanceToPointer(a,d)/(e/1E3));a.body.velocity.x=Math.cos(g)*b;a.body.velocity.y=Math.sin(g)*b;return g},moveToXY:function(a,b,d,e,g){void 0===e&&(e=60);void 0===g&&(g=0);var l=Math.atan2(d-a.y,b-a.x);0<g&&(e=this.distanceToXY(a,b,d)/(g/1E3));a.body.velocity.x=Math.cos(l)*e;a.body.velocity.y=Math.sin(l)*e;return l},velocityFromAngle:function(a,c,d){void 0===c&&(c=60);d=d||new b.Point;return d.setTo(Math.cos(this.game.math.degToRad(a))*c,Math.sin(this.game.math.degToRad(a))*c)},velocityFromRotation:function(a,
c,d){void 0===c&&(c=60);d=d||new b.Point;return d.setTo(Math.cos(a)*c,Math.sin(a)*c)},accelerationFromRotation:function(a,c,d){void 0===c&&(c=60);d=d||new b.Point;return d.setTo(Math.cos(a)*c,Math.sin(a)*c)},accelerateToObject:function(a,b,d,e,g){void 0===d&&(d=60);void 0===e&&(e=1E3);void 0===g&&(g=1E3);b=this.angleBetween(a,b);a.body.acceleration.setTo(Math.cos(b)*d,Math.sin(b)*d);a.body.maxVelocity.setTo(e,g);return b},accelerateToPointer:function(a,b,d,e,g){void 0===d&&(d=60);void 0===b&&(b=this.game.input.activePointer);
void 0===e&&(e=1E3);void 0===g&&(g=1E3);b=this.angleToPointer(a,b);a.body.acceleration.setTo(Math.cos(b)*d,Math.sin(b)*d);a.body.maxVelocity.setTo(e,g);return b},accelerateToXY:function(a,b,d,e,g,l){void 0===e&&(e=60);void 0===g&&(g=1E3);void 0===l&&(l=1E3);b=this.angleToXY(a,b,d);a.body.acceleration.setTo(Math.cos(b)*e,Math.sin(b)*e);a.body.maxVelocity.setTo(g,l);return b},distanceBetween:function(a,b){var d=a.x-b.x,e=a.y-b.y;return Math.sqrt(d*d+e*e)},distanceToXY:function(a,b,d){b=a.x-b;a=a.y-
d;return Math.sqrt(b*b+a*a)},distanceToPointer:function(a,b){b=b||this.game.input.activePointer;var d=a.x-b.worldX,e=a.y-b.worldY;return Math.sqrt(d*d+e*e)},angleBetween:function(a,b){return Math.atan2(b.y-a.y,b.x-a.x)},angleToXY:function(a,b,d){return Math.atan2(d-a.y,b-a.x)},angleToPointer:function(a,b){b=b||this.game.input.activePointer;return Math.atan2(b.worldY-a.y,b.worldX-a.x)}};b.Physics.Arcade.Body=function(a){this.sprite=a;this.game=a.game;this.type=b.Physics.ARCADE;this.enable=!0;this.offset=
new b.Point;this.position=new b.Point(a.x,a.y);this.prev=new b.Point(this.position.x,this.position.y);this.allowRotation=!0;this.preRotation=this.rotation=a.rotation;this.width=a.width;this.height=a.height;this.sourceWidth=a.width;this.sourceHeight=a.height;a.texture&&(this.sourceWidth=a.texture.frame.width,this.sourceHeight=a.texture.frame.height);this.halfWidth=Math.abs(a.width/2);this.halfHeight=Math.abs(a.height/2);this.center=new b.Point(a.x+this.halfWidth,a.y+this.halfHeight);this.velocity=
new b.Point;this.newVelocity=new b.Point(0,0);this.deltaMax=new b.Point(0,0);this.acceleration=new b.Point;this.drag=new b.Point;this.allowGravity=!0;this.gravity=new b.Point(0,0);this.bounce=new b.Point;this.maxVelocity=new b.Point(1E4,1E4);this.friction=new b.Point(1,0);this.angularDrag=this.angularAcceleration=this.angularVelocity=0;this.maxAngular=1E3;this.mass=1;this.speed=this.angle=0;this.facing=b.NONE;this.immovable=!1;this.moves=!0;this.customSeparateY=this.customSeparateX=!1;this.overlapY=
this.overlapX=0;this.collideWorldBounds=this.embedded=!1;this.checkCollision={none:!1,any:!0,up:!0,down:!0,left:!0,right:!0};this.touching={none:!0,up:!1,down:!1,left:!1,right:!1};this.wasTouching={none:!0,up:!1,down:!1,left:!1,right:!1};this.blocked={up:!1,down:!1,left:!1,right:!1};this.tilePadding=new b.Point;this.syncBounds=this.skipQuadTree=this.dirty=!1;this._reset=!0;this._sx=a.scale.x;this._sy=a.scale.y;this._dy=this._dx=0};b.Physics.Arcade.Body.prototype={updateBounds:function(){if(this.syncBounds){var a=
this.sprite.getBounds();a.ceilAll();if(a.width!==this.width||a.height!==this.height)this.width=a.width,this.height=a.height,this._reset=!0}else{var a=Math.abs(this.sprite.scale.x),b=Math.abs(this.sprite.scale.y);if(a!==this._sx||b!==this._sy)this.width=this.sourceWidth*a,this.height=this.sourceHeight*b,this._sx=a,this._sy=b,this._reset=!0}this._reset&&(this.halfWidth=Math.floor(this.width/2),this.halfHeight=Math.floor(this.height/2),this.center.setTo(this.position.x+this.halfWidth,this.position.y+
this.halfHeight))},preUpdate:function(){if(this.enable&&!this.game.physics.arcade.isPaused){this.dirty=!0;this.wasTouching.none=this.touching.none;this.wasTouching.up=this.touching.up;this.wasTouching.down=this.touching.down;this.wasTouching.left=this.touching.left;this.wasTouching.right=this.touching.right;this.touching.none=!0;this.touching.up=!1;this.touching.down=!1;this.touching.left=!1;this.touching.right=!1;this.blocked.up=!1;this.blocked.down=!1;this.blocked.left=!1;this.embedded=this.blocked.right=
!1;this.updateBounds();this.position.x=this.sprite.world.x-this.sprite.anchor.x*this.width+this.offset.x;this.position.y=this.sprite.world.y-this.sprite.anchor.y*this.height+this.offset.y;this.preRotation=this.rotation=this.sprite.angle;if(this._reset||this.sprite.fresh)this.prev.x=this.position.x,this.prev.y=this.position.y;if(this.moves){this.game.physics.arcade.updateMotion(this);this.newVelocity.set(this.velocity.x*this.game.time.physicsElapsed,this.velocity.y*this.game.time.physicsElapsed);this.position.x+=
this.newVelocity.x;this.position.y+=this.newVelocity.y;if(this.position.x!==this.prev.x||this.position.y!==this.prev.y)this.speed=Math.sqrt(this.velocity.x*this.velocity.x+this.velocity.y*this.velocity.y),this.angle=Math.atan2(this.velocity.y,this.velocity.x);this.collideWorldBounds&&this.checkWorldBounds()}this._dx=this.deltaX();this._dy=this.deltaY();this._reset=!1}},postUpdate:function(){this.enable&&this.dirty&&(this.dirty=!1,0>this.deltaX()?this.facing=b.LEFT:0<this.deltaX()&&(this.facing=b.RIGHT),
0>this.deltaY()?this.facing=b.UP:0<this.deltaY()&&(this.facing=b.DOWN),this.moves&&(this._dx=this.deltaX(),this._dy=this.deltaY(),0!==this.deltaMax.x&&0!==this._dx&&(0>this._dx&&this._dx<-this.deltaMax.x?this._dx=-this.deltaMax.x:0<this._dx&&this._dx>this.deltaMax.x&&(this._dx=this.deltaMax.x)),0!==this.deltaMax.y&&0!==this._dy&&(0>this._dy&&this._dy<-this.deltaMax.y?this._dy=-this.deltaMax.y:0<this._dy&&this._dy>this.deltaMax.y&&(this._dy=this.deltaMax.y)),this.sprite.position.x+=this._dx,this.sprite.position.y+=
this._dy,this._reset=!0),this.center.setTo(this.position.x+this.halfWidth,this.position.y+this.halfHeight),this.allowRotation&&(this.sprite.angle+=this.deltaZ()),this.prev.x=this.position.x,this.prev.y=this.position.y)},destroy:function(){this.sprite.parent&&this.sprite.parent instanceof b.Group&&this.sprite.parent.removeFromHash(this.sprite);this.sprite=this.sprite.body=null},checkWorldBounds:function(){var a=this.position,b=this.game.physics.arcade.bounds,d=this.game.physics.arcade.checkCollision;
a.x<b.x&&d.left?(a.x=b.x,this.velocity.x*=-this.bounce.x,this.blocked.left=!0):this.right>b.right&&d.right&&(a.x=b.right-this.width,this.velocity.x*=-this.bounce.x,this.blocked.right=!0);a.y<b.y&&d.up?(a.y=b.y,this.velocity.y*=-this.bounce.y,this.blocked.up=!0):this.bottom>b.bottom&&d.down&&(a.y=b.bottom-this.height,this.velocity.y*=-this.bounce.y,this.blocked.down=!0)},setSize:function(a,b,d,e){void 0===d&&(d=this.offset.x);void 0===e&&(e=this.offset.y);this.sourceWidth=a;this.sourceHeight=b;this.width=
this.sourceWidth*this._sx;this.height=this.sourceHeight*this._sy;this.halfWidth=Math.floor(this.width/2);this.halfHeight=Math.floor(this.height/2);this.offset.setTo(d,e);this.center.setTo(this.position.x+this.halfWidth,this.position.y+this.halfHeight)},reset:function(a,b){this.velocity.set(0);this.acceleration.set(0);this.angularAcceleration=this.angularVelocity=this.speed=0;this.position.x=a-this.sprite.anchor.x*this.width+this.offset.x;this.position.y=b-this.sprite.anchor.y*this.height+this.offset.y;
this.prev.x=this.position.x;this.prev.y=this.position.y;this.preRotation=this.rotation=this.sprite.angle;this._sx=this.sprite.scale.x;this._sy=this.sprite.scale.y;this.center.setTo(this.position.x+this.halfWidth,this.position.y+this.halfHeight)},hitTest:function(a,c){return b.Rectangle.contains(this,a,c)},onFloor:function(){return this.blocked.down},onWall:function(){return this.blocked.left||this.blocked.right},deltaAbsX:function(){return 0<this.deltaX()?this.deltaX():-this.deltaX()},deltaAbsY:function(){return 0<
this.deltaY()?this.deltaY():-this.deltaY()},deltaX:function(){return this.position.x-this.prev.x},deltaY:function(){return this.position.y-this.prev.y},deltaZ:function(){return this.rotation-this.preRotation}};Object.defineProperty(b.Physics.Arcade.Body.prototype,"bottom",{get:function(){return this.position.y+this.height}});Object.defineProperty(b.Physics.Arcade.Body.prototype,"right",{get:function(){return this.position.x+this.width}});Object.defineProperty(b.Physics.Arcade.Body.prototype,"x",{get:function(){return this.position.x},
set:function(a){this.position.x=a}});Object.defineProperty(b.Physics.Arcade.Body.prototype,"y",{get:function(){return this.position.y},set:function(a){this.position.y=a}});b.Physics.Arcade.Body.render=function(a,b,d,e){void 0===e&&(e=!0);d=d||"rgba(0,255,0,0.4)";e?(a.fillStyle=d,a.fillRect(b.position.x-b.game.camera.x,b.position.y-b.game.camera.y,b.width,b.height)):(a.strokeStyle=d,a.strokeRect(b.position.x-b.game.camera.x,b.position.y-b.game.camera.y,b.width,b.height))};b.Physics.Arcade.Body.renderBodyInfo=
function(a,b){a.line("x: "+b.x.toFixed(2),"y: "+b.y.toFixed(2),"width: "+b.width,"height: "+b.height);a.line("velocity x: "+b.velocity.x.toFixed(2),"y: "+b.velocity.y.toFixed(2),"deltaX: "+b._dx.toFixed(2),"deltaY: "+b._dy.toFixed(2));a.line("acceleration x: "+b.acceleration.x.toFixed(2),"y: "+b.acceleration.y.toFixed(2),"speed: "+b.speed.toFixed(2),"angle: "+b.angle.toFixed(2));a.line("gravity x: "+b.gravity.x,"y: "+b.gravity.y,"bounce x: "+b.bounce.x.toFixed(2),"y: "+b.bounce.y.toFixed(2));a.line("touching left: "+
b.touching.left,"right: "+b.touching.right,"up: "+b.touching.up,"down: "+b.touching.down);a.line("blocked left: "+b.blocked.left,"right: "+b.blocked.right,"up: "+b.blocked.up,"down: "+b.blocked.down)};b.Physics.Arcade.Body.prototype.constructor=b.Physics.Arcade.Body;b.Physics.Arcade.TilemapCollision=function(){};b.Physics.Arcade.TilemapCollision.prototype={TILE_BIAS:16,collideSpriteVsTilemapLayer:function(a,b,d,e,g,l){if(a.body&&(b=b.getTiles(a.body.position.x-a.body.tilePadding.x,a.body.position.y-
a.body.tilePadding.y,a.body.width+a.body.tilePadding.x,a.body.height+a.body.tilePadding.y,!1,!1),0!==b.length))for(var f=0;f<b.length;f++)e?e.call(g,a,b[f])&&this.separateTile(f,a.body,b[f],l)&&(this._total++,d&&d.call(g,a,b[f])):this.separateTile(f,a.body,b[f],l)&&(this._total++,d&&d.call(g,a,b[f]))},collideGroupVsTilemapLayer:function(a,b,d,e,g,l){if(0!==a.length)for(var f=0;f<a.children.length;f++)a.children[f].exists&&this.collideSpriteVsTilemapLayer(a.children[f],b,d,e,g,l)},separateTile:function(a,
b,d,e){if(!b.enable||!d.intersects(b.position.x,b.position.y,b.right,b.bottom))return!1;if(e)return!0;if(d.collisionCallback&&!d.collisionCallback.call(d.collisionCallbackContext,b.sprite,d)||d.layer.callbacks[d.index]&&!d.layer.callbacks[d.index].callback.call(d.layer.callbacks[d.index].callbackContext,b.sprite,d)||!(d.faceLeft||d.faceRight||d.faceTop||d.faceBottom))return!1;var g=e=a=0,l=1;b.deltaAbsX()>b.deltaAbsY()?g=-1:b.deltaAbsX()<b.deltaAbsY()&&(l=-1);0!==b.deltaX()&&0!==b.deltaY()&&(d.faceLeft||
d.faceRight)&&(d.faceTop||d.faceBottom)&&(g=Math.min(Math.abs(b.position.x-d.right),Math.abs(b.right-d.left)),l=Math.min(Math.abs(b.position.y-d.bottom),Math.abs(b.bottom-d.top)));if(g<l){if(d.faceLeft||d.faceRight)if(a=this.tileCheckX(b,d),0!==a&&!d.intersects(b.position.x,b.position.y,b.right,b.bottom))return!0;if(d.faceTop||d.faceBottom)e=this.tileCheckY(b,d)}else{if(d.faceTop||d.faceBottom)if(e=this.tileCheckY(b,d),0!==e&&!d.intersects(b.position.x,b.position.y,b.right,b.bottom))return!0;if(d.faceLeft||
d.faceRight)a=this.tileCheckX(b,d)}return 0!==a||0!==e},tileCheckX:function(a,b){var d=0;0>a.deltaX()&&!a.blocked.left&&b.collideRight&&a.checkCollision.left?b.faceRight&&a.x<b.right&&(d=a.x-b.right,d<-this.TILE_BIAS&&(d=0)):0<a.deltaX()&&!a.blocked.right&&b.collideLeft&&a.checkCollision.right&&b.faceLeft&&a.right>b.left&&(d=a.right-b.left,d>this.TILE_BIAS&&(d=0));0!==d&&(a.customSeparateX?a.overlapX=d:this.processTileSeparationX(a,d));return d},tileCheckY:function(a,b){var d=0;0>a.deltaY()&&!a.blocked.up&&
b.collideDown&&a.checkCollision.up?b.faceBottom&&a.y<b.bottom&&(d=a.y-b.bottom,d<-this.TILE_BIAS&&(d=0)):0<a.deltaY()&&!a.blocked.down&&b.collideUp&&a.checkCollision.down&&b.faceTop&&a.bottom>b.top&&(d=a.bottom-b.top,d>this.TILE_BIAS&&(d=0));0!==d&&(a.customSeparateY?a.overlapY=d:this.processTileSeparationY(a,d));return d},processTileSeparationX:function(a,b){0>b?a.blocked.left=!0:0<b&&(a.blocked.right=!0);a.position.x-=b;a.velocity.x=0===a.bounce.x?0:-a.velocity.x*a.bounce.x},processTileSeparationY:function(a,
b){0>b?a.blocked.up=!0:0<b&&(a.blocked.down=!0);a.position.y-=b;a.velocity.y=0===a.bounce.y?0:-a.velocity.y*a.bounce.y}};b.Utils.mixinPrototype(b.Physics.Arcade.prototype,b.Physics.Arcade.TilemapCollision.prototype);b.Physics.Ninja=function(a){this.game=a;this.time=this.game.time;this.gravity=.2;this.bounds=new b.Rectangle(0,0,a.world.width,a.world.height);this.maxObjects=10;this.maxLevels=4;this.quadTree=new b.QuadTree(this.game.world.bounds.x,this.game.world.bounds.y,this.game.world.bounds.width,
this.game.world.bounds.height,this.maxObjects,this.maxLevels);this.setBoundsToWorld()};b.Physics.Ninja.prototype.constructor=b.Physics.Ninja;b.Physics.Ninja.prototype={enableAABB:function(a,b){this.enable(a,1,0,0,b)},enableCircle:function(a,b,d){this.enable(a,2,0,b,d)},enableTile:function(a,b,d){this.enable(a,3,b,0,d)},enable:function(a,c,d,e,g){void 0===c&&(c=1);void 0===d&&(d=1);void 0===e&&(e=0);void 0===g&&(g=!0);if(Array.isArray(a))for(var l=a.length;l--;)a[l]instanceof b.Group?this.enable(a[l].children,
c,d,e,g):(this.enableBody(a[l],c,d,e),g&&a[l].hasOwnProperty("children")&&0<a[l].children.length&&this.enable(a[l],c,d,e,!0));else a instanceof b.Group?this.enable(a.children,c,d,e,g):(this.enableBody(a,c,d,e),g&&a.hasOwnProperty("children")&&0<a.children.length&&this.enable(a.children,c,d,e,!0))},enableBody:function(a,c,d,e){a.hasOwnProperty("body")&&null===a.body&&(a.body=new b.Physics.Ninja.Body(this,a,c,d,e),a.anchor.set(.5))},setBounds:function(a,b,d,e){this.bounds.setTo(a,b,d,e)},setBoundsToWorld:function(){this.bounds.setTo(this.game.world.bounds.x,
this.game.world.bounds.y,this.game.world.bounds.width,this.game.world.bounds.height)},clearTilemapLayerBodies:function(a,b){b=a.getLayer(b);for(var d=a.layers[b].bodies.length;d--;)a.layers[b].bodies[d].destroy();a.layers[b].bodies.length=[]},convertTilemap:function(a,c,d){c=a.getLayer(c);this.clearTilemapLayerBodies(a,c);for(var e=0,g=a.layers[c].height;e<g;e++)for(var l=0,f=a.layers[c].width;l<f;l++){var h=a.layers[c].data[e][l];h&&d.hasOwnProperty(h.index)&&(h=new b.Physics.Ninja.Body(this,null,
3,d[h.index],0,h.worldX+h.centerX,h.worldY+h.centerY,h.width,h.height),a.layers[c].bodies.push(h))}return a.layers[c].bodies},overlap:function(a,b,d,e,g){d=d||null;e=e||null;g=g||d;this._result=!1;this._total=0;if(Array.isArray(b))for(var l=0,f=b.length;l<f;l++)this.collideHandler(a,b[l],d,e,g,!0);else this.collideHandler(a,b,d,e,g,!0);return 0<this._total},collide:function(a,b,d,e,g){d=d||null;e=e||null;g=g||d;this._result=!1;this._total=0;if(Array.isArray(b))for(var l=0,f=b.length;l<f;l++)this.collideHandler(a,
b[l],d,e,g,!1);else this.collideHandler(a,b,d,e,g,!1);return 0<this._total},collideHandler:function(a,c,d,e,g,l){void 0!==c||a.type!==b.GROUP&&a.type!==b.EMITTER?a&&c&&a.exists&&c.exists&&(a.type==b.SPRITE||a.type==b.TILESPRITE?c.type==b.SPRITE||c.type==b.TILESPRITE?this.collideSpriteVsSprite(a,c,d,e,g,l):c.type==b.GROUP||c.type==b.EMITTER?this.collideSpriteVsGroup(a,c,d,e,g,l):c.type==b.TILEMAPLAYER&&this.collideSpriteVsTilemapLayer(a,c,d,e,g):a.type==b.GROUP?c.type==b.SPRITE||c.type==b.TILESPRITE?
this.collideSpriteVsGroup(c,a,d,e,g,l):c.type==b.GROUP||c.type==b.EMITTER?this.collideGroupVsGroup(a,c,d,e,g,l):c.type==b.TILEMAPLAYER&&this.collideGroupVsTilemapLayer(a,c,d,e,g):a.type==b.TILEMAPLAYER?c.type==b.SPRITE||c.type==b.TILESPRITE?this.collideSpriteVsTilemapLayer(c,a,d,e,g):c.type!=b.GROUP&&c.type!=b.EMITTER||this.collideGroupVsTilemapLayer(c,a,d,e,g):a.type==b.EMITTER&&(c.type==b.SPRITE||c.type==b.TILESPRITE?this.collideSpriteVsGroup(c,a,d,e,g,l):c.type==b.GROUP||c.type==b.EMITTER?this.collideGroupVsGroup(a,
c,d,e,g,l):c.type==b.TILEMAPLAYER&&this.collideGroupVsTilemapLayer(a,c,d,e,g))):this.collideGroupVsSelf(a,d,e,g,l)},collideSpriteVsSprite:function(a,b,d,e,g,l){this.separate(a.body,b.body,e,g,l)&&(d&&d.call(g,a,b),this._total++)},collideSpriteVsGroup:function(a,b,d,e,g,l){if(0!==b.length)for(var f=0,h=b.children.length;f<h;f++)b.children[f].exists&&b.children[f].body&&this.separate(a.body,b.children[f].body,e,g,l)&&(d&&d.call(g,a,b.children[f]),this._total++)},collideGroupVsSelf:function(a,b,d,e,
g){if(0!==a.length)for(var l=a.children.length,f=0;f<l;f++)for(var h=f+1;h<=l;h++)a.children[f]&&a.children[h]&&a.children[f].exists&&a.children[h].exists&&this.collideSpriteVsSprite(a.children[f],a.children[h],b,d,e,g)},collideGroupVsGroup:function(a,b,d,e,g,l){if(0!==a.length&&0!==b.length)for(var f=0,h=a.children.length;f<h;f++)a.children[f].exists&&this.collideSpriteVsGroup(a.children[f],b,d,e,g,l)},separate:function(a,c){if(a.type!==b.Physics.NINJA||c.type!==b.Physics.NINJA)return!1;if(a.aabb&&
c.aabb)return a.aabb.collideAABBVsAABB(c.aabb);if(a.aabb&&c.tile)return a.aabb.collideAABBVsTile(c.tile);if(a.tile&&c.aabb)return c.aabb.collideAABBVsTile(a.tile);if(a.circle&&c.tile)return a.circle.collideCircleVsTile(c.tile);if(a.tile&&c.circle)return c.circle.collideCircleVsTile(a.tile)}};b.Physics.Ninja.Body=function(a,c,d,e,g,l,f,h,k){c=c||null;void 0===d&&(d=1);void 0===e&&(e=1);void 0===g&&(g=16);this.sprite=c;this.game=a.game;this.type=b.Physics.NINJA;this.system=a;this.shape=this.circle=
this.tile=this.aabb=null;this.drag=1;this.friction=.05;this.gravityScale=1;this.bounce=.3;this.velocity=new b.Point;this.facing=b.NONE;this.immovable=!1;this.collideWorldBounds=!0;this.checkCollision={none:!1,any:!0,up:!0,down:!0,left:!0,right:!0};this.touching={none:!0,up:!1,down:!1,left:!1,right:!1};this.wasTouching={none:!0,up:!1,down:!1,left:!1,right:!1};this.maxSpeed=8;c&&(l=c.x,f=c.y,h=c.width,k=c.height,0===c.anchor.x&&(l+=.5*c.width),0===c.anchor.y&&(f+=.5*c.height));1===d?this.shape=this.aabb=
new b.Physics.Ninja.AABB(this,l,f,h,k):2===d?this.shape=this.circle=new b.Physics.Ninja.Circle(this,l,f,g):3===d&&(this.shape=this.tile=new b.Physics.Ninja.Tile(this,l,f,h,k,e))};b.Physics.Ninja.Body.prototype={preUpdate:function(){this.wasTouching.none=this.touching.none;this.wasTouching.up=this.touching.up;this.wasTouching.down=this.touching.down;this.wasTouching.left=this.touching.left;this.wasTouching.right=this.touching.right;this.touching.none=!0;this.touching.up=!1;this.touching.down=!1;this.touching.left=
!1;this.touching.right=!1;this.shape.integrate();this.collideWorldBounds&&this.shape.collideWorldBounds()},postUpdate:function(){this.sprite&&(this.sprite.type===b.TILESPRITE?(this.sprite.x=this.shape.pos.x-this.shape.xw,this.sprite.y=this.shape.pos.y-this.shape.yw):(this.sprite.x=this.shape.pos.x,this.sprite.y=this.shape.pos.y));0>this.velocity.x?this.facing=b.LEFT:0<this.velocity.x&&(this.facing=b.RIGHT);0>this.velocity.y?this.facing=b.UP:0<this.velocity.y&&(this.facing=b.DOWN)},setZeroVelocity:function(){this.shape.oldpos.x=
this.shape.pos.x;this.shape.oldpos.y=this.shape.pos.y},moveTo:function(a,b){var d=a*this.game.time.physicsElapsed;b=this.game.math.degToRad(b);this.shape.pos.x=this.shape.oldpos.x+d*Math.cos(b);this.shape.pos.y=this.shape.oldpos.y+d*Math.sin(b)},moveFrom:function(a,b){var d=-a*this.game.time.physicsElapsed;b=this.game.math.degToRad(b);this.shape.pos.x=this.shape.oldpos.x+d*Math.cos(b);this.shape.pos.y=this.shape.oldpos.y+d*Math.sin(b)},moveLeft:function(a){this.shape.pos.x=this.shape.oldpos.x+Math.min(this.maxSpeed,
Math.max(-this.maxSpeed,this.shape.pos.x-this.shape.oldpos.x+-a*this.game.time.physicsElapsed))},moveRight:function(a){this.shape.pos.x=this.shape.oldpos.x+Math.min(this.maxSpeed,Math.max(-this.maxSpeed,this.shape.pos.x-this.shape.oldpos.x+a*this.game.time.physicsElapsed))},moveUp:function(a){this.shape.pos.y=this.shape.oldpos.y+Math.min(this.maxSpeed,Math.max(-this.maxSpeed,this.shape.pos.y-this.shape.oldpos.y+-a*this.game.time.physicsElapsed))},moveDown:function(a){this.shape.pos.y=this.shape.oldpos.y+
Math.min(this.maxSpeed,Math.max(-this.maxSpeed,this.shape.pos.y-this.shape.oldpos.y+a*this.game.time.physicsElapsed))},reset:function(){this.velocity.set(0);this.shape.pos.x=this.sprite.x;this.shape.pos.y=this.sprite.y;this.shape.oldpos.copyFrom(this.shape.pos)},deltaAbsX:function(){return 0<this.deltaX()?this.deltaX():-this.deltaX()},deltaAbsY:function(){return 0<this.deltaY()?this.deltaY():-this.deltaY()},deltaX:function(){return this.shape.pos.x-this.shape.oldpos.x},deltaY:function(){return this.shape.pos.y-
this.shape.oldpos.y},destroy:function(){this.circle=this.tile=this.aabb=this.system=this.sprite=null;this.shape.destroy();this.shape=null}};Object.defineProperty(b.Physics.Ninja.Body.prototype,"x",{get:function(){return this.shape.pos.x},set:function(a){this.shape.pos.x=a}});Object.defineProperty(b.Physics.Ninja.Body.prototype,"y",{get:function(){return this.shape.pos.y},set:function(a){this.shape.pos.y=a}});Object.defineProperty(b.Physics.Ninja.Body.prototype,"width",{get:function(){return this.shape.width}});
Object.defineProperty(b.Physics.Ninja.Body.prototype,"height",{get:function(){return this.shape.height}});Object.defineProperty(b.Physics.Ninja.Body.prototype,"bottom",{get:function(){return this.shape.pos.y+this.shape.yw}});Object.defineProperty(b.Physics.Ninja.Body.prototype,"right",{get:function(){return this.shape.pos.x+this.shape.xw}});Object.defineProperty(b.Physics.Ninja.Body.prototype,"speed",{get:function(){return Math.sqrt(this.shape.velocity.x*this.shape.velocity.x+this.shape.velocity.y*
this.shape.velocity.y)}});Object.defineProperty(b.Physics.Ninja.Body.prototype,"angle",{get:function(){return Math.atan2(this.shape.velocity.y,this.shape.velocity.x)}});b.Physics.Ninja.Body.render=function(a,b,d,e){void 0===e&&(e=!0);(b.aabb||b.circle)&&b.shape.render(a,b.game.camera.x,b.game.camera.y,d||"rgba(0,255,0,0.4)",e)};b.Physics.Ninja.AABB=function(a,c,d,e,g){this.body=a;this.system=a.system;this.pos=new b.Point(c,d);this.oldpos=new b.Point(c,d);this.xw=Math.abs(e/2);this.yw=Math.abs(g/2);
this.width=e;this.height=g;this.oV=this.oH=0;this.velocity=new b.Point;this.aabbTileProjections={};this.aabbTileProjections[b.Physics.Ninja.Tile.TYPE_FULL]=this.projAABB_Full;this.aabbTileProjections[b.Physics.Ninja.Tile.TYPE_45DEG]=this.projAABB_45Deg;this.aabbTileProjections[b.Physics.Ninja.Tile.TYPE_CONCAVE]=this.projAABB_Concave;this.aabbTileProjections[b.Physics.Ninja.Tile.TYPE_CONVEX]=this.projAABB_Convex;this.aabbTileProjections[b.Physics.Ninja.Tile.TYPE_22DEGs]=this.projAABB_22DegS;this.aabbTileProjections[b.Physics.Ninja.Tile.TYPE_22DEGb]=
this.projAABB_22DegB;this.aabbTileProjections[b.Physics.Ninja.Tile.TYPE_67DEGs]=this.projAABB_67DegS;this.aabbTileProjections[b.Physics.Ninja.Tile.TYPE_67DEGb]=this.projAABB_67DegB;this.aabbTileProjections[b.Physics.Ninja.Tile.TYPE_HALF]=this.projAABB_Half};b.Physics.Ninja.AABB.prototype.constructor=b.Physics.Ninja.AABB;b.Physics.Ninja.AABB.COL_NONE=0;b.Physics.Ninja.AABB.COL_AXIS=1;b.Physics.Ninja.AABB.COL_OTHER=2;b.Physics.Ninja.AABB.prototype={integrate:function(){var a=this.pos.x,b=this.pos.y;
this.pos.x+=this.body.drag*this.pos.x-this.body.drag*this.oldpos.x;this.pos.y+=this.body.drag*this.pos.y-this.body.drag*this.oldpos.y+this.system.gravity*this.body.gravityScale;this.velocity.set(this.pos.x-a,this.pos.y-b);this.oldpos.set(a,b)},reportCollision:function(a,b,d,e){var g=this.pos,l=this.oldpos,f=g.x-l.x,h=g.y-l.y,k=f*d+h*e,m=k*d,n=k*e;0>k?(f=(f-m)*this.body.friction,h=(h-n)*this.body.friction,k=1+this.body.bounce,m*=k,n*=k,1===d?this.body.touching.left=!0:-1===d&&(this.body.touching.right=
!0),1===e?this.body.touching.up=!0:-1===e&&(this.body.touching.down=!0)):m=n=f=h=0;g.x+=a;g.y+=b;l.x+=a+m+f;l.y+=b+n+h},reportCollisionVsWorld:function(a,b,d,e){this.reportCollision(a,b,d,e)},reverse:function(){var a=this.pos.x-this.oldpos.x,b=this.pos.y-this.oldpos.y;this.oldpos.x<this.pos.x?this.oldpos.x=this.pos.x+a:this.oldpos.x>this.pos.x&&(this.oldpos.x=this.pos.x-a);this.oldpos.y<this.pos.y?this.oldpos.y=this.pos.y+b:this.oldpos.y>this.pos.y&&(this.oldpos.y=this.pos.y-b)},reportCollisionVsBody:function(a,
b,d,e,g){this.body.immovable&&g.body.immovable?(a*=.5,b*=.5,this.pos.add(a,b),this.oldpos.set(this.pos.x,this.pos.y),g.pos.subtract(a,b),g.oldpos.set(g.pos.x,g.pos.y)):this.body.immovable||g.body.immovable?this.body.immovable?g.body.immovable||g.reportCollision(-a,-b,-d,-e):this.reportCollision(a,b,d,e):(a*=.5,b*=.5,this.reportCollision(a,b,d,e),g.reportCollision(-a,-b,-d,-e))},collideWorldBounds:function(){var a=this.system.bounds.x-(this.pos.x-this.xw);0<a?this.reportCollisionVsWorld(a,0,1,0,null):
(a=this.pos.x+this.xw-this.system.bounds.right,0<a&&this.reportCollisionVsWorld(-a,0,-1,0,null));a=this.system.bounds.y-(this.pos.y-this.yw);0<a?this.reportCollisionVsWorld(0,a,0,1,null):(a=this.pos.y+this.yw-this.system.bounds.bottom,0<a&&this.reportCollisionVsWorld(0,-a,0,-1,null))},collideAABBVsAABB:function(a){var c=this.pos,d=a.pos.y,e=a.yw,g=c.x-a.pos.x,l=a.xw+this.xw-Math.abs(g);return 0<l&&(c=c.y-d,e=e+this.yw-Math.abs(c),0<e)?(l<e?(0>g&&(l*=-1),e=0):0>c?(l=0,e*=-1):l=0,g=Math.sqrt(l*l+e*
e),this.reportCollisionVsBody(l,e,l/g,e/g,a),b.Physics.Ninja.AABB.COL_AXIS):!1},collideAABBVsTile:function(a){var b=this.pos.x-a.pos.x,d=a.xw+this.xw-Math.abs(b);if(0<d){var e=this.pos.y-a.pos.y,g=a.yw+this.yw-Math.abs(e);if(0<g)return d<g?(0>b&&(d*=-1),g=0):0>e?(d=0,g*=-1):d=0,this.resolveTile(d,g,this,a)}return!1},resolveTile:function(a,b,d,e){return 0<e.id?this.aabbTileProjections[e.type](a,b,d,e):!1},projAABB_Full:function(a,c,d,e){var g=Math.sqrt(a*a+c*c);d.reportCollisionVsWorld(a,c,a/g,c/g,
e);return b.Physics.Ninja.AABB.COL_AXIS},projAABB_Half:function(a,c,d,e){var g=e.signx,l=e.signy,f=(d.pos.x-g*d.xw-e.pos.x)*g+(d.pos.y-l*d.yw-e.pos.y)*l;if(0>f){g*=-f;l*=-f;f=Math.sqrt(a*a+c*c);if(f<Math.sqrt(g*g+l*l))return d.reportCollisionVsWorld(a,c,a/f,c/f,e),b.Physics.Ninja.AABB.COL_AXIS;d.reportCollisionVsWorld(g,l,e.signx,e.signy,e);return b.Physics.Ninja.AABB.COL_OTHER}return b.Physics.Ninja.AABB.COL_NONE},projAABB_45Deg:function(a,c,d,e){var g=e.sx,l=e.sy,f=(d.pos.x-e.signx*d.xw-e.pos.x)*
g+(d.pos.y-e.signy*d.yw-e.pos.y)*l;if(0>f){g*=-f;l*=-f;f=Math.sqrt(a*a+c*c);if(f<Math.sqrt(g*g+l*l))return d.reportCollisionVsWorld(a,c,a/f,c/f,e),b.Physics.Ninja.AABB.COL_AXIS;d.reportCollisionVsWorld(g,l,e.sx,e.sy);return b.Physics.Ninja.AABB.COL_OTHER}return b.Physics.Ninja.AABB.COL_NONE},projAABB_22DegS:function(a,c,d,e){var g=e.signx,l=e.signy,f=e.pos.y-(d.pos.y-l*d.yw);if(0<f*l){var h=e.sx,k=e.sy,g=(d.pos.x-g*d.xw-(e.pos.x+g*e.xw))*h+(d.pos.y-l*d.yw-(e.pos.y-l*e.yw))*k;if(0>g){var h=h*-g,k=
k*-g,g=Math.sqrt(h*h+k*k),l=Math.sqrt(a*a+c*c),m=Math.abs(f);if(l<g){if(m<l)return d.reportCollisionVsWorld(0,f,0,f/m,e),b.Physics.Ninja.AABB.COL_OTHER;d.reportCollisionVsWorld(a,c,a/l,c/l,e);return b.Physics.Ninja.AABB.COL_AXIS}m<g?d.reportCollisionVsWorld(0,f,0,f/m,e):d.reportCollisionVsWorld(h,k,e.sx,e.sy,e);return b.Physics.Ninja.AABB.COL_OTHER}}return b.Physics.Ninja.AABB.COL_NONE},projAABB_22DegB:function(a,c,d,e){var g=e.signx,l=e.signy,f=e.sx,h=e.sy,g=(d.pos.x-g*d.xw-(e.pos.x-g*e.xw))*f+(d.pos.y-
l*d.yw-(e.pos.y+l*e.yw))*h;if(0>g){f*=-g;h*=-g;g=Math.sqrt(a*a+c*c);if(g<Math.sqrt(f*f+h*h))return d.reportCollisionVsWorld(a,c,a/g,c/g,e),b.Physics.Ninja.AABB.COL_AXIS;d.reportCollisionVsWorld(f,h,e.sx,e.sy,e);return b.Physics.Ninja.AABB.COL_OTHER}return b.Physics.Ninja.AABB.COL_NONE},projAABB_67DegS:function(a,c,d,e){var g=e.signx,l=e.signy,f=e.pos.x-(d.pos.x-g*d.xw);if(0<f*g){var h=e.sx,k=e.sy,g=(d.pos.x-g*d.xw-(e.pos.x-g*e.xw))*h+(d.pos.y-l*d.yw-(e.pos.y+l*e.yw))*k;if(0>g){var h=h*-g,k=k*-g,g=
Math.sqrt(h*h+k*k),l=Math.sqrt(a*a+c*c),m=Math.abs(f);if(l<g){if(m<l)return d.reportCollisionVsWorld(f,0,f/m,0,e),b.Physics.Ninja.AABB.COL_OTHER;d.reportCollisionVsWorld(a,c,a/l,c/l,e);return b.Physics.Ninja.AABB.COL_AXIS}m<g?d.reportCollisionVsWorld(f,0,f/m,0,e):d.reportCollisionVsWorld(h,k,e.sx,e.sy,e);return b.Physics.Ninja.AABB.COL_OTHER}}return b.Physics.Ninja.AABB.COL_NONE},projAABB_67DegB:function(a,c,d,e){var g=e.signx,l=e.signy,f=e.sx,h=e.sy,g=(d.pos.x-g*d.xw-(e.pos.x+g*e.xw))*f+(d.pos.y-
l*d.yw-(e.pos.y-l*e.yw))*h;if(0>g){f*=-g;h*=-g;g=Math.sqrt(a*a+c*c);if(g<Math.sqrt(f*f+h*h))return d.reportCollisionVsWorld(a,c,a/g,c/g,e),b.Physics.Ninja.AABB.COL_AXIS;d.reportCollisionVsWorld(f,h,e.sx,e.sy,e);return b.Physics.Ninja.AABB.COL_OTHER}return b.Physics.Ninja.AABB.COL_NONE},projAABB_Convex:function(a,c,d,e){var g=e.signx,f=e.signy,h=d.pos.x-g*d.xw-(e.pos.x-g*e.xw),k=d.pos.y-f*d.yw-(e.pos.y-f*e.yw),m=Math.sqrt(h*h+k*k),n=2*e.xw,n=Math.sqrt(n*n+0)-m;return 0>g*h||0>f*k?(g=Math.sqrt(a*a+
c*c),d.reportCollisionVsWorld(a,c,a/g,c/g,e),b.Physics.Ninja.AABB.COL_AXIS):0<n?(h/=m,k/=m,d.reportCollisionVsWorld(h*n,k*n,h,k,e),b.Physics.Ninja.AABB.COL_OTHER):b.Physics.Ninja.AABB.COL_NONE},projAABB_Concave:function(a,c,d,e){var g=e.signx,f=e.signy,g=e.pos.x+g*e.xw-(d.pos.x-g*d.xw),f=e.pos.y+f*e.yw-(d.pos.y-f*d.yw),h=2*e.xw,k=Math.sqrt(g*g+f*f),h=k-Math.sqrt(h*h+0);if(0<h){var m=Math.sqrt(a*a+c*c);if(m<h)return d.reportCollisionVsWorld(a,c,a/m,c/m,e),b.Physics.Ninja.AABB.COL_AXIS;g/=k;f/=k;d.reportCollisionVsWorld(g*
h,f*h,g,f,e);return b.Physics.Ninja.AABB.COL_OTHER}return b.Physics.Ninja.AABB.COL_NONE},destroy:function(){this.system=this.body=null},render:function(a,b,d,e,g){b=this.pos.x-this.xw-b;d=this.pos.y-this.yw-d;g?(a.fillStyle=e,a.fillRect(b,d,this.width,this.height)):(a.strokeStyle=e,a.strokeRect(b,d,this.width,this.height))}};b.Physics.Ninja.Tile=function(a,c,d,e,g,f){void 0===f&&(f=b.Physics.Ninja.Tile.EMPTY);this.body=a;this.system=a.system;this.id=f;this.type=b.Physics.Ninja.Tile.TYPE_EMPTY;this.pos=
new b.Point(c,d);this.oldpos=new b.Point(c,d);1<this.id&&30>this.id&&(g=e);this.xw=Math.abs(e/2);this.yw=Math.abs(g/2);this.width=e;this.height=g;this.velocity=new b.Point;this.sy=this.sx=this.signy=this.signx=0;this.body.gravityScale=0;this.body.collideWorldBounds=!1;0<this.id&&this.setType(this.id)};b.Physics.Ninja.Tile.prototype.constructor=b.Physics.Ninja.Tile;b.Physics.Ninja.Tile.prototype={integrate:function(){var a=this.pos.x,b=this.pos.y;this.pos.x+=this.body.drag*this.pos.x-this.body.drag*
this.oldpos.x;this.pos.y+=this.body.drag*this.pos.y-this.body.drag*this.oldpos.y+this.system.gravity*this.body.gravityScale;this.velocity.set(this.pos.x-a,this.pos.y-b);this.oldpos.set(a,b)},collideWorldBounds:function(){var a=this.system.bounds.x-(this.pos.x-this.xw);0<a?this.reportCollisionVsWorld(a,0,1,0,null):(a=this.pos.x+this.xw-this.system.bounds.right,0<a&&this.reportCollisionVsWorld(-a,0,-1,0,null));a=this.system.bounds.y-(this.pos.y-this.yw);0<a?this.reportCollisionVsWorld(0,a,0,1,null):
(a=this.pos.y+this.yw-this.system.bounds.bottom,0<a&&this.reportCollisionVsWorld(0,-a,0,-1,null))},reportCollisionVsWorld:function(a,b,d,e){var g=this.pos,f=this.oldpos,h=g.x-f.x,k=g.y-f.y,m=h*d+k*e,n=m*d,q=m*e;0>m?(h=(h-n)*this.body.friction,k=(k-q)*this.body.friction,m=1+this.body.bounce,n*=m,q*=m,1===d?this.body.touching.left=!0:-1===d&&(this.body.touching.right=!0),1===e?this.body.touching.up=!0:-1===e&&(this.body.touching.down=!0)):n=q=h=k=0;g.x+=a;g.y+=b;f.x+=a+n+h;f.y+=b+q+k},setType:function(a){a===
b.Physics.Ninja.Tile.EMPTY?this.clear():(this.id=a,this.updateType());return this},clear:function(){this.id=b.Physics.Ninja.Tile.EMPTY;this.updateType()},destroy:function(){this.system=this.body=null},updateType:function(){if(0===this.id)return this.type=b.Physics.Ninja.Tile.TYPE_EMPTY,this.sy=this.sx=this.signy=this.signx=0,!0;if(this.id<b.Physics.Ninja.Tile.TYPE_45DEG)this.type=b.Physics.Ninja.Tile.TYPE_FULL,this.sy=this.sx=this.signy=this.signx=0;else if(this.id<b.Physics.Ninja.Tile.TYPE_CONCAVE)if(this.type=
b.Physics.Ninja.Tile.TYPE_45DEG,this.id==b.Physics.Ninja.Tile.SLOPE_45DEGpn)this.signx=1,this.signy=-1,this.sx=this.signx/Math.SQRT2,this.sy=this.signy/Math.SQRT2;else if(this.id==b.Physics.Ninja.Tile.SLOPE_45DEGnn)this.signy=this.signx=-1,this.sx=this.signx/Math.SQRT2,this.sy=this.signy/Math.SQRT2;else if(this.id==b.Physics.Ninja.Tile.SLOPE_45DEGnp)this.signx=-1,this.signy=1,this.sx=this.signx/Math.SQRT2,this.sy=this.signy/Math.SQRT2;else if(this.id==b.Physics.Ninja.Tile.SLOPE_45DEGpp)this.signy=
this.signx=1,this.sx=this.signx/Math.SQRT2,this.sy=this.signy/Math.SQRT2;else return!1;else if(this.id<b.Physics.Ninja.Tile.TYPE_CONVEX)if(this.type=b.Physics.Ninja.Tile.TYPE_CONCAVE,this.id==b.Physics.Ninja.Tile.CONCAVEpn)this.signx=1,this.signy=-1,this.sy=this.sx=0;else if(this.id==b.Physics.Ninja.Tile.CONCAVEnn)this.signy=this.signx=-1,this.sy=this.sx=0;else if(this.id==b.Physics.Ninja.Tile.CONCAVEnp)this.signx=-1,this.signy=1,this.sy=this.sx=0;else if(this.id==b.Physics.Ninja.Tile.CONCAVEpp)this.signy=
this.signx=1,this.sy=this.sx=0;else return!1;else if(this.id<b.Physics.Ninja.Tile.TYPE_22DEGs)if(this.type=b.Physics.Ninja.Tile.TYPE_CONVEX,this.id==b.Physics.Ninja.Tile.CONVEXpn)this.signx=1,this.signy=-1,this.sy=this.sx=0;else if(this.id==b.Physics.Ninja.Tile.CONVEXnn)this.signy=this.signx=-1,this.sy=this.sx=0;else if(this.id==b.Physics.Ninja.Tile.CONVEXnp)this.signx=-1,this.signy=1,this.sy=this.sx=0;else if(this.id==b.Physics.Ninja.Tile.CONVEXpp)this.signy=this.signx=1,this.sy=this.sx=0;else return!1;
else if(this.id<b.Physics.Ninja.Tile.TYPE_22DEGb)if(this.type=b.Physics.Ninja.Tile.TYPE_22DEGs,this.id==b.Physics.Ninja.Tile.SLOPE_22DEGpnS){this.signx=1;this.signy=-1;var a=Math.sqrt(5);this.sx=1*this.signx/a;this.sy=2*this.signy/a}else if(this.id==b.Physics.Ninja.Tile.SLOPE_22DEGnnS)this.signy=this.signx=-1,a=Math.sqrt(5),this.sx=1*this.signx/a,this.sy=2*this.signy/a;else if(this.id==b.Physics.Ninja.Tile.SLOPE_22DEGnpS)this.signx=-1,this.signy=1,a=Math.sqrt(5),this.sx=1*this.signx/a,this.sy=2*this.signy/
a;else if(this.id==b.Physics.Ninja.Tile.SLOPE_22DEGppS)this.signy=this.signx=1,a=Math.sqrt(5),this.sx=1*this.signx/a,this.sy=2*this.signy/a;else return!1;else if(this.id<b.Physics.Ninja.Tile.TYPE_67DEGs)if(this.type=b.Physics.Ninja.Tile.TYPE_22DEGb,this.id==b.Physics.Ninja.Tile.SLOPE_22DEGpnB)this.signx=1,this.signy=-1,a=Math.sqrt(5),this.sx=1*this.signx/a,this.sy=2*this.signy/a;else if(this.id==b.Physics.Ninja.Tile.SLOPE_22DEGnnB)this.signy=this.signx=-1,a=Math.sqrt(5),this.sx=1*this.signx/a,this.sy=
2*this.signy/a;else if(this.id==b.Physics.Ninja.Tile.SLOPE_22DEGnpB)this.signx=-1,this.signy=1,a=Math.sqrt(5),this.sx=1*this.signx/a,this.sy=2*this.signy/a;else if(this.id==b.Physics.Ninja.Tile.SLOPE_22DEGppB)this.signy=this.signx=1,a=Math.sqrt(5),this.sx=1*this.signx/a,this.sy=2*this.signy/a;else return!1;else if(this.id<b.Physics.Ninja.Tile.TYPE_67DEGb)if(this.type=b.Physics.Ninja.Tile.TYPE_67DEGs,this.id==b.Physics.Ninja.Tile.SLOPE_67DEGpnS)this.signx=1,this.signy=-1,a=Math.sqrt(5),this.sx=2*this.signx/
a,this.sy=1*this.signy/a;else if(this.id==b.Physics.Ninja.Tile.SLOPE_67DEGnnS)this.signy=this.signx=-1,a=Math.sqrt(5),this.sx=2*this.signx/a,this.sy=1*this.signy/a;else if(this.id==b.Physics.Ninja.Tile.SLOPE_67DEGnpS)this.signx=-1,this.signy=1,a=Math.sqrt(5),this.sx=2*this.signx/a,this.sy=1*this.signy/a;else if(this.id==b.Physics.Ninja.Tile.SLOPE_67DEGppS)this.signy=this.signx=1,a=Math.sqrt(5),this.sx=2*this.signx/a,this.sy=1*this.signy/a;else return!1;else if(this.id<b.Physics.Ninja.Tile.TYPE_HALF)if(this.type=
b.Physics.Ninja.Tile.TYPE_67DEGb,this.id==b.Physics.Ninja.Tile.SLOPE_67DEGpnB)this.signx=1,this.signy=-1,a=Math.sqrt(5),this.sx=2*this.signx/a,this.sy=1*this.signy/a;else if(this.id==b.Physics.Ninja.Tile.SLOPE_67DEGnnB)this.signy=this.signx=-1,a=Math.sqrt(5),this.sx=2*this.signx/a,this.sy=1*this.signy/a;else if(this.id==b.Physics.Ninja.Tile.SLOPE_67DEGnpB)this.signx=-1,this.signy=1,a=Math.sqrt(5),this.sx=2*this.signx/a,this.sy=1*this.signy/a;else if(this.id==b.Physics.Ninja.Tile.SLOPE_67DEGppB)this.signy=
this.signx=1,a=Math.sqrt(5),this.sx=2*this.signx/a,this.sy=1*this.signy/a;else return!1;else if(this.type=b.Physics.Ninja.Tile.TYPE_HALF,this.id==b.Physics.Ninja.Tile.HALFd)this.signx=0,this.signy=-1,this.sx=this.signx,this.sy=this.signy;else if(this.id==b.Physics.Ninja.Tile.HALFu)this.signx=0,this.signy=1,this.sx=this.signx,this.sy=this.signy;else if(this.id==b.Physics.Ninja.Tile.HALFl)this.signx=1,this.signy=0,this.sx=this.signx,this.sy=this.signy;else if(this.id==b.Physics.Ninja.Tile.HALFr)this.signx=
-1,this.signy=0,this.sx=this.signx,this.sy=this.signy;else return!1}};Object.defineProperty(b.Physics.Ninja.Tile.prototype,"x",{get:function(){return this.pos.x-this.xw},set:function(a){this.pos.x=a}});Object.defineProperty(b.Physics.Ninja.Tile.prototype,"y",{get:function(){return this.pos.y-this.yw},set:function(a){this.pos.y=a}});Object.defineProperty(b.Physics.Ninja.Tile.prototype,"bottom",{get:function(){return this.pos.y+this.yw}});Object.defineProperty(b.Physics.Ninja.Tile.prototype,"right",
{get:function(){return this.pos.x+this.xw}});b.Physics.Ninja.Tile.EMPTY=0;b.Physics.Ninja.Tile.FULL=1;b.Physics.Ninja.Tile.SLOPE_45DEGpn=2;b.Physics.Ninja.Tile.SLOPE_45DEGnn=3;b.Physics.Ninja.Tile.SLOPE_45DEGnp=4;b.Physics.Ninja.Tile.SLOPE_45DEGpp=5;b.Physics.Ninja.Tile.CONCAVEpn=6;b.Physics.Ninja.Tile.CONCAVEnn=7;b.Physics.Ninja.Tile.CONCAVEnp=8;b.Physics.Ninja.Tile.CONCAVEpp=9;b.Physics.Ninja.Tile.CONVEXpn=10;b.Physics.Ninja.Tile.CONVEXnn=11;b.Physics.Ninja.Tile.CONVEXnp=12;b.Physics.Ninja.Tile.CONVEXpp=
13;b.Physics.Ninja.Tile.SLOPE_22DEGpnS=14;b.Physics.Ninja.Tile.SLOPE_22DEGnnS=15;b.Physics.Ninja.Tile.SLOPE_22DEGnpS=16;b.Physics.Ninja.Tile.SLOPE_22DEGppS=17;b.Physics.Ninja.Tile.SLOPE_22DEGpnB=18;b.Physics.Ninja.Tile.SLOPE_22DEGnnB=19;b.Physics.Ninja.Tile.SLOPE_22DEGnpB=20;b.Physics.Ninja.Tile.SLOPE_22DEGppB=21;b.Physics.Ninja.Tile.SLOPE_67DEGpnS=22;b.Physics.Ninja.Tile.SLOPE_67DEGnnS=23;b.Physics.Ninja.Tile.SLOPE_67DEGnpS=24;b.Physics.Ninja.Tile.SLOPE_67DEGppS=25;b.Physics.Ninja.Tile.SLOPE_67DEGpnB=
26;b.Physics.Ninja.Tile.SLOPE_67DEGnnB=27;b.Physics.Ninja.Tile.SLOPE_67DEGnpB=28;b.Physics.Ninja.Tile.SLOPE_67DEGppB=29;b.Physics.Ninja.Tile.HALFd=30;b.Physics.Ninja.Tile.HALFr=31;b.Physics.Ninja.Tile.HALFu=32;b.Physics.Ninja.Tile.HALFl=33;b.Physics.Ninja.Tile.TYPE_EMPTY=0;b.Physics.Ninja.Tile.TYPE_FULL=1;b.Physics.Ninja.Tile.TYPE_45DEG=2;b.Physics.Ninja.Tile.TYPE_CONCAVE=6;b.Physics.Ninja.Tile.TYPE_CONVEX=10;b.Physics.Ninja.Tile.TYPE_22DEGs=14;b.Physics.Ninja.Tile.TYPE_22DEGb=18;b.Physics.Ninja.Tile.TYPE_67DEGs=
22;b.Physics.Ninja.Tile.TYPE_67DEGb=26;b.Physics.Ninja.Tile.TYPE_HALF=30;b.Physics.Ninja.Circle=function(a,c,d,e){this.body=a;this.system=a.system;this.pos=new b.Point(c,d);this.oldpos=new b.Point(c,d);this.yw=this.xw=this.radius=e;this.width=2*e;this.height=2*e;this.oV=this.oH=0;this.velocity=new b.Point;this.circleTileProjections={};this.circleTileProjections[b.Physics.Ninja.Tile.TYPE_FULL]=this.projCircle_Full;this.circleTileProjections[b.Physics.Ninja.Tile.TYPE_45DEG]=this.projCircle_45Deg;this.circleTileProjections[b.Physics.Ninja.Tile.TYPE_CONCAVE]=
this.projCircle_Concave;this.circleTileProjections[b.Physics.Ninja.Tile.TYPE_CONVEX]=this.projCircle_Convex;this.circleTileProjections[b.Physics.Ninja.Tile.TYPE_22DEGs]=this.projCircle_22DegS;this.circleTileProjections[b.Physics.Ninja.Tile.TYPE_22DEGb]=this.projCircle_22DegB;this.circleTileProjections[b.Physics.Ninja.Tile.TYPE_67DEGs]=this.projCircle_67DegS;this.circleTileProjections[b.Physics.Ninja.Tile.TYPE_67DEGb]=this.projCircle_67DegB;this.circleTileProjections[b.Physics.Ninja.Tile.TYPE_HALF]=
this.projCircle_Half};b.Physics.Ninja.Circle.prototype.constructor=b.Physics.Ninja.Circle;b.Physics.Ninja.Circle.COL_NONE=0;b.Physics.Ninja.Circle.COL_AXIS=1;b.Physics.Ninja.Circle.COL_OTHER=2;b.Physics.Ninja.Circle.prototype={integrate:function(){var a=this.pos.x,b=this.pos.y;this.pos.x+=this.body.drag*this.pos.x-this.body.drag*this.oldpos.x;this.pos.y+=this.body.drag*this.pos.y-this.body.drag*this.oldpos.y+this.system.gravity*this.body.gravityScale;this.velocity.set(this.pos.x-a,this.pos.y-b);this.oldpos.set(a,
b)},reportCollisionVsWorld:function(a,b,d,e){var g=this.pos,f=this.oldpos,h=g.x-f.x,k=g.y-f.y,m=h*d+k*e,n=m*d,q=m*e;0>m?(h=(h-n)*this.body.friction,k=(k-q)*this.body.friction,m=1+this.body.bounce,n*=m,q*=m,1===d?this.body.touching.left=!0:-1===d&&(this.body.touching.right=!0),1===e?this.body.touching.up=!0:-1===e&&(this.body.touching.down=!0)):n=q=h=k=0;g.x+=a;g.y+=b;f.x+=a+n+h;f.y+=b+q+k},collideWorldBounds:function(){var a=this.system.bounds.x-(this.pos.x-this.radius);0<a?this.reportCollisionVsWorld(a,
0,1,0,null):(a=this.pos.x+this.radius-this.system.bounds.right,0<a&&this.reportCollisionVsWorld(-a,0,-1,0,null));a=this.system.bounds.y-(this.pos.y-this.radius);0<a?this.reportCollisionVsWorld(0,a,0,1,null):(a=this.pos.y+this.radius-this.system.bounds.bottom,0<a&&this.reportCollisionVsWorld(0,-a,0,-1,null))},collideCircleVsTile:function(a){var b=this.pos,d=this.radius,e=a.pos.y,g=a.xw,f=a.yw,h=b.x-a.pos.x,k=g+d-Math.abs(h);if(0<k&&(b=b.y-e,d=f+d-Math.abs(b),0<d))return this.oV=this.oH=0,h<-g?this.oH=
-1:g<h&&(this.oH=1),b<-f?this.oV=-1:f<b&&(this.oV=1),this.resolveCircleTile(k,d,this.oH,this.oV,this,a)},resolveCircleTile:function(a,b,d,e,g,f){return 0<f.id?this.circleTileProjections[f.type](a,b,d,e,g,f):!1},projCircle_Full:function(a,c,d,e,g,f){if(0===d)return 0===e?a<c?(c=g.pos.x-f.pos.x,0>c?g.reportCollisionVsWorld(-a,0,-1,0,f):g.reportCollisionVsWorld(a,0,1,0,f)):(a=g.pos.y-f.pos.y,0>a?g.reportCollisionVsWorld(0,-c,0,-1,f):g.reportCollisionVsWorld(0,c,0,1,f)):g.reportCollisionVsWorld(0,c*e,
0,e,f),b.Physics.Ninja.Circle.COL_AXIS;if(0===e)return g.reportCollisionVsWorld(a*d,0,d,0,f),b.Physics.Ninja.Circle.COL_AXIS;a=f.pos.y+e*f.yw;c=g.pos.x-(f.pos.x+d*f.xw);a=g.pos.y-a;var h=Math.sqrt(c*c+a*a),k=g.radius-h;return 0<k?(0===h?(c=d/Math.SQRT2,a=e/Math.SQRT2):(c/=h,a/=h),g.reportCollisionVsWorld(c*k,a*k,c,a,f),b.Physics.Ninja.Circle.COL_OTHER):b.Physics.Ninja.Circle.COL_NONE},projCircle_45Deg:function(a,c,d,e,g,f){var h=f.signx,k=f.signy;if(0===d)if(0===e){var m=f.sx,n=f.sy;d=g.pos.x-m*g.radius-
f.pos.x;e=g.pos.y-n*g.radius-f.pos.y;e=d*m+e*n;if(0>e){m*=-e;n*=-e;a<c?(e=a,c=0,0>g.pos.x-f.pos.x&&(a*=-1)):(e=c,a=0,0>g.pos.y-f.pos.y&&(c*=-1));if(e<Math.sqrt(m*m+n*n))return g.reportCollisionVsWorld(a,c,a/e,c/e,f),b.Physics.Ninja.Circle.COL_AXIS;g.reportCollisionVsWorld(m,n,f.sx,f.sy,f);return b.Physics.Ninja.Circle.COL_OTHER}}else{if(0>k*e)return g.reportCollisionVsWorld(0,c*e,0,e,f),b.Physics.Ninja.Circle.COL_AXIS;m=f.sx;n=f.sy;d=g.pos.x-(f.pos.x-h*f.xw);e=g.pos.y-(f.pos.y+e*f.yw);if(0<(d*-n+
e*m)*h*k){if(m=Math.sqrt(d*d+e*e),a=g.radius-m,0<a)return d/=m,e/=m,g.reportCollisionVsWorld(d*a,e*a,d,e,f),b.Physics.Ninja.Circle.COL_OTHER}else if(a=g.radius-Math.abs(d*m+e*n),0<a)return g.reportCollisionVsWorld(m*a,n*a,m,n,f),b.Physics.Ninja.Circle.COL_OTHER}else if(0===e){if(0>h*d)return g.reportCollisionVsWorld(a*d,0,d,0,f),b.Physics.Ninja.Circle.COL_AXIS;m=f.sx;n=f.sy;d=g.pos.x-(f.pos.x+d*f.xw);e=g.pos.y-(f.pos.y-k*f.yw);if(0>(d*-n+e*m)*h*k){if(m=Math.sqrt(d*d+e*e),a=g.radius-m,0<a)return d/=
m,e/=m,g.reportCollisionVsWorld(d*a,e*a,d,e,f),b.Physics.Ninja.Circle.COL_OTHER}else if(a=g.radius-Math.abs(d*m+e*n),0<a)return g.reportCollisionVsWorld(m*a,n*a,m,n,f),b.Physics.Ninja.Circle.COL_OTHER}else if(!(0<h*d+k*e)&&(n=g.pos.x-(f.pos.x+d*f.xw),c=g.pos.y-(f.pos.y+e*f.yw),m=Math.sqrt(n*n+c*c),a=g.radius-m,0<a))return 0===m?(n=d/Math.SQRT2,c=e/Math.SQRT2):(n/=m,c/=m),g.reportCollisionVsWorld(n*a,c*a,n,c,f),b.Physics.Ninja.Circle.COL_OTHER;return b.Physics.Ninja.Circle.COL_NONE},projCircle_Concave:function(a,
c,d,e,g,f){var h=f.signx,k=f.signy,m;if(0===d)if(0===e){if(d=f.pos.x+h*f.xw-g.pos.x,e=f.pos.y+k*f.yw-g.pos.y,h=2*f.xw,k=Math.sqrt(d*d+e*e),h=k+g.radius-Math.sqrt(h*h+0),0<h){a<c?(m=a,c=0,0>g.pos.x-f.pos.x&&(a*=-1)):(m=c,a=0,0>g.pos.y-f.pos.y&&(c*=-1));if(m<h)return g.reportCollisionVsWorld(a,c,a/m,c/m,f),b.Physics.Ninja.Circle.COL_AXIS;d/=k;e/=k;g.reportCollisionVsWorld(d*h,e*h,d,e,f);return b.Physics.Ninja.Circle.COL_OTHER}}else{if(0>k*e)return g.reportCollisionVsWorld(0,c*e,0,e,f),b.Physics.Ninja.Circle.COL_AXIS;
a=f.pos.x-h*f.xw;c=f.pos.y+e*f.yw;a=g.pos.x-a;c=g.pos.y-c;k=Math.sqrt(a*a+c*c);h=g.radius-k;if(0<h)return 0===k?(a=0,c=e):(a/=k,c/=k),g.reportCollisionVsWorld(a*h,c*h,a,c,f),b.Physics.Ninja.Circle.COL_OTHER}else if(0===e){if(0>h*d)return g.reportCollisionVsWorld(a*d,0,d,0,f),b.Physics.Ninja.Circle.COL_AXIS;a=f.pos.x+d*f.xw;c=f.pos.y-k*f.yw;a=g.pos.x-a;c=g.pos.y-c;k=Math.sqrt(a*a+c*c);h=g.radius-k;if(0<h)return 0===k?(a=d,c=0):(a/=k,c/=k),g.reportCollisionVsWorld(a*h,c*h,a,c,f),b.Physics.Ninja.Circle.COL_OTHER}else if(!(0<
h*d+k*e)&&(a=f.pos.x+d*f.xw,c=f.pos.y+e*f.yw,a=g.pos.x-a,c=g.pos.y-c,k=Math.sqrt(a*a+c*c),h=g.radius-k,0<h))return 0===k?(a=d/Math.SQRT2,c=e/Math.SQRT2):(a/=k,c/=k),g.reportCollisionVsWorld(a*h,c*h,a,c,f),b.Physics.Ninja.Circle.COL_OTHER;return b.Physics.Ninja.Circle.COL_NONE},projCircle_Convex:function(a,c,d,e,g,f){var h=f.signx,k=f.signy,m;if(0===d)if(0===e){if(d=g.pos.x-(f.pos.x-h*f.xw),e=g.pos.y-(f.pos.y-k*f.yw),k=2*f.xw,h=Math.sqrt(k*k+0),k=Math.sqrt(d*d+e*e),h=h+g.radius-k,0<h){a<c?(m=a,c=0,
0>g.pos.x-f.pos.x&&(a*=-1)):(m=c,a=0,0>g.pos.y-f.pos.y&&(c*=-1));if(m<h)return g.reportCollisionVsWorld(a,c,a/m,c/m,f),b.Physics.Ninja.Circle.COL_AXIS;d/=k;e/=k;g.reportCollisionVsWorld(d*h,e*h,d,e,f);return b.Physics.Ninja.Circle.COL_OTHER}}else{if(0>k*e)return g.reportCollisionVsWorld(0,c*e,0,e,f),b.Physics.Ninja.Circle.COL_AXIS;d=g.pos.x-(f.pos.x-h*f.xw);e=g.pos.y-(f.pos.y-k*f.yw);k=2*f.xw;h=Math.sqrt(k*k+0);k=Math.sqrt(d*d+e*e);h=h+g.radius-k;if(0<h)return d/=k,e/=k,g.reportCollisionVsWorld(d*
h,e*h,d,e,f),b.Physics.Ninja.Circle.COL_OTHER}else if(0===e){if(0>h*d)return g.reportCollisionVsWorld(a*d,0,d,0,f),b.Physics.Ninja.Circle.COL_AXIS;d=g.pos.x-(f.pos.x-h*f.xw);e=g.pos.y-(f.pos.y-k*f.yw);k=2*f.xw;h=Math.sqrt(k*k+0);k=Math.sqrt(d*d+e*e);h=h+g.radius-k;if(0<h)return d/=k,e/=k,g.reportCollisionVsWorld(d*h,e*h,d,e,f),b.Physics.Ninja.Circle.COL_OTHER}else if(0<h*d+k*e){if(d=g.pos.x-(f.pos.x-h*f.xw),e=g.pos.y-(f.pos.y-k*f.yw),k=2*f.xw,h=Math.sqrt(k*k+0),k=Math.sqrt(d*d+e*e),h=h+g.radius-k,
0<h)return d/=k,e/=k,g.reportCollisionVsWorld(d*h,e*h,d,e,f),b.Physics.Ninja.Circle.COL_OTHER}else if(a=g.pos.x-(f.pos.x+d*f.xw),c=g.pos.y-(f.pos.y+e*f.yw),k=Math.sqrt(a*a+c*c),h=g.radius-k,0<h)return 0===k?(a=d/Math.SQRT2,c=e/Math.SQRT2):(a/=k,c/=k),g.reportCollisionVsWorld(a*h,c*h,a,c,f),b.Physics.Ninja.Circle.COL_OTHER;return b.Physics.Ninja.Circle.COL_NONE},projCircle_Half:function(a,c,d,e,g,f){var h=f.signx,k=f.signy,m=d*h+e*k;if(!(0<m))if(0===d)if(0===e){if(m=g.radius,d=h,e=k,h=(g.pos.x-h*m-
f.pos.x)*d+(g.pos.y-k*m-f.pos.y)*e,0>h){d*=-h;e*=-h;h=Math.sqrt(a*a+c*c);if(h<Math.sqrt(d*d+e*e))return g.reportCollisionVsWorld(a,c,a/h,c/h,f),b.Physics.Ninja.Circle.COL_AXIS;g.reportCollisionVsWorld(d,e,f.signx,f.signy);return b.Physics.Ninja.Circle.COL_OTHER}}else if(0===m){a=g.pos.x-f.pos.x;if(0>a*h)return g.reportCollisionVsWorld(0,c*e,0,e,f),b.Physics.Ninja.Circle.COL_AXIS;c=g.pos.y-(f.pos.y+e*f.yw);k=Math.sqrt(a*a+c*c);m=g.radius-k;if(0<m)return 0===k?(a=h/Math.SQRT2,c=e/Math.SQRT2):(a/=k,
c/=k),g.reportCollisionVsWorld(a*m,c*m,a,c,f),b.Physics.Ninja.Circle.COL_OTHER}else return g.reportCollisionVsWorld(0,c*e,0,e,f),b.Physics.Ninja.Circle.COL_AXIS;else if(0===e)if(0===m){c=g.pos.y-f.pos.y;if(0>c*k)return g.reportCollisionVsWorld(a*d,0,d,0,f),b.Physics.Ninja.Circle.COL_AXIS;a=g.pos.x-(f.pos.x+d*f.xw);k=Math.sqrt(a*a+c*c);m=g.radius-k;if(0<m)return 0===k?(a=h/Math.SQRT2,c=e/Math.SQRT2):(a/=k,c/=k),g.reportCollisionVsWorld(a*m,c*m,a,c,f),b.Physics.Ninja.Circle.COL_OTHER}else return g.reportCollisionVsWorld(a*
d,0,d,0,f),b.Physics.Ninja.Circle.COL_AXIS;else if(h=f.pos.y+e*f.yw,a=g.pos.x-(f.pos.x+d*f.xw),c=g.pos.y-h,k=Math.sqrt(a*a+c*c),m=g.radius-k,0<m)return 0===k?(a=d/Math.SQRT2,c=e/Math.SQRT2):(a/=k,c/=k),g.reportCollisionVsWorld(a*m,c*m,a,c,f),b.Physics.Ninja.Circle.COL_OTHER;return b.Physics.Ninja.Circle.COL_NONE},projCircle_22DegS:function(a,c,d,e,g,f){var h,k=f.signx;h=f.signy;if(!(0<h*e))if(0===d)if(0===e){e=f.sx;var m=f.sy,n=g.radius;d=g.pos.x-(f.pos.x-k*f.xw);var q=g.pos.y-f.pos.y,t=d*-m+q*e;
if(0<t*k*h){if(h=Math.sqrt(d*d+q*q),a=n-h,0<a)return d/=h,q/=h,g.reportCollisionVsWorld(d*a,q*a,d,q,f),b.Physics.Ninja.Circle.COL_OTHER}else if(h=(d-n*e)*e+(q-n*m)*m,0>h){e*=-h;m*=-h;d=Math.sqrt(e*e+m*m);a<c?(h=a,c=0,0>g.pos.x-f.pos.x&&(a*=-1)):(h=c,a=0,0>g.pos.y-f.pos.y&&(c*=-1));if(h<d)return g.reportCollisionVsWorld(a,c,a/h,c/h,f),b.Physics.Ninja.Circle.COL_AXIS;g.reportCollisionVsWorld(e,m,f.sx,f.sy,f);return b.Physics.Ninja.Circle.COL_OTHER}}else return g.reportCollisionVsWorld(0,c*e,0,e,f),
b.Physics.Ninja.Circle.COL_AXIS;else if(0===e)if(0>k*d){c=f.pos.x-k*f.xw;m=f.pos.y;c=g.pos.x-c;m=g.pos.y-m;if(0>m*h)return g.reportCollisionVsWorld(a*d,0,d,0,f),b.Physics.Ninja.Circle.COL_AXIS;h=Math.sqrt(c*c+m*m);a=g.radius-h;if(0<a)return 0===h?(c=d/Math.SQRT2,m=e/Math.SQRT2):(c/=h,m/=h),g.reportCollisionVsWorld(c*a,m*a,c,m,f),b.Physics.Ninja.Circle.COL_OTHER}else if(e=f.sx,m=f.sy,d=g.pos.x-(f.pos.x+d*f.xw),q=g.pos.y-(f.pos.y-h*f.yw),t=d*-m+q*e,0>t*k*h){if(h=Math.sqrt(d*d+q*q),a=g.radius-h,0<a)return d/=
h,q/=h,g.reportCollisionVsWorld(d*a,q*a,d,q,f),b.Physics.Ninja.Circle.COL_OTHER}else{if(h=d*e+q*m,a=g.radius-Math.abs(h),0<a)return g.reportCollisionVsWorld(e*a,m*a,e,m,f),b.Physics.Ninja.Circle.COL_OTHER}else if(c=f.pos.x+d*f.xw,m=f.pos.y+e*f.yw,c=g.pos.x-c,m=g.pos.y-m,h=Math.sqrt(c*c+m*m),a=g.radius-h,0<a)return 0===h?(c=d/Math.SQRT2,m=e/Math.SQRT2):(c/=h,m/=h),g.reportCollisionVsWorld(c*a,m*a,c,m,f),b.Physics.Ninja.Circle.COL_OTHER;return b.Physics.Ninja.Circle.COL_NONE},projCircle_22DegB:function(a,
c,d,e,g,f){var h;h=f.signx;var k=f.signy;if(0===d)if(0===e){d=f.sx;e=f.sy;var m=g.radius,n=g.pos.x-d*m-(f.pos.x-h*f.xw),m=g.pos.y-e*m-(f.pos.y+k*f.yw);h=n*d+m*e;if(0>h){d*=-h;e*=-h;k=Math.sqrt(d*d+e*e);a<c?(h=a,c=0,0>g.pos.x-f.pos.x&&(a*=-1)):(h=c,a=0,0>g.pos.y-f.pos.y&&(c*=-1));if(h<k)return g.reportCollisionVsWorld(a,c,a/h,c/h,f),b.Physics.Ninja.Circle.COL_AXIS;g.reportCollisionVsWorld(d,e,f.sx,f.sy,f);return b.Physics.Ninja.Circle.COL_OTHER}}else{if(0>k*e)return g.reportCollisionVsWorld(0,c*e,
0,e,f),b.Physics.Ninja.Circle.COL_AXIS;d=f.sx;e=f.sy;n=g.pos.x-(f.pos.x-h*f.xw);m=g.pos.y-(f.pos.y+k*f.yw);if(0<(n*-e+m*d)*h*k){if(c=Math.sqrt(n*n+m*m),a=g.radius-c,0<a)return n/=c,m/=c,g.reportCollisionVsWorld(n*a,m*a,n,m,f),b.Physics.Ninja.Circle.COL_OTHER}else if(a=g.radius-Math.abs(n*d+m*e),0<a)return g.reportCollisionVsWorld(d*a,e*a,d,e,f),b.Physics.Ninja.Circle.COL_OTHER}else if(0===e){if(0>h*d)return g.reportCollisionVsWorld(a*d,0,d,0,f),b.Physics.Ninja.Circle.COL_AXIS;n=g.pos.x-(f.pos.x+h*
f.xw);m=g.pos.y-f.pos.y;if(0>m*k)return g.reportCollisionVsWorld(a*d,0,d,0,f),b.Physics.Ninja.Circle.COL_AXIS;d=f.sx;e=f.sy;if(0>(n*-e+m*d)*h*k){if(c=Math.sqrt(n*n+m*m),a=g.radius-c,0<a)return n/=c,m/=c,g.reportCollisionVsWorld(n*a,m*a,n,m,f),b.Physics.Ninja.Circle.COL_OTHER}else if(a=g.radius-Math.abs(n*d+m*e),0<a)return g.reportCollisionVsWorld(d*a,e*a,f.sx,f.sy,f),b.Physics.Ninja.Circle.COL_OTHER}else if(0<h*d+k*e){if(a=Math.sqrt(5),d=1*h/a,e=2*k/a,m=g.radius,n=g.pos.x-d*m-(f.pos.x-h*f.xw),m=g.pos.y-
e*m-(f.pos.y+k*f.yw),h=n*d+m*e,0>h)return g.reportCollisionVsWorld(-d*h,-e*h,f.sx,f.sy,f),b.Physics.Ninja.Circle.COL_OTHER}else if(h=g.pos.x-(f.pos.x+d*f.xw),k=g.pos.y-(f.pos.y+e*f.yw),c=Math.sqrt(h*h+k*k),a=g.radius-c,0<a)return 0===c?(h=d/Math.SQRT2,k=e/Math.SQRT2):(h/=c,k/=c),g.reportCollisionVsWorld(h*a,k*a,h,k,f),b.Physics.Ninja.Circle.COL_OTHER;return b.Physics.Ninja.Circle.COL_NONE},projCircle_67DegS:function(a,c,d,e,g,f){var h=f.signx,k=f.signy;if(!(0<h*d))if(0===d)if(0===e){d=f.sx;var m=
f.sy,n=g.radius,q=g.pos.x-f.pos.x;e=g.pos.y-(f.pos.y-k*f.yw);var t=q*-m+e*d;if(0>t*h*k){if(h=Math.sqrt(q*q+e*e),c=n-h,0<c)return q/=h,e/=h,g.reportCollisionVsWorld(q*c,e*c,q,e,f),b.Physics.Ninja.Circle.COL_OTHER}else if(h=(q-n*d)*d+(e-n*m)*m,0>h){d*=-h;m*=-h;e=Math.sqrt(d*d+m*m);a<c?(h=a,c=0,0>g.pos.x-f.pos.x&&(a*=-1)):(h=c,a=0,0>g.pos.y-f.pos.y&&(c*=-1));if(h<e)return g.reportCollisionVsWorld(a,c,a/h,c/h,f),b.Physics.Ninja.Circle.COL_AXIS;g.reportCollisionVsWorld(d,m,f.sx,f.sy,f);return b.Physics.Ninja.Circle.COL_OTHER}}else if(0>
k*e){a=f.pos.x;m=f.pos.y-k*f.yw;a=g.pos.x-a;m=g.pos.y-m;if(0>a*h)return g.reportCollisionVsWorld(0,c*e,0,e,f),b.Physics.Ninja.Circle.COL_AXIS;h=Math.sqrt(a*a+m*m);c=g.radius-h;if(0<c)return 0===h?(a=d/Math.SQRT2,m=e/Math.SQRT2):(a/=h,m/=h),g.reportCollisionVsWorld(a*c,m*c,a,m,f),b.Physics.Ninja.Circle.COL_OTHER}else if(d=f.sx,m=f.sy,q=g.pos.x-(f.pos.x-h*f.xw),e=g.pos.y-(f.pos.y+e*f.yw),t=q*-m+e*d,0<t*h*k){if(h=Math.sqrt(q*q+e*e),c=g.radius-h,0<c)return q/=h,e/=h,g.reportCollisionVsWorld(q*c,e*c,q,
e,f),b.Physics.Ninja.Circle.COL_OTHER}else{if(h=q*d+e*m,c=g.radius-Math.abs(h),0<c)return g.reportCollisionVsWorld(d*c,m*c,f.sx,f.sy,f),b.Physics.Ninja.Circle.COL_OTHER}else{if(0===e)return g.reportCollisionVsWorld(a*d,0,d,0,f),b.Physics.Ninja.Circle.COL_AXIS;a=f.pos.x+d*f.xw;m=f.pos.y+e*f.yw;a=g.pos.x-a;m=g.pos.y-m;h=Math.sqrt(a*a+m*m);c=g.radius-h;if(0<c)return 0===h?(a=d/Math.SQRT2,m=e/Math.SQRT2):(a/=h,m/=h),g.reportCollisionVsWorld(a*c,m*c,a,m,f),b.Physics.Ninja.Circle.COL_OTHER}return b.Physics.Ninja.Circle.COL_NONE},
projCircle_67DegB:function(a,c,d,e,g,f){var h=f.signx,k=f.signy;if(0===d)if(0===e){e=f.sx;d=f.sy;var m=g.radius,n=g.pos.x-e*m-(f.pos.x+h*f.xw),m=g.pos.y-d*m-(f.pos.y-k*f.yw),h=n*e+m*d;if(0>h){e*=-h;d*=-h;k=Math.sqrt(e*e+d*d);a<c?(h=a,c=0,0>g.pos.x-f.pos.x&&(a*=-1)):(h=c,a=0,0>g.pos.y-f.pos.y&&(c*=-1));if(h<k)return g.reportCollisionVsWorld(a,c,a/h,c/h,f),b.Physics.Ninja.Circle.COL_AXIS;g.reportCollisionVsWorld(e,d,f.sx,f.sy,f);return b.Physics.Ninja.Circle.COL_OTHER}}else{if(0>k*e)return g.reportCollisionVsWorld(0,
c*e,0,e,f),b.Physics.Ninja.Circle.COL_AXIS;n=g.pos.x-f.pos.x;m=g.pos.y-(f.pos.y+k*f.yw);if(0>n*h)return g.reportCollisionVsWorld(0,c*e,0,e,f),b.Physics.Ninja.Circle.COL_AXIS;e=f.sx;d=f.sy;if(0<(n*-d+m*e)*h*k){if(c=Math.sqrt(n*n+m*m),a=g.radius-c,0<a)return n/=c,m/=c,g.reportCollisionVsWorld(n*a,m*a,n,m,f),b.Physics.Ninja.Circle.COL_OTHER}else if(a=g.radius-Math.abs(n*e+m*d),0<a)return g.reportCollisionVsWorld(e*a,d*a,e,d,f),b.Physics.Ninja.Circle.COL_OTHER}else if(0===e){if(0>h*d)return g.reportCollisionVsWorld(a*
d,0,d,0,f),b.Physics.Ninja.Circle.COL_AXIS;a=Math.sqrt(5);e=2*h/a;d=1*k/a;n=g.pos.x-(f.pos.x+h*f.xw);m=g.pos.y-(f.pos.y-k*f.yw);if(0>(n*-d+m*e)*h*k){if(c=Math.sqrt(n*n+m*m),a=g.radius-c,0<a)return n/=c,m/=c,g.reportCollisionVsWorld(n*a,m*a,n,m,f),b.Physics.Ninja.Circle.COL_OTHER}else if(a=g.radius-Math.abs(n*e+m*d),0<a)return g.reportCollisionVsWorld(e*a,d*a,f.sx,f.sy,f),b.Physics.Ninja.Circle.COL_OTHER}else if(0<h*d+k*e){if(e=f.sx,d=f.sy,m=g.radius,n=g.pos.x-e*m-(f.pos.x+h*f.xw),m=g.pos.y-d*m-(f.pos.y-
k*f.yw),h=n*e+m*d,0>h)return g.reportCollisionVsWorld(-e*h,-d*h,f.sx,f.sy,f),b.Physics.Ninja.Circle.COL_OTHER}else if(h=g.pos.x-(f.pos.x+d*f.xw),k=g.pos.y-(f.pos.y+e*f.yw),c=Math.sqrt(h*h+k*k),a=g.radius-c,0<a)return 0===c?(h=d/Math.SQRT2,k=e/Math.SQRT2):(h/=c,k/=c),g.reportCollisionVsWorld(h*a,k*a,h,k,f),b.Physics.Ninja.Circle.COL_OTHER;return b.Physics.Ninja.Circle.COL_NONE},destroy:function(){this.system=this.body=null},render:function(a,b,d,e,g){b=this.pos.x-b;d=this.pos.y-d;a.beginPath();a.arc(b,
d,this.radius,0,2*Math.PI,!1);g?(a.fillStyle=e,a.fill()):(a.strokeStyle=e,a.stroke())}};b.ImageCollection=function(a,b,d,e,g,f,h){if(void 0===d||0>=d)d=32;if(void 0===e||0>=e)e=32;void 0===g&&(g=0);void 0===f&&(f=0);this.name=a;this.firstgid=b|0;this.imageWidth=d|0;this.imageHeight=e|0;this.imageMargin=g|0;this.imageSpacing=f|0;this.properties=h||{};this.images=[];this.total=0};b.ImageCollection.prototype={containsImageIndex:function(a){return a>=this.firstgid&&a<this.firstgid+this.total},addImage:function(a,
b){this.images.push({gid:a,image:b});this.total++}};b.ImageCollection.prototype.constructor=b.ImageCollection;b.Tile=function(a,b,d,e,g,f){this.layer=a;this.index=b;this.x=d;this.y=e;this.rotation=0;this.flipped=!1;this.worldX=d*g;this.worldY=e*f;this.width=g;this.height=f;this.centerX=Math.abs(g/2);this.centerY=Math.abs(f/2);this.alpha=1;this.properties={};this.collideDown=this.collideUp=this.collideRight=this.collideLeft=this.faceRight=this.faceLeft=this.faceBottom=this.faceTop=this.scanned=!1;
this.collisionCallback=null;this.collisionCallbackContext=this};b.Tile.prototype={containsPoint:function(a,b){return!(a<this.worldX||b<this.worldY||a>this.right||b>this.bottom)},intersects:function(a,b,d,e){return d<=this.worldX||e<=this.worldY||a>=this.worldX+this.width||b>=this.worldY+this.height?!1:!0},setCollisionCallback:function(a,b){this.collisionCallback=a;this.collisionCallbackContext=b},destroy:function(){this.properties=this.collisionCallbackContext=this.collisionCallback=null},setCollision:function(a,
b,d,e){this.collideLeft=a;this.collideRight=b;this.collideUp=d;this.collideDown=e;this.faceLeft=a;this.faceRight=b;this.faceTop=d;this.faceBottom=e},resetCollision:function(){this.faceRight=this.faceLeft=this.faceBottom=this.faceTop=this.collideDown=this.collideUp=this.collideRight=this.collideLeft=!1},isInteresting:function(a,b){return a&&b?this.collideLeft||this.collideRight||this.collideUp||this.collideDown||this.faceTop||this.faceBottom||this.faceLeft||this.faceRight||this.collisionCallback:a?
this.collideLeft||this.collideRight||this.collideUp||this.collideDown:b?this.faceTop||this.faceBottom||this.faceLeft||this.faceRight:!1},copy:function(a){this.index=a.index;this.alpha=a.alpha;this.properties=a.properties;this.collideUp=a.collideUp;this.collideDown=a.collideDown;this.collideLeft=a.collideLeft;this.collideRight=a.collideRight;this.collisionCallback=a.collisionCallback;this.collisionCallbackContext=a.collisionCallbackContext}};b.Tile.prototype.constructor=b.Tile;Object.defineProperty(b.Tile.prototype,
"collides",{get:function(){return this.collideLeft||this.collideRight||this.collideUp||this.collideDown}});Object.defineProperty(b.Tile.prototype,"canCollide",{get:function(){return this.collideLeft||this.collideRight||this.collideUp||this.collideDown||this.collisionCallback}});Object.defineProperty(b.Tile.prototype,"left",{get:function(){return this.worldX}});Object.defineProperty(b.Tile.prototype,"right",{get:function(){return this.worldX+this.width}});Object.defineProperty(b.Tile.prototype,"top",
{get:function(){return this.worldY}});Object.defineProperty(b.Tile.prototype,"bottom",{get:function(){return this.worldY+this.height}});b.Tilemap=function(a,c,d,e,g,f){this.game=a;this.key=c;a=b.TilemapParser.parse(this.game,c,d,e,g,f);null!==a&&(this.width=a.width,this.height=a.height,this.tileWidth=a.tileWidth,this.tileHeight=a.tileHeight,this.orientation=a.orientation,this.format=a.format,this.version=a.version,this.properties=a.properties,this.widthInPixels=a.widthInPixels,this.heightInPixels=
a.heightInPixels,this.layers=a.layers,this.tilesets=a.tilesets,this.imagecollections=a.imagecollections,this.tiles=a.tiles,this.objects=a.objects,this.collideIndexes=[],this.collision=a.collision,this.images=a.images,this.currentLayer=0,this.debugMap=[],this._results=[],this._tempB=this._tempA=0)};b.Tilemap.CSV=0;b.Tilemap.TILED_JSON=1;b.Tilemap.NORTH=0;b.Tilemap.EAST=1;b.Tilemap.SOUTH=2;b.Tilemap.WEST=3;b.Tilemap.prototype={create:function(a,b,d,e,g,f){void 0===f&&(f=this.game.world);this.width=
b;this.height=d;this.setTileSize(e,g);this.layers.length=0;return this.createBlankLayer(a,b,d,e,g,f)},setTileSize:function(a,b){this.tileWidth=a;this.tileHeight=b;this.widthInPixels=this.width*a;this.heightInPixels=this.height*b},addTilesetImage:function(a,c,d,e,g,f,h){if(void 0===a)return null;void 0===d&&(d=this.tileWidth);void 0===e&&(e=this.tileHeight);void 0===g&&(g=0);void 0===f&&(f=0);void 0===h&&(h=0);0===d&&(d=32);0===e&&(e=32);var k=null;if(void 0===c||null===c)c=a;if(c instanceof b.BitmapData)k=
c.canvas;else{if(!this.game.cache.checkImageKey(c))return console.warn('Phaser.Tilemap.addTilesetImage: Invalid image key given: "'+c+'"'),null;k=this.game.cache.getImage(c)}var m=this.getTilesetIndex(a);if(null===m&&this.format===b.Tilemap.TILED_JSON)return console.warn('Phaser.Tilemap.addTilesetImage: No data found in the JSON matching the tileset name: "'+c+'"'),null;if(this.tilesets[m])return this.tilesets[m].setImage(k),this.tilesets[m];a=new b.Tileset(a,h,d,e,g,f,{});a.setImage(k);this.tilesets.push(a);
for(var k=this.tilesets.length-1,m=c=g,n=0,q=0,t=0,r=h;r<h+a.total;r++){this.tiles[r]=[c,m,k];c+=d+f;n++;if(n===a.total)break;q++;if(q===a.columns&&(c=g,m+=e+f,q=0,t++,t===a.rows))break}return a},createFromObjects:function(a,c,d,e,g,f,h,k,m){void 0===g&&(g=!0);void 0===f&&(f=!1);void 0===h&&(h=this.game.world);void 0===k&&(k=b.Sprite);void 0===m&&(m=!0);if(this.objects[a])for(var n,q=!1,t=0,r=this.objects[a].length;t<r;t++){if("undefined"!==typeof this.objects[a][t].gid&&"number"===typeof c&&this.objects[a][t].gid===
c&&(q=!0),"undefined"!==typeof this.objects[a][t].id&&"number"===typeof c&&this.objects[a][t].id===c&&(q=!0),"undefined"!==typeof this.objects[a][t].name&&"string"===typeof c&&this.objects[a][t].name===c&&(q=!0),q){n=new k(this.game,this.objects[a][t].x,this.objects[a][t].y,d,e);n.name=this.objects[a][t].name;n.visible=this.objects[a][t].visible;n.autoCull=f;n.exists=g;n.width=this.objects[a][t].width;n.height=this.objects[a][t].height;this.objects[a][t].rotation&&(n.angle=this.objects[a][t].rotation);
m&&(n.y-=n.height);h.add(n);for(var x in this.objects[a][t].properties)h.set(n,x,this.objects[a][t].properties[x],!1,!1,0,!0)}}else console.warn("Tilemap.createFromObjects: Invalid objectgroup name given: "+a)},createFromTiles:function(a,c,d,e,g,f){"number"===typeof a&&(a=[a]);void 0===c||null===c?c=[]:"number"===typeof c&&(c=[c]);e=this.getLayer(e);void 0===g&&(g=this.game.world);void 0===f&&(f={});void 0===f.customClass&&(f.customClass=b.Sprite);void 0===f.adjustY&&(f.adjustY=!0);var h=this.layers[e].width,
k=this.layers[e].height;this.copy(0,0,h,k,e);if(2>this._results.length)return 0;for(var m=0,n,q=1,t=this._results.length;q<t;q++)if(-1!==a.indexOf(this._results[q].index)){n=new f.customClass(this.game,this._results[q].worldX,this._results[q].worldY,d);for(var r in f)n[r]=f[r];g.add(n);m++}if(1===c.length)for(q=0;q<a.length;q++)this.replace(a[q],c[0],0,0,h,k,e);else if(1<c.length)for(q=0;q<a.length;q++)this.replace(a[q],c[q],0,0,h,k,e);return m},createLayer:function(a,c,d,e){void 0===c&&(c=this.game.width);
void 0===d&&(d=this.game.height);void 0===e&&(e=this.game.world);var g=a;"string"===typeof a&&(g=this.getLayerIndex(a));if(null===g||g>this.layers.length)console.warn("Tilemap.createLayer: Invalid layer ID given: "+g);else return e.add(new b.TilemapLayer(this.game,this,g,c,d))},createBlankLayer:function(a,c,d,e,g,f){void 0===f&&(f=this.game.world);if(null!==this.getLayerIndex(a))console.warn("Tilemap.createBlankLayer: Layer with matching name already exists");else{for(var h={name:a,x:0,y:0,width:c,
height:d,widthInPixels:c*e,heightInPixels:d*g,alpha:1,visible:!0,properties:{},indexes:[],callbacks:[],bodies:[],data:null},k,m=[],n=0;n<d;n++){k=[];for(var q=0;q<c;q++)k.push(new b.Tile(h,-1,q,n,e,g));m.push(k)}h.data=m;this.layers.push(h);this.currentLayer=this.layers.length-1;c=h.widthInPixels;h=h.heightInPixels;c>this.game.width&&(c=this.game.width);h>this.game.height&&(h=this.game.height);m=new b.TilemapLayer(this.game,this,this.layers.length-1,c,h);m.name=a;return f.add(m)}},getIndex:function(a,
b){for(var d=0;d<a.length;d++)if(a[d].name===b)return d;return null},getLayerIndex:function(a){return this.getIndex(this.layers,a)},getTilesetIndex:function(a){return this.getIndex(this.tilesets,a)},getImageIndex:function(a){return this.getIndex(this.images,a)},getObjectIndex:function(a){return this.getIndex(this.objects,a)},setTileIndexCallback:function(a,b,d,e){e=this.getLayer(e);if("number"===typeof a)this.layers[e].callbacks[a]={callback:b,callbackContext:d};else for(var g=0,f=a.length;g<f;g++)this.layers[e].callbacks[a[g]]=
{callback:b,callbackContext:d}},setTileLocationCallback:function(a,b,d,e,g,f,h){h=this.getLayer(h);this.copy(a,b,d,e,h);if(!(2>this._results.length))for(a=1;a<this._results.length;a++)this._results[a].setCollisionCallback(g,f)},setCollision:function(a,b,d,e){void 0===b&&(b=!0);void 0===e&&(e=!0);d=this.getLayer(d);if("number"===typeof a)return this.setCollisionByIndex(a,b,d,!0);if(Array.isArray(a)){for(var g=0;g<a.length;g++)this.setCollisionByIndex(a[g],b,d,!1);e&&this.calculateFaces(d)}},setCollisionBetween:function(a,
b,d,e,g){void 0===d&&(d=!0);void 0===g&&(g=!0);e=this.getLayer(e);if(!(a>b)){for(;a<=b;a++)this.setCollisionByIndex(a,d,e,!1);g&&this.calculateFaces(e)}},setCollisionByExclusion:function(a,b,d,e){void 0===b&&(b=!0);void 0===e&&(e=!0);d=this.getLayer(d);for(var g=0,f=this.tiles.length;g<f;g++)-1===a.indexOf(g)&&this.setCollisionByIndex(g,b,d,!1);e&&this.calculateFaces(d)},setCollisionByIndex:function(a,b,d,e){void 0===b&&(b=!0);void 0===d&&(d=this.currentLayer);void 0===e&&(e=!0);if(b)this.collideIndexes.push(a);
else{var g=this.collideIndexes.indexOf(a);-1<g&&this.collideIndexes.splice(g,1)}for(g=0;g<this.layers[d].height;g++)for(var f=0;f<this.layers[d].width;f++){var h=this.layers[d].data[g][f];h&&h.index===a&&(b?h.setCollision(!0,!0,!0,!0):h.resetCollision(),h.faceTop=b,h.faceBottom=b,h.faceLeft=b,h.faceRight=b)}e&&this.calculateFaces(d);return d},getLayer:function(a){void 0===a?a=this.currentLayer:"string"===typeof a?a=this.getLayerIndex(a):a instanceof b.TilemapLayer&&(a=a.index);return a},setPreventRecalculate:function(a){!0===
a&&!0!==this.preventingRecalculate&&(this.preventingRecalculate=!0,this.needToRecalculate={});if(!1===a&&!0===this.preventingRecalculate){this.preventingRecalculate=!1;for(var b in this.needToRecalculate)this.calculateFaces(b);this.needToRecalculate=!1}},calculateFaces:function(a){if(this.preventingRecalculate)this.needToRecalculate[a]=!0;else for(var b=null,d=null,e=null,g=null,f=0,h=this.layers[a].height;f<h;f++)for(var k=0,m=this.layers[a].width;k<m;k++){var n=this.layers[a].data[f][k];n&&(b=this.getTileAbove(a,
k,f),d=this.getTileBelow(a,k,f),e=this.getTileLeft(a,k,f),g=this.getTileRight(a,k,f),n.collides&&(n.faceTop=!0,n.faceBottom=!0,n.faceLeft=!0,n.faceRight=!0),b&&b.collides&&(n.faceTop=!1),d&&d.collides&&(n.faceBottom=!1),e&&e.collides&&(n.faceLeft=!1),g&&g.collides&&(n.faceRight=!1))}},getTileAbove:function(a,b,d){return 0<d?this.layers[a].data[d-1][b]:null},getTileBelow:function(a,b,d){return d<this.layers[a].height-1?this.layers[a].data[d+1][b]:null},getTileLeft:function(a,b,d){return 0<b?this.layers[a].data[d][b-
1]:null},getTileRight:function(a,b,d){return b<this.layers[a].width-1?this.layers[a].data[d][b+1]:null},setLayer:function(a){a=this.getLayer(a);this.layers[a]&&(this.currentLayer=a)},hasTile:function(a,b,d){d=this.getLayer(d);return-1<this.layers[d].data[b][a].index},removeTile:function(a,c,d){d=this.getLayer(d);if(0<=a&&a<this.layers[d].width&&0<=c&&c<this.layers[d].height&&this.hasTile(a,c,d)){var e=this.layers[d].data[c][a];this.layers[d].data[c][a]=new b.Tile(this.layers[d],-1,a,c,this.tileWidth,
this.tileHeight);this.layers[d].dirty=!0;this.calculateFaces(d);return e}},removeTileWorldXY:function(a,b,d,e,f){f=this.getLayer(f);a=this.game.math.snapToFloor(a,d)/d;b=this.game.math.snapToFloor(b,e)/e;return this.removeTile(a,b,f)},putTile:function(a,c,d,e){if(null===a)return this.removeTile(c,d,e);e=this.getLayer(e);if(0<=c&&c<this.layers[e].width&&0<=d&&d<this.layers[e].height){var f;a instanceof b.Tile?(f=a.index,this.hasTile(c,d,e)?this.layers[e].data[d][c].copy(a):this.layers[e].data[d][c]=
new b.Tile(e,f,c,d,a.width,a.height)):(f=a,this.hasTile(c,d,e)?this.layers[e].data[d][c].index=f:this.layers[e].data[d][c]=new b.Tile(this.layers[e],f,c,d,this.tileWidth,this.tileHeight));-1<this.collideIndexes.indexOf(f)?this.layers[e].data[d][c].setCollision(!0,!0,!0,!0):this.layers[e].data[d][c].resetCollision();this.layers[e].dirty=!0;this.calculateFaces(e);return this.layers[e].data[d][c]}return null},putTileWorldXY:function(a,b,d,e,f,h){h=this.getLayer(h);b=this.game.math.snapToFloor(b,e)/e;
d=this.game.math.snapToFloor(d,f)/f;return this.putTile(a,b,d,h)},searchTileIndex:function(a,b,d,e){void 0===b&&(b=0);void 0===d&&(d=!1);e=this.getLayer(e);var f=0;if(d)for(d=this.layers[e].height-1;0<=d;d--)for(var h=this.layers[e].width-1;0<=h;h--){if(this.layers[e].data[d][h].index===a){if(f===b)return this.layers[e].data[d][h];f++}}else for(d=0;d<this.layers[e].height;d++)for(h=0;h<this.layers[e].width;h++)if(this.layers[e].data[d][h].index===a){if(f===b)return this.layers[e].data[d][h];f++}return null},
getTile:function(a,b,d,e){void 0===e&&(e=!1);d=this.getLayer(d);return 0<=a&&a<this.layers[d].width&&0<=b&&b<this.layers[d].height?-1===this.layers[d].data[b][a].index?e?this.layers[d].data[b][a]:null:this.layers[d].data[b][a]:null},getTileWorldXY:function(a,b,d,e,f,h){void 0===d&&(d=this.tileWidth);void 0===e&&(e=this.tileHeight);f=this.getLayer(f);a=this.game.math.snapToFloor(a,d)/d;b=this.game.math.snapToFloor(b,e)/e;return this.getTile(a,b,f,h)},copy:function(a,b,d,e,f){f=this.getLayer(f);if(this.layers[f]){void 0===
a&&(a=0);void 0===b&&(b=0);void 0===d&&(d=this.layers[f].width);void 0===e&&(e=this.layers[f].height);0>a&&(a=0);0>b&&(b=0);d>this.layers[f].width&&(d=this.layers[f].width);e>this.layers[f].height&&(e=this.layers[f].height);this._results.length=0;this._results.push({x:a,y:b,width:d,height:e,layer:f});for(var h=b;h<b+e;h++)for(var k=a;k<a+d;k++)this._results.push(this.layers[f].data[h][k]);return this._results}this._results.length=0},paste:function(a,b,d,e){void 0===a&&(a=0);void 0===b&&(b=0);e=this.getLayer(e);
if(d&&!(2>d.length)){a-=d[1].x;b-=d[1].y;for(var f=1;f<d.length;f++)this.layers[e].data[b+d[f].y][a+d[f].x].copy(d[f]);this.layers[e].dirty=!0;this.calculateFaces(e)}},swap:function(a,b,d,e,f,h,k){k=this.getLayer(k);this.copy(d,e,f,h,k);2>this._results.length||(this._tempA=a,this._tempB=b,this._results.forEach(this.swapHandler,this),this.paste(d,e,this._results,k))},swapHandler:function(a){a.index===this._tempA?a.index=this._tempB:a.index===this._tempB&&(a.index=this._tempA)},forEach:function(a,b,
d,e,f,h,k){k=this.getLayer(k);this.copy(d,e,f,h,k);2>this._results.length||(this._results.forEach(a,b),this.paste(d,e,this._results,k))},replace:function(a,b,d,e,f,h,k){k=this.getLayer(k);this.copy(d,e,f,h,k);if(!(2>this._results.length)){for(f=1;f<this._results.length;f++)this._results[f].index===a&&(this._results[f].index=b);this.paste(d,e,this._results,k)}},random:function(a,b,d,e,f){f=this.getLayer(f);this.copy(a,b,d,e,f);if(!(2>this._results.length)){d=[];for(e=1;e<this._results.length;e++)if(this._results[e].index){var h=
this._results[e].index;-1===d.indexOf(h)&&d.push(h)}for(e=1;e<this._results.length;e++)this._results[e].index=this.game.rnd.pick(d);this.paste(a,b,this._results,f)}},shuffle:function(a,c,d,e,f){f=this.getLayer(f);this.copy(a,c,d,e,f);if(!(2>this._results.length)){d=[];for(e=1;e<this._results.length;e++)this._results[e].index&&d.push(this._results[e].index);b.Utils.shuffle(d);for(e=1;e<this._results.length;e++)this._results[e].index=d[e-1];this.paste(a,c,this._results,f)}},fill:function(a,b,d,e,f,
h){h=this.getLayer(h);this.copy(b,d,e,f,h);if(!(2>this._results.length)){for(e=1;e<this._results.length;e++)this._results[e].index=a;this.paste(b,d,this._results,h)}},removeAllLayers:function(){this.currentLayer=this.layers.length=0},dump:function(){for(var a="",b=[""],d=0;d<this.layers[this.currentLayer].height;d++){for(var e=0;e<this.layers[this.currentLayer].width;e++)a+="%c  ",1<this.layers[this.currentLayer].data[d][e]?this.debugMap[this.layers[this.currentLayer].data[d][e]]?b.push("background: "+
this.debugMap[this.layers[this.currentLayer].data[d][e]]):b.push("background: #ffffff"):b.push("background: rgb(0, 0, 0)");a+="\n"}b[0]=a;console.log.apply(console,b)},destroy:function(){this.removeAllLayers();this.data=[];this.game=null}};b.Tilemap.prototype.constructor=b.Tilemap;Object.defineProperty(b.Tilemap.prototype,"layer",{get:function(){return this.layers[this.currentLayer]},set:function(a){a!==this.currentLayer&&this.setLayer(a)}});b.TilemapLayer=function(a,c,d,e,f){e|=0;f|=0;b.Sprite.call(this,
a,0,0);this.map=c;this.index=d;this.layer=c.layers[d];this.canvas=b.Canvas.create(e,f);this.context=this.canvas.getContext("2d");this.setTexture(new PIXI.Texture(new PIXI.BaseTexture(this.canvas)));this.physicsType=this.type=b.TILEMAPLAYER;this.renderSettings={enableScrollDelta:!1,overdrawRatio:.2,copyCanvas:null};this.debug=!1;this.exists=!0;this.debugSettings={missingImageFill:"rgb(255,255,255)",debuggedTileOverfill:"rgba(0,255,0,0.4)",forceFullRedraw:!0,debugAlpha:.5,facingEdgeStroke:"rgba(0,255,0,1)",
collidingTileOverfill:"rgba(0,255,0,0.2)"};this.scrollFactorY=this.scrollFactorX=1;this.dirty=!0;this.rayStepRate=4;this._wrap=!1;this._mc={scrollX:0,scrollY:0,renderWidth:0,renderHeight:0,tileWidth:c.tileWidth,tileHeight:c.tileHeight,cw:c.tileWidth,ch:c.tileHeight,tilesets:[]};this._scrollY=this._scrollX=0;this._results=[];a.device.canvasBitBltShift||(this.renderSettings.copyCanvas=b.TilemapLayer.ensureSharedCopyCanvas());this.fixedToCamera=!0};b.TilemapLayer.prototype=Object.create(b.Sprite.prototype);
b.TilemapLayer.prototype.constructor=b.TilemapLayer;b.TilemapLayer.prototype.preUpdateCore=b.Component.Core.preUpdate;b.TilemapLayer.sharedCopyCanvas=null;b.TilemapLayer.ensureSharedCopyCanvas=function(){this.sharedCopyCanvas||(this.sharedCopyCanvas=b.Canvas.create(2,2));return this.sharedCopyCanvas};b.TilemapLayer.prototype.preUpdate=function(){return this.preUpdateCore()};b.TilemapLayer.prototype.postUpdate=function(){b.Component.FixedToCamera.postUpdate.call(this);var a=this.game.camera;this.scrollX=
a.x*this.scrollFactorX/this.scale.x;this.scrollY=a.y*this.scrollFactorY/this.scale.y;this.render()};b.TilemapLayer.prototype.resize=function(a,b){this.canvas.width=a;this.canvas.height=b;this.texture.frame.resize(a,b);this.texture.width=a;this.texture.height=b;this.texture.crop.width=a;this.texture.crop.height=b;this.texture.baseTexture.width=a;this.texture.baseTexture.height=b;this.texture.baseTexture.dirty();this.texture.requiresUpdate=!0;this.texture._updateUvs();this.dirty=!0};b.TilemapLayer.prototype.resizeWorld=
function(){this.game.world.setBounds(0,0,this.layer.widthInPixels*this.scale.x,this.layer.heightInPixels*this.scale.y)};b.TilemapLayer.prototype._fixX=function(a){0>a&&(a=0);return 1===this.scrollFactorX?a:this._scrollX+(a-this._scrollX/this.scrollFactorX)};b.TilemapLayer.prototype._unfixX=function(a){return 1===this.scrollFactorX?a:this._scrollX/this.scrollFactorX+(a-this._scrollX)};b.TilemapLayer.prototype._fixY=function(a){0>a&&(a=0);return 1===this.scrollFactorY?a:this._scrollY+(a-this._scrollY/
this.scrollFactorY)};b.TilemapLayer.prototype._unfixY=function(a){return 1===this.scrollFactorY?a:this._scrollY/this.scrollFactorY+(a-this._scrollY)};b.TilemapLayer.prototype.getTileX=function(a){return Math.floor(this._fixX(a)/this._mc.tileWidth)};b.TilemapLayer.prototype.getTileY=function(a){return Math.floor(this._fixY(a)/this._mc.tileHeight)};b.TilemapLayer.prototype.getTileXY=function(a,b,d){d.x=this.getTileX(a);d.y=this.getTileY(b);return d};b.TilemapLayer.prototype.getRayCastTiles=function(a,
b,d,e){b||(b=this.rayStepRate);void 0===d&&(d=!1);void 0===e&&(e=!1);d=this.getTiles(a.x,a.y,a.width,a.height,d,e);if(0===d.length)return[];a=a.coordinatesOnLine(b);b=[];for(e=0;e<d.length;e++)for(var f=0;f<a.length;f++){var h=d[e],k=a[f];if(h.containsPoint(k[0],k[1])){b.push(h);break}}return b};b.TilemapLayer.prototype.getTiles=function(a,b,d,e,f,h){void 0===f&&(f=!1);void 0===h&&(h=!1);var k=!(f||h);a=this._fixX(a);b=this._fixY(b);var m=Math.floor(a/(this._mc.cw*this.scale.x)),n=Math.floor(b/(this._mc.ch*
this.scale.y));a=Math.ceil((a+d)/(this._mc.cw*this.scale.x))-m;for(b=Math.ceil((b+e)/(this._mc.ch*this.scale.y))-n;this._results.length;)this._results.pop();for(e=n;e<n+b;e++)for(d=m;d<m+a;d++){var w=this.layer.data[e];w&&w[d]&&(k||w[d].isInteresting(f,h))&&this._results.push(w[d])}return this._results.slice()};b.TilemapLayer.prototype.resolveTileset=function(a){var b=this._mc.tilesets;if(2E3>a)for(;b.length<a;)b.push(void 0);var d=this.map.tiles[a]&&this.map.tiles[a][2];return null!=d&&(d=this.map.tilesets[d])&&
d.containsTileIndex(a)?b[a]=d:b[a]=null};b.TilemapLayer.prototype.resetTilesetCache=function(){for(var a=this._mc.tilesets;a.length;)a.pop()};b.TilemapLayer.prototype.setScale=function(a,b){a=a||1;b=b||a;for(var d=0;d<this.layer.data.length;d++)for(var e=this.layer.data[d],f=0;f<e.length;f++){var h=e[f];h.width=this.map.tileWidth*a;h.height=this.map.tileHeight*b;h.worldX=h.x*h.width;h.worldY=h.y*h.height}this.scale.setTo(a,b)};b.TilemapLayer.prototype.shiftCanvas=function(a,b,d){var e=a.canvas,f=
e.width-Math.abs(b),h=e.height-Math.abs(d),k=0,m=0,n=b,w=d;0>b&&(k=-b,n=0);0>d&&(m=-d,w=0);if(b=this.renderSettings.copyCanvas){if(b.width<f||b.height<h)b.width=f,b.height=h;d=b.getContext("2d");d.clearRect(0,0,f,h);d.drawImage(e,k,m,f,h,0,0,f,h);a.clearRect(n,w,f,h);a.drawImage(b,0,0,f,h,n,w,f,h)}else a.save(),a.globalCompositeOperation="copy",a.drawImage(e,k,m,f,h,n,w,f,h),a.restore()};b.TilemapLayer.prototype.renderRegion=function(a,b,d,e,f,h){var k=this.context,m=this.layer.width,n=this.layer.height,
w=this._mc.tileWidth,q=this._mc.tileHeight,t=this._mc.tilesets,r=NaN;this._wrap||(d<=f&&(d=Math.max(0,d),f=Math.min(m-1,f)),e<=h&&(e=Math.max(0,e),h=Math.min(n-1,h)));a=d*w-a;var x=(d+1048576*m)%m,v,A,C;k.fillStyle=this.tileColor;A=(e+1048576*n)%n;h-=e;for(e=e*q-b;0<=h;A++,h--,e+=q){A>=n&&(A-=n);var B=this.layer.data[A];v=x;C=f-d;for(b=a;0<=C;v++,C--,b+=w){v>=m&&(v-=m);var z=B[v];if(z&&!(0>z.index)){var E=z.index,D=t[E];void 0===D&&(D=this.resolveTileset(E));z.alpha===r||this.debug||(r=k.globalAlpha=
z.alpha);D?z.rotation||z.flipped?(k.save(),k.translate(b+z.centerX,e+z.centerY),k.rotate(z.rotation),z.flipped&&k.scale(-1,1),D.draw(k,-z.centerX,-z.centerY,E),k.restore()):D.draw(k,b,e,E):this.debugSettings.missingImageFill&&(k.fillStyle=this.debugSettings.missingImageFill,k.fillRect(b,e,w,q));z.debug&&this.debugSettings.debuggedTileOverfill&&(k.fillStyle=this.debugSettings.debuggedTileOverfill,k.fillRect(b,e,w,q))}}}};b.TilemapLayer.prototype.renderDeltaScroll=function(a,b){var d=this._mc.scrollX,
e=this._mc.scrollY,f=this.canvas.width,h=this.canvas.height,k=this._mc.tileWidth,m=this._mc.tileHeight,n=0,w=-k,q=0,t=-m;0>a?(n=f+a,w=f-1):0<a&&(w=a);0>b?(q=h+b,t=h-1):0<b&&(t=b);this.shiftCanvas(this.context,a,b);n=Math.floor((n+d)/k);w=Math.floor((w+d)/k);q=Math.floor((q+e)/m);t=Math.floor((t+e)/m);n<=w&&(this.context.clearRect(n*k-d,0,(w-n+1)*k,h),this.renderRegion(d,e,n,Math.floor((0+e)/m),w,Math.floor((h-1+e)/m)));q<=t&&(this.context.clearRect(0,q*m-e,f,(t-q+1)*m),this.renderRegion(d,e,Math.floor((0+
d)/k),q,Math.floor((f-1+d)/k),t))};b.TilemapLayer.prototype.renderFull=function(){var a=this._mc.scrollX,b=this._mc.scrollY,d=this.canvas.width,e=this.canvas.height,f=this._mc.tileWidth,h=this._mc.tileHeight,k=Math.floor(a/f),f=Math.floor((d-1+a)/f),m=Math.floor(b/h),h=Math.floor((e-1+b)/h);this.context.clearRect(0,0,d,e);this.renderRegion(a,b,k,m,f,h)};b.TilemapLayer.prototype.render=function(){var a=!1;if(this.visible){if(this.dirty||this.layer.dirty)this.layer.dirty=!1,a=!0;var b=this.canvas.width,
d=this.canvas.height,e=this._scrollX|0,f=this._scrollY|0,h=this._mc,k=h.scrollX-e,m=h.scrollY-f;if(a||0!==k||0!==m||h.renderWidth!==b||h.renderHeight!==d){this.context.save();h.scrollX=e;h.scrollY=f;if(h.renderWidth!==b||h.renderHeight!==d)h.renderWidth=b,h.renderHeight=d;this.debug&&(this.context.globalAlpha=this.debugSettings.debugAlpha,this.debugSettings.forceFullRedraw&&(a=!0));!a&&this.renderSettings.enableScrollDelta&&Math.abs(k)+Math.abs(m)<Math.min(b,d)?this.renderDeltaScroll(k,m):this.renderFull();
this.debug&&(this.context.globalAlpha=1,this.renderDebug());this.texture.baseTexture.dirty();this.dirty=!1;this.context.restore();return!0}}};b.TilemapLayer.prototype.renderDebug=function(){var a=this._mc.scrollX,b=this._mc.scrollY,d=this.context,e=this.layer.width,f=this.layer.height,h=this._mc.tileWidth,k=this._mc.tileHeight,m=Math.floor(a/h),n=Math.floor((this.canvas.width-1+a)/h),w=Math.floor(b/k),q=Math.floor((this.canvas.height-1+b)/k),a=m*h-a,t=(m+1048576*e)%e,r,x,v;d.strokeStyle=this.debugSettings.facingEdgeStroke;
x=(w+1048576*f)%f;q-=w;for(w=w*k-b;0<=q;x++,q--,w+=k){x>=f&&(x-=f);var A=this.layer.data[x];r=t;v=n-m;for(b=a;0<=v;r++,v--,b+=h){r>=e&&(r-=e);var C=A[r];!C||0>C.index||!C.collides||(this.debugSettings.collidingTileOverfill&&(d.fillStyle=this.debugSettings.collidingTileOverfill,d.fillRect(b,w,this._mc.cw,this._mc.ch)),this.debugSettings.facingEdgeStroke&&(d.beginPath(),C.faceTop&&(d.moveTo(b,w),d.lineTo(b+this._mc.cw,w)),C.faceBottom&&(d.moveTo(b,w+this._mc.ch),d.lineTo(b+this._mc.cw,w+this._mc.ch)),
C.faceLeft&&(d.moveTo(b,w),d.lineTo(b,w+this._mc.ch)),C.faceRight&&(d.moveTo(b+this._mc.cw,w),d.lineTo(b+this._mc.cw,w+this._mc.ch)),d.stroke()))}}};Object.defineProperty(b.TilemapLayer.prototype,"wrap",{get:function(){return this._wrap},set:function(a){this._wrap=a;this.dirty=!0}});Object.defineProperty(b.TilemapLayer.prototype,"scrollX",{get:function(){return this._scrollX},set:function(a){this._scrollX=a}});Object.defineProperty(b.TilemapLayer.prototype,"scrollY",{get:function(){return this._scrollY},
set:function(a){this._scrollY=a}});Object.defineProperty(b.TilemapLayer.prototype,"collisionWidth",{get:function(){return this._mc.cw},set:function(a){this._mc.cw=a|0;this.dirty=!0}});Object.defineProperty(b.TilemapLayer.prototype,"collisionHeight",{get:function(){return this._mc.ch},set:function(a){this._mc.ch=a|0;this.dirty=!0}});b.TilemapParser={parse:function(a,c,d,e,f,h){void 0===d&&(d=32);void 0===e&&(e=32);void 0===f&&(f=10);void 0===h&&(h=10);if(void 0===c)return this.getEmptyData();if(null===
c)return this.getEmptyData(d,e,f,h);if(a=a.cache.getTilemapData(c)){if(a.format===b.Tilemap.CSV)return this.parseCSV(c,a.data,d,e);if(!a.format||a.format===b.Tilemap.TILED_JSON)return this.parseTiledJSON(a.data)}else console.warn("Phaser.TilemapParser.parse - No map data found for key "+c)},parseCSV:function(a,c,d,e){var f=this.getEmptyData();c=c.trim();var h=[];c=c.split("\n");for(var k=c.length,m=0,n=0;n<c.length;n++){h[n]=[];for(var w=c[n].split(","),q=0;q<w.length;q++)h[n][q]=new b.Tile(f.layers[0],
parseInt(w[q],10),q,n,d,e);0===m&&(m=w.length)}f.format=b.Tilemap.CSV;f.name=a;f.width=m;f.height=k;f.tileWidth=d;f.tileHeight=e;f.widthInPixels=m*d;f.heightInPixels=k*e;f.layers[0].width=m;f.layers[0].height=k;f.layers[0].widthInPixels=f.widthInPixels;f.layers[0].heightInPixels=f.heightInPixels;f.layers[0].data=h;return f},getEmptyData:function(a,b,d,e){var f={width:0,height:0,tileWidth:0,tileHeight:0};"undefined"!==typeof a&&null!==a&&(f.tileWidth=a);"undefined"!==typeof b&&null!==b&&(f.tileHeight=
b);"undefined"!==typeof d&&null!==d&&(f.width=d);"undefined"!==typeof e&&null!==e&&(f.height=e);f.orientation="orthogonal";f.version="1";f.properties={};f.widthInPixels=0;f.heightInPixels=0;a=[];a.push({name:"layer",x:0,y:0,width:0,height:0,widthInPixels:0,heightInPixels:0,alpha:1,visible:!0,properties:{},indexes:[],callbacks:[],bodies:[],data:[]});f.layers=a;f.images=[];f.objects={};f.collision={};f.tilesets=[];f.tiles=[];return f},parseTiledJSON:function(a){function c(a,b){var c={},d;for(d in b){var e=
b[d];"undefined"!==typeof a[e]&&(c[e]=a[e])}return c}if("orthogonal"!==a.orientation)return console.warn("TilemapParser.parseTiledJSON - Only orthogonal map types are supported in this version of Phaser"),null;var d={};d.width=a.width;d.height=a.height;d.tileWidth=a.tilewidth;d.tileHeight=a.tileheight;d.orientation=a.orientation;d.format=b.Tilemap.TILED_JSON;d.version=a.version;d.properties=a.properties;d.widthInPixels=d.width*d.tileWidth;d.heightInPixels=d.height*d.tileHeight;for(var e=[],f=0;f<
a.layers.length;f++)if("tilelayer"===a.layers[f].type){var h={name:a.layers[f].name,x:a.layers[f].x,y:a.layers[f].y,width:a.layers[f].width,height:a.layers[f].height,widthInPixels:a.layers[f].width*a.tilewidth,heightInPixels:a.layers[f].height*a.tileheight,alpha:a.layers[f].opacity,visible:a.layers[f].visible,properties:{},indexes:[],callbacks:[],bodies:[]};a.layers[f].properties&&(h.properties=a.layers[f].properties);for(var k=0,m=[],n=[],w,q,t,r,x=0,v=a.layers[f].data.length;x<v;x++){w=0;q=!1;r=
a.layers[f].data[x];if(536870912<r)switch(t=0,2147483648<r&&(r-=2147483648,t+=4),1073741824<r&&(r-=1073741824,t+=2),536870912<r&&(r-=536870912,t+=1),t){case 5:w=Math.PI/2;break;case 6:w=Math.PI;break;case 3:w=3*Math.PI/2;break;case 4:w=0;q=!0;break;case 7:w=Math.PI/2;q=!0;break;case 2:w=Math.PI;q=!0;break;case 1:w=3*Math.PI/2,q=!0}0<r?(m.push(new b.Tile(h,r,k,n.length,a.tilewidth,a.tileheight)),m[m.length-1].rotation=w,m[m.length-1].flipped=q):m.push(new b.Tile(h,-1,k,n.length,a.tilewidth,a.tileheight));
k++;k===a.layers[f].width&&(n.push(m),k=0,m=[])}h.data=n;e.push(h)}d.layers=e;v=[];for(f=0;f<a.layers.length;f++)"imagelayer"===a.layers[f].type&&(h={name:a.layers[f].name,image:a.layers[f].image,x:a.layers[f].x,y:a.layers[f].y,alpha:a.layers[f].opacity,visible:a.layers[f].visible,properties:{}},a.layers[f].properties&&(h.properties=a.layers[f].properties),v.push(h));d.images=v;k=[];m=[];for(f=0;f<a.tilesets.length;f++)if(v=a.tilesets[f],v.image)h=new b.Tileset(v.name,v.firstgid,v.tilewidth,v.tileheight,
v.margin,v.spacing,v.properties),v.tileproperties&&(h.tileProperties=v.tileproperties),h.updateTileData(v.imagewidth,v.imageheight),k.push(h);else{x=new b.ImageCollection(v.name,v.firstgid,v.tilewidth,v.tileheight,v.margin,v.spacing,v.properties);for(f in v.tiles)h=v.tiles[f].image,r=v.firstgid+parseInt(f,10),x.addImage(r,h);m.push(x)}d.tilesets=k;d.imagecollections=m;h={};k={};for(f=0;f<a.layers.length;f++)if("objectgroup"===a.layers[f].type)for(h[a.layers[f].name]=[],k[a.layers[f].name]=[],m=0,
v=a.layers[f].objects.length;m<v;m++){if(a.layers[f].objects[m].gid)r={gid:a.layers[f].objects[m].gid,name:a.layers[f].objects[m].name,type:a.layers[f].objects[m].hasOwnProperty("type")?a.layers[f].objects[m].type:"",x:a.layers[f].objects[m].x,y:a.layers[f].objects[m].y,visible:a.layers[f].objects[m].visible,properties:a.layers[f].objects[m].properties},a.layers[f].objects[m].rotation&&(r.rotation=a.layers[f].objects[m].rotation);else if(a.layers[f].objects[m].polyline){r={name:a.layers[f].objects[m].name,
type:a.layers[f].objects[m].type,x:a.layers[f].objects[m].x,y:a.layers[f].objects[m].y,width:a.layers[f].objects[m].width,height:a.layers[f].objects[m].height,visible:a.layers[f].objects[m].visible,properties:a.layers[f].objects[m].properties};a.layers[f].objects[m].rotation&&(r.rotation=a.layers[f].objects[m].rotation);r.polyline=[];for(x=0;x<a.layers[f].objects[m].polyline.length;x++)r.polyline.push([a.layers[f].objects[m].polyline[x].x,a.layers[f].objects[m].polyline[x].y]);k[a.layers[f].name].push(r)}else if(a.layers[f].objects[m].polygon)for(r=
c(a.layers[f].objects[m],"name type x y visible rotation properties".split(" ")),r.polygon=[],x=0;x<a.layers[f].objects[m].polygon.length;x++)r.polygon.push([a.layers[f].objects[m].polygon[x].x,a.layers[f].objects[m].polygon[x].y]);else a.layers[f].objects[m].ellipse?r=c(a.layers[f].objects[m],"name type ellipse x y width height visible rotation properties".split(" ")):(r=c(a.layers[f].objects[m],"name type x y width height visible rotation properties".split(" ")),r.rectangle=!0);h[a.layers[f].name].push(r)}d.objects=
h;d.collision=k;d.tiles=[];for(f=0;f<d.tilesets.length;f++)for(v=d.tilesets[f],a=k=v.tileMargin,r=m=h=0,x=v.firstgid;x<v.firstgid+v.total;x++){d.tiles[x]=[k,a,f];k+=v.tileWidth+v.tileSpacing;h++;if(h===v.total)break;m++;if(m===v.columns&&(k=v.tileMargin,a+=v.tileHeight+v.tileSpacing,m=0,r++,r===v.rows))break}for(f=0;f<d.layers.length;f++)for(h=d.layers[f],k=0;k<h.data.length;k++)for(m=h.data[k],r=0;r<m.length;r++)a=m[r],0>a.index||(v=d.tiles[a.index][2],v=d.tilesets[v],v.tileProperties&&v.tileProperties[a.index-
v.firstgid]&&(a.properties=b.Utils.mixin(v.tileProperties[a.index-v.firstgid],a.properties)));return d}};b.Tileset=function(a,b,d,e,f,h,k){if(void 0===d||0>=d)d=32;if(void 0===e||0>=e)e=32;void 0===f&&(f=0);void 0===h&&(h=0);this.name=a;this.firstgid=b|0;this.tileWidth=d|0;this.tileHeight=e|0;this.tileMargin=f|0;this.tileSpacing=h|0;this.properties=k||{};this.image=null;this.total=this.columns=this.rows=0;this.drawCoords=[]};b.Tileset.prototype={draw:function(a,b,d,e){e=e-this.firstgid<<1;0<=e&&e+
1<this.drawCoords.length&&a.drawImage(this.image,this.drawCoords[e],this.drawCoords[e+1],this.tileWidth,this.tileHeight,b,d,this.tileWidth,this.tileHeight)},containsTileIndex:function(a){return a>=this.firstgid&&a<this.firstgid+this.total},setImage:function(a){this.image=a;this.updateTileData(a.width,a.height)},setSpacing:function(a,b){this.tileMargin=a|0;this.tileSpacing=b|0;this.image&&this.updateTileData(this.image.width,this.image.height)},updateTileData:function(a,b){var d=(b-2*this.tileMargin+
this.tileSpacing)/(this.tileHeight+this.tileSpacing),e=(a-2*this.tileMargin+this.tileSpacing)/(this.tileWidth+this.tileSpacing);0===d%1&&0===e%1||console.warn("Phaser.Tileset - image tile area is not an even multiple of tile size");d=Math.floor(d);e=Math.floor(e);(this.rows&&this.rows!==d||this.columns&&this.columns!==e)&&console.warn("Phaser.Tileset - actual and expected number of tile rows and columns differ");this.rows=d;this.columns=e;this.total=d*e;this.drawCoords.length=0;for(var e=d=this.tileMargin,
f=0;f<this.rows;f++){for(var h=0;h<this.columns;h++)this.drawCoords.push(d),this.drawCoords.push(e),d+=this.tileWidth+this.tileSpacing;d=this.tileMargin;e+=this.tileHeight+this.tileSpacing}}};b.Tileset.prototype.constructor=b.Tileset;b.Particles=function(a){this.game=a;this.emitters={};this.ID=0};b.Particles.prototype={add:function(a){return this.emitters[a.name]=a},remove:function(a){delete this.emitters[a.name]},update:function(){for(var a in this.emitters)this.emitters[a].exists&&this.emitters[a].update()}};
b.Particles.prototype.constructor=b.Particles;b.Video=function(a,c,d){void 0===c&&(c=null);void 0===d&&(d=null);this.game=a;this.key=c;this.height=this.width=0;this.type=b.VIDEO;this.touchLocked=this.disableTextureUpload=!1;this.onPlay=new b.Signal;this.onChangeSource=new b.Signal;this.onComplete=new b.Signal;this.onAccess=new b.Signal;this.onError=new b.Signal;this.onTimeout=new b.Signal;this.timeout=15E3;this.videoStream=this.video=this._timeOutID=null;this.isStreaming=!1;this.retryLimit=20;this.retry=
0;this.retryInterval=500;this._retryID=null;this._autoplay=this._pending=this._paused=this._codePaused=this._muted=this._codeMuted=!1;if(c&&this.game.cache.checkVideoKey(c)){var e=this.game.cache.getVideo(c);e.isBlob?this.createVideoFromBlob(e.data):this.video=e.data;this.width=this.video.videoWidth;this.height=this.video.videoHeight}else d&&this.createVideoFromURL(d,!1);this.baseTexture=this.video&&!d?new PIXI.BaseTexture(this.video):new PIXI.BaseTexture(PIXI.TextureCache.__default.baseTexture.source);
this.baseTexture.forceLoaded(this.width,this.height);this.texture=new PIXI.Texture(this.baseTexture);this.textureFrame=new b.Frame(0,0,0,this.width,this.height,"video");this.texture.setFrame(this.textureFrame);this.texture.valid=!1;null!==c&&this.video&&(this.texture.valid=this.video.canplay);this.snapshot=null;b.BitmapData&&(this.snapshot=new b.BitmapData(this.game,"",this.width,this.height));!this.game.device.cocoonJS&&(this.game.device.iOS||this.game.device.android)||window.PhaserGlobal&&window.PhaserGlobal.fakeiOSTouchLock?
this.setTouchLock():e&&(e.locked=!1)};b.Video.prototype={connectToMediaStream:function(a,b){a&&b&&(this.video=a,this.videoStream=b,this.isStreaming=!0,this.baseTexture.source=this.video,this.updateTexture(null,this.video.videoWidth,this.video.videoHeight),this.onAccess.dispatch(this));return this},startMediaStream:function(a,b,d){void 0===a&&(a=!1);void 0===b&&(b=null);void 0===d&&(d=null);if(!this.game.device.getUserMedia)return this.onError.dispatch(this,"No getUserMedia"),!1;null!==this.videoStream&&
this.videoStream.stop();this.removeVideoElement();this.video=document.createElement("video");this.video.setAttribute("autoplay","autoplay");null!==b&&(this.video.width=b);null!==d&&(this.video.height=d);this._timeOutID=window.setTimeout(this.getUserMediaTimeout.bind(this),this.timeout);try{navigator.getUserMedia({audio:a,video:!0},this.getUserMediaSuccess.bind(this),this.getUserMediaError.bind(this))}catch(e){this.getUserMediaError(e)}return this},getUserMediaTimeout:function(){clearTimeout(this._timeOutID);
this.onTimeout.dispatch(this)},getUserMediaError:function(a){clearTimeout(this._timeOutID);this.onError.dispatch(this,a)},getUserMediaSuccess:function(a){clearTimeout(this._timeOutID);this.videoStream=a;void 0!==this.video.mozSrcObject?this.video.mozSrcObject=a:this.video.src=window.URL&&window.URL.createObjectURL(a)||a;var b=this;this.video.onloadeddata=function(){function a(){if(0<e)if(0<b.video.videoWidth){var f=b.video.videoWidth,h=b.video.videoHeight;isNaN(b.video.videoHeight)&&(h=f/(4/3));b.video.play();
b.isStreaming=!0;b.baseTexture.source=b.video;b.updateTexture(null,f,h);b.onAccess.dispatch(b)}else window.setTimeout(a,500);else console.warn("Unable to connect to video stream. Webcam error?");e--}var e=10;a()}},createVideoFromBlob:function(a){var b=this;this.video=document.createElement("video");this.video.controls=!1;this.video.setAttribute("autoplay","autoplay");this.video.addEventListener("loadeddata",function(a){b.updateTexture(a)},!0);this.video.src=window.URL.createObjectURL(a);this.video.canplay=
!0;return this},createVideoFromURL:function(a,b){void 0===b&&(b=!1);this.texture&&(this.texture.valid=!1);this.video=document.createElement("video");this.video.controls=!1;b&&this.video.setAttribute("autoplay","autoplay");this.video.src=a;this.video.canplay=!0;this.video.load();this.retry=this.retryLimit;this._retryID=window.setTimeout(this.checkVideoProgress.bind(this),this.retryInterval);this.key=a;return this},updateTexture:function(a,b,d){a=!1;if(void 0===b||null===b)b=this.video.videoWidth,a=
!0;if(void 0===d||null===d)d=this.video.videoHeight;this.width=b;this.height=d;this.baseTexture.source!==this.video&&(this.baseTexture.source=this.video);this.baseTexture.forceLoaded(b,d);this.texture.frame.resize(b,d);this.texture.width=b;this.texture.height=d;this.texture.valid=!0;this.snapshot&&this.snapshot.resize(b,d);a&&null!==this.key&&(this.onChangeSource.dispatch(this,b,d),this._autoplay&&(this.video.play(),this.onPlay.dispatch(this,this.loop,this.playbackRate)))},complete:function(){this.onComplete.dispatch(this)},
play:function(a,b){void 0===a&&(a=!1);void 0===b&&(b=1);this.game.sound.onMute&&(this.game.sound.onMute.add(this.setMute,this),this.game.sound.onUnMute.add(this.unsetMute,this),this.game.sound.mute&&this.setMute());this.game.onPause.add(this.setPause,this);this.game.onResume.add(this.setResume,this);this.video.addEventListener("ended",this.complete.bind(this),!0);this.video.loop=a?"loop":"";this.video.playbackRate=b;this.touchLocked?this._pending=!0:(this._pending=!1,null!==this.key&&(4!==this.video.readyState?
(this.retry=this.retryLimit,this._retryID=window.setTimeout(this.checkVideoProgress.bind(this),this.retryInterval)):this.video.addEventListener("playing",this.playHandler.bind(this),!0)),this.video.play(),this.onPlay.dispatch(this,a,b));return this},playHandler:function(){this.video.removeEventListener("playing",this.playHandler.bind(this));this.updateTexture()},stop:function(){this.game.sound.onMute&&(this.game.sound.onMute.remove(this.setMute,this),this.game.sound.onUnMute.remove(this.unsetMute,
this));this.game.onPause.remove(this.setPause,this);this.game.onResume.remove(this.setResume,this);this.isStreaming?(this.video.mozSrcObject?(this.video.mozSrcObject.stop(),this.video.src=null):(this.video.src="",this.videoStream.stop()),this.videoStream=null,this.isStreaming=!1):(this.video.removeEventListener("ended",this.complete.bind(this)),this.touchLocked?this._pending=!1:this.video.pause());return this},add:function(a){if(Array.isArray(a))for(var b=0;b<a.length;b++)a[b].loadTexture&&a[b].loadTexture(this);
else a.loadTexture(this);return this},addToWorld:function(a,b,d,e,f,h){f=f||1;h=h||1;a=this.game.add.image(a,b,this);a.anchor.set(d,e);a.scale.set(f,h);return a},render:function(){!this.disableTextureUpload&&this.playing&&this.baseTexture.dirty()},setMute:function(){this._muted||(this._muted=!0,this.video.muted=!0)},unsetMute:function(){this._muted&&!this._codeMuted&&(this._muted=!1,this.video.muted=!1)},setPause:function(){this._paused||this.touchLocked||(this._paused=!0,this.video.pause())},setResume:function(){!this._paused||
this._codePaused||this.touchLocked||(this._paused=!1,this.video.ended||this.video.play())},changeSource:function(a,b){void 0===b&&(b=!0);this.texture.valid=!1;this.video.pause();this.retry=this.retryLimit;this._retryID=window.setTimeout(this.checkVideoProgress.bind(this),this.retryInterval);this.video.src=a;this.video.load();this._autoplay=b;b||(this.paused=!0);return this},checkVideoProgress:function(){4===this.video.readyState?this.updateTexture():(this.retry--,0<this.retry?this._retryID=window.setTimeout(this.checkVideoProgress.bind(this),
this.retryInterval):console.warn("Phaser.Video: Unable to start downloading video in time",this.isStreaming))},setTouchLock:function(){this.game.input.touch.addTouchLockCallback(this.unlock,this);this.touchLocked=!0},unlock:function(){this.touchLocked=!1;this.video.play();this.onPlay.dispatch(this,this.loop,this.playbackRate);if(this.key){var a=this.game.cache.getVideo(this.key);a&&!a.isBlob&&(a.locked=!1)}return!0},grab:function(a,b,d){void 0===a&&(a=!1);void 0===b&&(b=1);void 0===d&&(d=null);if(null===
this.snapshot)console.warn("Video.grab cannot run because Phaser.BitmapData is unavailable");else return a&&this.snapshot.cls(),this.snapshot.copy(this.video,0,0,this.width,this.height,0,0,this.width,this.height,0,0,0,1,1,b,d),this.snapshot},removeVideoElement:function(){if(this.video){for(this.video.parentNode&&this.video.parentNode.removeChild(this.video);this.video.hasChildNodes();)this.video.removeChild(this.video.firstChild);this.video.removeAttribute("autoplay");this.video.removeAttribute("src");
this.video=null}},destroy:function(){this.stop();this.removeVideoElement();this.touchLocked&&this.game.input.touch.removeTouchLockCallback(this.unlock,this);this._retryID&&window.clearTimeout(this._retryID)}};Object.defineProperty(b.Video.prototype,"currentTime",{get:function(){return this.video?this.video.currentTime:0},set:function(a){this.video.currentTime=a}});Object.defineProperty(b.Video.prototype,"duration",{get:function(){return this.video?this.video.duration:0}});Object.defineProperty(b.Video.prototype,
"progress",{get:function(){return this.video?this.video.currentTime/this.video.duration:0}});Object.defineProperty(b.Video.prototype,"mute",{get:function(){return this._muted},set:function(a){a?this._muted||(this._codeMuted=!0,this.setMute()):this._muted&&(this._codeMuted=!1,this.unsetMute())}});Object.defineProperty(b.Video.prototype,"paused",{get:function(){return this._paused},set:function(a){this.touchLocked||(a?this._paused||(this._codePaused=!0,this.setPause()):this._paused&&(this._codePaused=
!1,this.setResume()))}});Object.defineProperty(b.Video.prototype,"volume",{get:function(){return this.video?this.video.volume:1},set:function(a){0>a?a=0:1<a&&(a=1);this.video&&(this.video.volume=a)}});Object.defineProperty(b.Video.prototype,"playbackRate",{get:function(){return this.video?this.video.playbackRate:1},set:function(a){this.video&&(this.video.playbackRate=a)}});Object.defineProperty(b.Video.prototype,"loop",{get:function(){return this.video?this.video.loop:!1},set:function(a){a&&this.video?
this.video.loop="loop":this.video&&(this.video.loop="")}});Object.defineProperty(b.Video.prototype,"playing",{get:function(){return!(this.video.paused&&this.video.ended)}});b.Video.prototype.constructor=b.Video;void 0===PIXI.blendModes&&(PIXI.blendModes=b.blendModes);void 0===PIXI.scaleModes&&(PIXI.scaleModes=b.scaleModes);void 0===PIXI.Texture.emptyTexture&&(PIXI.Texture.emptyTexture=new PIXI.Texture(new PIXI.BaseTexture));void 0===PIXI.DisplayObject._tempMatrix&&(PIXI.DisplayObject._tempMatrix=
new PIXI.Matrix);void 0===PIXI.RenderTexture.tempMatrix&&(PIXI.RenderTexture.tempMatrix=new PIXI.Matrix);void 0===PIXI.Graphics.POLY&&(PIXI.Graphics.POLY=b.POLYGON,PIXI.Graphics.RECT=b.RECTANGLE,PIXI.Graphics.CIRC=b.CIRCLE,PIXI.Graphics.ELIP=b.ELLIPSE,PIXI.Graphics.RREC=b.ROUNDEDRECTANGLE);PIXI.TextureSilentFail=!0;"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=b),exports.Phaser=b):"undefined"!==typeof define&&define.amd?define("Phaser",this.Phaser=
b):this.Phaser=b;return b}).call(this);
